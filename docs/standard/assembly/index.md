---
title: .NET のアセンブリ
ms.date: 07/10/2018
ms.assetid: 149f5ca5-5b34-4746-9542-1ae43b2d0256
---
# <a name="assemblies-in-net"></a><span data-ttu-id="5ad65-102">.NET のアセンブリ</span><span class="sxs-lookup"><span data-stu-id="5ad65-102">Assemblies in .NET</span></span>

<span data-ttu-id="5ad65-103">アセンブリは、.NET ベースのアプリケーションの配置、バージョン管理、再利用、アクティベーション スコープ、およびセキュリティ権限の基本単位です。</span><span class="sxs-lookup"><span data-stu-id="5ad65-103">Assemblies form the fundamental unit of deployment, version control, reuse, activation scoping, and security permissions for a .NET-based application.</span></span> <span data-ttu-id="5ad65-104">アセンブリは、実行可能 (.exe) ファイルまたはダイナミック リンク ライブラリ (.dll) ファイルの形を取る、.NET アプリケーションの構成要素です。</span><span class="sxs-lookup"><span data-stu-id="5ad65-104">Assemblies take the form of an executable (.exe) file or dynamic link library (.dll) file, and are the building blocks of the .NET applications.</span></span> <span data-ttu-id="5ad65-105">それらは、型の実装に関して必要な情報を共通言語ランタイムに提供します。</span><span class="sxs-lookup"><span data-stu-id="5ad65-105">They provide the common language runtime with the information it needs to be aware of type implementations.</span></span> <span data-ttu-id="5ad65-106">アセンブリは、機能的な論理的な単位を形成し、連携して動作するように構築された、型とリソースのコレクションと考えることができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-106">You can think of an assembly as a collection of types and resources that form a logical unit of functionality and are built to work together.</span></span>

<span data-ttu-id="5ad65-107">.NET Core と .NET Framework では、1 つまたは複数のソース コード ファイルからアセンブリをビルドできます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-107">In .NET Core and .NET Framework, an assembly can be built from one or more source code files.</span></span> <span data-ttu-id="5ad65-108">.NET Framework では、アセンブリに 1 つまたは複数のモジュールを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-108">In .NET Framework, assemblies can contain one or more modules.</span></span> <span data-ttu-id="5ad65-109">これを使うと、複数の個別の開発者が別々のソース コード ファイルやモジュールで作業し、それらを組み合わせて 1 つのアセンブリを作成することで、より大規模なプロジェクトの計画が可能になります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-109">This allows larger projects to be planned in such a way that several individual developers work on separate source code files or modules, which are combined to create a single assembly.</span></span> <span data-ttu-id="5ad65-110">モジュールについて詳しくは、「[方法:マルチファイル アセンブリをビルドする](../../framework/app-domains/how-to-build-a-multifile-assembly.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-110">For more information about modules, see [How to: Build a Multifile Assembly](../../framework/app-domains/how-to-build-a-multifile-assembly.md).</span></span>

<span data-ttu-id="5ad65-111">アセンブリには、次の特徴があります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-111">Assemblies have the following properties:</span></span>

- <span data-ttu-id="5ad65-112">アセンブリは、.exe または .dll ファイルとして実装されます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-112">Assemblies are implemented as .exe or .dll files.</span></span>

- <span data-ttu-id="5ad65-113">.NET Framework をターゲットにするライブラリの場合、アセンブリを[グローバル アセンブリ キャッシュ](../../framework/app-domains/gac.md)に配置することで、それをアプリケーション間で共有することができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-113">For libraries that target the .NET Framework, you can share an assembly between applications by putting it in the [global assembly cache](../../framework/app-domains/gac.md).</span></span> <span data-ttu-id="5ad65-114">グローバル アセンブリ キャッシュに含める前に、アセンブリに厳密な名前を付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-114">Assemblies must be strong-named before they can be included in the global assembly cache.</span></span> <span data-ttu-id="5ad65-115">詳細については、「[厳密な名前付きアセンブリ](../../framework/app-domains/strong-named-assemblies.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-115">For more information, see [Strong-Named Assemblies](../../framework/app-domains/strong-named-assemblies.md).</span></span>

- <span data-ttu-id="5ad65-116">アセンブリは、必要な場合にのみメモリに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-116">Assemblies are only loaded into memory if they are required.</span></span> <span data-ttu-id="5ad65-117">使用されない場合、読み込まれることはありません。</span><span class="sxs-lookup"><span data-stu-id="5ad65-117">If they are not used, they are not loaded.</span></span> <span data-ttu-id="5ad65-118">これは、アセンブリを使用すると、大規模なプロジェクト内のリソースを効率的に管理できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="5ad65-118">This means that assemblies can be an efficient way to manage resources in larger projects.</span></span>

- <span data-ttu-id="5ad65-119">リフレクションを使用して、アセンブリに関する情報をプログラムによって取得できます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-119">You can programmatically obtain information about an assembly by using reflection.</span></span> <span data-ttu-id="5ad65-120">詳細については、「[リフレクション (C#)](../../csharp/programming-guide/concepts/reflection.md)」または「[リフレクション (Visual Basic)](../../visual-basic/programming-guide/concepts/reflection.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-120">For more information, see [Reflection (C#)](../../csharp/programming-guide/concepts/reflection.md) or [Reflection (Visual Basic)](../../visual-basic/programming-guide/concepts/reflection.md).</span></span>

- <span data-ttu-id="5ad65-121">アセンブリの読み込みは、<xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A?displayProperty=nameWithType> メソッドを呼び出してそれを検査するためにのみ実行できます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-121">You can load an assembly only to inspect it by calling a method <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A?displayProperty=nameWithType>.</span></span>

## <a name="assembly-manifest"></a><span data-ttu-id="5ad65-122">アセンブリ マニフェスト</span><span class="sxs-lookup"><span data-stu-id="5ad65-122">Assembly manifest</span></span>

<span data-ttu-id="5ad65-123">すべてのアセンブリの中にあるのが "*アセンブリ マニフェスト*" です。</span><span class="sxs-lookup"><span data-stu-id="5ad65-123">Within every assembly is an *assembly manifest*.</span></span> <span data-ttu-id="5ad65-124">目次と同じように、アセンブリ マニフェストには次の項目が含まれます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-124">Similar to a table of contents, the assembly manifest contains the following:</span></span>

- <span data-ttu-id="5ad65-125">アセンブリの ID (名前とバージョン)。</span><span class="sxs-lookup"><span data-stu-id="5ad65-125">The assembly's identity (its name and version).</span></span>

- <span data-ttu-id="5ad65-126">アセンブリを構成するその他すべてのファイルについて記述するファイル テーブル (自分で作成したその他のアセンブリで .exe や .dll ファイルが依存しているもの、またはビットマップや Readme ファイルなど)。</span><span class="sxs-lookup"><span data-stu-id="5ad65-126">A file table describing all the other files that make up the assembly, such as other assemblies you created that your .exe or .dll file relies on, or even bitmap or Readme files.</span></span>

- <span data-ttu-id="5ad65-127">"*アセンブリ参照リスト*"。これは、すべての外部依存関係の一覧です。アプリケーションが必要とする .dll ファイルやその他のファイルであり、他のユーザーが作成したものを含む場合もあります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-127">An *assembly reference list*, which is a list of all external dependencies — .dlls or other files your application needs that may have been created by someone else.</span></span> <span data-ttu-id="5ad65-128">アセンブリ参照には、グローバルおよびプライベートの両方のオブジェクトへの参照が含まれます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-128">Assembly references contain references to both global and private objects.</span></span> <span data-ttu-id="5ad65-129">グローバル オブジェクトは、その他のすべてのアプリケーションで利用できます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-129">Global objects are available to all other applications.</span></span> <span data-ttu-id="5ad65-130">.NET Core では、それらは特定の .NET Core ランタイムと組み合わされます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-130">In .NET Core, they are coupled with a particular .NET Core runtime.</span></span> <span data-ttu-id="5ad65-131">.NET Framework では、それらはグローバル アセンブリ キャッシュ内にあります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-131">In .NET Framework, they reside in the global assembly cache.</span></span> <span data-ttu-id="5ad65-132"><xref:System.IO?displayProperty=nameWithType> 名前空間は、グローバル アセンブリ キャッシュ内のアセンブリの例です。</span><span class="sxs-lookup"><span data-stu-id="5ad65-132">The <xref:System.IO?displayProperty=nameWithType> namespace is an example of an assembly in the global assembly cache.</span></span> <span data-ttu-id="5ad65-133">プライベート オブジェクトは、アプリケーションがインストールされているディレクトリと同じレベルまたはその下のディレクトリ内に存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-133">Private objects must be in a directory at either the same level as or below the directory in which your application is installed.</span></span>

<span data-ttu-id="5ad65-134">アセンブリにはコンテンツ、バージョン管理、および依存関係に関する情報が含まれているため、それらを使用するアプリケーションは、Windows のレジストリ値に依存しなくても正常に機能することができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-134">Because assemblies contain information about content, versioning, and dependencies, the applications that use them need not rely don Windows registry values to function properly.</span></span> <span data-ttu-id="5ad65-135">アセンブリは、.dll の競合を減らし、アプリケーションの信頼性を高め、配置を容易にします。</span><span class="sxs-lookup"><span data-stu-id="5ad65-135">Assemblies reduce .dll conflicts and make your applications more reliable and easier to deploy.</span></span> <span data-ttu-id="5ad65-136">多くの場合、.NET ベースのアプリケーションは、ターゲット コンピューターにそのファイルをコピーするだけでインストールすることができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-136">In many cases, you can install a .NET-based application simply by copying its files to the target computer.</span></span> <span data-ttu-id="5ad65-137">詳細については、「[アセンブリ マニフェスト](../../framework/app-domains/assembly-manifest.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-137">For more information, see [Assembly Manifest](../../framework/app-domains/assembly-manifest.md).</span></span>

## <a name="adding-a-reference-to-an-assembly"></a><span data-ttu-id="5ad65-138">アセンブリへの参照の追加</span><span class="sxs-lookup"><span data-stu-id="5ad65-138">Adding a reference to an assembly</span></span>

<span data-ttu-id="5ad65-139">アセンブリを使用するには、アセンブリへの参照を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-139">To use an assembly, you must add a reference to it.</span></span> <span data-ttu-id="5ad65-140">次に、C# の [using ディレクティブ](../../csharp/language-reference/keywords/using-directive.md)、または Visual Basic の [Imports ステートメント](../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)を使って、使用する項目の名前空間を選択できます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-140">Next, you can use the [using directive](../../csharp/language-reference/keywords/using-directive.md) for C# or [Imports statement](../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md) for Visual Basic to choose the namespace of the items you want to use.</span></span> <span data-ttu-id="5ad65-141">アセンブリが参照されてインポートされた後は、その名前空間のアクセス可能なすべての型、プロパティ、メソッド、およびのその他のメンバーを、そのコードがご自分のソース ファイルの一部であるかのようにアプリケーションで使用することができます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-141">Once an assembly is referenced and imported, all the accessible types, properties, methods, and other members of its namespaces are available to your application as if their code were part of your source file.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad65-142">.NET クラス ライブラリのほとんどのアセンブリは自動的に参照されます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-142">Most assemblies from the .NET Class Library are referenced automatically.</span></span> <span data-ttu-id="5ad65-143">ただし、場合によっては、システム アセンブリが自動的に参照されない場合があります。</span><span class="sxs-lookup"><span data-stu-id="5ad65-143">In some cases, though, a system assembly may not automatically be referenced.</span></span> <span data-ttu-id="5ad65-144">.NET Core では、アセンブリを含む NuGet パッケージへの参照を追加するには、Visual Studio の NuGet パッケージ マネージャーを使用するか、アセンブリの [<PackageReference>](../../core/tools/dependencies.md#the-new-packagereference-element) 要素を \*.csproj または \*.vbproj プロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="5ad65-144">In .NET Core, you can add a reference to the NuGet package that contains the assembly either by using NuGet Package Manager in Visual Studio or by adding a [<PackageReference>](../../core/tools/dependencies.md#the-new-packagereference-element) element for the assembly to the \*.csproj or \*.vbproj project.</span></span> <span data-ttu-id="5ad65-145">.NET Framework では、アセンブリへの参照を追加するには、Visual Studio の **[参照の追加]** ダイアログを使用するか、[C#](../../csharp/language-reference/compiler-options/reference-compiler-option.md) または [Visual Basic](../../visual-basic/reference/command-line-compiler/reference.md) コンパイラに向けてコマンド ライン オプション `-reference` を使用します。</span><span class="sxs-lookup"><span data-stu-id="5ad65-145">In .NET Framework, you can add a reference to the assembly by using the **Add Reference** dialog in Visual Studio or by using the `-reference` command line option for the [C#](../../csharp/language-reference/compiler-options/reference-compiler-option.md) or [Visual Basic](../../visual-basic/reference/command-line-compiler/reference.md) compilers.</span></span>

<span data-ttu-id="5ad65-146">C# では、1 つのアプリケーションで同じアセンブリの 2 つのバージョンを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="5ad65-146">In C#, you can also use two versions of the same assembly in a single application.</span></span> <span data-ttu-id="5ad65-147">詳細については、「[extern エイリアス](../../csharp/language-reference/keywords/extern-alias.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-147">For more information, see [extern alias](../../csharp/language-reference/keywords/extern-alias.md).</span></span>

## <a name="creating-an-assembly"></a><span data-ttu-id="5ad65-148">アセンブリの作成</span><span class="sxs-lookup"><span data-stu-id="5ad65-148">Creating an assembly</span></span>

<span data-ttu-id="5ad65-149">アプリケーションをコンパイルするには、それを Visual Studio でビルドするか、.NET Core コマンド ライン インターフェイス (CLI) ツールを使ってコマンド ラインからそれをビルドするか、またはコマンド ライン コンパイラを使って .NET Framework アセンブリをビルドします。</span><span class="sxs-lookup"><span data-stu-id="5ad65-149">Compile your application by building it in Visual Studio, by building it from the command line by using .NET Core command-line interface (CLI) tools, or by building .NET Framework assemblies with a command-line compiler.</span></span> <span data-ttu-id="5ad65-150">.NET CLI ツールを使ったアセンブリのビルドについて詳しくは、「[.NET Core コマンドライン インターフェイス (CLI) ツール](../../core/tools/index.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-150">For more information about building assemblies using .NET CLI tools, see [.NET Core command-line interface (CLI) tools](../../core/tools/index.md).</span></span> <span data-ttu-id="5ad65-151">コマンド ライン コンパイラを使ったアセンブリのビルドについては、「[csc.exe を使用したコマンド ラインからのビルド](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)」(C#)、および[コマンド ラインからのビルド](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) (Visual Basic) に関する記事をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="5ad65-151">For building assemblies with the command-line compilers, see [Command-line build with csc.exe](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md) for C# and [Building from the Command Line](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) for Visual Basic.</span></span>

> [!NOTE]
> <span data-ttu-id="5ad65-152">Visual Studio でアセンブリをビルドするには、**[ビルド]** メニューの **[ビルド]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="5ad65-152">To build an assembly in Visual Studio, on the **Build** menu choose **Build**.</span></span>

## <a name="see-also"></a><span data-ttu-id="5ad65-153">関連項目</span><span class="sxs-lookup"><span data-stu-id="5ad65-153">See also</span></span>

- [<span data-ttu-id="5ad65-154">.NET アセンブリ ファイルの形式</span><span class="sxs-lookup"><span data-stu-id="5ad65-154">.NET assembly file format</span></span>](file-format.md)
- [<span data-ttu-id="5ad65-155">共通言語ランタイムのアセンブリ</span><span class="sxs-lookup"><span data-stu-id="5ad65-155">Assemblies in the Common Language Runtime</span></span>](../../framework/app-domains/assemblies-in-the-common-language-runtime.md)
- [<span data-ttu-id="5ad65-156">フレンド アセンブリ</span><span class="sxs-lookup"><span data-stu-id="5ad65-156">Friend Assemblies</span></span>](friend-assemblies.md)
- [<span data-ttu-id="5ad65-157">方法: アセンブリを読み込み、アンロードする (C#)</span><span class="sxs-lookup"><span data-stu-id="5ad65-157">How to: Load and Unload Assemblies (C#)</span></span>](../../csharp/programming-guide/concepts/assemblies-gac/how-to-load-and-unload-assemblies.md)
- [<span data-ttu-id="5ad65-158">方法: アセンブリを読み込み、アンロードする (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5ad65-158">How to: Load and Unload Assemblies (Visual Basic)</span></span>](../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-load-and-unload-assemblies.md)
- [<span data-ttu-id="5ad65-159">方法: .NET Core でアセンブリのアンローダビリティを使用およびデバッグする</span><span class="sxs-lookup"><span data-stu-id="5ad65-159">How to: Use and Debug Assembly Unloadability in .NET Core</span></span>](unloadability-howto.md)
- [<span data-ttu-id="5ad65-160">方法: ファイルがアセンブリであるかどうかを確認する (C#)</span><span class="sxs-lookup"><span data-stu-id="5ad65-160">How to: Determine If a File Is an Assembly (C#)</span></span>](../../csharp/programming-guide/concepts/assemblies-gac/how-to-determine-if-a-file-is-an-assembly.md)
- [<span data-ttu-id="5ad65-161">方法: ファイルがアセンブリであるかどうかを確認する (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5ad65-161">How to: Determine If a File Is an Assembly (Visual Basic)</span></span>](../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-determine-if-a-file-is-an-assembly.md)
