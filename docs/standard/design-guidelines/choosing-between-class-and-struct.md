---
title: "クラスまたは構造体の選択 | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-standard"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
helpviewer_keywords: 
  - "クラス ライブラリ デザインのガイドライン [.NET Framework] 構造体"
  - "クラス ライブラリ デザインのガイドライン [.NET Framework] クラス"
  - "クラスと構造体 [.NET Framework]"
  - "クラス [.NET Framework] のデザイン ガイドライン"
  - "型のデザインのガイドライン、構造体"
  - "構造体 [.NET Framework] のデザイン ガイドライン"
  - "および構造体、クラス [.NET Framework]"
  - "クラス型の設計ガイドライン"
ms.assetid: f8b8ec9b-0ba7-4dea-aadf-a93395cd804f
caps.latest.revision: 11
author: "rpetrusha"
ms.author: "ronpet"
manager: "wpickett"
caps.handback.revision: 11
---
# クラスまたは構造体の選択
すべての framework デザイナーに直面基本的な設計上の決定の 1 つは、クラス \(参照型\)、または構造体 \(値型\) として型を設計するかどうかです。 参照型と値の型の動作の違いをよく理解は、この選択を行うに不可欠です。  
  
 参照型と検討します。 値の型の最初の違いは参照型が、ガベージ コレクション ヒープに割り当てられている値の型はスタックまたは型を含むにインラインで割り当てられ、スタックがアンワインドされるときに割り当て解除は、またはその親の型が割り当て解除されたを取得します。 したがって、値型の割り当てと解放は、一般的な参照型の割り当てと解放より安価では。  
  
 次に、参照型の配列ではの不一致、つまり、配列要素に、ヒープ上に存在する参照型のインスタンスへの参照のみが割り当てられます。 値型の配列には、インライン、つまり配列の要素が値型の実際のインスタンスが割り当てられます。 そのため、値型の配列の割り当てと解放は参照型の配列の割り当てと解放よりもかなり安価です。 さらに、ほとんどの場合は、値型の配列と、参照の局所性程度が高くが発生します。  
  
 次の相違点は、メモリ使用量に関連します。 値型にボックス化を実装するインターフェイスの 1 つまたは参照型にキャストされるときです。 ボックス化解除された得られる値の型にキャストするとき。 ボックスが、ヒープ上に割り当てられたされガベージ コレクション、あまりボックス化とボックス化解除されるオブジェクトであるため、ヒープ、ガベージ コレクターと最終的には、アプリケーションのパフォーマンスに影響を及ぼすことができます。  これに対し、このようなボックス化は行われませんように参照型にキャストされます。  
  
 次に、参照型の割り当ては、値型の割り当て値全体をコピーする一方、参照をコピーします。 そのため、大規模な参照型の割り当てでは、大きな値の型の割り当てより安価です。  
  
 最後に、値によって渡される値型は、参照型は、参照によって渡されます。 参照型のインスタンスへの変更では、インスタンスを指すすべての参照に影響します。 値型のインスタンスは、値によって渡されるときにコピーされます。 値型のインスタンスが変更されたときに、もちろんは変わりませんは、そのコピーのいずれか。 コピーがユーザーによって明示的に作成されませんが、引数が渡されるまたは返される値を返すときに暗黙的に作成されたであるために、変更可能な値の型は多くのユーザーが混乱することができます。 そのため、値型は変更できません。  
  
 経験上、として、framework の型の大部分は、クラスをする必要があります。 ただし、状況によっては、値型の特性やすく構造体を使用した方が適切があります。  
  
 **✓ を検討してください** 型のインスタンスが小型でよく有効期間の短い、またはその他のオブジェクトに埋め込まれている一般的場合は、クラスの代わりに構造体を定義することです。  
  
 **X 回避** 型にすべての次の特性がある存在しない限り、構造体を定義します。  
  
-   プリミティブ型のような単一の値を論理的に表す \(`int`, 、`double`, などです。\)。  
  
-   16 バイト未満のサイズのインスタンスがあります。  
  
-   変更可能なことはできません。  
  
-   頻繁にボックス化することはありません。  
  
 その他の場合は、クラスとして、型を定義する必要があります。  
  
 *部分 © 2005年、2009 Microsoft Corporation します。 All rights reserved.*  
  
 *翔泳社からのアクセス許可によって検出 [Framework デザイン ガイドライン: 規則が、表現方法と再利用可能な .NET ライブラリを 2 nd Edition パターン](http://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619) は Cwalina Brad エイブラムスによる、Microsoft Windows の開発シリーズの一部として Addison\-wesley Professional、2008 年 10 月 22 日を公開します。*  
  
## 参照  
 [型デザインのガイドライン](../../../docs/standard/design-guidelines/type.md)   
 [Framework デザイン ガイドライン](../../../docs/standard/design-guidelines/index.md)