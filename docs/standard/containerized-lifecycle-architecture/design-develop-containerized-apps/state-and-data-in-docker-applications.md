---
title: Docker アプリケーションの状態とデータ
description: Microsoft プラットフォームとツールでコンテナー化された Docker アプリケーションのライフサイクル
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 09/22/2017
ms.openlocfilehash: 78db191bdec4c25c11728d819d89eaaaff4bd7da
ms.sourcegitcommit: 3ab9254890a52a50762995fa6d7d77a00348db7e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2018
ms.locfileid: "46488991"
---
# <a name="state-and-data-in-docker-applications"></a><span data-ttu-id="6e2a7-103">Docker アプリケーションの状態とデータ</span><span class="sxs-lookup"><span data-stu-id="6e2a7-103">State and data in Docker applications</span></span>

<span data-ttu-id="6e2a7-104">コンテナーのプリミティブ型では、不変性です。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-104">A primitive of containers is immutability.</span></span> <span data-ttu-id="6e2a7-105">VM と比較すると、コンテナーはしない共通の出現として表示されなくなります。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-105">When compared to a VM, containers don't disappear as a common occurrence.</span></span> <span data-ttu-id="6e2a7-106">配信不能処理、CPU の過負荷、または完全または失敗したディスクからのさまざまな形式で、VM が失敗します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-106">A VM might fail in various forms from dead processes, overloaded CPU, or a full or failed disk.</span></span> <span data-ttu-id="6e2a7-107">まだ、VM を使用する予定し、RAID ドライブがドライブ障害、データの管理を保証するために一般的です。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-107">Yet, we expect the VM to be available and RAID drives are commonplace to assure drive failures maintain data.</span></span>

<span data-ttu-id="6e2a7-108">ただし、コンテナーがプロセスのインスタンスがあると考えられます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-108">However, containers are thought to be instances of processes.</span></span> <span data-ttu-id="6e2a7-109">プロセスは、永続的な状態で保持されません。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-109">A process doesn't maintain durable state.</span></span> <span data-ttu-id="6e2a7-110">場合でも、コンテナーは、そのローカル ストレージに書き込むことができます、ことと、そのインスタンスが無期限の周囲になりますと仮定した場合と同じことと仮定すると、メモリの単一コピーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-110">Even though a container can write to its local storage, assuming that that instance will be around indefinitely would be equivalent to assuming a single-copy memory will be durable.</span></span> <span data-ttu-id="6e2a7-111">プロセスなどのコンテナーが複製されます、強制終了または、移動される可能性がコンテナー オーケストレーターで管理対象、ことを想定してください。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-111">You should assume that containers, like processes, are duplicated, killed, or, when managed with a container orchestrator, they might be moved.</span></span>

<span data-ttu-id="6e2a7-112">Docker と呼ばれる機能を使用して、*オーバーレイ ファイル システム*いずれかを格納する書き込み時コピー処理を実装するには、基になる元のイメージと比較して、コンテナーのルート ファイル システムに情報を更新します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-112">Docker uses a feature known as an *overlay file system* to implement a copy-on-write process that stores any updated information to the root file system of a container, compared to the original image on which it is based.</span></span> <span data-ttu-id="6e2a7-113">コンテナーはその後、システムから削除する場合、これらの変更は失われます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-113">These changes are lost if the container is subsequently deleted from the system.</span></span> <span data-ttu-id="6e2a7-114">コンテナーであり、そのためが永続的なストレージ既定では。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-114">A container, therefore, does not have persistent storage by default.</span></span> <span data-ttu-id="6e2a7-115">コンテナーの状態を保存することはできますが、この問題を回避、システムの設計となりますコンテナー アーキテクチャの原則と競合しています。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-115">Although it's possible to save the state of a container, designing a system around this would be in conflict with the principle of container architecture.</span></span>

<span data-ttu-id="6e2a7-116">Docker アプリケーションの永続的なデータを管理するには、一般的な解決策があります。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-116">To manage persistent data in Docker applications, there are common solutions:</span></span>

-   <span data-ttu-id="6e2a7-117">[**データ ボリューム**](https://docs.docker.com/engine/tutorials/dockervolumes/) これらのだけ説明するように、ホストにマウントします。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-117">[**Data volumes**](https://docs.docker.com/engine/tutorials/dockervolumes/) These mount to the host, as just noted.</span></span>

-   <span data-ttu-id="6e2a7-118">[**データ ボリューム コンテナー**](https://docs.docker.com/engine/tutorials/dockervolumes/#/creating-and-mounting-a-data-volume-container) サイクルできますを外部のコンテナーを使用して、コンテナー間で共有記憶域を提供します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-118">[**Data volume containers**](https://docs.docker.com/engine/tutorials/dockervolumes/#/creating-and-mounting-a-data-volume-container) These provide shared storage across containers, using an external container that can cycle.</span></span>

-   <span data-ttu-id="6e2a7-119">[**ボリューム プラグイン**](https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume) これら長期的な永続化を提供するリモートの場所へのボリュームのマウントします。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-119">[**Volume Plugins**](https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume) These mount volumes to remote locations, providing long-term persistence.</span></span>

-   <span data-ttu-id="6e2a7-120">**リモート データ ソース** 例は、SQL および NOSQL データベースを含めるまたは Redis のようなキャッシュ サービス。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-120">**Remote data sources** Examples include SQL and NO-SQL databases or cache services like Redis.</span></span>

-   <span data-ttu-id="6e2a7-121">[**Azure Storage**](https://docs.microsoft.com/azure/storage/) geo 再頒布可能プラットフォームはコンテナーの最適な長期的な永続化を提供するサービス (PaaS) 記憶域として提供します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-121">[**Azure Storage**](https://docs.microsoft.com/azure/storage/) This provides geo distributable platform as a service (PaaS) storage, providing the best of containers as long-term persistence.</span></span>

<span data-ttu-id="6e2a7-122">バイパスする 1 つまたは複数のコンテナー内のディレクトリを特別に指定されたデータ ボリューム、[共用体のファイル システム](https://docs.docker.com/glossary/?term=Union%20file%20system)します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-122">Data volumes are specially designated directories within one or more containers that bypass the [Union File System](https://docs.docker.com/glossary/?term=Union%20file%20system).</span></span> <span data-ttu-id="6e2a7-123">データ ボリュームは、データ、コンテナーのライフ サイクルの独立を維持するために設計されています。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-123">Data volumes are designed to maintain data, independent of the container's life cycle.</span></span> <span data-ttu-id="6e2a7-124">Docker したがってしないと自動的に削除ボリュームはそのコンテナーによって参照されなく「ガベージ収集」のボリュームも、コンテナーは削除します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-124">Docker therefore never automatically deletes volumes when you remove a container, nor will it "garbage collect" volumes that are no longer referenced by a container.</span></span> <span data-ttu-id="6e2a7-125">ホスト オペレーティング システムでは、参照でき、任意のボリュームのデータを自由に編集データ ボリュームを慎重に使用するもう 1 つの理由であることができます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-125">The host operating system can browse and edit the data in any volume freely, which is just another reason to use data volumes sparingly.</span></span>

<span data-ttu-id="6e2a7-126">A[データ ボリューム コンテナー](https://docs.docker.com/glossary/?term=volume)では、通常のデータ ボリューム。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-126">A [data volume container](https://docs.docker.com/glossary/?term=volume) is an improvement over regular data volumes.</span></span> <span data-ttu-id="6e2a7-127">休止コンテナー (前述) 内に作成された 1 つまたは複数のデータ ボリュームが含まれている本質的にすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-127">It is essentially a dormant container that has one or more data volumes created within it (as described earlier).</span></span> <span data-ttu-id="6e2a7-128">データ ボリューム コンテナーを使用すると、中央のマウント ポイントからコンテナーへアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-128">The data volume container provides access to containers from a central mount point.</span></span> <span data-ttu-id="6e2a7-129">このアクセス方法の利点は、データ コンテナーは論理マウント ポイントの作成元のデータの場所が抽象化です。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-129">The benefit of this method of access is that it abstracts the location of the original data, making the data container a logical mount point.</span></span> <span data-ttu-id="6e2a7-130">また、"application"コンテナーの作成と破棄専用コンテナーに永続的なデータを維持しながらデータ コンテナーのボリュームにアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-130">It also allows "application" containers accessing the data container volumes to be created and destroyed while keeping the data persistent in a dedicated container.</span></span>

<span data-ttu-id="6e2a7-131">図 4-5 では、通常の Docker ボリューム コンテナー自体ものの、ホスト サーバー/VM の物理的な境界内での記憶域上に配置できることを示します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-131">Figure 4-5 shows that regular Docker volumes can be placed on storage out of the containers themselves but within the host server/VM physical boundaries.</span></span> <span data-ttu-id="6e2a7-132">*Docker ボリュームは 1 つのホスト サーバーまたは VM から別のボリュームを使用する機能がない*します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-132">*Docker volumes don't have the ability to use a volume from one host server/VM to another*.</span></span>

![](./media/image5.png)

<span data-ttu-id="6e2a7-133">図 4-5: データ ボリュームとコンテナー アプリ/コンテナーの外部データ ソース</span><span class="sxs-lookup"><span data-stu-id="6e2a7-133">Figure 4-5: Data volumes and external data sources for containers apps/containers</span></span>

<span data-ttu-id="6e2a7-134">別々 の物理ホスト上で実行されるコンテナー間で共有されるデータを管理することができないのためお勧め使用しないことのボリュームのビジネス データ、Docker ホストが固定ホストおよび VM、しない限り、ため、オーケストレーターで Docker コンテナーを使用する場合コンテナーは、1 から、クラスターで実行される最適化に応じて、別のホストに移動する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-134">Due to the inability to manage data shared between containers that run on separate physical hosts, it is recommended that you not use volumes for business data unless the Docker host is a fixed host/VM, because when using Docker containers in an orchestrator, containers are expected to be moved from one to another host, depending on the optimizations to be performed by the cluster.</span></span>

<span data-ttu-id="6e2a7-135">そのため、通常のデータ ボリュームは、トレース ファイルやテンポラル ファイルなどの場合、または複数のホストは、コンテナーは移動されませんにはビジネス データの整合性に影響する同様の概念を使用する適切なメカニズムです。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-135">Therefore, regular data volumes are a good mechanism to work with trace files, temporal files, or any similar concept that won't affect the business data consistency if or when your containers are moved across multiple hosts.</span></span>

<span data-ttu-id="6e2a7-136">[ボリューム プラグイン](https://docs.docker.com/engine/extend/plugins_volume/)クラスター内のすべてのホスト間でデータを提供します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-136">[Volume plug-ins](https://docs.docker.com/engine/extend/plugins_volume/) provide data across all hosts in a cluster.</span></span> <span data-ttu-id="6e2a7-137">すべてのボリューム プラグインは同じように作成されますが、ボリューム プラグインは通常、不変のコンテナーから外部化されているの永続的な信頼性の高いストレージを提供します。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-137">Although not all volume plug-ins are created equally, volume plug-ins typically provide externalized persistent reliable storage from the immutable containers.</span></span>

<span data-ttu-id="6e2a7-138">リモート データ ソースと SQL Database、DocumentDB、Redis のようなリモート キャッシュなどのキャッシュは、コンテナーなしで開発と同じでになります。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-138">Remote data sources and caches like SQL Database, DocumentDB, or a remote cache like Redis would be the same as developing without containers.</span></span> <span data-ttu-id="6e2a7-139">これは、ビジネス アプリケーションのデータを格納する優先、および実績のある方法のいずれかです。</span><span class="sxs-lookup"><span data-stu-id="6e2a7-139">This is one of the preferred, and proven, ways to store business application data.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="6e2a7-140">[前へ](monolithic-applications.md)
[次へ](soa-applications.md)</span><span class="sxs-lookup"><span data-stu-id="6e2a7-140">[Previous](monolithic-applications.md)
[Next](soa-applications.md)</span></span>
