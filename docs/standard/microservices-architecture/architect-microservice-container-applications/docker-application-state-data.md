---
title: "状態と Docker のアプリケーションでのデータ"
description: "コンテナーの .NET アプリケーションの .NET Microservices アーキテクチャ |状態と Docker のアプリケーションでのデータ"
keywords: "Docker, Microservices、ASP.NET、コンテナー、SQL、CosmosDB、Docker"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 36d0fb9f27ef56b36c380e2fc972c79cff77003e
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/22/2017
---
# <a name="state-and-data-in-docker-applications"></a>状態と Docker のアプリケーションでのデータ

ほとんどの場合は、プロセスのインスタンスとコンテナーの考えることができます。 プロセスでは、永続的な状態は保持されません。 コンテナーは、そのローカル ストレージに書き込むことができます、中には、メモリ内の 1 つの場所が持続的にすると仮定した場合のようになりますインスタンスがなるを無期限と仮定した場合します。 プロセスと同様に、コンテナー イメージを複数のインスタンスを持つ見なさまたは強制終了最終的にはコンテナー オーケストレータで管理されています、その必要がありますと見なされます、可能性があります取得から移動である 1 つのノードまたは VM 間。

Docker と呼ばれる機能を提供する、*ファイル システムをオーバーレイ*です。 これは、ストアが、ルート ファイル システムにコンテナーの情報を更新するコピー オン ライト タスクを実装します。 情報は、コンテナーの基になる元のイメージにはさらにします。 コンテナーが削除された場合、システムから、それらの変更は失われます。 そのため、そのローカル記憶域内のコンテナーの状態を保存することはできますが、この問題を回避システムの設計と競合コンテナー設計では既定ではステートレスの内部設置型です。

次のソリューションを使用すると、Docker のアプリケーションで永続的なデータを管理します。

-   [データ ボリューム](https://docs.docker.com/engine/tutorials/dockervolumes/)ホストにマウントします。

-   [データ ボリューム コンテナー](https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-mounting-a-data-volume-container)外部のコンテナーを使用してコンテナー間で共有記憶域を提供します。

-   [ボリューム プラグイン](https://docs.docker.com/engine/tutorials/dockervolumes/)長期的な永続化を提供するリモート サービスにボリュームをマウントします。

-   [Azure ストレージ](https://docs.microsoft.com/azure/storage/)、コンテナーに対する適切な長期的な永続化ソリューションを提供する、geo 配布可能な記憶域を提供します。

-   リモートのリレーショナル データベースと同様に[Azure SQL Database](https://azure.microsoft.com/services/sql-database/)などの NoSQL データベースまたは[Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/introduction)、やなどのサービスをキャッシュ[Redis](https://redis.io/)です。

次に、これらのオプションについての詳細を提供します。

**データ ボリューム**コンテナー内のディレクトリに、ホスト OS からマップされたディレクトリであります。 ときに、コンテナー内のコードは、アクセスは、ホスト OS 上のディレクトリに実際には、ディレクトリへのアクセスを持っています。 このディレクトリは、コンテナー、自体の有効期間に関連付けられていないと、ディレクトリに直接ホスト OS で実行されているコードからアクセスできるまたは別のコンテナーでそれ自体に、同じホストのディレクトリをマップします。 したがって、データ ボリュームは、コンテナーの有効期間とは別にデータを保持する設計されています。 コンテナーを削除するかで Docker ホストのデータからイメージが保存される場合、データ ボリュームは削除されません。 ボリュームのデータは、ホスト OS もからアクセスできます。

**データ ボリューム コンテナー**の通常のデータ ボリュームの発展させたものです。 データ ボリューム コンテナーとは、その中の 1 つまたは複数のデータ ボリュームのある単純なコンテナーです。 データ ボリューム コンテナーは、中央のマウント ポイントから、コンテナーにアクセスを提供します。 データ アクセスのこのメソッドは、元のデータの場所を抽象化ので便利です。 それを除けば、その動作は、アプリケーションのコンテナーのライフ サイクルとは無関係に、この専用コンテナー内のデータが永続化されるため、通常のデータ ボリュームに似ています。

図 4-5 に示すように、コンテナー自体の外部では、ホスト サーバーまたは VM の物理的な境界内で正規の Docker ボリュームに格納できます。 ただし、Docker コンテナーは、別に、1 つのホスト サーバーまたは VM からボリュームをアクセスできません。 つまり、これらのボリュームでことはできませんを別の Docker ホストに実行しているコンテナー間で共有データを管理するには

![](./media/image5.png)

**図 4-5**です。 データのボリュームとコンテナー ベースのアプリケーションの外部データ ソース

さらに、Docker コンテナーは、orchestrator によって管理されている、ときにコンテナー可能性があります""ホスト間で移動、クラスターによって行われる最適化によって異なります。 したがって、ビジネス データをデータ ボリュームを使用することをいないお勧めします。 トレース ファイル、テンポラル ファイルを使用する適切なメカニズムはまたはも、類似するには影響しませんビジネス データの一貫性。

**ボリューム プラグイン**など[Flocker](https://clusterhq.com/flocker/)クラスター内のすべてのホスト間でデータ アクセスを提供します。 すべてのボリューム プラグインが同様に作成される、中にボリュームのプラグインは通常外部化された永続的な信頼性の高い記憶域の変更できないコンテナーを提供します。

**リモート データ ソースとキャッシュ**コンテナー詰めアプリケーション コンテナーせずを開発するときの使用は Azure SQL Database、Azure Cosmos DB、またはリモートのキャッシュで Redis を使用できるようになどのツールです。 これは、実績のあるビジネス アプリケーション データの格納方法です。

**Azure のストレージです。** ビジネス データは、通常を外部のリソースまたは Azure Storage などのデータベースに配置する必要があります。 具象型での azure ストレージでは、クラウド内の次のサービスを提供します。

-   Blob ストレージでは、非構造化オブジェクト データを格納します。 Blob は、ドキュメントやメディアのファイル (画像、オーディオ、およびビデオ ファイル) などのテキストまたはバイナリ データの任意の型にすることができます。 Blob ストレージは、オブジェクトの格納とも呼ばれます。

-   ファイル記憶域は、標準の SMB プロトコルを使用してレガシ アプリケーション用の共有記憶域を提供します。 Azure の仮想マシンおよびクラウド サービスは、マウントされた共有を介してアプリケーション コンポーネント間で、ファイル データを共有することができます。 内部設置型アプリケーションは、ファイル サービス REST API を介して、共有内のファイル データにアクセスできます。

-   テーブル ストレージは、構造化されたデータセットを格納します。 テーブル ストレージは、迅速な開発と大量のデータを高速アクセスを許可する NoSQL キー属性データ ストア、です。

**リレーショナル データベースおよび NoSQL データベース。** SQL Server、PostgreSQL、Oracle、または NoSQL データベースと Azure Cosmos DB、MongoDB などのようなリレーショナル データベースから、外部のデータベースを使用する場合は、多くの選択肢があります。これらのデータベースは、まったく異なるサブジェクトであるため、このガイドの一部として説明する予定がないです。


>[!div class="step-by-step"]
[前](containerize-モノリシック-applications.md) [次へ] (サービス-指向-architecture.md)
