---
title: "ドキュメント間での既存のノードのコピー"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: "4"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 0f20e5bd595c8eb49360e58f281a8cf6eda89acf
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/18/2017
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a>ドキュメント間での既存のノードのコピー
**ImportNode**メソッドは、ノードまたはノード サブツリー全体をコピーしてから 1 つの機構**XmlDocument**別にします。 呼び出しから返されるノードは、ソース ドキュメントのノードのコピーであり、そこには属性値、ノード名、ノード型が含まれます。さらに、プレフィックス、ローカル名、名前空間 URI (Uniform Resource Identifier) など、名前空間に関連するすべての属性も含まれます。 ソース ドキュメントは変更されません。 インポートしたノードは、ノードを挿入するメソッドの 1 つを使用してツリーに追加する必要があります。  
  
 新しいドキュメントにノードを追加すると、その新しいドキュメントがそのノードを所有します。 これは、ノードが別のドキュメント フラグメントに作成される場合でも、各ノードの作成時には所有元のドキュメントが設定されるためです。 これは、XML ドキュメント オブジェクト モデル (DOM) の要件とに、設計仕様が適用されて、 **XmlDocument**クラスです。 たとえば、 **CreateElement**、新しいノードを作成する唯一の方法です。  
  
 インポートされたノード、および値のノードの種類によって、*ディープ*パラメーター、追加情報を適切にコピーされます。 XML では、あるドキュメントから別のドキュメントへ XML ソースまたは HTML ソースのフラグメントをコピーしたときに 2 つのドキュメントのドキュメント型定義 (DTD) が別々になることがありますが、このメソッドでは、その動作を再現しようとします。  
  
 インポートできるノードの型について、それぞれに固有の動作を次の表に示します。  
  
|ノード型|*ディープ*パラメーターが true|*ディープ*パラメーターが false|  
|---------------|------------------------------|-------------------------------|  
|XmlAttribute|<xref:System.Xml.XmlAttribute.Specified%2A>に設定されている**true** XmlAttribute でします。 ソースの子孫の**XmlAttribute**は再帰的にインポートし、結果として得られるノード再アセンブルされ、対応するサブツリーが形成されます。|*ディープ*パラメーターには適用されません**XmlAttribute**ノード、インポート時に、その子ノードを常に実行するためです。|  
|XmlCDataSection|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlComment|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlDocumentFragment|ソース ノードの子孫が再帰的にインポートされます。結果として得られるノードは再アセンブルされ、対応するサブツリーが形成されます。|空**XmlDocumentFragment**を作成します。|  
|XmlDocumentType|ノードがデータと共にコピーされます。*|ノードがデータと共にコピーされます。*|  
|XmlElement|ソース要素の子孫が再帰的にインポートされます。結果として得られるノードは再アセンブルされ、対応するサブツリーが形成されます。 **注:**既定の属性はコピーされません。 インポートされるドキュメントでこの要素名に対する既定の属性が定義されている場合は、それらが割り当てられます。|インポートされたノード、ソース要素の属性と、生成された指定**XmlAttribute**ノードは、新しい要素にアタッチします。 子孫ノードはコピーされません。 **注:**既定の属性はコピーされません。 インポートされるドキュメントでこの要素名に対する既定の属性が定義されている場合は、それらが割り当てられます。|  
|XmlEntityReference|このメソッドはのみコピー元とコピー先のドキュメントには、エンティティの定義が異なる可能性がある、ため、 **XmlEntityReference**ノード。 置換テキストは含まれません。 インポート先のドキュメントに同じエンティティが定義されている場合は、その値が割り当てられます。|このメソッドはのみコピー元とコピー先のドキュメントには、エンティティの定義が異なる可能性がある、ため、 **XmlEntityReference**ノード。 置換テキストは含まれません。 インポート先のドキュメントに同じエンティティが定義されている場合は、その値が割り当てられます。|  
|XmlProcessingInstruction|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|  
|XmlText|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlSignificantWhitespace|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlWhitespace|ノードをそのデータと共にコピーします。|ノードをそのデータと共にコピーします。|  
|XmlDeclaration|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|インポートされたノードから、ターゲットおよびデータの値がコピーされます。|  
|その他のすべてのノード型|これらのノード型はインポートできません。|これらのノード型はインポートできません。|  
  
> [!NOTE]
>  DocumentType ノードはインポートできますが、1 つのドキュメントは 1 つの DocumentType しか持てません。 したがって、ドキュメント型をインポートした場合は、それをツリーに挿入する前に、ドキュメント内にドキュメント型がないことを確認する必要があります。 ノードの削除方法の詳細については、次を参照してください。[ノードの削除、コンテンツ、および XML ドキュメントから値](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md)です。  
  
## <a name="see-also"></a>関連項目  
 [XML ドキュメント オブジェクト モデル (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
