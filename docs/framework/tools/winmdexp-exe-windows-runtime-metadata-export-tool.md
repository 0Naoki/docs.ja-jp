---
title: Winmdexp.exe (Windows ランタイム メタデータのエクスポート ツール)
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 8a228513bd29e35e8793124846de16f1c8bf4c10
ms.sourcegitcommit: 6eac9a01ff5d70c6d18460324c016a3612c5e268
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/17/2018
ms.locfileid: "45625036"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="adc89-102">Winmdexp.exe (Windows ランタイム メタデータのエクスポート ツール)</span><span class="sxs-lookup"><span data-stu-id="adc89-102">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>
<span data-ttu-id="adc89-103">[!INCLUDE[wrt](../../../includes/wrt-md.md)] メタデータ エクスポート ツール (Winmdexp.exe) は、.NET Framework モジュールを、[!INCLUDE[wrt](../../../includes/wrt-md.md)] メタデータを含むファイルに変換します。</span><span class="sxs-lookup"><span data-stu-id="adc89-103">The [!INCLUDE[wrt](../../../includes/wrt-md.md)] Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata.</span></span> <span data-ttu-id="adc89-104">.NET Framework アセンブリと [!INCLUDE[wrt](../../../includes/wrt-md.md)] メタデータ ファイルは同じ物理形式を使用しますが、メタデータ テーブルの内容に違いがあります。つまり、.NET Framework アセンブリは、自動的に [!INCLUDE[wrt](../../../includes/wrt-md.md)] コンポーネントとして使用できるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="adc89-104">Although .NET Framework assemblies and [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as [!INCLUDE[wrt](../../../includes/wrt-md.md)] Components.</span></span> <span data-ttu-id="adc89-105">.NET Framework モジュールを [!INCLUDE[wrt](../../../includes/wrt-md.md)] コンポーネントにするプロセスは、*エクスポート*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="adc89-105">The process of turning a .NET Framework module into a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component is referred to as *exporting*.</span></span> <span data-ttu-id="adc89-106">[!INCLUDE[net_v45](../../../includes/net-v45-md.md)] と [!INCLUDE[net_v451](../../../includes/net-v451-md.md)] では、生成される Windows メタデータ (.winmd) ファイルにメタデータと実装の両方が含まれます。</span><span class="sxs-lookup"><span data-stu-id="adc89-106">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] and [!INCLUDE[net_v451](../../../includes/net-v451-md.md)], the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="adc89-107">[!INCLUDE[vs_dev12](../../../includes/vs-dev12-md.md)] または [!INCLUDE[vs_dev11_ext](../../../includes/vs-dev11-ext-md.md)] で、C# および Visual Basic の **Windows ストア**にある **[!INCLUDE[wrt](../../../includes/wrt-md.md)] コンポーネント** テンプレートを使用する場合、コンパイラのターゲットは .winmdobj ファイルであり、後続のビルド ステップで Winmdexp.exe が呼び出され、.winmdobj ファイルが .winmd ファイルにエクスポートされます。</span><span class="sxs-lookup"><span data-stu-id="adc89-107">When you use the **[!INCLUDE[wrt](../../../includes/wrt-md.md)] Component** template, which is located under **Windows Store** for C# and Visual Basic in [!INCLUDE[vs_dev12](../../../includes/vs-dev12-md.md)] or [!INCLUDE[vs_dev11_ext](../../../includes/vs-dev11-ext-md.md)], the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="adc89-108">[!INCLUDE[wrt](../../../includes/wrt-md.md)] コンポーネントをビルドする場合は、この方法をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="adc89-108">This is the recommended way to build a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component.</span></span> <span data-ttu-id="adc89-109">Visual Studio による制御より細かくビルド プロセスを制御する場合は、Winmdexp.exe ファイルを直接使用します。</span><span class="sxs-lookup"><span data-stu-id="adc89-109">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="adc89-110">このツールは、Visual Studio と共に自動的にインストールされます。</span><span class="sxs-lookup"><span data-stu-id="adc89-110">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="adc89-111">このツールを実行するには、開発者コマンド プロンプト (または、Windows 7 の Visual Studio コマンド プロンプト) を使用します。</span><span class="sxs-lookup"><span data-stu-id="adc89-111">To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="adc89-112">詳細については、「[Visual Studio 用開発者コマンド プロンプト](../../../docs/framework/tools/developer-command-prompt-for-vs.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="adc89-112">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="adc89-113">コマンド プロンプトに次のように入力します。</span><span class="sxs-lookup"><span data-stu-id="adc89-113">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="adc89-114">構文</span><span class="sxs-lookup"><span data-stu-id="adc89-114">Syntax</span></span>  
  
```  
winmdexp [options] winmdmodule  
```  
  
#### <a name="parameters"></a><span data-ttu-id="adc89-115">パラメーター</span><span class="sxs-lookup"><span data-stu-id="adc89-115">Parameters</span></span>  
  
|<span data-ttu-id="adc89-116">引数またはオプション</span><span class="sxs-lookup"><span data-stu-id="adc89-116">Argument or option</span></span>|<span data-ttu-id="adc89-117">説明</span><span class="sxs-lookup"><span data-stu-id="adc89-117">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="adc89-118">エクスポートするモジュール (.winmdobj) を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-118">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="adc89-119">指定できるのは 1 つのモジュールのみです。</span><span class="sxs-lookup"><span data-stu-id="adc89-119">Only one module is allowed.</span></span> <span data-ttu-id="adc89-120">このモジュールを作成するには、`/target` ターゲットと共に `winmdobj` コンパイラ オプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="adc89-120">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="adc89-121">「[/target:winmdobj (C# コンパイラ オプション)](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md)」または「[/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="adc89-121">See [/target:winmdobj (C# Compiler Options)](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="adc89-122">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-122">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="adc89-123">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-123">`/d:` `docfile`</span></span>|<span data-ttu-id="adc89-124">Winmdexp.exe が生成する出力 XML ドキュメント ファイルを指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-124">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="adc89-125">[!INCLUDE[net_v45](../../../includes/net-v45-md.md)] では、出力ファイルは基本的に入力 XML ドキュメント ファイルと同じです。</span><span class="sxs-lookup"><span data-stu-id="adc89-125">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)], the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="adc89-126">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-126">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="adc89-127">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-127">`/md:` `docfile`</span></span>|<span data-ttu-id="adc89-128">コンパイラが `winmdmodule` と共に生成した XML ドキュメント ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-128">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="adc89-129">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-129">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="adc89-130">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-130">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="adc89-131">`winmdmodule` のシンボルを含むプログラム データベース (PDB) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-131">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="adc89-132">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="adc89-132">`/nowarn:` `warning`</span></span>|<span data-ttu-id="adc89-133">指定した警告番号が使用されなくなります。</span><span class="sxs-lookup"><span data-stu-id="adc89-133">Suppresses the specified warning number.</span></span> <span data-ttu-id="adc89-134">*warning* の場合は、エラー コードの数字部分だけを先行ゼロなしで指定してください。</span><span class="sxs-lookup"><span data-stu-id="adc89-134">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="adc89-135">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="adc89-135">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="adc89-136">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="adc89-136">`/o:` `file`</span></span>|<span data-ttu-id="adc89-137">出力 Windows メタデータ (.winmd) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-137">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="adc89-138">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-138">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="adc89-139">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="adc89-139">`/p:` `symbolfile`</span></span>|<span data-ttu-id="adc89-140">エクスポートされた Windows メタデータ (.winmd) ファイルのシンボルを含む出力プログラム データベース (PDB) ファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-140">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="adc89-141">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="adc89-141">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="adc89-142">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="adc89-142">`/r:` `winmd`</span></span>|<span data-ttu-id="adc89-143">エクスポート時に参照するメタデータ ファイル (.winmd またはアセンブリ) を指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-143">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="adc89-144">「\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5」(32 ビット コンピューターでは「\Program Files\\...」) にある参照アセンブリを使用する場合は、System.Runtime.dll と mscorlib.dll の両方への参照を含めます。</span><span class="sxs-lookup"><span data-stu-id="adc89-144">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="adc89-145">UTF-8 エンコードでメッセージが出力される必要があることを指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-145">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="adc89-146">すべての警告をエラーとして扱うよう指定しています。</span><span class="sxs-lookup"><span data-stu-id="adc89-146">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="adc89-147">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="adc89-147">**@** `responsefile`</span></span>|<span data-ttu-id="adc89-148">オプション (および、必要に応じて `winmdmodule`) を含む応答 (.rsp) ファイルを指定します。</span><span class="sxs-lookup"><span data-stu-id="adc89-148">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="adc89-149">`responsefile` の各行に 1 つの引数またはオプションが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="adc89-149">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="adc89-150">コメント</span><span class="sxs-lookup"><span data-stu-id="adc89-150">Remarks</span></span>  
 <span data-ttu-id="adc89-151">Winmdexp.exe は、任意の .NET Framework アセンブリを .winmd ファイルに変換するようには設計されていません。</span><span class="sxs-lookup"><span data-stu-id="adc89-151">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="adc89-152">`/target:winmdobj` オプションでコンパイルされるモジュールが必要で、追加の制限が適用されます。</span><span class="sxs-lookup"><span data-stu-id="adc89-152">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="adc89-153">この中で最も重要な制限は、アセンブリの API サーフェイスで公開されるすべての型は必ず [!INCLUDE[wrt](../../../includes/wrt-md.md)] 型であるということです。</span><span class="sxs-lookup"><span data-stu-id="adc89-153">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="adc89-154">詳細については、Windows デベロッパー センターの記事「[C# および Visual Basic での Windows ランタイム コンポーネントの作成](https://go.microsoft.com/fwlink/p/?LinkID=238313)」の「Windows ランタイム コンポーネントの宣言型」セクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="adc89-154">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](https://go.microsoft.com/fwlink/p/?LinkID=238313) in the Windows Dev Center.</span></span>  
  
 <span data-ttu-id="adc89-155">C# または Visual Basic で [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] アプリまたは [!INCLUDE[wrt](../../../includes/wrt-md.md)] コンポーネントを作成する場合は、[!INCLUDE[wrt](../../../includes/wrt-md.md)] でのプログラミングをより自然にするためのサポートが .NET Framework で提供されています。</span><span class="sxs-lookup"><span data-stu-id="adc89-155">When you write a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app or a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component with C# or Visual Basic, the .NET Framework provides support to make programming with the [!INCLUDE[wrt](../../../includes/wrt-md.md)] more natural.</span></span> <span data-ttu-id="adc89-156">これは、記事「[Windows ストア アプリおよび Windows ランタイムのための .NET Framework サポート](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)」で解説されています。</span><span class="sxs-lookup"><span data-stu-id="adc89-156">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="adc89-157">プロセスでは、一般的に使用される [!INCLUDE[wrt](../../../includes/wrt-md.md)] 型が .NET Framework 型にマップされます。</span><span class="sxs-lookup"><span data-stu-id="adc89-157">In the process, some commonly used [!INCLUDE[wrt](../../../includes/wrt-md.md)] types are mapped to .NET Framework types.</span></span> <span data-ttu-id="adc89-158">Winmdexp.exe は、このプロセスを反転し、対応する [!INCLUDE[wrt](../../../includes/wrt-md.md)] 型を使用する API サーフェイスを生成します。</span><span class="sxs-lookup"><span data-stu-id="adc89-158">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="adc89-159">たとえば、<xref:System.Collections.Generic.IList%601> インターフェイスから構築された型は、[!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](https://go.microsoft.com/fwlink/p/?LinkId=251132) インターフェイスから構築された型にマップされます。</span><span class="sxs-lookup"><span data-stu-id="adc89-159">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the [!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](https://go.microsoft.com/fwlink/p/?LinkId=251132)interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="adc89-160">参照</span><span class="sxs-lookup"><span data-stu-id="adc89-160">See Also</span></span>  
 [<span data-ttu-id="adc89-161">Windows ストア アプリおよび Windows ランタイムのための .NET Framework サポート</span><span class="sxs-lookup"><span data-stu-id="adc89-161">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)  
 [<span data-ttu-id="adc89-162">C# および Visual Basic での Windows ランタイム コンポーネントの作成</span><span class="sxs-lookup"><span data-stu-id="adc89-162">Creating Windows Runtime Components in C# and Visual Basic</span></span>](https://go.microsoft.com/fwlink/p/?LinkID=238313)  
 [<span data-ttu-id="adc89-163">Winmdexp.exe のエラー メッセージ</span><span class="sxs-lookup"><span data-stu-id="adc89-163">Winmdexp.exe Error Messages</span></span>](../../../docs/framework/tools/winmdexp-exe-error-messages.md)  
 [<span data-ttu-id="adc89-164">ビルド ツール、配置ツール、および構成ツール (.NET Framework)</span><span class="sxs-lookup"><span data-stu-id="adc89-164">Build, Deployment, and Configuration Tools (.NET Framework)</span></span>](https://msdn.microsoft.com/library/b8c921be-6012-4181-b8d4-ab15813fc9a7)
