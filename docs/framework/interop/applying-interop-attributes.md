---
title: "相互運用固有の属性の適用"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
caps.latest.revision: "10"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: 160a9597ff22ffc044cf3a35d345ba7d7e1606e4
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="0ab0b-102">相互運用固有の属性の適用</span><span class="sxs-lookup"><span data-stu-id="0ab0b-102">Applying Interop Attributes</span></span>
<span data-ttu-id="0ab0b-103"><xref:System.Runtime.InteropServices> 名前空間では、デザイン時にユーザーが適用する属性、変換処理中に COM 相互運用ツールおよび API によって適用される属性、ユーザーまたは COM 相互運用機能によって適用される属性という 3 つのカテゴリの相互運用固有の属性が提供されます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-103">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="0ab0b-104">マネージ コードに属性を適用する作業に慣れていない場合は、「[属性を使用したメタデータの拡張](../../../docs/standard/attributes/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-104">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md).</span></span> <span data-ttu-id="0ab0b-105">他のカスタム属性の場合と同様に、相互運用固有の属性は、型、メソッド、プロパティ、パラメーター、フィールド、およびその他のメンバーに対して適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-105">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="0ab0b-106">デザイン時属性</span><span class="sxs-lookup"><span data-stu-id="0ab0b-106">Design-Time Attributes</span></span>  
 <span data-ttu-id="0ab0b-107">COM 相互運用ツールおよび API によって実行された変換処理の結果を調整するには、デザイン時属性を使用します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-107">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="0ab0b-108">マネージ ソース コードに適用できる属性の説明を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-108">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="0ab0b-109">COM 相互運用ツールで、この表に示す属性を適用できる場合もあります。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-109">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="0ab0b-110">属性</span><span class="sxs-lookup"><span data-stu-id="0ab0b-110">Attribute</span></span>|<span data-ttu-id="0ab0b-111">説明</span><span class="sxs-lookup"><span data-stu-id="0ab0b-111">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="0ab0b-112">Automation Marshaler またはカスタムのプロキシとスタブを使用して、型をマーシャリングするかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-112">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="0ab0b-113">クラスに対して生成されたインターフェイスの型を制御します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-113">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="0ab0b-114">タイプ ライブラリからインポートされた元のコクラスの CLSID を識別します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-114">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="0ab0b-115">COM 相互運用ツールでは、通常、この属性が適用されます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-115">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="0ab0b-116">コクラスまたはインターフェイス定義が COM タイプ ライブラリからインポートされたことを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-116">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="0ab0b-117">ランタイムはこのフラグを使用して、型をアクティブ化およびマーシャリングする方法を認識します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-117">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="0ab0b-118">この属性は、型がタイプ ライブラリにエクスポートされることを禁止します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-118">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="0ab0b-119">COM 相互運用ツールでは、通常、この属性が適用されます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-119">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="0ab0b-120">COM から使用するためにアセンブリを登録するときに、メソッドが呼び出されるようにします。これで、登録処理中にユーザー作成コードを実行できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-120">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="0ab0b-121">クラスのイベントの発生元になるインターフェイスを識別します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-121">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="0ab0b-122">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-122">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="0ab0b-123">アセンブリが COM から登録解除されるときにメソッドが呼び出されるようにします。これで、処理中にユーザー作成コードを実行できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-123">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="0ab0b-124">属性値が **false** の場合、型は COM から参照できなくなります。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-124">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="0ab0b-125">この属性は、COM の参照可能範囲を制御するために、個別の型またはアセンブリ全体に適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-125">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="0ab0b-126">既定では、すべてのパブリックなマネージ型は参照可能なので、この属性でこれらの型を参照可能にする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-126">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="0ab0b-127">メソッドまたはフィールドの COM ディスパッチ識別子 (DISPID) を指定します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-127">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="0ab0b-128">この属性には、対象のメソッド、フィールド、またはプロパティの DISPID が含まれています。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-128">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="0ab0b-129">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-129">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="0ab0b-130">**StructLayoutAttribute** と共に使用される場合は、クラス内の各フィールドの物理的位置を示します。**LayoutKind** は Explicit に設定されます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-130">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="0ab0b-131">クラス、インターフェイス、またはタイプ ライブラリ全体のグローバル一意識別子 (GUID) を指定します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-131">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="0ab0b-132">属性に渡される文字列は、**System.Guid** 型の受け入れ可能なコンストラクター引数の形式である必要があります。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-132">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="0ab0b-133">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-133">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="0ab0b-134">COM にデュアル インターフェイスやディスパッチ インターフェイスを公開するときに、共通言語ランタイムで使用する **IDispatch** インターフェイスの実装の種類を示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-134">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="0ab0b-135">呼び出し元にデータをマーシャリングすることを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-135">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="0ab0b-136">属性パラメーターに使用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-136">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="0ab0b-137">マネージ インターフェイスを COM クライアントに公開する方法を制御します (デュアル、IUnknown から派生、または IDispatch のみ)。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-137">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="0ab0b-138">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-138">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="0ab0b-139">アンマネージ メソッド シグネチャで LCID パラメーターが必要であることを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-139">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="0ab0b-140">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-140">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="0ab0b-141">マネージ コードとアンマネージ コードとの間で、フィールドまたはパラメーター内のデータをマーシャリングする方法を示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-141">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="0ab0b-142">各データ型には既定のマーシャリング動作があるため、この属性は常に省略可能です。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-142">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="0ab0b-143">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-143">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="0ab0b-144">パラメーターが省略可能であることを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-144">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="0ab0b-145">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-145">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="0ab0b-146">フィールドまたはパラメーター内のデータが、呼び出されたオブジェクトから呼び出し元に返されるときに、マーシャリングされる必要があることを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-146">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="0ab0b-147">通常は相互運用呼び出し時に発生する、HRESULT または retval シグネチャ変換を抑止します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-147">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="0ab0b-148">この属性は、タイプ ライブラリのエクスポートだけでなく、マーシャリングにも影響します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-148">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="0ab0b-149">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-149">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="0ab0b-150">.NET Framework クラスの ProgID を指定します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-150">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="0ab0b-151">属性パラメーターに使用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-151">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="0ab0b-152">クラスのフィールドの物理レイアウトを制御します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-152">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="0ab0b-153">COM 相互運用ツールでは、この属性を適用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-153">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="0ab0b-154">変換ツール属性</span><span class="sxs-lookup"><span data-stu-id="0ab0b-154">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="0ab0b-155">変換処理中に COM 相互運用ツールが適用する属性の説明を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-155">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="0ab0b-156">これらの属性は、デザイン時には適用しません。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-156">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="0ab0b-157">属性</span><span class="sxs-lookup"><span data-stu-id="0ab0b-157">Attribute</span></span>|<span data-ttu-id="0ab0b-158">説明</span><span class="sxs-lookup"><span data-stu-id="0ab0b-158">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="0ab0b-159">パラメーターまたはフィールドの種類の COM エイリアスを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-159">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="0ab0b-160">属性パラメーター、フィールド、または戻り値に使用できます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-160">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="0ab0b-161">クラスまたはインターフェイスに関する情報が、タイプ ライブラリからアセンブリにインポートされたときに失われたことを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-161">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="0ab0b-162">ソース インターフェイスと、イベント インターフェイスのメソッドを実装するクラスを識別します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-162">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="0ab0b-163">アセンブリが元は COM タイプ ライブラリからインポートされたことを示します。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-163">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="0ab0b-164">この属性には、元のタイプ ライブラリのタイプ ライブラリ定義が含まれます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-164">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="0ab0b-165">元はこの関数のために COM タイプ ライブラリからインポートされた **FUNCFLAGS** が含まれます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-165">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="0ab0b-166">元はこの型のために COM タイプ ライブラリからインポートされた **TYPEFLAGS** が含まれます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-166">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="0ab0b-167">元はこの変数のために COM タイプ ライブラリからインポートされた **VARFLAGS** が含まれます。</span><span class="sxs-lookup"><span data-stu-id="0ab0b-167">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="0ab0b-168">関連項目</span><span class="sxs-lookup"><span data-stu-id="0ab0b-168">See Also</span></span>  
 <xref:System.Runtime.InteropServices>  
 [<span data-ttu-id="0ab0b-169">COM への .NET Framework コンポーネントの公開</span><span class="sxs-lookup"><span data-stu-id="0ab0b-169">Exposing .NET Framework Components to COM</span></span>](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)  
 [<span data-ttu-id="0ab0b-170">属性</span><span class="sxs-lookup"><span data-stu-id="0ab0b-170">Attributes</span></span>](../../../docs/standard/attributes/index.md)  
 [<span data-ttu-id="0ab0b-171">要件 (相互運用のための .NET 型の)</span><span class="sxs-lookup"><span data-stu-id="0ab0b-171">Qualifying .NET Types for Interoperation</span></span>](../../../docs/framework/interop/qualifying-net-types-for-interoperation.md)  
 [<span data-ttu-id="0ab0b-172">COM 用のアセンブリのパッケージ化</span><span class="sxs-lookup"><span data-stu-id="0ab0b-172">Packaging an Assembly for COM</span></span>](../../../docs/framework/interop/packaging-an-assembly-for-com.md)
