---
title: '方法: プロジェクト データ ソース (WCF Data Services) を使用してデータをバインドします。'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data binding, WCF Data Services
- WCF Data Services, data binding
ms.assetid: 2477af0a-676f-44f7-b73d-e66208785509
ms.openlocfilehash: 465585d93d7bb20208720dc360b2cf8e6bb5f0e4
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/23/2019
ms.locfileid: "54540755"
---
# <a name="how-to-bind-data-using-a-project-data-source-wcf-data-services"></a><span data-ttu-id="64a84-102">方法: プロジェクト データ ソース (WCF Data Services) を使用してデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="64a84-102">How to: Bind Data Using a Project Data Source (WCF Data Services)</span></span>

<span data-ttu-id="64a84-103">WCF Data Services クライアント アプリケーションで生成されたデータ オブジェクトに基づくデータ ソースを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="64a84-103">You can create data sources that are based on the generated data objects in an WCF Data Services client application.</span></span> <span data-ttu-id="64a84-104">使用してデータ サービスへの参照を追加すると、**サービス参照の追加**ダイアログ ボックスで、生成されたクライアント データ クラスと一緒にプロジェクト データ ソースが作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-104">When you add a reference to a data service by using the **Add Service Reference** dialog, a project data source is created along with the generated client data classes.</span></span> <span data-ttu-id="64a84-105">データ サービスが公開する各エンティティ セットに対して 1 つのデータ ソースが作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-105">One data source is created for each entity set that the data service exposes.</span></span> <span data-ttu-id="64a84-106">データ ソースの項目をドラッグして、サービスからデータを表示するフォームを作成することができます、**データソース**デザイナーにウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="64a84-106">You can create forms that display data from the service by dragging these data source items from the **Data Sources** window onto the designer.</span></span> <span data-ttu-id="64a84-107">これらの項目は、データ ソースにバインドされているコントロールになります。</span><span class="sxs-lookup"><span data-stu-id="64a84-107">These items become controls that are bound to the data source.</span></span> <span data-ttu-id="64a84-108">インスタンスに、実行中にこのデータ ソースがバインドされている、<xref:System.Data.Services.Client.DataServiceCollection%601>クラスは、データ サービスに、クエリによって返されるオブジェクトが入力されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-108">During execution, this data source is bound to an instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class, which is filled with objects that are returned by a query to the data service.</span></span> <span data-ttu-id="64a84-109">詳細については、次を参照してください。[データ コントロールをバインド](../../../../docs/framework/data/wcf/binding-data-to-controls-wcf-data-services.md)します。</span><span class="sxs-lookup"><span data-stu-id="64a84-109">For more information, see [Binding Data to Controls](../../../../docs/framework/data/wcf/binding-data-to-controls-wcf-data-services.md).</span></span>

 <span data-ttu-id="64a84-110">このトピックの例では、Northwind サンプル データ サービスおよび自動生成されたクライアント データ サービス クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a84-110">The examples in this topic use the Northwind sample data service and autogenerated client data service classes.</span></span> <span data-ttu-id="64a84-111">このサービスとクライアント データ クラスを作成を完了すると、 [WCF Data Services クイック スタート](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md)します。</span><span class="sxs-lookup"><span data-stu-id="64a84-111">This service and the client data classes are created when you complete the [WCF Data Services quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md).</span></span>

## <a name="use-a-project-data-source-in-a-wpf-window"></a><span data-ttu-id="64a84-112">WPF ウィンドウで、プロジェクトのデータ ソースを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a84-112">Use a project data source in a WPF window</span></span>

1.  <span data-ttu-id="64a84-113">Visual Studio での WPF プロジェクトで Northwind データ サービスへの参照を追加します。</span><span class="sxs-lookup"><span data-stu-id="64a84-113">In Visual Studio, in a WPF project, add a reference to the Northwind data service.</span></span> <span data-ttu-id="64a84-114">詳細については、「[方法 :データ サービス参照を追加](../../../../docs/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services.md)します。</span><span class="sxs-lookup"><span data-stu-id="64a84-114">For more information, see [How to: Add a Data Service Reference](../../../../docs/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services.md).</span></span>

2.  <span data-ttu-id="64a84-115">**データソース**ウィンドウで、展開、`Customers`内のノード、 **NorthwindEntities**プロジェクト データ ソース。</span><span class="sxs-lookup"><span data-stu-id="64a84-115">In the **Data Sources** window, expand the `Customers` node in the **NorthwindEntities** project data source.</span></span>

3.  <span data-ttu-id="64a84-116">をクリックして、 **CustomerID**アイテムで、 **ComboBox**ドラッグし、一覧から、 **CustomerID**から項目、**顧客**ノードをデザイナー。</span><span class="sxs-lookup"><span data-stu-id="64a84-116">Click the **CustomerID** item, select **ComboBox** from the list, and drag the **CustomerID** item from the **Customers** node to the designer.</span></span>

     <span data-ttu-id="64a84-117">ウィンドウの XAML ファイルに次のオブジェクト要素が作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-117">This creates the following object elements in the XAML file for the window:</span></span>

    -   <span data-ttu-id="64a84-118"><xref:System.Windows.Data.CollectionViewSource> という名前の `customersViewSource` 要素。</span><span class="sxs-lookup"><span data-stu-id="64a84-118">A <xref:System.Windows.Data.CollectionViewSource> element named `customersViewSource`.</span></span> <span data-ttu-id="64a84-119">最上位レベルの <xref:System.Windows.FrameworkElement.DataContext%2A> オブジェクト要素の <xref:System.Windows.Controls.Grid> プロパティが、この新しい <xref:System.Windows.Data.CollectionViewSource> に設定されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-119">The <xref:System.Windows.FrameworkElement.DataContext%2A> property of the top-level <xref:System.Windows.Controls.Grid> object element is set to this new <xref:System.Windows.Data.CollectionViewSource>.</span></span>

    -   <span data-ttu-id="64a84-120"><xref:System.Windows.Controls.ComboBox> という名前のデータ バインド `CustomerID`。</span><span class="sxs-lookup"><span data-stu-id="64a84-120">A data-bound <xref:System.Windows.Controls.ComboBox> named `CustomerID`.</span></span>

    -   <span data-ttu-id="64a84-121"><xref:System.Windows.Controls.Label>。</span><span class="sxs-lookup"><span data-stu-id="64a84-121">A <xref:System.Windows.Controls.Label>.</span></span>

4.  <span data-ttu-id="64a84-122">ドラッグ、**注文**をデザイナーにナビゲーション プロパティ。</span><span class="sxs-lookup"><span data-stu-id="64a84-122">Drag the **Orders** navigation property to the designer.</span></span>

     <span data-ttu-id="64a84-123">ウィンドウの XAML ファイルに次の追加オブジェクト要素が作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-123">This creates the following additional object elements in the XAML file for the window:</span></span>

    -   <span data-ttu-id="64a84-124"><xref:System.Windows.Data.CollectionViewSource> という名前の 2 番目の `customersOrdersViewSource` 要素。このソースは `customerViewSource` です。</span><span class="sxs-lookup"><span data-stu-id="64a84-124">A second <xref:System.Windows.Data.CollectionViewSource> element named `customersOrdersViewSource`, the source of which is the `customerViewSource`.</span></span>

    -   <span data-ttu-id="64a84-125"><xref:System.Windows.Controls.DataGrid> という名前のデータ バインド `ordersDataGrid` コントロール。</span><span class="sxs-lookup"><span data-stu-id="64a84-125">A data-bound <xref:System.Windows.Controls.DataGrid> control named `ordersDataGrid`.</span></span>

5.  <span data-ttu-id="64a84-126">(省略可能)その他の項目をドラッグ、**顧客**ノードをデザイナーにします。</span><span class="sxs-lookup"><span data-stu-id="64a84-126">(Optional) Drag additional items from the **Customers** node to the designer.</span></span>

6.  <span data-ttu-id="64a84-127">フォームのコード ページを開き、次に示す `using` ステートメント (Visual Basic の場合は `Imports`) を追加します。</span><span class="sxs-lookup"><span data-stu-id="64a84-127">Open the code page for the form and add the following `using` statements (`Imports` in Visual Basic):</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersUsingWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorderswpf2.xaml.cs#customersordersusingwpf)]

7.  <span data-ttu-id="64a84-128">フォームを定義する部分クラスで、<xref:System.Data.Objects.ObjectContext> インスタンスを作成し、`customerID` の定数を定義する次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a84-128">In the partial class that defines the form, add the following code that creates an <xref:System.Data.Objects.ObjectContext> instance and defines the `customerID` constant.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDefinitionWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorderswpf2.xaml.cs#customersordersdefinitionwpf)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDefinitionWpf](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/customerorderswpf2.xaml.vb#customersordersdefinitionwpf)]

8.  <span data-ttu-id="64a84-129">デザイナーでウィンドウを選択します。</span><span class="sxs-lookup"><span data-stu-id="64a84-129">In the designer, select the window.</span></span>

    > [!NOTE]
    > <span data-ttu-id="64a84-130">ウィンドウ内にある内容を選択するのではなく、ウィンドウ自身を選択します。</span><span class="sxs-lookup"><span data-stu-id="64a84-130">Make sure that you select the window itself, rather than selecting content that is within the window.</span></span> <span data-ttu-id="64a84-131">ウィンドウが選択されている場合、**名前**の上部にあるテキスト ボックス、**プロパティ**ウィンドウがウィンドウの名前を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="64a84-131">If the window is selected, the **Name** text box near the top of the **Properties** window should contain the name of the window.</span></span>

9. <span data-ttu-id="64a84-132">**プロパティ**ウィンドウで、**イベント**ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="64a84-132">In the **Properties** window, select the **Events** button.</span></span>

10. <span data-ttu-id="64a84-133">検索、 **Loaded**イベント、およびこのイベントの横にあるドロップダウン リスト ボックスの一覧をクリックします。</span><span class="sxs-lookup"><span data-stu-id="64a84-133">Find the **Loaded** event, and then double-click the drop-down list next to this event.</span></span>

     <span data-ttu-id="64a84-134">Visual Studio でウィンドウの分離コード ファイルが開き、<xref:System.Windows.FrameworkElement.Loaded> イベント ハンドラーが生成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-134">Visual Studio opens the code-behind file for the window and generates a <xref:System.Windows.FrameworkElement.Loaded> event handler.</span></span>

11. <span data-ttu-id="64a84-135">新しく作成された <xref:System.Windows.FrameworkElement.Loaded> イベント ハンドラーで、次のコードをコピーして貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="64a84-135">In the newly created <xref:System.Windows.FrameworkElement.Loaded> event handler, copy and paste the following code.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBindingWpf](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorderswpf2.xaml.cs#customersordersdatabindingwpf)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDataBindingWpf](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/customerorderswpf2.xaml.vb#customersordersdatabindingwpf)]

12. <span data-ttu-id="64a84-136">このコードは、関連する <xref:System.Data.Services.Client.DataServiceCollection%601> オブジェクトと一緒に `Customers` の <xref:System.Collections.Generic.IEnumerable%601> を Northwind データ サービスから返す LINQ クエリの実行に基づいて `Customers` 型の `Orders` のインスタンスを作成し、`customersViewSource` にバインドします。</span><span class="sxs-lookup"><span data-stu-id="64a84-136">This code creates an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for the `Customers` type based on the execution of a LINQ query that returns an <xref:System.Collections.Generic.IEnumerable%601> of `Customers` along with related `Orders` objects from the Northwind data service and binds it to the `customersViewSource`.</span></span>

## <a name="use-a-project-data-source-in-a-windows-form"></a><span data-ttu-id="64a84-137">Windows フォームでのプロジェクト データ ソースを使用します。</span><span class="sxs-lookup"><span data-stu-id="64a84-137">Use a project data source in a Windows form</span></span>

1.  <span data-ttu-id="64a84-138">**データソース**ウィンドウで、展開、**顧客**内のノード、 **NorthwindEntities**プロジェクト データ ソース。</span><span class="sxs-lookup"><span data-stu-id="64a84-138">In the **Data Sources** window, expand the **Customers** node in the **NorthwindEntities** project data source.</span></span>

2.  <span data-ttu-id="64a84-139">をクリックして、 **CustomerID**アイテムで、 **ComboBox**ドラッグし、一覧から、 **CustomerID**から項目、**顧客**ノードをデザイナー。</span><span class="sxs-lookup"><span data-stu-id="64a84-139">Click the **CustomerID** item, select **ComboBox** from the list, and drag the **CustomerID** item from the **Customers** node to the designer.</span></span>

     <span data-ttu-id="64a84-140">次のコントロールがフォーム上に作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-140">This creates the following controls on the form:</span></span>

    -   <span data-ttu-id="64a84-141"><xref:System.Windows.Forms.BindingSource> という名前の `customersBindingSource` のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="64a84-141">An instance of <xref:System.Windows.Forms.BindingSource> named `customersBindingSource`.</span></span>

    -   <span data-ttu-id="64a84-142"><xref:System.Windows.Forms.BindingNavigator> という名前の `customersBindingNavigator` のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="64a84-142">An instance of <xref:System.Windows.Forms.BindingNavigator> named `customersBindingNavigator`.</span></span> <span data-ttu-id="64a84-143">このコントロールは必要ないので削除できます。</span><span class="sxs-lookup"><span data-stu-id="64a84-143">You can delete this control as it will not be needed.</span></span>

    -   <span data-ttu-id="64a84-144"><xref:System.Windows.Forms.ComboBox> という名前のデータ バインド `CustomerID`。</span><span class="sxs-lookup"><span data-stu-id="64a84-144">A data-bound <xref:System.Windows.Forms.ComboBox> named `CustomerID`.</span></span>

    -   <span data-ttu-id="64a84-145"><xref:System.Windows.Forms.Label>。</span><span class="sxs-lookup"><span data-stu-id="64a84-145">A <xref:System.Windows.Forms.Label>.</span></span>

3.  <span data-ttu-id="64a84-146">ドラッグ、**注文**フォームへのナビゲーション プロパティ。</span><span class="sxs-lookup"><span data-stu-id="64a84-146">Drag the **Orders** navigation property to the form.</span></span>

4.  <span data-ttu-id="64a84-147">これにより、`ordersBindingSource` プロパティが <xref:System.Windows.Forms.BindingSource.DataSource%2A> に設定され、`customersBindingSource` プロパティが <xref:System.Windows.Forms.BindingSource.DataMember%2A> に設定された `Customers` コントロールが作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-147">This creates the `ordersBindingSource` control with the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property of the control set to the `customersBindingSource` and the <xref:System.Windows.Forms.BindingSource.DataMember%2A> property set to `Customers`.</span></span> <span data-ttu-id="64a84-148">また、`ordersDataGridView` データ バインド コントロールも、適切なタイトルのラベル コントロールと共にフォーム上に作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-148">It also creates the `ordersDataGridView` data-bound control on the form, accompanied by an appropriately titled label control.</span></span>

5.  <span data-ttu-id="64a84-149">(省略可能)その他の項目をドラッグ、**顧客**ノードをデザイナーにします。</span><span class="sxs-lookup"><span data-stu-id="64a84-149">(Optional) Drag additional items from the **Customers** node to the designer.</span></span>

6.  <span data-ttu-id="64a84-150">フォームのコード ページを開き、次に示す `using` ステートメント (Visual Basic の場合は `Imports`) を追加します。</span><span class="sxs-lookup"><span data-stu-id="64a84-150">Open the code page for the form and add the following `using` statements (`Imports` in Visual Basic):</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersUsing](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorders.cs#customersordersusing)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersUsing](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/customerorders.vb#customersordersusing)]

7.  <span data-ttu-id="64a84-151">フォームを定義する部分クラスで、<xref:System.Data.Objects.ObjectContext> インスタンスを作成し、`customerID` の定数を定義する次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="64a84-151">In the partial class that defines the form, add the following code that creates an <xref:System.Data.Objects.ObjectContext> instance and defines the `customerID` constant.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDefinition](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorders.cs#customersordersdefinition)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDefinition](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/customerorders.vb#customersordersdefinition)]

8.  <span data-ttu-id="64a84-152">フォーム デザイナーで、フォームをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="64a84-152">In the form designer, double-click the form.</span></span>

     <span data-ttu-id="64a84-153">フォームのコード ページが開き、フォームの `Load` イベントを処理するメソッドが作成されます。</span><span class="sxs-lookup"><span data-stu-id="64a84-153">This opens the code page for the form and creates the method that handles the `Load` event for the form.</span></span>

9. <span data-ttu-id="64a84-154">`Load` イベント ハンドラーで、次のコードをコピーして貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="64a84-154">In the `Load` event handler, copy and paste the following code.</span></span>

     [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/customerorders.cs#customersordersdatabinding)]
     [!code-vb[Astoria Northwind Client#CustomersOrdersDataBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/customerorders.vb#customersordersdatabinding)]

10. <span data-ttu-id="64a84-155">このコードは、Northwind データ サービスから <xref:System.Data.Services.Client.DataServiceCollection%601> の `Customers` を返す <xref:System.Data.Services.Client.DataServiceQuery%601> の実行に基づいて <xref:System.Collections.Generic.IEnumerable%601> 型の `Customers` のインスタンスを作成し、`customersBindingSource` にバインドします。</span><span class="sxs-lookup"><span data-stu-id="64a84-155">This code creates an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for the `Customers` type based on the execution of a <xref:System.Data.Services.Client.DataServiceQuery%601> that returns an <xref:System.Collections.Generic.IEnumerable%601> of `Customers` from the Northwind data service and binds it to the `customersBindingSource`.</span></span>

## <a name="see-also"></a><span data-ttu-id="64a84-156">関連項目</span><span class="sxs-lookup"><span data-stu-id="64a84-156">See also</span></span>

- [<span data-ttu-id="64a84-157">WCF Data Services クライアント ライブラリ</span><span class="sxs-lookup"><span data-stu-id="64a84-157">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)
- [<span data-ttu-id="64a84-158">方法: Windows Presentation Foundation 要素にデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="64a84-158">How to: Bind Data to Windows Presentation Foundation Elements</span></span>](../../../../docs/framework/data/wcf/bind-data-to-wpf-elements-wcf-data-services.md)
