---
title: アクションを使用してサーバー側の動作を実装する
ms.date: 03/30/2017
ms.assetid: 11a372db-7168-498b-80d2-9419ff557ba5
ms.openlocfilehash: 515553540053ed0c16085fde06e2cc2d2dedda1e
ms.sourcegitcommit: fb78d8abbdb87144a3872cf154930157090dd933
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/26/2018
ms.locfileid: "47204480"
---
# <a name="using-actions-to-implement-server-side-behavior"></a><span data-ttu-id="f8bcf-102">アクションを使用してサーバー側の動作を実装する</span><span class="sxs-lookup"><span data-stu-id="f8bcf-102">Using actions to implement server-side behavior</span></span>

<span data-ttu-id="f8bcf-103">OData アクションを使用すると、OData サービスから取得したリソースに対する動作を実装できます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-103">OData Actions provide a way to implement a behavior that acts upon a resource retrieved from an OData service.</span></span> <span data-ttu-id="f8bcf-104">たとえば、リソースとしてデジタル ムービーについて考えてみましょう。デジタル ムービーについては、チェックアウト、評価やコメント、チェックインなど、多様な操作が考えられます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-104">For example consider a digital movie as a resource, there are many things you may do with a digital movie: check-out, rate/comment, or check-in.</span></span> <span data-ttu-id="f8bcf-105">これらはすべて、デジタル ムービーを管理するために WCF Data Services で実装できるアクションの例です。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-105">These are all examples of Actions that may be implemented by a WCF Data Service that manages digital movies.</span></span> <span data-ttu-id="f8bcf-106">アクションは、そのアクションを呼び出すことのできる対象のリソースが含まれている OData 応答に記述します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-106">Actions are described in an OData response that contains a resource on which the Action can be invoked.</span></span> <span data-ttu-id="f8bcf-107">ユーザーが、デジタル ムービーを表すリソースを要求した場合、WCF Data Services から返される応答には、そのリソースに使用できるアクションに関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-107">When a user requests a resource that represents a digital movie the response returned from the WCF Data Service contains information about the Actions that are available for that resource.</span></span> <span data-ttu-id="f8bcf-108">アクションを使用できるかどうかは、データ サービスまたはリソースの状態によって変わる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-108">The availability of an Action can depend on the state of the data service or resource.</span></span> <span data-ttu-id="f8bcf-109">たとえば、デジタル ムービーがチェックアウトされている場合、それを別のユーザーがチェックアウトすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-109">For example once a digital movie is checked out it cannot be checked out by another user.</span></span> <span data-ttu-id="f8bcf-110">クライアントは、URL を指定するだけでアクションを呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-110">Clients can invoke an action simply by specifying a URL.</span></span> <span data-ttu-id="f8bcf-111">たとえば、`http://MyServer/MovieService.svc/Movies(6)`は特定のデジタル ムービーを識別および`http://MyServer/MovieService.svc/Movies(6)/Checkout`特定のムービーに対するアクションを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-111">For example, `http://MyServer/MovieService.svc/Movies(6)` would identify a specific digital movie and `http://MyServer/MovieService.svc/Movies(6)/Checkout` would invoke the action on the specific movie.</span></span> <span data-ttu-id="f8bcf-112">アクションを使用すると、データ モデルを公開することなくサービス モデルを公開することができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-112">Actions allow you to expose you service model without exposing your data model.</span></span> <span data-ttu-id="f8bcf-113">先ほどのムービー サービスを例とすると、評価データをリソースとして直接公開せずにムービーをユーザーが評価できるようにするというケースが考えられます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-113">Continuing with the movie service example, you may wish to allow a user to rate a movie, but not directly expose the rating data as a resource.</span></span> <span data-ttu-id="f8bcf-114">そこで、たとえば Rate (評価) アクションを実装することにより、リソースとして評価データに直接アクセスせずに、ムービーをユーザーが評価できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-114">You could implement a Rate Action to allow the user to rate a movie but not directly access the rating data as a resource.</span></span>
  
## <a name="implementing-an-action"></a><span data-ttu-id="f8bcf-115">アクションの実装</span><span class="sxs-lookup"><span data-stu-id="f8bcf-115">Implementing an action</span></span>  
 <span data-ttu-id="f8bcf-116">実装する必要がありますサービス アクションを実装するために、 <xref:System.IServiceProvider>、 [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)、および[IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx)インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-116">To implement a service action you must implement the <xref:System.IServiceProvider>, [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx), and [IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx) interfaces.</span></span> <span data-ttu-id="f8bcf-117"><xref:System.IServiceProvider> により、WCF データ サービスの実装を取得する[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-117"><xref:System.IServiceProvider> allows WCF Data Services to get your implementation of [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx).</span></span> <span data-ttu-id="f8bcf-118">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)を作成する WCF Data Services が検索、について説明し、サービスの操作を起動します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-118">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx) allows WCF Data Services to create, find, describe and invoke service actions.</span></span> <span data-ttu-id="f8bcf-119">[IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx)存在する場合、サービス アクションの動作を実装するコードを呼び出すし、結果を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-119">[IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx) allows you to invoke the code that implements the service actions’ behavior and get the results, if any.</span></span> <span data-ttu-id="f8bcf-120">WCF Data Services は呼び出しごとの WCF サービスであり、サービスの新しいインスタンスは、サービスが呼び出されるごとに作成されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-120">Keep in mind that WCF Data Services are Per-Call WCF Services, a new instance of the service will be created each time the service is called.</span></span>  <span data-ttu-id="f8bcf-121">サービスの作成時に、不要な作業が行われないよう注意してください。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-121">Make sure no unnecessary work is done when the service is created.</span></span>  
  
### <a name="iserviceprovider"></a><span data-ttu-id="f8bcf-122">IServiceProvider</span><span class="sxs-lookup"><span data-stu-id="f8bcf-122">IServiceProvider</span></span>  
 <span data-ttu-id="f8bcf-123"><xref:System.IServiceProvider> には、<xref:System.IServiceProvider.GetService%2A> というメソッドが含まれています。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-123"><xref:System.IServiceProvider> contains a method called <xref:System.IServiceProvider.GetService%2A>.</span></span> <span data-ttu-id="f8bcf-124">このメソッドは、メタデータ サービス プロバイダーやデータ サービス アクション プロバイダーなど、いくつかのサービス プロバイダーを取得するために、WCF Data Services によって呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-124">This method is called by WCF Data Services to retrieve a number of service providers, including metadata service providers and data service action providers.</span></span> <span data-ttu-id="f8bcf-125">データ サービス アクション プロバイダーを求められたら、返す、 [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)実装します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-125">When asked for a data service action provider, return your [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx) implementation.</span></span>  
  
### <a name="idataserviceactionprovider"></a><span data-ttu-id="f8bcf-126">IDataServiceActionProvider</span><span class="sxs-lookup"><span data-stu-id="f8bcf-126">IDataServiceActionProvider</span></span>  
 <span data-ttu-id="f8bcf-127">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)使用可能なアクションに関する情報を取得するためのメソッドが含まれます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-127">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx) contains methods that allow you to retrieve information about the available actions.</span></span> <span data-ttu-id="f8bcf-128">実装に[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)のサービスの実装で定義されているサービスのメタデータを補強する[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx)アクションがあると必要に応じてアクションへのディスパッチを処理します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-128">When you implement [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx) you are augmenting the metadata for your service which is defined by your service’s implementation of [IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider(v=vs.113).aspx) with Actions and handling dispatch to those actions as appropriate.</span></span>  
  
#### <a name="advertiseserviceaction"></a><span data-ttu-id="f8bcf-129">AdvertiseServiceAction</span><span class="sxs-lookup"><span data-stu-id="f8bcf-129">AdvertiseServiceAction</span></span>  
 <span data-ttu-id="f8bcf-130">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider.advertiseserviceaction(v=vs.113).aspx)が呼び出され、指定したリソースで使用可能なアクションを決定します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-130">[IDataServiceActionProvider](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider.advertiseserviceaction(v=vs.113).aspx) is called to determine what actions are available for the specified resource.</span></span> <span data-ttu-id="f8bcf-131">このメソッドは、常時使用可能ではないアクションについてのみ呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-131">This method is only called for actions that are not always available.</span></span> <span data-ttu-id="f8bcf-132">このメソッドの用途は、要求されているリソースの状態またはサービスの状態に基づいて、アクションを OData 応答に含めるかどうかを確認することです。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-132">It is used to check if the action should be included in the OData response based upon the state of the resource being requested or the state of the service.</span></span> <span data-ttu-id="f8bcf-133">この確認をどのように行うかは、開発者が指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-133">How this check is accomplished is completely up to you.</span></span> <span data-ttu-id="f8bcf-134">使用可能かどうかを計算する処理の負荷が高く、現在のリソースがフィード内にある場合は、確認をスキップしてアクションの情報提供を行うこともできます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-134">If it is an expensive to calculate availability and the current resource is in a feed, it is acceptable to skip the check and advertise the action.</span></span> <span data-ttu-id="f8bcf-135">返される現在のリソースがフィードの一部である場合は、`inFeed` パラメーターが `true` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-135">The `inFeed` parameter is set to `true` if the current resource being returned is part of a feed.</span></span>  
  
#### <a name="createinvokable"></a><span data-ttu-id="f8bcf-136">CreateInvokable</span><span class="sxs-lookup"><span data-stu-id="f8bcf-136">CreateInvokable</span></span>  
 <span data-ttu-id="f8bcf-137">[CreateInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider.createinvokable(v=vs.113).aspx)を作成するために呼び出される、 [IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx)アクションの動作を実装するコードをカプセル化するデリゲートを格納しています。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-137">[CreateInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceactionprovider.createinvokable(v=vs.113).aspx) is called to create a [IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx) that contains a delegate that encapsulates the code that implements the action’s behavior.</span></span> <span data-ttu-id="f8bcf-138">これを作成、 [IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx)のインスタンスが、アクションは呼び出されません。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-138">This creates the [IDataServiceInvokable](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable(v=vs.113).aspx) instance but does not invoke the action.</span></span> <span data-ttu-id="f8bcf-139">WCF Data Services のアクションは副作用を伴うため、更新プロバイダーと連携して、その変更をディスクに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-139">WCF Data Service Actions have side effects and need to work in conjunction with the Update Provider to save those changes to disk.</span></span> <span data-ttu-id="f8bcf-140">[IDataServiceInvokable.Invoke](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable.invoke(v=vs.113).aspx)メソッドが呼び出される、更新プロバイダーの SaveChanges() からメソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-140">The [IDataServiceInvokable.Invoke](https://msdn.microsoft.com/library/system.data.services.providers.idataserviceinvokable.invoke(v=vs.113).aspx) method is called from the Update Provider’s SaveChanges() method is called.</span></span>  
  
#### <a name="getserviceactions"></a><span data-ttu-id="f8bcf-141">GetServiceActions</span><span class="sxs-lookup"><span data-stu-id="f8bcf-141">GetServiceActions</span></span>  
 <span data-ttu-id="f8bcf-142">このメソッドのコレクションを返します[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)のすべての WCF データ サービスは、公開操作を表すインスタンス。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-142">This method returns a collection of [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) instances that represent all of the actions a WCF Data Service exposes.</span></span> <span data-ttu-id="f8bcf-143">[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)アクション名、パラメーター、戻り値の型などの情報を含むアクションのメタデータ表現です。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-143">[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) is the metadata representation of an Action, that includes information like the Action name, its parameters, and its return type.</span></span>  
  
#### <a name="getserviceactionsbybindingparametertype"></a><span data-ttu-id="f8bcf-144">GetServiceActionsByBindingParameterType</span><span class="sxs-lookup"><span data-stu-id="f8bcf-144">GetServiceActionsByBindingParameterType</span></span>  
 <span data-ttu-id="f8bcf-145">このメソッドは、すべてのコレクションを返します[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)インスタンスを指定したバインディング パラメーターの型にバインドできます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-145">This method returns a collection of all [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) instances that can be bound to the specified binding parameter type.</span></span> <span data-ttu-id="f8bcf-146">つまり、すべて[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)を指定したリソースの種類 (バインディング パラメーターの種類とも呼ばれます) を操作できます。これは、サービスは、そのリソースに対して呼び出すことができるアクションに関する情報を含めるためにリソースを返すときに使用されます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-146">In other words, all [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)s that can act on the specified resource type (also called binding parameter type).This is used when the service returns a resource in order to include information about Actions that can be invoked against that resource.</span></span> <span data-ttu-id="f8bcf-147">このメソッドが返すアクションは、(派生型ではなく) 指定どおりのバインディング パラメーターの種類にバインドできるアクションのみです。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-147">This method should only return actions that can bind to the exact binding parameter type (no derived types).</span></span> <span data-ttu-id="f8bcf-148">このメソッドは、要求ごと、検出された種類ごとに 1 回呼び出され、結果は WCF Data Services によってキャッシュされます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-148">This method is called once per request per type encountered and the result is cached by WCF Data Services.</span></span>  
  
#### <a name="tryresolveserviceaction"></a><span data-ttu-id="f8bcf-149">TryResolveServiceAction</span><span class="sxs-lookup"><span data-stu-id="f8bcf-149">TryResolveServiceAction</span></span>  
 <span data-ttu-id="f8bcf-150">このメソッドは、指定した検索[ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)返します`true`場合、 [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)が見つかった。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-150">This method searches for a specified [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) and returns `true` if the [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) is found.</span></span> <span data-ttu-id="f8bcf-151">場合、検出、 [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx)で返される、 `serviceAction` `out`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-151">If found, the [ServiceAction](https://msdn.microsoft.com/library/system.data.services.providers.serviceaction(v=vs.113).aspx) is returned in the `serviceAction` `out` parameter.</span></span>  
  
### <a name="idataserviceinvokable"></a><span data-ttu-id="f8bcf-152">IDataServiceInvokable</span><span class="sxs-lookup"><span data-stu-id="f8bcf-152">IDataServiceInvokable</span></span>  
 <span data-ttu-id="f8bcf-153">このインターフェイスは、WCF Data Services アクションの実行方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-153">This interface provides a way to execute a WCF Data Service Action.</span></span> <span data-ttu-id="f8bcf-154">IDataServiceInvokable を実装する場合は、次の 3 つを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-154">When implementing IDataServiceInvokable you are responsible for 3 things:</span></span>  
  
1.  <span data-ttu-id="f8bcf-155">パラメーターをキャプチャし、場合によってはマーシャリングを行う。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-155">Capturing and potentially marshaling the parameters</span></span>  
  
2.  <span data-ttu-id="f8bcf-156">Invoke() の呼び出し時に、アクションを実際に実装するコードにパラメーターをディスパッチする。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-156">Dispatching the parameters to the code that actually implements the Action when Invoke() is called</span></span>  
  
3.  <span data-ttu-id="f8bcf-157">GetResult() を使用して取得できるように、Invoke() の結果を保存する。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-157">Storing any results from Invoke() so they can be retrieved using GetResult()</span></span>  
  
 <span data-ttu-id="f8bcf-158">パラメーターは、トークンとして渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-158">The parameters may be passed as tokens.</span></span> <span data-ttu-id="f8bcf-159">これは、リソースを表すトークンを扱うデータ サービス プロバイダーを作成することができるためです。ただしその場合は、実際のアクションにディスパッチする前に、トークンを実際のリソースに変換 (マーシャリング) する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-159">This is because it is possible to write a Data Service Provider that works with tokens that represent resources, if this is the case you may need to convert (marshal) these tokens into actual resources before dispatching to the actual action.</span></span> <span data-ttu-id="f8bcf-160">アクションが呼び出されたときに発生したリソースへの変更を保存してディスクに書き込むことができるよう、マーシャリングを行ったパラメーターは編集可能な状態にしておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-160">After the parameter has been marshalled, it must be in an editable state so that any changes to the resource that occur when the action is invoked will be saved and written to disk.</span></span>  
  
 <span data-ttu-id="f8bcf-161">このインターフェイスには、Invoke および GetResult という 2 つのメソッドが必要です。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-161">This interface requires two methods: Invoke and GetResult.</span></span> <span data-ttu-id="f8bcf-162">Invoke はアクションの動作を実装するデリゲートを呼び出し、GetResult はアクションの結果を返します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-162">Invoke invokes the delegate that implements the action’s behavior and GetResult returns the result of the action.</span></span>  
  
## <a name="invoking-a-wcf-data-service-action"></a><span data-ttu-id="f8bcf-163">WCF Data Services アクションの呼び出し</span><span class="sxs-lookup"><span data-stu-id="f8bcf-163">Invoking a WCF Data Service Action</span></span>  
 <span data-ttu-id="f8bcf-164">アクションは HTTP POST 要求を使用して呼び出します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-164">Actions are invoked using an HTTP POST request.</span></span> <span data-ttu-id="f8bcf-165">リソースの後にアクション名を続けて URL を指定します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-165">The URL specifies the resource followed by the action name.</span></span> <span data-ttu-id="f8bcf-166">パラメーターは、要求の本文を使用して渡します。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-166">Parameters are passed in the body of the request.</span></span> <span data-ttu-id="f8bcf-167">たとえば、MovieService というサービスがあり、Rate というアクションが公開されているとします。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-167">For example if there was a service called MovieService which exposed an action called Rate.</span></span> <span data-ttu-id="f8bcf-168">この場合、特定のムービーに対して Rate アクションを呼び出すには、次のような URL 使用することができます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-168">You could use the following URL to invoke the Rate action on a specific movie:</span></span>  
  
 `http://MovieServer/MovieService.svc/Movies(1)/Rate`
  
 <span data-ttu-id="f8bcf-169">Movies(1) は評価対象のムービーを示し、Rate は Rate アクションを指定しています。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-169">Movies(1) specifies the movie you wish to rate and Rate specifies the Rate action.</span></span> <span data-ttu-id="f8bcf-170">次の例に示すように、評価の実際の値は HTTP 要求の本文に含まれます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-170">The actual value of the rating will be in the body of the HTTP request as shown in the following example:</span></span>  
  
```  
POST http://MovieServer/MoviesService.svc/Movies(1)/Rate HTTP/1.1   
Content-Type: application/json   
Content-Length: 20   
Host: localhost:15238  
{   
   "rating": 4   
}  
```  
  
> [!WARNING]
> <span data-ttu-id="f8bcf-171">上のサンプル コードが動作するのは、JSON Light をサポートする WCF Data Services 5.2 以降を使用している場合のみです。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-171">The above sample code will work only with WCF Data Services 5.2 and later which has support for JSON light.</span></span> <span data-ttu-id="f8bcf-172">それより前のバージョンの WCF Data Services を使用している場合は、Verbose JSON の Content-Type を「`application/json;odata=verbose`」のように指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-172">If using an earlier version of WCF Data Services, you must specify the json verbose content-type as follows: `application/json;odata=verbose`.</span></span>  
  
 <span data-ttu-id="f8bcf-173">また、次のコード スニペットのように、WCF Data Services クライアントを使用してアクションを呼び出すこともできます。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-173">Alternatively you can invoke an action using the WCF Data Services Client as shown in the following code snippet.</span></span>  
  
```csharp
MoviesModel context = new MoviesModel (new Uri("http://MyServer/MoviesService.svc/"));  
//...  
context.Execute(new Uri("http://MyServer/MoviesService.svc/Movies(1)/Rate"), "POST", new BodyOperationParameter("rating",4) );
```
  
 <span data-ttu-id="f8bcf-174">上のコード スニペットの `MoviesModel` クラスは、Visual Studio の [サービス参照の追加] で WCF Data Services への参照を追加することでが生成されたものです。</span><span class="sxs-lookup"><span data-stu-id="f8bcf-174">In the code snippet above, the `MoviesModel` class was generated by using Visual Studio to Add Service Reference to a WCF Data Service.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8bcf-175">関連項目</span><span class="sxs-lookup"><span data-stu-id="f8bcf-175">See Also</span></span>  
 [<span data-ttu-id="f8bcf-176">WCF Data Services 4.5</span><span class="sxs-lookup"><span data-stu-id="f8bcf-176">WCF Data Services 4.5</span></span>](../../../../docs/framework/data/wcf/index.md)  
 [<span data-ttu-id="f8bcf-177">WCF Data Services の定義</span><span class="sxs-lookup"><span data-stu-id="f8bcf-177">Defining WCF Data Services</span></span>](../../../../docs/framework/data/wcf/defining-wcf-data-services.md)  
 [<span data-ttu-id="f8bcf-178">WCF Data Services の開発と配置</span><span class="sxs-lookup"><span data-stu-id="f8bcf-178">Developing and Deploying WCF Data Services</span></span>](../../../../docs/framework/data/wcf/developing-and-deploying-wcf-data-services.md)  
 [<span data-ttu-id="f8bcf-179">カスタム データ サービス プロバイダー</span><span class="sxs-lookup"><span data-stu-id="f8bcf-179">Custom Data Service Providers</span></span>](../../../../docs/framework/data/wcf/custom-data-service-providers-wcf-data-services.md)
