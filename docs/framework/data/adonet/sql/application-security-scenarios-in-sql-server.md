---
title: "SQL Server におけるアプリケーション セキュリティのシナリオ"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 0164f3a4-406e-4693-bec3-03c8e18b46d7
caps.latest.revision: "5"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: d3791ea4084a6ae568fef1e76680f91434284639
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="application-security-scenarios-in-sql-server"></a><span data-ttu-id="bee39-102">SQL Server におけるアプリケーション セキュリティのシナリオ</span><span class="sxs-lookup"><span data-stu-id="bee39-102">Application Security Scenarios in SQL Server</span></span>
<span data-ttu-id="bee39-103">安全な SQL Server クライアント アプリケーションを作成するにあたって、絶対に正しいという唯一の方法はありません。</span><span class="sxs-lookup"><span data-stu-id="bee39-103">There is no single correct way to create a secure SQL Server client application.</span></span> <span data-ttu-id="bee39-104">アプリケーションの要件、配置環境、およびユーザー数は、アプリケーションごとに異なります。</span><span class="sxs-lookup"><span data-stu-id="bee39-104">Every application is unique in its requirements, deployment environment, and user population.</span></span> <span data-ttu-id="bee39-105">配置した当初は十分なセキュリティが確保されたアプリケーションも、時間の経過と共に安全性が低下してゆくことが考えられます。</span><span class="sxs-lookup"><span data-stu-id="bee39-105">An application that is reasonably secure when it is initially deployed can become less secure over time.</span></span> <span data-ttu-id="bee39-106">将来発生する脅威を正確に予測することは不可能です。</span><span class="sxs-lookup"><span data-stu-id="bee39-106">It is impossible to predict with any accuracy what threats may emerge in the future.</span></span>  
  
 <span data-ttu-id="bee39-107">SQL Server は、製品として何度もバージョン アップを重ねながら、開発者が安全なデータベース アプリケーションを作成できるように、最新のセキュリティ機能を取り入れつつ進化してきました。</span><span class="sxs-lookup"><span data-stu-id="bee39-107">SQL Server, as a product, has evolved over many versions to incorporate the latest security features that enable developers to create secure database applications.</span></span> <span data-ttu-id="bee39-108">しかし、普遍的なセキュリティがない以上、継続的に監視し更新してゆくことがどうしても必要になります。</span><span class="sxs-lookup"><span data-stu-id="bee39-108">However, security doesn't come in the box; it requires continual monitoring and updating.</span></span>  
  
## <a name="common-threats"></a><span data-ttu-id="bee39-109">一般的な脅威</span><span class="sxs-lookup"><span data-stu-id="bee39-109">Common Threats</span></span>  
 <span data-ttu-id="bee39-110">開発者は、セキュリティ上の脅威とそれに対抗するツール、および、セキュリティ ホールを作らないようにするにはどうすればよいかを理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="bee39-110">Developers need to understand security threats, the tools provided to counter them, and how to avoid self-inflicted security holes.</span></span> <span data-ttu-id="bee39-111">セキュリティは鎖のようなものと考えることができます。つまり、1 か所でも弱い部分があると、全体の強度が損なわれるということです。</span><span class="sxs-lookup"><span data-stu-id="bee39-111">Security can best be thought of as a chain, where a break in any one link compromises the strength of the whole.</span></span> <span data-ttu-id="bee39-112">以下は、このセクションの各トピックで詳しく取り上げているセキュリティ上の一般的な脅威を一覧にしたものです。</span><span class="sxs-lookup"><span data-stu-id="bee39-112">The following list includes some common security threats that are discussed in more detail in the topics in this section.</span></span>  
  
### <a name="sql-injection"></a><span data-ttu-id="bee39-113">SQL インジェクション</span><span class="sxs-lookup"><span data-stu-id="bee39-113">SQL Injection</span></span>  
 <span data-ttu-id="bee39-114">SQL インジェクションとは、悪意のあるユーザーによって、有効な入力データの代わりに Transact-SQL ステートメントが入力されることをいいます。</span><span class="sxs-lookup"><span data-stu-id="bee39-114">SQL Injection is the process by which a malicious user enters Transact-SQL statements instead of valid input.</span></span> <span data-ttu-id="bee39-115">この入力データが検証を経ることなくサーバーに直接渡され、なおかつ、挿入されたコードをアプリケーションが気付かずに実行した場合、その攻撃によってデータが破損または破壊される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bee39-115">If the input is passed directly to the server without being validated and if the application inadvertently executes the injected code, then the attack has the potential to damage or destroy data.</span></span> <span data-ttu-id="bee39-116">SQL Server インジェクション攻撃を阻止する方法としては、ストアド プロシージャやパラメーター化コマンドを使用する方法のほか、動的 SQL を実行できないようにしたり、すべてのユーザーの権限を制限したりすることが考えられます。</span><span class="sxs-lookup"><span data-stu-id="bee39-116">You can thwart SQL Server injection attacks by using stored procedures and parameterized commands, avoiding dynamic SQL, and restricting permissions on all users.</span></span>  
  
### <a name="elevation-of-privilege"></a><span data-ttu-id="bee39-117">権限の昇格</span><span class="sxs-lookup"><span data-stu-id="bee39-117">Elevation of Privilege</span></span>  
 <span data-ttu-id="bee39-118">権限の昇格攻撃は、ユーザーが、所有者や管理者など、信頼されたアカウントの権限で振る舞うことのできる状況で発生します。</span><span class="sxs-lookup"><span data-stu-id="bee39-118">Elevation of privilege attacks occur when a user is able to assume the privileges of a trusted account, such as an owner or administrator.</span></span> <span data-ttu-id="bee39-119">大切なことは、常に最小限の特権しか持たないユーザー アカウントで実行するようにし、必要な権限以外は割り当てないようにすることです。</span><span class="sxs-lookup"><span data-stu-id="bee39-119">Always run under least-privileged user accounts and assign only needed permissions.</span></span> <span data-ttu-id="bee39-120">コードの実行に、管理者アカウントや所有者アカウントを使用することは避けてください。</span><span class="sxs-lookup"><span data-stu-id="bee39-120">Avoid using administrative or owner accounts for executing code.</span></span> <span data-ttu-id="bee39-121">このようにすることで、仮に攻撃を阻止できなかった場合でも、損害の範囲を最小限に抑えることができます。</span><span class="sxs-lookup"><span data-stu-id="bee39-121">This limits the amount of damage that can occur if an attack succeeds.</span></span> <span data-ttu-id="bee39-122">より高い権限が要求される作業を行う場合は、その期間だけプロシージャの署名や権限の借用を使用するようにします。</span><span class="sxs-lookup"><span data-stu-id="bee39-122">When performing tasks that require additional permissions, use procedure signing or impersonation only for the duration of the task.</span></span> <span data-ttu-id="bee39-123">証明書を使ってストアド プロシージャに署名したり、権限の借用を使用して一時的に権限を割り当てたりできます。</span><span class="sxs-lookup"><span data-stu-id="bee39-123">You can sign stored procedures with certificates or use impersonation to temporarily assign permissions.</span></span>  
  
### <a name="probing-and-intelligent-observation"></a><span data-ttu-id="bee39-124">プローブと情報取得</span><span class="sxs-lookup"><span data-stu-id="bee39-124">Probing and Intelligent Observation</span></span>  
 <span data-ttu-id="bee39-125">プローブ攻撃には、アプリケーションから生成されるエラー メッセージを調べてセキュリティ上の脆弱性を探す手法がよく用いられます。</span><span class="sxs-lookup"><span data-stu-id="bee39-125">A probing attack can use error messages generated by an application to search for security vulnerabilities.</span></span> <span data-ttu-id="bee39-126">すべてのプロシージャ コードにはエラー処理を実装し、SQL Server のエラー情報がエンド ユーザーに返されないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="bee39-126">Implement error handling in all procedural code to prevent SQL Server error information from being returned to the end user.</span></span>  
  
### <a name="authentication"></a><span data-ttu-id="bee39-127">認証</span><span class="sxs-lookup"><span data-stu-id="bee39-127">Authentication</span></span>  
 <span data-ttu-id="bee39-128">SQL Server ログインを使用したアプリケーションでは、ユーザーによって入力されたデータから実行時に接続文字列を構築している場合、接続文字列のインジェクション攻撃を受ける可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bee39-128">A connection string injection attack can occur when using SQL Server logins if a connection string based on user input is constructed at run time.</span></span> <span data-ttu-id="bee39-129">接続文字列をチェックして、有効なキーワードの組み合わせが使用されているかどうかを調べないと、攻撃者によって余分な文字が挿入され、機密データなど、サーバー上のリソースへのアクセスを許してしまうことも考えられます。</span><span class="sxs-lookup"><span data-stu-id="bee39-129">If the connection string is not checked for valid keyword pairs, an attacker can insert extra characters, potentially accessing sensitive data or other resources on the server.</span></span> <span data-ttu-id="bee39-130">できるだけ Windows 認証を使用してください。</span><span class="sxs-lookup"><span data-stu-id="bee39-130">Use Windows authentication wherever possible.</span></span> <span data-ttu-id="bee39-131">SQL Server ログインを使用する必要がある場合は、<xref:System.Data.SqlClient.SqlConnectionStringBuilder> を使用して接続文字列を実行時に作成および検証するようにします。</span><span class="sxs-lookup"><span data-stu-id="bee39-131">If you must use SQL Server logins, use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder> to create and validate connection strings at run time.</span></span>  
  
### <a name="passwords"></a><span data-ttu-id="bee39-132">パスワード</span><span class="sxs-lookup"><span data-stu-id="bee39-132">Passwords</span></span>  
 <span data-ttu-id="bee39-133">権限を持ったユーザーのパスワードを侵入者が入手するか、パスワードを推測できた場合、多くの場合、攻撃を許す結果になります。</span><span class="sxs-lookup"><span data-stu-id="bee39-133">Many attacks succeed because an intruder was able to obtain or guess a password for a privileged user.</span></span> <span data-ttu-id="bee39-134">パスワードは侵入者に対する防御の最前線であるため、システムのセキュリティにとって強力なパスワードを設定することは不可欠です。</span><span class="sxs-lookup"><span data-stu-id="bee39-134">Passwords are your first line of defense against intruders, so setting strong passwords is essential to the security of your system.</span></span> <span data-ttu-id="bee39-135">混合モード認証のパスワード ポリシーを作成して適用するようにしてください。</span><span class="sxs-lookup"><span data-stu-id="bee39-135">Create and enforce password policies for mixed mode authentication.</span></span>  
  
 <span data-ttu-id="bee39-136">Windows 認証を使用する場合でも、`sa` アカウントに必ず強力なパスワードを割り当てます。</span><span class="sxs-lookup"><span data-stu-id="bee39-136">Always assign a strong password to the `sa` account, even when using Windows Authentication.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="bee39-137">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="bee39-137">In This Section</span></span>  
 [<span data-ttu-id="bee39-138">SQL Server でストアド プロシージャを使用した権限の管理</span><span class="sxs-lookup"><span data-stu-id="bee39-138">Managing Permissions with Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/managing-permissions-with-stored-procedures-in-sql-server.md)  
 <span data-ttu-id="bee39-139">ストアド プロシージャを使用して権限を管理したり、データ アクセスを制御したりする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-139">Describes how to use stored procedures to manage permissions and control data access.</span></span> <span data-ttu-id="bee39-140">ストアド プロシージャは、セキュリティ上のさまざまな脅威に対抗する手段として効果的です。</span><span class="sxs-lookup"><span data-stu-id="bee39-140">Using stored procedures is an effective way to respond to many security threats.</span></span>  
  
 [<span data-ttu-id="bee39-141">SQL Server での動的 SQL の安全な作成</span><span class="sxs-lookup"><span data-stu-id="bee39-141">Writing Secure Dynamic SQL in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)  
 <span data-ttu-id="bee39-142">ストアド プロシージャを使用して、安全な動的 SQL を作成する手法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-142">Describes techniques for writing secure dynamic SQL using stored procedures.</span></span>  
  
 [<span data-ttu-id="bee39-143">SQL Server でストアド プロシージャの署名</span><span class="sxs-lookup"><span data-stu-id="bee39-143">Signing Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)  
 <span data-ttu-id="bee39-144">証明書を使ってストアド プロシージャに署名することで、ユーザーが直接アクセスしなくてもデータを利用できるようにする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-144">Describes how to sign a stored procedure with a certificate to enable users to work with data they do not have direct access to.</span></span> <span data-ttu-id="bee39-145">これにより、操作を直接実行するための権限が呼び出し元になくても、ストアド プロシージャで操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="bee39-145">This enables stored procedures to perform operations that the caller does not have permissions to perform directly.</span></span>  
  
 [<span data-ttu-id="bee39-146">SQL Server での偽装アクセス許可のカスタマイズ</span><span class="sxs-lookup"><span data-stu-id="bee39-146">Customizing Permissions with Impersonation in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server.md)  
 <span data-ttu-id="bee39-147">EXECUTE AS 句を使って他のユーザーの権限を借用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-147">Describes how to use the EXECUTE AS clause to impersonate another user.</span></span> <span data-ttu-id="bee39-148">権限の借用では、呼び出し元の実行コンテキストが、特定のユーザーの実行コンテキストに切り替えられます。</span><span class="sxs-lookup"><span data-stu-id="bee39-148">Impersonation switches the execution context from the caller to the specified user.</span></span>  
  
 [<span data-ttu-id="bee39-149">SQL Server で行レベルの権限の付与</span><span class="sxs-lookup"><span data-stu-id="bee39-149">Granting Row-Level Permissions in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/granting-row-level-permissions-in-sql-server.md)  
 <span data-ttu-id="bee39-150">データ アクセスを制限する行レベルの権限を実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-150">Describes how to implement row-level permissions to restrict data access.</span></span>  
  
 [<span data-ttu-id="bee39-151">SQL Server でアプリケーション ロールを作成します。</span><span class="sxs-lookup"><span data-stu-id="bee39-151">Creating Application Roles in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/creating-application-roles-in-sql-server.md)  
 <span data-ttu-id="bee39-152">アプリケーション ロールの機能について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-152">Describes features and functionality of application roles.</span></span>  
  
 [<span data-ttu-id="bee39-153">SQL server データベースにまたがるアクセスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="bee39-153">Enabling Cross-Database Access in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/enabling-cross-database-access-in-sql-server.md)  
 <span data-ttu-id="bee39-154">セキュリティを損なうことなく複数データベースにまたがるアクセスを有効にする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bee39-154">Describes how to enable cross-database access without jeopardizing security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bee39-155">関連項目</span><span class="sxs-lookup"><span data-stu-id="bee39-155">See Also</span></span>  
 [<span data-ttu-id="bee39-156">SQL Server のセキュリティ</span><span class="sxs-lookup"><span data-stu-id="bee39-156">SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/sql-server-security.md)  
 [<span data-ttu-id="bee39-157">SQL Server のセキュリティの概要</span><span class="sxs-lookup"><span data-stu-id="bee39-157">Overview of SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)  
 [<span data-ttu-id="bee39-158">ADO.NET アプリケーションのセキュリティ保護</span><span class="sxs-lookup"><span data-stu-id="bee39-158">Securing ADO.NET Applications</span></span>](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)  
 [<span data-ttu-id="bee39-159">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="bee39-159">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
