---
title: LINQ と ADO.NET
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: f57d50e6c76b3d95c1d87b6beafe345f9a251e04
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/23/2019
ms.locfileid: "54714816"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="13cf3-102">LINQ と ADO.NET</span><span class="sxs-lookup"><span data-stu-id="13cf3-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="13cf3-103">今日では、多くのビジネス開発者が 2 つ (以上) のプログラミング言語を使用する必要があります。 高級言語 (Visual c# または Visual Basic) などのビジネス ロジックやプレゼンテーション層とデータベースと対話するクエリ言語 (など[!INCLUDE[tsql](../../../../includes/tsql-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="13cf3-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span></span> <span data-ttu-id="13cf3-104">開発者は実質的に複数の言語に精通していることが要求され、開発環境における言語の不整合が生じる原因にもなっています。</span><span class="sxs-lookup"><span data-stu-id="13cf3-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="13cf3-105">たとえば、データ アクセス API を使用してデータベースを照会するアプリケーションでは、クエリは文字列リテラルとして引用符で囲んで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="13cf3-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="13cf3-106">コンパイラはこのクエリ文字列を認識できないため、エラー (無効な構文、参照されている列または行が実際に存在するかどうかなど) のチェック機構が働きません。</span><span class="sxs-lookup"><span data-stu-id="13cf3-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="13cf3-107">クエリ パラメーターの型チェックや `IntelliSense` のサポートもありません。</span><span class="sxs-lookup"><span data-stu-id="13cf3-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] <span data-ttu-id="13cf3-108">により、開発者はアプリケーション コード内でプログラミング言語とクエリ言語を使い分けることなく、セット ベースのクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-108">enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="13cf3-109">インメモリのデータ構造、XML ドキュメント、SQL データベース、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] オブジェクトなど、列挙可能な各種データ ソース (つまり、<xref:System.Collections.IEnumerable> インターフェイスを実装するデータ ソース) に対する <xref:System.Data.DataSet> クエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="13cf3-110">実装方法には違いがありますが、こうした列挙可能なデータ ソースはすべて同じ構文および言語構造を公開しています。</span><span class="sxs-lookup"><span data-stu-id="13cf3-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="13cf3-111">クエリはプログラミング言語のみで作成できるため、コンパイラによる認識も検証もできない文字列リテラルとしてクエリ言語を記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="13cf3-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="13cf3-112">Visual Studio プログラマはコンパイル時の型や構文チェックを提供することで生産性を向上させることもできますクエリをプログラミング言語に統合し、`IntelliSense`します。</span><span class="sxs-lookup"><span data-stu-id="13cf3-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="13cf3-113">クエリのデバッグやエラーの修正に伴う手間は、これらの機能によって軽減されます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="13cf3-114">SQL テーブルのデータをメモリ内のオブジェクトに転送することは、面倒であるだけでなく間違いの元にもなります。</span><span class="sxs-lookup"><span data-stu-id="13cf3-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="13cf3-115">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] および [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] で実装された [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] プロバイダーは、ソース データを <xref:System.Collections.IEnumerable> ベースのオブジェクト コレクションに変換します。</span><span class="sxs-lookup"><span data-stu-id="13cf3-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="13cf3-116">プログラマからは、クエリの実行時も更新時も常にデータが <xref:System.Collections.IEnumerable> コレクションとして見えます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="13cf3-117">これらのコレクションに対するクエリを記述する際には、`IntelliSense` の機能を完全に利用できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="13cf3-118">ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] には、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、および [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] の 3 つのテクノロジがあります。</span><span class="sxs-lookup"><span data-stu-id="13cf3-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="13cf3-119">提供に対するクエリの実行度で最適化された、<xref:System.Data.DataSet>と[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]SQL Server データベースのスキーマを直接クエリすることができますと[!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)]クエリを実行することができます、[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="13cf3-119">provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] allows you to query an [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span></span>  
  
 <span data-ttu-id="13cf3-120">次の図は、ADO.NET LINQ テクノロジが、高級プログラミング言語および LINQ 対応のデータ ソースとどのように関係しているかを簡単に表したものです。</span><span class="sxs-lookup"><span data-stu-id="13cf3-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="13cf3-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="13cf3-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="13cf3-122">LINQ の詳細については、[言語統合クエリ (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13cf3-122">For more information about LINQ, see [Language Integrated Query (LINQ)](../../../csharp/programming-guide/concepts/linq/index.md).</span></span>
  
 <span data-ttu-id="13cf3-123">以降のセクションで、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、および [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="13cf3-123">The following sections provide more information about [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="13cf3-124">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="13cf3-124">LINQ to DataSet</span></span>  
 <span data-ttu-id="13cf3-125"><xref:System.Data.DataSet> は、[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] の基礎である非接続型プログラミング モデルの重要な要素であり幅広く使用されています。</span><span class="sxs-lookup"><span data-stu-id="13cf3-125">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is built on, and is widely used.</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="13cf3-126">により、開発者は、他の多くのデータ ソースで利用できる共通のクエリ作成メカニズムを使用しながら、より高度なクエリ機能を <xref:System.Data.DataSet> に組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-126">enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="13cf3-127">詳細については、「[LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13cf3-127">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="13cf3-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="13cf3-128">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="13cf3-129">は、概念モデルへのマッピングを必要としない開発者にとって有用なツールです。</span><span class="sxs-lookup"><span data-stu-id="13cf3-129">is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="13cf3-130">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] では、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] プログラミング モデルを既存のデータベース スキーマ上で直接利用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="13cf3-130">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> <span data-ttu-id="13cf3-131">開発者は、データを表現する [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] クラスを、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] を使って生成できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-131">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables developers to generate [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] classes that represent data.</span></span> <span data-ttu-id="13cf3-132">こうして生成されたクラスは、概念データ モデルではなく、直接データベースのテーブル、ビュー、ストアド プロシージャ、およびユーザー定義関数にマッピングされます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-132">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="13cf3-133">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] では、開発者が、XML などのデータ ソースに加え、インメモリ コレクションや [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] と同じ <xref:System.Data.DataSet> プログラミング パターンを使用して、ストレージ スキーマに対して直接コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-133">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="13cf3-134">詳細については、「[LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13cf3-134">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="13cf3-135">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="13cf3-135">LINQ to Entities</span></span>  
 <span data-ttu-id="13cf3-136">現在、多くのアプリケーションが、リレーショナル データベースを基にして作成されています。</span><span class="sxs-lookup"><span data-stu-id="13cf3-136">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="13cf3-137">ある時点で、これらのアプリケーションにはリレーショナル形式で表されるデータと対話する必要が生じます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-137">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="13cf3-138">データベース スキーマはアプリケーションの構築に理想的であるとは限らず、アプリケーションの概念モデルはデータベースの論理モデルと同じではありません。</span><span class="sxs-lookup"><span data-stu-id="13cf3-138">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="13cf3-139">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]は、アプリケーションがデータをオブジェクトとして操作するために特定のドメインのデータをモデル化するときに使用できる概念データ モデルです。</span><span class="sxs-lookup"><span data-stu-id="13cf3-139">The [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="13cf3-140">参照してください[ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="13cf3-140">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="13cf3-141">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]を介して、リレーショナル データは .NET 環境でオブジェクトとして公開されます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-141">Through the [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="13cf3-142">これにより、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] の利用に最適なオブジェクト レイヤーが実現されます。開発者は、ビジネス ロジックの構築に使用する言語で、データベースを照会するクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-142">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="13cf3-143">この機能は、[!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="13cf3-143">This capability is known as [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> <span data-ttu-id="13cf3-144">LINQ の詳細については、「[LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="13cf3-144">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="13cf3-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="13cf3-145">See also</span></span>

- [<span data-ttu-id="13cf3-146">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="13cf3-146">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)
- [<span data-ttu-id="13cf3-147">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="13cf3-147">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
- [<span data-ttu-id="13cf3-148">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="13cf3-148">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)
- [<span data-ttu-id="13cf3-149">統合言語クエリ (LINQ)</span><span class="sxs-lookup"><span data-stu-id="13cf3-149">Language Integrated Query (LINQ)</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="13cf3-150">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="13cf3-150">ADO.NET Overview</span></span>](ado-net-overview.md)
