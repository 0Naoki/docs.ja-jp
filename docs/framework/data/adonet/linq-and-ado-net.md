---
title: "LINQ と ADO.NET"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
caps.latest.revision: "8"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: a8b196dd7eda673d1bd5f436f708471c81a857eb
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="linq-and-adonet"></a><span data-ttu-id="40997-102">LINQ と ADO.NET</span><span class="sxs-lookup"><span data-stu-id="40997-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="40997-103">今日、ビジネス アプリケーション開発者の多くは、2 つ (またはそれ以上) のプログラミング言語を使ってアプリケーションを開発しています。ビジネス ロジックやプレゼンテーション層には高級言語 ([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]、[!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)] など) が、データベースとの対話にはクエリ言語 ([!INCLUDE[tsql](../../../../includes/tsql-md.md)] など) が使用されています。</span><span class="sxs-lookup"><span data-stu-id="40997-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)] or [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]), and a query language to interact with the database (such as [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span></span> <span data-ttu-id="40997-104">開発者は実質的に複数の言語に精通していることが要求され、開発環境における言語の不整合が生じる原因にもなっています。</span><span class="sxs-lookup"><span data-stu-id="40997-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="40997-105">たとえば、データ アクセス API を使用してデータベースを照会するアプリケーションでは、クエリは文字列リテラルとして引用符で囲んで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="40997-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="40997-106">コンパイラはこのクエリ文字列を認識できないため、エラー (無効な構文、参照されている列または行が実際に存在するかどうかなど) のチェック機構が働きません。</span><span class="sxs-lookup"><span data-stu-id="40997-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="40997-107">クエリ パラメーターの型チェックや `IntelliSense` のサポートもありません。</span><span class="sxs-lookup"><span data-stu-id="40997-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]<span data-ttu-id="40997-108"> により、開発者はアプリケーション コード内でプログラミング言語とクエリ言語を使い分けることなく、セット ベースのクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="40997-108"> enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="40997-109">インメモリのデータ構造、XML ドキュメント、SQL データベース、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] オブジェクトなど、列挙可能な各種データ ソース (つまり、<xref:System.Collections.IEnumerable> インターフェイスを実装するデータ ソース) に対する <xref:System.Data.DataSet> クエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="40997-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="40997-110">実装方法には違いがありますが、こうした列挙可能なデータ ソースはすべて同じ構文および言語構造を公開しています。</span><span class="sxs-lookup"><span data-stu-id="40997-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="40997-111">クエリはプログラミング言語のみで作成できるため、コンパイラによる認識も検証もできない文字列リテラルとしてクエリ言語を記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="40997-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="40997-112">クエリをプログラミング言語に統合することにより、コンパイル時の型チェックや構文チェック、[!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] の使用などが可能となるため、`IntelliSense` プログラマは生産性を高めることができます。</span><span class="sxs-lookup"><span data-stu-id="40997-112">Integrating queries into the programming language also enables [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="40997-113">クエリのデバッグやエラーの修正に伴う手間は、これらの機能によって軽減されます。</span><span class="sxs-lookup"><span data-stu-id="40997-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="40997-114">SQL テーブルのデータをメモリ内のオブジェクトに転送することは、面倒であるだけでなく間違いの元にもなります。</span><span class="sxs-lookup"><span data-stu-id="40997-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="40997-115">[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] および [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] で実装された [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] プロバイダーは、ソース データを <xref:System.Collections.IEnumerable> ベースのオブジェクト コレクションに変換します。</span><span class="sxs-lookup"><span data-stu-id="40997-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="40997-116">プログラマからは、クエリの実行時も更新時も常にデータが <xref:System.Collections.IEnumerable> コレクションとして見えます。</span><span class="sxs-lookup"><span data-stu-id="40997-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="40997-117">これらのコレクションに対するクエリを記述する際には、`IntelliSense` の機能を完全に利用できます。</span><span class="sxs-lookup"><span data-stu-id="40997-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="40997-118">ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] には、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、および [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] の 3 つのテクノロジがあります。</span><span class="sxs-lookup"><span data-stu-id="40997-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="40997-119"> は、<xref:System.Data.DataSet> に対する高度で最適化されたクエリの実行を可能にします。一方、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] は、[!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)] データベース スキーマに対して直接クエリを実行できるようにします。また、[!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] は、[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] をクエリできるようにします。</span><span class="sxs-lookup"><span data-stu-id="40997-119"> provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query [!INCLUDE[ssNoVersion](../../../../includes/ssnoversion-md.md)] database schemas, and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] allows you to query an [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span></span>  
  
 <span data-ttu-id="40997-120">次の図は、ADO.NET LINQ テクノロジが、高級プログラミング言語および LINQ 対応のデータ ソースとどのように関係しているかを簡単に表したものです。</span><span class="sxs-lookup"><span data-stu-id="40997-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="40997-121">![LINQ to ADO.NET の概要](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="40997-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="40997-122">LINQ の言語機能の概要については、次を参照してください。 [LINQ の概要](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e)です。</span><span class="sxs-lookup"><span data-stu-id="40997-122">For general information on the LINQ language features, see [Introduction to LINQ](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e).</span></span> <span data-ttu-id="40997-123">アプリケーションでの LINQ の使用については、次を参照してください。、[ビルド内にありません: LINQ の一般的なプログラミング ガイド](http://msdn.microsoft.com/en-us/609c7a6b-cbdd-429d-99f3-78d13d3bc049)、LINQ テクノロジを使用する方法についての詳細が含まれています。</span><span class="sxs-lookup"><span data-stu-id="40997-123">For information about using LINQ in your applications, see the [NOT IN BUILD: LINQ General Programming Guide](http://msdn.microsoft.com/en-us/609c7a6b-cbdd-429d-99f3-78d13d3bc049), which contains detailed information about how to use LINQ technologies.</span></span>  
  
 <span data-ttu-id="40997-124">以降のセクションで、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]、[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]、および [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="40997-124">The following sections provide more information about [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="40997-125">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="40997-125">LINQ to DataSet</span></span>  
 <span data-ttu-id="40997-126"><xref:System.Data.DataSet> は、[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] の基礎である非接続型プログラミング モデルの重要な要素であり幅広く使用されています。</span><span class="sxs-lookup"><span data-stu-id="40997-126">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is built on, and is widely used.</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="40997-127"> により、開発者は、他の多くのデータ ソースで利用できる共通のクエリ作成メカニズムを使用しながら、より高度なクエリ機能を <xref:System.Data.DataSet> に組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="40997-127"> enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="40997-128">詳細については、「[LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="40997-128">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="40997-129">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="40997-129">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="40997-130"> は、概念モデルへのマッピングを必要としない開発者にとって有用なツールです。</span><span class="sxs-lookup"><span data-stu-id="40997-130"> is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="40997-131">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] では、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] プログラミング モデルを既存のデータベース スキーマ上で直接利用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="40997-131">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> <span data-ttu-id="40997-132">開発者は、データを表現する [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] クラスを、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] を使って生成できます。</span><span class="sxs-lookup"><span data-stu-id="40997-132">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables developers to generate [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] classes that represent data.</span></span> <span data-ttu-id="40997-133">こうして生成されたクラスは、概念データ モデルではなく、直接データベースのテーブル、ビュー、ストアド プロシージャ、およびユーザー定義関数にマッピングされます。</span><span class="sxs-lookup"><span data-stu-id="40997-133">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="40997-134">[!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] では、開発者が、XML などのデータ ソースに加え、インメモリ コレクションや [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] と同じ <xref:System.Data.DataSet> プログラミング パターンを使用して、ストレージ スキーマに対して直接コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="40997-134">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="40997-135">詳細については、「[LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="40997-135">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="40997-136">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="40997-136">LINQ to Entities</span></span>  
 <span data-ttu-id="40997-137">現在、多くのアプリケーションが、リレーショナル データベースを基にして作成されています。</span><span class="sxs-lookup"><span data-stu-id="40997-137">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="40997-138">ある時点で、これらのアプリケーションにはリレーショナル形式で表されるデータと対話する必要が生じます。</span><span class="sxs-lookup"><span data-stu-id="40997-138">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="40997-139">データベース スキーマはアプリケーションの構築に理想的であるとは限らず、アプリケーションの概念モデルはデータベースの論理モデルと同じではありません。</span><span class="sxs-lookup"><span data-stu-id="40997-139">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="40997-140">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]は、アプリケーションがデータをオブジェクトとして操作するために特定のドメインのデータをモデル化するときに使用できる概念データ モデルです。</span><span class="sxs-lookup"><span data-stu-id="40997-140">The [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="40997-141">参照してください[ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md)詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="40997-141">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="40997-142">[!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)]を介して、リレーショナル データは .NET 環境でオブジェクトとして公開されます。</span><span class="sxs-lookup"><span data-stu-id="40997-142">Through the [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="40997-143">これにより、[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] の利用に最適なオブジェクト レイヤーが実現されます。開発者は、ビジネス ロジックの構築に使用する言語で、データベースを照会するクエリを作成できます。</span><span class="sxs-lookup"><span data-stu-id="40997-143">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="40997-144">この機能は、[!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="40997-144">This capability is known as [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> <span data-ttu-id="40997-145">LINQ の詳細については、「[LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="40997-145">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40997-146">関連項目</span><span class="sxs-lookup"><span data-stu-id="40997-146">See Also</span></span>  
 [<span data-ttu-id="40997-147">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="40997-147">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)  
 [<span data-ttu-id="40997-148">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="40997-148">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)  
 [<span data-ttu-id="40997-149">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="40997-149">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)  
 [<span data-ttu-id="40997-150">統合言語クエリ (LINQ)</span><span class="sxs-lookup"><span data-stu-id="40997-150">LINQ (Language-Integrated Query)</span></span>](http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d)  
 [<span data-ttu-id="40997-151">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="40997-151">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
