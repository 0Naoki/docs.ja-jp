---
title: LINQ to DataSet の概要
ms.date: 03/30/2017
ms.assetid: dc20a8fb-03f6-4b68-9c2b-7f7299e3070b
ms.openlocfilehash: 0dd220e609d4934527f121e4e5c85f3d83323d69
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2019
ms.locfileid: "65878104"
---
# <a name="linq-to-dataset-overview"></a><span data-ttu-id="3a5c6-102">LINQ to DataSet の概要</span><span class="sxs-lookup"><span data-stu-id="3a5c6-102">LINQ to DataSet Overview</span></span>
<span data-ttu-id="3a5c6-103"><xref:System.Data.DataSet> ADO.NET の広く普及しているコンポーネントの 1 つです。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-103">The <xref:System.Data.DataSet> is one of the more widely used components of ADO.NET.</span></span> <span data-ttu-id="3a5c6-104">ADO.NET の基になる非接続型プログラミング モデルの重要な要素はされ、明示的にデータをキャッシュするさまざまなデータ ソースからできます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-104">It is a key element of the disconnected programming model that ADO.NET is based on, and it enables you to explicitly cache data from different data sources.</span></span> <span data-ttu-id="3a5c6-105">プレゼンテーション層では、<xref:System.Data.DataSet> とデータ バインディングの GUI コントロールとが密接に連携します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-105">For the presentation tier, the <xref:System.Data.DataSet> is tightly integrated with GUI controls for data-binding.</span></span> <span data-ttu-id="3a5c6-106">中間層では、リレーショナル形式のデータを維持するキャッシュとして機能し、単純で高速なクエリと、階層的なナビゲーション サービスを提供します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-106">For the middle-tier, it provides a cache that preserves the relational shape of data, and includes fast simple query and hierarchy navigation services.</span></span> <span data-ttu-id="3a5c6-107">データベースに対する要求の数を削減するために使用する一般的な手法は、使用する、<xref:System.Data.DataSet>中間層でのキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-107">A common technique used to lower the number of requests on a database is to use the <xref:System.Data.DataSet> for caching in the middle-tier.</span></span> <span data-ttu-id="3a5c6-108">たとえば、データに基づく ASP.NET Web アプリケーションを検討してください。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-108">For example, consider a data-driven ASP.NET Web application.</span></span> <span data-ttu-id="3a5c6-109">ほとんど変更されないアプリケーション データがかなりの割合で存在し、しかも、複数のセッションまたは複数のユーザー間で共通して使用されているケースがよくあります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-109">Often, a significant portion of the application data does not change frequently and is common across sessions or users.</span></span> <span data-ttu-id="3a5c6-110">このデータを Web サーバー上のメモリに維持しておくことで、データベースに対する要求数を減らし、高速な対話処理をユーザーに提供できます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-110">This data can be kept in memory on the Web server, which reduces the number of requests against the database and speeds up the user’s interactions.</span></span> <span data-ttu-id="3a5c6-111">もう 1 つの便利な側面、<xref:System.Data.DataSet>アプリケーション領域に 1 つまたは複数のデータ ソースからデータのサブセットをアプリケーションでできることです。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-111">Another useful aspect of the <xref:System.Data.DataSet> is that it allows an application to bring subsets of data from one or more data source into the application space.</span></span> <span data-ttu-id="3a5c6-112">アプリケーションは、そのデータをリレーショナル形式を維持したままインメモリで操作できます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-112">The application can then manipulate the data in-memory, while retaining its relational shape.</span></span>  
  
 <span data-ttu-id="3a5c6-113">こうした突出した特長がある反面、<xref:System.Data.DataSet> のクエリ機能には制限があります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-113">Despite its prominence, the <xref:System.Data.DataSet> has limited query capabilities.</span></span> <span data-ttu-id="3a5c6-114"><xref:System.Data.DataTable.Select%2A> メソッドでデータのフィルター処理や並べ替えを行ったり、<xref:System.Data.DataRow.GetChildRows%2A> メソッドや <xref:System.Data.DataRow.GetParentRow%2A> メソッドを使って階層のナビゲーションを行うことはできます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-114">The <xref:System.Data.DataTable.Select%2A> method can be used for filtering and sorting, and the <xref:System.Data.DataRow.GetChildRows%2A> and <xref:System.Data.DataRow.GetParentRow%2A> methods can be used for hierarchy navigation.</span></span> <span data-ttu-id="3a5c6-115">しかし、さらに複雑な処理を行うには、開発者が独自にクエリを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-115">For anything more complex, however, the developer must write a custom query.</span></span> <span data-ttu-id="3a5c6-116">その結果、アプリケーションで期待したパフォーマンスが得られなかったり、メンテナンスが難しくなったりする可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-116">This can result in applications that perform poorly and are difficult to maintain.</span></span>  
  
 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] <span data-ttu-id="3a5c6-117">は、<xref:System.Data.DataSet> オブジェクトにキャッシュされたデータに対するクエリをより簡単に、より高速にします。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-117">makes it easier and faster to query over data cached in a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="3a5c6-118">これらのクエリはアプリケーション コードに文字列リテラルとして記述するのではなく、プログラミング言語そのもので表現できます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-118">These queries are expressed in the programming language itself, rather than as string literals embedded in the application code.</span></span> <span data-ttu-id="3a5c6-119">つまり、開発者はクエリ言語を個別に習得する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-119">This means that developers do not have to learn a separate query language.</span></span> <span data-ttu-id="3a5c6-120">さらに、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]により、Visual Studio IDE は、コンパイル時の構文チェック、静的な型指定、および IntelliSense サポートを提供するために Visual Studio 開発者はより生産的に作業を[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-120">Additionally, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] enables Visual Studio developers to work more productively, because the Visual Studio IDE provides compile-time syntax checking, static typing, and IntelliSense support for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)].</span></span> <span data-ttu-id="3a5c6-121">また、[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] を使用すると、1 つまたは複数のデータ ソースから取得して統合したデータを照会することもできます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-121">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] can also be used to query over data that has been consolidated from one or more data sources.</span></span> <span data-ttu-id="3a5c6-122">これにより、データの表現方法や扱いに柔軟性が要求されるさまざまなシナリオが実現します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-122">This enables many scenarios that require flexibility in how data is represented and handled.</span></span> <span data-ttu-id="3a5c6-123">特に、汎用のレポート作成、分析、ビジネス インテリジェンスを行うアプリケーションでは、この手法を用いたデータ操作が欠かせません。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-123">In particular, generic reporting, analysis, and business intelligence applications require this method of manipulation.</span></span>  
  
## <a name="querying-datasets-using-linq-to-dataset"></a><span data-ttu-id="3a5c6-124">LINQ to DataSet を使った DataSet のクエリ</span><span class="sxs-lookup"><span data-stu-id="3a5c6-124">Querying DataSets Using LINQ to DataSet</span></span>  
 <span data-ttu-id="3a5c6-125"><xref:System.Data.DataSet> を使用して [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] オブジェクトを照会するには、あらかじめ <xref:System.Data.DataSet> にデータを読み込んでおく必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-125">Before you can begin querying a <xref:System.Data.DataSet> object using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], you must populate the <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="3a5c6-126">いくつかの方法にデータを読み込む、<xref:System.Data.DataSet>などを使用して、<xref:System.Data.Common.DataAdapter>クラスまたは[LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-126">There are several ways to load data into a <xref:System.Data.DataSet>, such as using the <xref:System.Data.Common.DataAdapter> class or [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="3a5c6-127">データが読み込まれた後、<xref:System.Data.DataSet>オブジェクト、クエリを実行を開始することができます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-127">After the data has been loaded into a <xref:System.Data.DataSet> object, you can begin to query it.</span></span> <span data-ttu-id="3a5c6-128">使用してクエリを作成[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]使用と似ています[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]他に対して[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-データ ソースを有効にします。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-128">Formulating queries using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] is similar to using [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] against other [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-enabled data sources.</span></span> [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] <span data-ttu-id="3a5c6-129">単一テーブルに対してクエリを実行できる、<xref:System.Data.DataSet>またはを使用して 1 つ以上のテーブルに対して、<xref:System.Linq.Enumerable.Join%2A>と<xref:System.Linq.Enumerable.GroupJoin%2A>標準クエリ演算子。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-129">queries can be performed against single tables in a <xref:System.Data.DataSet> or against more than one table by using the <xref:System.Linq.Enumerable.Join%2A> and <xref:System.Linq.Enumerable.GroupJoin%2A> standard query operators.</span></span>  
  
 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] <span data-ttu-id="3a5c6-130">型指定された、型指定されていないとの両方に対してクエリがサポートされている<xref:System.Data.DataSet>オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-130">queries are supported against both typed and untyped <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="3a5c6-131">アプリケーションのデザイン時に <xref:System.Data.DataSet> のスキーマがわかっている場合は、型指定された <xref:System.Data.DataSet> を使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-131">If the schema of the <xref:System.Data.DataSet> is known at application design time, a typed <xref:System.Data.DataSet> is recommended.</span></span> <span data-ttu-id="3a5c6-132">型指定された <xref:System.Data.DataSet> のテーブルおよび行は、列ごとに型指定されたメンバーを持ちます。これにより、クエリが簡素化され、読みやすくなります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-132">In a typed <xref:System.Data.DataSet>, the tables and rows have typed members for each of the columns, which makes queries simpler and more readable.</span></span>  
  
 <span data-ttu-id="3a5c6-133">だけでなく、System.Core.dll に実装された標準クエリ演算子[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]いくつか追加<xref:System.Data.DataSet>-特定の拡張機能のセットに対してクエリを簡単にする<xref:System.Data.DataRow>オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-133">In addition to the standard query operators implemented in System.Core.dll, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] adds several <xref:System.Data.DataSet>-specific extensions that make it easier to query over a set of <xref:System.Data.DataRow> objects.</span></span> <span data-ttu-id="3a5c6-134">これらの <xref:System.Data.DataSet> 固有の拡張機能には、<xref:System.Data.DataRow> の列値にアクセスするためのメソッドのほか、一連の行を比較するための演算子があります。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-134">These <xref:System.Data.DataSet>-specific extensions include operators for comparing sequences of rows, as well as methods that provide access to the column values of a <xref:System.Data.DataRow>.</span></span>  
  
## <a name="n-tier-applications-and-linq-to-dataset"></a><span data-ttu-id="3a5c6-135">n 層アプリケーションと LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="3a5c6-135">N-tier Applications and LINQ to DataSet</span></span>  
 <span data-ttu-id="3a5c6-136">n 層データ アプリケーションは、複数の論理レイヤー (層) に分けられた、データ処理を中心とするアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-136">N-tier data applications are data-centric applications that are separated into multiple logical layers (or tiers).</span></span> <span data-ttu-id="3a5c6-137">一般に、n 層アプリケーションには、プレゼンテーション層、中間層、およびデータ層が含まれます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-137">A typical N-tier application includes a presentation tier, a middle tier, and a data tier.</span></span> <span data-ttu-id="3a5c6-138">アプリケーション コンポーネントを別個の層に分離すると、アプリケーションの保守容易性とスケーラビリティが向上します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-138">Separating application components into separate tiers increases the maintainability and scalability of the application.</span></span> <span data-ttu-id="3a5c6-139">N 層データ アプリケーションの詳細については、次を参照してください。 [n 層アプリケーションでデータセットを操作](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications)します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-139">For more information about N-tier data applications, see [Work with datasets in n-tier applications](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span></span>  
  
 <span data-ttu-id="3a5c6-140">n 層アプリケーションでは、Web アプリケーションの情報をキャッシュするために <xref:System.Data.DataSet> が中間層で使用されます。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-140">In N-tier applications, the <xref:System.Data.DataSet> is often used in the middle-tier to cache information for a Web application.</span></span> <span data-ttu-id="3a5c6-141">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]クエリ機能は拡張メソッドによって実装され、既存の ADO.NET 2.0 の拡張<xref:System.Data.DataSet>します。</span><span class="sxs-lookup"><span data-stu-id="3a5c6-141">The [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] querying functionality is implemented through extension methods and extends the existing ADO.NET 2.0 <xref:System.Data.DataSet>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a5c6-142">関連項目</span><span class="sxs-lookup"><span data-stu-id="3a5c6-142">See also</span></span>

- [<span data-ttu-id="3a5c6-143">DataSet のクエリ</span><span class="sxs-lookup"><span data-stu-id="3a5c6-143">Querying DataSets</span></span>](../../../../docs/framework/data/adonet/querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="3a5c6-144">統合言語クエリ (LINQ) - C#</span><span class="sxs-lookup"><span data-stu-id="3a5c6-144">Language-Integrated Query (LINQ) - C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="3a5c6-145">統合言語クエリ (LINQ) - Visual Basic</span><span class="sxs-lookup"><span data-stu-id="3a5c6-145">Language-Integrated Query (LINQ) - Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="3a5c6-146">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="3a5c6-146">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
