---
title: "パラメーターおよびパラメーター データ型の構成"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: 9119b6db6b1d3c2099af3c7bdbe042ced4dca94e
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="7234d-102">パラメーターおよびパラメーター データ型の構成</span><span class="sxs-lookup"><span data-stu-id="7234d-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="7234d-103">コマンド オブジェクトは、パラメーターを使用して SQL ステートメントまたはストアド プロシージャに値を渡すことによって、型チェックと検証の機能を実現します。</span><span class="sxs-lookup"><span data-stu-id="7234d-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="7234d-104">コマンド テキストとは異なり、パラメーターの入力は実行可能なコードとしてではなく、リテラル値として扱われます。</span><span class="sxs-lookup"><span data-stu-id="7234d-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="7234d-105">これにより、攻撃者がサーバーのセキュリティを侵害するコマンドを SQL ステートメントに "注入" する SQL インジェクション攻撃を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="7234d-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="7234d-106">パラメーター化コマンドによりクエリ実行パフォーマンスも向上します。これは、データベース サーバーが入力コマンドを適切なキャッシュ済みクエリ プランに正確に一致させるのに役立つためです。</span><span class="sxs-lookup"><span data-stu-id="7234d-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="7234d-107">詳細については、SQL Server オンライン ブックの「 [実行プランのキャッシュと再利用](http://go.microsoft.com/fwlink/?LinkId=120424) 」および「 [パラメーターと実行プランの再利用](http://go.microsoft.com/fwlink/?LinkId=120423) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7234d-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="7234d-108">セキュリティおよびパフォーマンス上の利点に加え、パラメーター化コマンドを使用すると、データ ソースに渡す値を簡単に扱うことができます。</span><span class="sxs-lookup"><span data-stu-id="7234d-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="7234d-109"><xref:System.Data.Common.DbParameter> オブジェクトは、コンストラクターを使って作成できるほか、 <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> コレクションの `Add` メソッドを呼び出し、 <xref:System.Data.Common.DbParameterCollection> にオブジェクトを追加することによって作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="7234d-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="7234d-110">`Add` メソッドは、コンストラクター引数または既存のパラメーター オブジェクトを入力として受け取ります。この点はデータ プロバイダーによっても異なります。</span><span class="sxs-lookup"><span data-stu-id="7234d-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="7234d-111">ParameterDirection プロパティの指定</span><span class="sxs-lookup"><span data-stu-id="7234d-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="7234d-112">パラメーターを追加する際は、入力パラメーターとは別に、パラメーターの <xref:System.Data.ParameterDirection> プロパティを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="7234d-113">`ParameterDirection` で使用できる <xref:System.Data.ParameterDirection> の値を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="7234d-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="7234d-114">メンバー名</span><span class="sxs-lookup"><span data-stu-id="7234d-114">Member name</span></span>|<span data-ttu-id="7234d-115">説明</span><span class="sxs-lookup"><span data-stu-id="7234d-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="7234d-116">このパラメーターは入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="7234d-116">The parameter is an input parameter.</span></span> <span data-ttu-id="7234d-117">既定値です。</span><span class="sxs-lookup"><span data-stu-id="7234d-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="7234d-118">このパラメーターは入力と出力の両方の機能を持っています。</span><span class="sxs-lookup"><span data-stu-id="7234d-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="7234d-119">このパラメーターは出力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="7234d-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="7234d-120">パラメーターは、ストアド プロシージャ、組み込み関数、ユーザー定義関数などの操作からの戻り値を表します。</span><span class="sxs-lookup"><span data-stu-id="7234d-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="7234d-121">パラメーターのプレースホルダーの使用</span><span class="sxs-lookup"><span data-stu-id="7234d-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="7234d-122">パラメーターのプレースホルダーの構文はデータ ソースに依存します。</span><span class="sxs-lookup"><span data-stu-id="7234d-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="7234d-123">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] のデータ プロバイダーによって、パラメーターおよびパラメーターのプレースホルダーの名前付けや指定方法が異なります。</span><span class="sxs-lookup"><span data-stu-id="7234d-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="7234d-124">次の表に示すように、データ ソースごとに固有の構文が採用されています。</span><span class="sxs-lookup"><span data-stu-id="7234d-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="7234d-125">データ プロバイダー</span><span class="sxs-lookup"><span data-stu-id="7234d-125">Data provider</span></span>|<span data-ttu-id="7234d-126">パラメーターの名前付け構文</span><span class="sxs-lookup"><span data-stu-id="7234d-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="7234d-127">`@`*parametername*形式の名前付きパラメーターが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="7234d-128">疑問符 (`?`) で指定される位置パラメーター マーカーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="7234d-129">疑問符 (`?`) で指定される位置パラメーター マーカーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="7234d-130">`:`*parmname* (または *parmname*) 形式の名前付きパラメーターが使用されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="7234d-131">パラメーターのデータ型の指定</span><span class="sxs-lookup"><span data-stu-id="7234d-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="7234d-132">パラメーターのデータ型は [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダーに固有の属性です。</span><span class="sxs-lookup"><span data-stu-id="7234d-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="7234d-133">型が指定されている場合は、その値がデータ ソースに渡される前に `Parameter` の値が [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダー型に変換されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="7234d-134">`Parameter` オブジェクトの `DbType` プロパティを特定の `Parameter` に設定する一般的な方法で <xref:System.Data.DbType>の型を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="7234d-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="7234d-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] オブジェクトの `Parameter` データ プロバイダー型は、 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] オブジェクトの `Value` の `Parameter` 型、または `DbType` オブジェクトの `Parameter` から推論されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="7234d-136">`Parameter` 値として渡されるオブジェクトまたは指定された `Parameter` に基づいて推論される `DbType`型を、次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="7234d-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="7234d-137">.NET Framework 型</span><span class="sxs-lookup"><span data-stu-id="7234d-137">.NET Framework type</span></span>|<span data-ttu-id="7234d-138">DbType</span><span class="sxs-lookup"><span data-stu-id="7234d-138">DbType</span></span>|<span data-ttu-id="7234d-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="7234d-139">SqlDbType</span></span>|<span data-ttu-id="7234d-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="7234d-140">OleDbType</span></span>|<span data-ttu-id="7234d-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="7234d-141">OdbcType</span></span>|<span data-ttu-id="7234d-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="7234d-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="7234d-143">ブール型</span><span class="sxs-lookup"><span data-stu-id="7234d-143">Boolean</span></span>|<span data-ttu-id="7234d-144">ビット</span><span class="sxs-lookup"><span data-stu-id="7234d-144">Bit</span></span>|<span data-ttu-id="7234d-145">ブール型</span><span class="sxs-lookup"><span data-stu-id="7234d-145">Boolean</span></span>|<span data-ttu-id="7234d-146">ビット</span><span class="sxs-lookup"><span data-stu-id="7234d-146">Bit</span></span>|<span data-ttu-id="7234d-147">Byte</span><span class="sxs-lookup"><span data-stu-id="7234d-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="7234d-148">Byte</span><span class="sxs-lookup"><span data-stu-id="7234d-148">Byte</span></span>|<span data-ttu-id="7234d-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="7234d-149">TinyInt</span></span>|<span data-ttu-id="7234d-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="7234d-150">UnsignedTinyInt</span></span>|<span data-ttu-id="7234d-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="7234d-151">TinyInt</span></span>|<span data-ttu-id="7234d-152">Byte</span><span class="sxs-lookup"><span data-stu-id="7234d-152">Byte</span></span>|  
|<span data-ttu-id="7234d-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="7234d-153">byte[]</span></span>|<span data-ttu-id="7234d-154">2 項</span><span class="sxs-lookup"><span data-stu-id="7234d-154">Binary</span></span>|<span data-ttu-id="7234d-155">VarBinary`.` 8000 バイトがバイト配列が VarBinary の最大サイズより大きい場合、この暗黙の変換は失敗します。8000 バイトを超えるバイト配列を明示的に設定、<xref:System.Data.SqlDbType>です。</span><span class="sxs-lookup"><span data-stu-id="7234d-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="7234d-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="7234d-156">VarBinary</span></span>|<span data-ttu-id="7234d-157">2 項</span><span class="sxs-lookup"><span data-stu-id="7234d-157">Binary</span></span>|<span data-ttu-id="7234d-158">Raw</span><span class="sxs-lookup"><span data-stu-id="7234d-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="7234d-159">char から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="7234d-160">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-160">Char</span></span>|<span data-ttu-id="7234d-161">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-161">Char</span></span>|<span data-ttu-id="7234d-162">Byte</span><span class="sxs-lookup"><span data-stu-id="7234d-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="7234d-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-163">DateTime</span></span>|<span data-ttu-id="7234d-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-164">DateTime</span></span>|<span data-ttu-id="7234d-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="7234d-165">DBTimeStamp</span></span>|<span data-ttu-id="7234d-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-166">DateTime</span></span>|<span data-ttu-id="7234d-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="7234d-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="7234d-168">DateTimeOffset</span></span>|<span data-ttu-id="7234d-169">SQL Server 2008 の DateTimeOffset。</span><span class="sxs-lookup"><span data-stu-id="7234d-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="7234d-170">SQL Server 2008 より前のバージョンの SQL Server では、DateTimeOffset から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="7234d-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="7234d-172">Decimal (10 進数型)</span><span class="sxs-lookup"><span data-stu-id="7234d-172">Decimal</span></span>|<span data-ttu-id="7234d-173">Decimal (10 進数型)</span><span class="sxs-lookup"><span data-stu-id="7234d-173">Decimal</span></span>|<span data-ttu-id="7234d-174">Decimal (10 進数型)</span><span class="sxs-lookup"><span data-stu-id="7234d-174">Decimal</span></span>|<span data-ttu-id="7234d-175">数字</span><span class="sxs-lookup"><span data-stu-id="7234d-175">Numeric</span></span>|<span data-ttu-id="7234d-176">Number</span><span class="sxs-lookup"><span data-stu-id="7234d-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="7234d-177">倍精度浮動小数点型</span><span class="sxs-lookup"><span data-stu-id="7234d-177">Double</span></span>|<span data-ttu-id="7234d-178">Float</span><span class="sxs-lookup"><span data-stu-id="7234d-178">Float</span></span>|<span data-ttu-id="7234d-179">倍精度浮動小数点型</span><span class="sxs-lookup"><span data-stu-id="7234d-179">Double</span></span>|<span data-ttu-id="7234d-180">倍精度浮動小数点型</span><span class="sxs-lookup"><span data-stu-id="7234d-180">Double</span></span>|<span data-ttu-id="7234d-181">倍精度浮動小数点型</span><span class="sxs-lookup"><span data-stu-id="7234d-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="7234d-182">Single</span><span class="sxs-lookup"><span data-stu-id="7234d-182">Single</span></span>|<span data-ttu-id="7234d-183">Real</span><span class="sxs-lookup"><span data-stu-id="7234d-183">Real</span></span>|<span data-ttu-id="7234d-184">Single</span><span class="sxs-lookup"><span data-stu-id="7234d-184">Single</span></span>|<span data-ttu-id="7234d-185">Real</span><span class="sxs-lookup"><span data-stu-id="7234d-185">Real</span></span>|<span data-ttu-id="7234d-186">Float</span><span class="sxs-lookup"><span data-stu-id="7234d-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="7234d-187">Guid</span><span class="sxs-lookup"><span data-stu-id="7234d-187">Guid</span></span>|<span data-ttu-id="7234d-188">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="7234d-188">UniqueIdentifier</span></span>|<span data-ttu-id="7234d-189">Guid</span><span class="sxs-lookup"><span data-stu-id="7234d-189">Guid</span></span>|<span data-ttu-id="7234d-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="7234d-190">UniqueIdentifier</span></span>|<span data-ttu-id="7234d-191">Raw</span><span class="sxs-lookup"><span data-stu-id="7234d-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="7234d-192">Int16</span><span class="sxs-lookup"><span data-stu-id="7234d-192">Int16</span></span>|<span data-ttu-id="7234d-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="7234d-193">SmallInt</span></span>|<span data-ttu-id="7234d-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="7234d-194">SmallInt</span></span>|<span data-ttu-id="7234d-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="7234d-195">SmallInt</span></span>|<span data-ttu-id="7234d-196">Int16</span><span class="sxs-lookup"><span data-stu-id="7234d-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="7234d-197">Int32</span><span class="sxs-lookup"><span data-stu-id="7234d-197">Int32</span></span>|<span data-ttu-id="7234d-198">Int</span><span class="sxs-lookup"><span data-stu-id="7234d-198">Int</span></span>|<span data-ttu-id="7234d-199">Int</span><span class="sxs-lookup"><span data-stu-id="7234d-199">Int</span></span>|<span data-ttu-id="7234d-200">Int</span><span class="sxs-lookup"><span data-stu-id="7234d-200">Int</span></span>|<span data-ttu-id="7234d-201">Int32</span><span class="sxs-lookup"><span data-stu-id="7234d-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="7234d-202">Int64</span><span class="sxs-lookup"><span data-stu-id="7234d-202">Int64</span></span>|<span data-ttu-id="7234d-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="7234d-203">BigInt</span></span>|<span data-ttu-id="7234d-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="7234d-204">BigInt</span></span>|<span data-ttu-id="7234d-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="7234d-205">BigInt</span></span>|<span data-ttu-id="7234d-206">Number</span><span class="sxs-lookup"><span data-stu-id="7234d-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="7234d-207">オブジェクト</span><span class="sxs-lookup"><span data-stu-id="7234d-207">Object</span></span>|<span data-ttu-id="7234d-208">バリアント</span><span class="sxs-lookup"><span data-stu-id="7234d-208">Variant</span></span>|<span data-ttu-id="7234d-209">バリアント</span><span class="sxs-lookup"><span data-stu-id="7234d-209">Variant</span></span>|<span data-ttu-id="7234d-210">Object から OdbcType への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="7234d-211">Blob</span><span class="sxs-lookup"><span data-stu-id="7234d-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="7234d-212">String</span><span class="sxs-lookup"><span data-stu-id="7234d-212">String</span></span>|<span data-ttu-id="7234d-213">NVarChar。</span><span class="sxs-lookup"><span data-stu-id="7234d-213">NVarChar.</span></span> <span data-ttu-id="7234d-214">文字列が NVarChar の最大サイズ (4000 文字) より大きい場合、この暗黙の変換はエラーになります。</span><span class="sxs-lookup"><span data-stu-id="7234d-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="7234d-215">4000 文字を超える文字列の場合は、明示的に <xref:System.Data.SqlDbType>を設定してください。</span><span class="sxs-lookup"><span data-stu-id="7234d-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="7234d-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="7234d-216">VarWChar</span></span>|<span data-ttu-id="7234d-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-217">NVarChar</span></span>|<span data-ttu-id="7234d-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="7234d-219">時間</span><span class="sxs-lookup"><span data-stu-id="7234d-219">Time</span></span>|<span data-ttu-id="7234d-220">SQL Server 2008 の Time。</span><span class="sxs-lookup"><span data-stu-id="7234d-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="7234d-221">SQL Server 2008 より前のバージョンの SQL Server では、TimeSpan から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="7234d-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="7234d-222">DBTime</span></span>|<span data-ttu-id="7234d-223">時間</span><span class="sxs-lookup"><span data-stu-id="7234d-223">Time</span></span>|<span data-ttu-id="7234d-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="7234d-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="7234d-225">UInt16</span></span>|<span data-ttu-id="7234d-226">UInt16 から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="7234d-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="7234d-227">UnsignedSmallInt</span></span>|<span data-ttu-id="7234d-228">Int</span><span class="sxs-lookup"><span data-stu-id="7234d-228">Int</span></span>|<span data-ttu-id="7234d-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="7234d-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="7234d-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="7234d-230">UInt32</span></span>|<span data-ttu-id="7234d-231">UInt32 から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="7234d-232">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="7234d-232">UnsignedInt</span></span>|<span data-ttu-id="7234d-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="7234d-233">BigInt</span></span>|<span data-ttu-id="7234d-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="7234d-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="7234d-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="7234d-235">UInt64</span></span>|<span data-ttu-id="7234d-236">UInt64 から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="7234d-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="7234d-237">UnsignedBigInt</span></span>|<span data-ttu-id="7234d-238">数字</span><span class="sxs-lookup"><span data-stu-id="7234d-238">Numeric</span></span>|<span data-ttu-id="7234d-239">Number</span><span class="sxs-lookup"><span data-stu-id="7234d-239">Number</span></span>|  
||<span data-ttu-id="7234d-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="7234d-240">AnsiString</span></span>|<span data-ttu-id="7234d-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-241">VarChar</span></span>|<span data-ttu-id="7234d-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-242">VarChar</span></span>|<span data-ttu-id="7234d-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-243">VarChar</span></span>|<span data-ttu-id="7234d-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-244">VarChar</span></span>|  
||<span data-ttu-id="7234d-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="7234d-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="7234d-246">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-246">Char</span></span>|<span data-ttu-id="7234d-247">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-247">Char</span></span>|<span data-ttu-id="7234d-248">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-248">Char</span></span>|<span data-ttu-id="7234d-249">Char</span><span class="sxs-lookup"><span data-stu-id="7234d-249">Char</span></span>|  
|``|<span data-ttu-id="7234d-250">通貨</span><span class="sxs-lookup"><span data-stu-id="7234d-250">Currency</span></span>|<span data-ttu-id="7234d-251">通貨</span><span class="sxs-lookup"><span data-stu-id="7234d-251">Money</span></span>|<span data-ttu-id="7234d-252">通貨</span><span class="sxs-lookup"><span data-stu-id="7234d-252">Currency</span></span>|<span data-ttu-id="7234d-253">`OdbcType` から `Currency` への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="7234d-254">Number</span><span class="sxs-lookup"><span data-stu-id="7234d-254">Number</span></span>|  
|``|<span data-ttu-id="7234d-255">日付</span><span class="sxs-lookup"><span data-stu-id="7234d-255">Date</span></span>|<span data-ttu-id="7234d-256">SQL Server 2008 の Date。</span><span class="sxs-lookup"><span data-stu-id="7234d-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="7234d-257">SQL Server 2008 より前のバージョンの SQL Server では、Date から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="7234d-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="7234d-258">DBDate</span></span>|<span data-ttu-id="7234d-259">日付</span><span class="sxs-lookup"><span data-stu-id="7234d-259">Date</span></span>|<span data-ttu-id="7234d-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-260">DateTime</span></span>|  
|``|<span data-ttu-id="7234d-261">SByte</span><span class="sxs-lookup"><span data-stu-id="7234d-261">SByte</span></span>|<span data-ttu-id="7234d-262">SByte から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="7234d-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="7234d-263">TinyInt</span></span>|<span data-ttu-id="7234d-264">SByte から `OdbcType` への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="7234d-265">SByte</span><span class="sxs-lookup"><span data-stu-id="7234d-265">SByte</span></span>|  
||<span data-ttu-id="7234d-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="7234d-266">StringFixedLength</span></span>|<span data-ttu-id="7234d-267">NChar</span><span class="sxs-lookup"><span data-stu-id="7234d-267">NChar</span></span>|<span data-ttu-id="7234d-268">WChar</span><span class="sxs-lookup"><span data-stu-id="7234d-268">WChar</span></span>|<span data-ttu-id="7234d-269">NChar</span><span class="sxs-lookup"><span data-stu-id="7234d-269">NChar</span></span>|<span data-ttu-id="7234d-270">NChar</span><span class="sxs-lookup"><span data-stu-id="7234d-270">NChar</span></span>|  
||<span data-ttu-id="7234d-271">時間</span><span class="sxs-lookup"><span data-stu-id="7234d-271">Time</span></span>|<span data-ttu-id="7234d-272">SQL Server 2008 の Time。</span><span class="sxs-lookup"><span data-stu-id="7234d-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="7234d-273">SQL Server 2008 より前のバージョンの SQL Server では、Time から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="7234d-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="7234d-274">DBTime</span></span>|<span data-ttu-id="7234d-275">時間</span><span class="sxs-lookup"><span data-stu-id="7234d-275">Time</span></span>|<span data-ttu-id="7234d-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="7234d-276">DateTime</span></span>|  
||<span data-ttu-id="7234d-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="7234d-277">VarNumeric</span></span>|<span data-ttu-id="7234d-278">VarNumeric から <xref:System.Data.SqlDbType> への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="7234d-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="7234d-279">VarNumeric</span></span>|<span data-ttu-id="7234d-280">VarNumeric から `OdbcType` への推論はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="7234d-281">Number</span><span class="sxs-lookup"><span data-stu-id="7234d-281">Number</span></span>|  
|<span data-ttu-id="7234d-282">ユーザー定義型 ( <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>を持つオブジェクト)</span><span class="sxs-lookup"><span data-stu-id="7234d-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="7234d-283">プロバイダーに応じて Object または String (SqlClient は常に Object を返し、Odbc は常に String を返します。OleDb マネージ データ プロバイダーはいずれかを表示できます)。</span><span class="sxs-lookup"><span data-stu-id="7234d-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="7234d-284"><xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> がある場合は SqlDbType.Udt、それ以外の場合は Variant。</span><span class="sxs-lookup"><span data-stu-id="7234d-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="7234d-285">OleDbType.VarWChar (値が null の場合)、それ以外の場合は OleDbType.Variant。</span><span class="sxs-lookup"><span data-stu-id="7234d-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="7234d-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="7234d-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="7234d-287">サポート外</span><span class="sxs-lookup"><span data-stu-id="7234d-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="7234d-288">decimal から他の型への変換は縮小変換になるため、decimal 値は最も近い整数値に切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="7234d-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="7234d-289">変換結果が対象の型にならなかった場合、 <xref:System.OverflowException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="7234d-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7234d-290">サーバーに NULL パラメーター値を送信する場合は、 <xref:System.DBNull>( `null` の場合は`Nothing` ) ではなく、 [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="7234d-291">システムの null 値は、値のない空オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="7234d-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="7234d-292"><xref:System.DBNull> は、null 値を表すために使用します。</span><span class="sxs-lookup"><span data-stu-id="7234d-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="7234d-293">データベースの NULL 値の詳細については、「 [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7234d-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="7234d-294">パラメーター情報の派生</span><span class="sxs-lookup"><span data-stu-id="7234d-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="7234d-295">`DbCommandBuilder` クラスを使用してストアド プロシージャからパラメーターを派生させることができます。</span><span class="sxs-lookup"><span data-stu-id="7234d-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="7234d-296">`SqlCommandBuilder` クラスと `OleDbCommandBuilder` クラスはどちらも静的メソッド `DeriveParameters`を提供します。このメソッドは、ストアド プロシージャから得られたパラメーター情報を使用して、コマンド オブジェクトのパラメーター コレクションを設定します。</span><span class="sxs-lookup"><span data-stu-id="7234d-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="7234d-297">`DeriveParameters` はコマンドの既存のパラメーター情報を上書きします。</span><span class="sxs-lookup"><span data-stu-id="7234d-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7234d-298">パラメーター情報を派生させた場合、情報を取得するためにデータ ソースへのラウンド トリップが 1 つ増えるため、パフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="7234d-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="7234d-299">パラメーター情報がデザイン時にわかっている場合は、パラメーターを明示的に設定することでアプリケーションのパフォーマンスを改善できます。</span><span class="sxs-lookup"><span data-stu-id="7234d-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="7234d-300">詳細については、次を参照してください。 [Commandbuilder でのコマンドを生成する](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md)です。</span><span class="sxs-lookup"><span data-stu-id="7234d-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="7234d-301">SqlCommand およびストアド プロシージャでのパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="7234d-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="7234d-302">ストアド プロシージャは、データドリブンのアプリケーションに多くの利点を提供します。</span><span class="sxs-lookup"><span data-stu-id="7234d-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="7234d-303">ストアド プロシージャを使用すると、データベースの操作を単一のコマンドにカプセル化し、最大のパフォーマンスが得られるように最適化し、さらに追加のセキュリティ機能を使用して、セキュリティを強化することができます。</span><span class="sxs-lookup"><span data-stu-id="7234d-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="7234d-304">ストアド プロシージャは、ストアド プロシージャ名の後にパラメーター引数を記述して SQL ステートメントとして渡すことで呼び出すことができますが、<xref:System.Data.Common.DbCommand.Parameters%2A> の [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] オブジェクトの <xref:System.Data.Common.DbCommand> コレクションを使用すると、ストアド プロシージャ パラメーターをより明示的に定義でき、出力パラメーターや戻り値にもアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="7234d-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7234d-305">パラメーター化ステートメントは、 `sp_executesql,` を使ってサーバー上で実行されるため、クエリ プランの再利用が可能になります。</span><span class="sxs-lookup"><span data-stu-id="7234d-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="7234d-306">`sp_executesql` バッチ内のローカル カーソルまたはローカル変数は、 `sp_executesql`を呼び出すバッチでは認識されません。</span><span class="sxs-lookup"><span data-stu-id="7234d-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="7234d-307">データベース コンテキストの変更は、 `sp_executesql` ステートメント終了時まで有効です。</span><span class="sxs-lookup"><span data-stu-id="7234d-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="7234d-308">詳細については、SQL Server オンライン ブックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7234d-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="7234d-309"><xref:System.Data.SqlClient.SqlCommand> でパラメーターを使用して SQL Server のストアド プロシージャを実行する場合は、 <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> コレクションに追加したパラメーターの名前が、ストアド プロシージャ内のパラメーター マーカーの名前と一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="7234d-310">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server は、SQL ステートメントまたはストアド プロシージャにパラメーターを渡す場合の疑問符 (?) プレースホルダーをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="7234d-311">ストアド プロシージャ内のパラメーターは名前付きのパラメーターと見なされ、一致するパラメーター マーカーが検索されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="7234d-312">たとえば、 `CustOrderHist` ストアド プロシージャが、 `@CustomerID`という名前のパラメーターで定義されているとします。</span><span class="sxs-lookup"><span data-stu-id="7234d-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="7234d-313">このストアド プロシージャを実行する場合、実行元のコードでも `@CustomerID`という名前のパラメーターを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="7234d-314">例</span><span class="sxs-lookup"><span data-stu-id="7234d-314">Example</span></span>  
 <span data-ttu-id="7234d-315">次の例では、 `Northwind` サンプル データベースにある SQL Server ストアド プロシージャを呼び出す方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="7234d-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="7234d-316">ストアド プロシージャの名前は `dbo.SalesByCategory` で、 `@CategoryName` データ型の `nvarchar(15)`という名前の入力パラメーターを持ちます。</span><span class="sxs-lookup"><span data-stu-id="7234d-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="7234d-317">このコードでは、プロシージャの終了時に接続が破棄されるように、using ブロック内で新しい <xref:System.Data.SqlClient.SqlConnection> を作成しています。</span><span class="sxs-lookup"><span data-stu-id="7234d-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="7234d-318"><xref:System.Data.SqlClient.SqlCommand> オブジェクトおよび <xref:System.Data.SqlClient.SqlParameter> オブジェクトが作成され、それぞれのプロパティが設定されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="7234d-319"><xref:System.Data.SqlClient.SqlDataReader> によって `SqlCommand` が実行された後、ストアド プロシージャから結果セットが返されて、出力がコンソール ウィンドウに表示されます。</span><span class="sxs-lookup"><span data-stu-id="7234d-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7234d-320">`SqlCommand` オブジェクトと `SqlParameter` オブジェクトを作成してから別個のステートメントでプロパティを設定する代わりに、オーバーロード コンストラクターを使用して複数のプロパティを 1 つのステートメントで設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="7234d-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="7234d-321">OleDbCommand または OdbcCommand によるパラメーターの使用</span><span class="sxs-lookup"><span data-stu-id="7234d-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="7234d-322"><xref:System.Data.OleDb.OleDbCommand> または <xref:System.Data.Odbc.OdbcCommand>でパラメーターを使用するときは、 `Parameters` コレクションにパラメーターが追加されている順序が、ストアド プロシージャ内でパラメーターが定義されている順序と一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="7234d-323">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB と [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC は、ストアド プロシージャ内のパラメーターをプレースホルダーとして処理し、順にパラメーター値を適用します。</span><span class="sxs-lookup"><span data-stu-id="7234d-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="7234d-324">また、戻り値パラメーターは、 `Parameters` コレクションに最初に追加されたパラメーターにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="7234d-325">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB と [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC は、SQL ステートメントまたはストアド プロシージャにパラメーターを渡す場合の名前付きのパラメーターをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="7234d-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="7234d-326">この場合は、次の例に示すように、疑問符 (?) プレースホルダーを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="7234d-327">したがって、 `Parameter` コレクションに `Parameters` オブジェクトを追加する順序は、パラメーターの疑問符 (?)</span><span class="sxs-lookup"><span data-stu-id="7234d-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="7234d-328">プレースホルダーの位置と完全に対応している必要があります。</span><span class="sxs-lookup"><span data-stu-id="7234d-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="7234d-329">OleDb の例</span><span class="sxs-lookup"><span data-stu-id="7234d-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="7234d-330">Odbc の例</span><span class="sxs-lookup"><span data-stu-id="7234d-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="7234d-331">関連項目</span><span class="sxs-lookup"><span data-stu-id="7234d-331">See Also</span></span>  
 [<span data-ttu-id="7234d-332">コマンドおよびパラメーター</span><span class="sxs-lookup"><span data-stu-id="7234d-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="7234d-333">DataAdapter パラメーター</span><span class="sxs-lookup"><span data-stu-id="7234d-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="7234d-334">ADO.NET でのデータ型のマッピング</span><span class="sxs-lookup"><span data-stu-id="7234d-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="7234d-335">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="7234d-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
