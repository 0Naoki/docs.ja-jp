---
title: ADO.NET での side-by-side 実行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 0ada258f74338fc7cbc9435fdea8fc896bd2efd6
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/07/2019
ms.locfileid: "70782713"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="dcabc-102">ADO.NET での side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="dcabc-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="dcabc-103">.NET Framework での side-by-side 実行は、アプリケーションがコンパイルされたバージョンを使用して、.NET Framework の複数のバージョンがインストールされているコンピューターでアプリケーションを実行する機能です。</span><span class="sxs-lookup"><span data-stu-id="dcabc-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="dcabc-104">サイドバイサイド実行の構成の詳細については、「side-by-side[実行](../../deployment/side-by-side-execution.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dcabc-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="dcabc-105">.NET Framework の1つのバージョンを使用してコンパイルされたアプリケーションは、.NET Framework の異なるバージョンで実行できます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="dcabc-106">ただし、インストールされている .NET Framework のバージョンごとにアプリケーションのバージョンをコンパイルし、個別に実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="dcabc-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="dcabc-107">どちらのシナリオでも、アプリケーションの上位互換性または旧バージョンとの互換性に影響する可能性があるリリース間の ADO.NET の変更に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="dcabc-108">上位互換性と下位互換性</span><span class="sxs-lookup"><span data-stu-id="dcabc-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="dcabc-109">上位互換性とは、アプリケーションを以前のバージョンの .NET Framework でコンパイルできるが、.NET Framework の新しいバージョンでは引き続き正常に動作することを意味します。</span><span class="sxs-lookup"><span data-stu-id="dcabc-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="dcabc-110">.NET Framework バージョン1.1 用に記述された ADO.NET コードは、以降のバージョンとの上位互換性があります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="dcabc-111">旧バージョンとの互換性とは、アプリケーションが新しいバージョンの .NET Framework 用にコンパイルされても、機能を損なうことなく、.NET Framework の以前のバージョンで引き続き実行されることを意味します。</span><span class="sxs-lookup"><span data-stu-id="dcabc-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="dcabc-112">もちろん、これは新しいバージョンの .NET Framework で導入された機能には当てはまりません。</span><span class="sxs-lookup"><span data-stu-id="dcabc-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="dcabc-113">.NET Framework Data Provider for ODBC</span><span class="sxs-lookup"><span data-stu-id="dcabc-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="dcabc-114">バージョン1.1 以降では、ODBC (<xref:System.Data.Odbc>) の .NET Framework Data Provider が .NET Framework の一部として含まれています。</span><span class="sxs-lookup"><span data-stu-id="dcabc-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="dcabc-115">ODBC データプロバイダーは、[データアクセスおよびストレージデベロッパーセンター](https://go.microsoft.com/fwlink/?linkid=4173)からの Web ダウンロードとして .NET Framework バージョン1.0 の開発者が使用できます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="dcabc-116">ODBC 用にダウンロードした .NET Framework Data Provider の名前空間は、 **Microsoft. Data. odbc**です。</span><span class="sxs-lookup"><span data-stu-id="dcabc-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="dcabc-117">ODBC データプロバイダーを使用してデータソースに接続する .NET Framework バージョン1.0 用に開発されたアプリケーションがあり、そのアプリケーションを .NET Framework バージョン1.1 以降のバージョンで実行する場合は、ODBC dat の名前空間を更新する必要があります。プロバイダーを system.string**にします。**</span><span class="sxs-lookup"><span data-stu-id="dcabc-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="dcabc-118">次に、新しいバージョンの .NET Framework 用に再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="dcabc-119">ODBC データプロバイダーを使用してデータソースに接続する .NET Framework バージョン2.0 以降用に開発されたアプリケーションがあり、そのアプリケーションを .NET Framework バージョン1.0 で実行する場合は、ODBC データプロバイダーをダウンロードしてインストールする必要があります.NET Framework バージョン1.0 システムの場合。</span><span class="sxs-lookup"><span data-stu-id="dcabc-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="dcabc-120">次に、ODBC データプロバイダーの名前**空間を変更**して、.NET Framework バージョン1.0 のアプリケーションを再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="dcabc-121">.NET Framework Data Provider for Oracle</span><span class="sxs-lookup"><span data-stu-id="dcabc-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="dcabc-122">バージョン1.1 以降では、Oracle 用の .NET Framework Data Provider<xref:System.Data.OracleClient>() が .NET Framework の一部として含まれています。</span><span class="sxs-lookup"><span data-stu-id="dcabc-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="dcabc-123">データプロバイダーは、[データアクセスおよびストレージデベロッパーセンター](https://go.microsoft.com/fwlink/?linkid=4173)から Web ダウンロードとして .NET Framework バージョン1.0 の開発者が使用できます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="dcabc-124">データプロバイダーを使用してデータソースに接続する .NET Framework バージョン2.0 以降用に開発されたアプリケーションがあり、そのアプリケーションを .NET Framework バージョン1.0 で実行する場合は、データプロバイダーをダウンロードして、. NE にインストールする必要があります。T Framework バージョン1.0 システム。</span><span class="sxs-lookup"><span data-stu-id="dcabc-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="dcabc-125">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="dcabc-125">Code Access Security</span></span>  
 <span data-ttu-id="dcabc-126">.NET Framework バージョン 1.0 (<xref:System.Data.SqlClient>、 <xref:System.Data.OleDb>) の .NET Framework データプロバイダーは、FullTrust アクセス許可で実行するために必要です。</span><span class="sxs-lookup"><span data-stu-id="dcabc-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="dcabc-127">.NET Framework バージョン1.0 の .NET Framework k データプロバイダーを FullTrust アクセス許可より低いゾーンで使用しようとすると、が<xref:System.Security.SecurityException>発生します。</span><span class="sxs-lookup"><span data-stu-id="dcabc-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="dcabc-128">ただし、.NET Framework バージョン2.0 以降では、一部の .NET Framework データプロバイダーを部分信頼ゾーンで使用できます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="dcabc-129">さらに、.NET Framework バージョン1.1 の .NET Framework データプロバイダーに新しいセキュリティ機能が追加されました。</span><span class="sxs-lookup"><span data-stu-id="dcabc-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="dcabc-130">この機能により、特定のセキュリティ ゾーンで使用できる接続文字列を制限することができます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="dcabc-131">特定のセキュリティ ゾーンに対して空白のパスワードの使用を禁止することもできます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="dcabc-132">詳細については、「 [コード アクセス セキュリティと ADO.NET](code-access-security.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dcabc-132">For more information, see [Code Access Security and ADO.NET](code-access-security.md).</span></span>  
  
 <span data-ttu-id="dcabc-133">.NET Framework の各インストールには個別のセキュリティ .config ファイルがあるため、セキュリティ設定には互換性の問題はありません。</span><span class="sxs-lookup"><span data-stu-id="dcabc-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="dcabc-134">ただし、アプリケーションが .NET Framework バージョン1.1 以降に含まれる ADO.NET の追加のセキュリティ機能に依存している場合は、バージョン1.0 システムに配布することはできません。</span><span class="sxs-lookup"><span data-stu-id="dcabc-134">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="dcabc-135">SqlCommand の実行</span><span class="sxs-lookup"><span data-stu-id="dcabc-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="dcabc-136">.NET Framework バージョン1.1 以降では、データソースで<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>コマンドを実行する方法が変更されました。</span><span class="sxs-lookup"><span data-stu-id="dcabc-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="dcabc-137">.NET Framework バージョン1.0 では、 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>は**sp_executesql**ストアドプロシージャのコンテキストですべてのコマンドを実行しました。</span><span class="sxs-lookup"><span data-stu-id="dcabc-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="dcabc-138">その結果、接続の状態に影響を与えるコマンド (たとえば、SET NOCOUNT ON) は、現在のコマンドの実行だけに適用されます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="dcabc-139">接続が開かれている間に実行される後続のコマンドについては、接続の状態は変更されません。</span><span class="sxs-lookup"><span data-stu-id="dcabc-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="dcabc-140">.NET Framework バージョン1.1 以降では、は<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 、コマンドにパラメーターが含まれている場合にのみ、 **sp_executesql**ストアドプロシージャのコンテキストでコマンドを実行します。これにより、パフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="dcabc-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="dcabc-141">その結果、接続の状態に影響を与えるコマンドが、非パラメーター化コマンドに含まれている場合、接続が開いている間に実行される後続のすべてのコマンドに対して、接続の状態を変更します。</span><span class="sxs-lookup"><span data-stu-id="dcabc-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="dcabc-142">たとえば、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> への呼び出しで次のバッチ コマンドが実行されるとします。</span><span class="sxs-lookup"><span data-stu-id="dcabc-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="dcabc-143">.NET Framework バージョン1.1 以降では、接続が開いている間に後続のコマンドが実行されると、NOCOUNT はオンのままになります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="dcabc-144">.NET Framework バージョン1.0 では、NOCOUNT は現在のコマンドの実行に対してのみ ON になります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="dcabc-145">この変更は、.NET Framework のいずれかのバージョンのの<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>動作に依存する場合に、アプリケーションの上位互換性と下位互換性の両方に影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="dcabc-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="dcabc-146">.NET Framework の以前のバージョンとそれ以降のバージョンの両方で実行されるアプリケーションでは、実行しているバージョンに関係なく、動作が同じであることを確認するコードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="dcabc-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="dcabc-147">変更された接続状態が後続のすべてのコマンドでも有効になるようにする場合は、<xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> を使用してコマンドを実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="dcabc-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="dcabc-148">変更された接続状態が後続のコマンドでは無効になるようにする場合は、接続状態をリセットするコマンドを含めるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="dcabc-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="dcabc-149">例:</span><span class="sxs-lookup"><span data-stu-id="dcabc-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="dcabc-150">関連項目</span><span class="sxs-lookup"><span data-stu-id="dcabc-150">See also</span></span>

- [<span data-ttu-id="dcabc-151">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="dcabc-151">ADO.NET Overview</span></span>](ado-net-overview.md)
- [<span data-ttu-id="dcabc-152">ADO.NET でのデータの取得および変更</span><span class="sxs-lookup"><span data-stu-id="dcabc-152">Retrieving and Modifying Data in ADO.NET</span></span>](retrieving-and-modifying-data.md)
