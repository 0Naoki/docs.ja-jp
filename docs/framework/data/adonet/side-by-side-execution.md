---
title: ADO.NET での side-by-side 実行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: d20d8e81d76284509d6fe733e4f283a9ab39cb00
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877091"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="21c2d-102">ADO.NET での side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="21c2d-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="21c2d-103">.NET Framework でのサイド バイ サイドで実行、アプリケーションのコンパイル対象のバージョンを排他的に使用して、インストールされている .NET Framework の複数のバージョンをあるコンピューター上でアプリケーションを実行する機能があります。</span><span class="sxs-lookup"><span data-stu-id="21c2d-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="21c2d-104">サイド バイ サイドで実行を構成する方法の詳細については、次を参照してください。[サイド バイ サイド実行](../../../../docs/framework/deployment/side-by-side-execution.md)します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="21c2d-105">.NET Framework の 1 つのバージョンを使用してコンパイルされたアプリケーションは、.NET Framework の別のバージョンで実行できます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="21c2d-106">ただし、バージョンの .NET Framework のインストールされている各バージョンのアプリケーションをコンパイルして、別々 に実行することお勧めします。</span><span class="sxs-lookup"><span data-stu-id="21c2d-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="21c2d-107">どちらのシナリオでは、ADO.NET の上位互換性またはアプリケーションの旧バージョンとの互換性に影響を与えるリリース間の変更注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="21c2d-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="21c2d-108">上位互換性と下位互換性</span><span class="sxs-lookup"><span data-stu-id="21c2d-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="21c2d-109">上位互換性は、アプリケーションは、.NET Framework の以前のバージョンでコンパイルすることができますが、.NET Framework の以降のバージョンで正常に実行も意味します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="21c2d-110">.NET Framework version 1.1 用に記述された ADO.NET コードでは、以降のバージョンとの上位互換性です。</span><span class="sxs-lookup"><span data-stu-id="21c2d-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="21c2d-111">旧バージョンとの互換性は、アプリケーションは、.NET Framework の新しいバージョンがコンパイルされるが、機能を失うことがなく、.NET Framework の以前のバージョンで引き続き実行を意味します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="21c2d-112">もちろん、この操作が、.NET Framework の新しいバージョンで導入された機能の場合です。</span><span class="sxs-lookup"><span data-stu-id="21c2d-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="21c2d-113">.NET Framework Data Provider for ODBC</span><span class="sxs-lookup"><span data-stu-id="21c2d-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="21c2d-114">バージョン 1.1 では、.NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) は、.NET Framework の一部として含まれます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="21c2d-115">ODBC データ プロバイダーを利用できる .NET Framework バージョン 1.0 の開発者から Web ダウンロードとして、[データ アクセスおよびストレージ デベロッパー センター](https://go.microsoft.com/fwlink/?linkid=4173)します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="21c2d-116">ダウンロードした .NET Framework Data Provider for ODBC の名前空間は**Microsoft.Data.Odbc**します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="21c2d-117">.NET Framework version 1.0、ODBC データ プロバイダーを使用して、データ ソースに接続するために開発されたアプリケーションがあり、.NET Framework version 1.1 またはそれ以降のバージョンでそのアプリケーションを実行する場合は、ODBC dat の名前空間を更新する必要があります。プロバイダーを**System.Data.Odbc**します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="21c2d-118">する必要がありますを再コンパイルすること、.NET Framework の新しいバージョンの。</span><span class="sxs-lookup"><span data-stu-id="21c2d-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="21c2d-119">ODBC データ プロバイダーを使用して、データ ソースに接続する .NET Framework バージョン 2.0 以降用に開発されたアプリケーションがあり、.NET Framework version 1.0 でそのアプリケーションを実行する場合、ODBC データ プロバイダーをダウンロードしてインストールする必要があります.NET Framework version 1.0 システム。</span><span class="sxs-lookup"><span data-stu-id="21c2d-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="21c2d-120">必要があります変更する名前空間に ODBC データ プロバイダーの**Microsoft.Data.Odbc**、および .NET Framework version 1.0 用にアプリケーションを再コンパイルします。</span><span class="sxs-lookup"><span data-stu-id="21c2d-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="21c2d-121">.NET Framework Data Provider for Oracle</span><span class="sxs-lookup"><span data-stu-id="21c2d-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="21c2d-122">バージョン 1.1 では、.NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) は、.NET Framework の一部として含まれます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="21c2d-123">データ プロバイダーを利用できる .NET Framework バージョン 1.0 の開発者から Web ダウンロードとして、[データ アクセスおよびストレージ デベロッパー センター](https://go.microsoft.com/fwlink/?linkid=4173)します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="21c2d-124">データ プロバイダーを使用して、データ ソースに接続する .NET Framework バージョン 2.0 以降用に開発されたアプリケーションがあり、.NET Framework version 1.0 でそのアプリケーションを実行する場合は、データ プロバイダーをダウンロードし、.NE にインストールする必要があります。T Framework version 1.0 システム。</span><span class="sxs-lookup"><span data-stu-id="21c2d-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="21c2d-125">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="21c2d-125">Code Access Security</span></span>  
 <span data-ttu-id="21c2d-126">.NET Framework version 1.0 で .NET Framework データ プロバイダー (<xref:System.Data.SqlClient>、 <xref:System.Data.OleDb>) FullTrust アクセス許可を持つ実行に必要な。</span><span class="sxs-lookup"><span data-stu-id="21c2d-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="21c2d-127">FullTrust アクセス許可の原因がより少ないゾーンで、.NET Framework データ プロバイダーを .NET Framework version 1.0 を使用すると、<xref:System.Security.SecurityException>します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="21c2d-128">ただし、以降、.NET Framework version 2.0 では、.NET Framework データ プロバイダーをすべて使用できますで部分的に信頼されたゾーン。</span><span class="sxs-lookup"><span data-stu-id="21c2d-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="21c2d-129">さらに、新しいセキュリティ機能は、.NET Framework version 1.1 での .NET Framework データ プロバイダーに追加されました。</span><span class="sxs-lookup"><span data-stu-id="21c2d-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="21c2d-130">この機能により、特定のセキュリティ ゾーンで使用できる接続文字列を制限することができます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="21c2d-131">特定のセキュリティ ゾーンに対して空白のパスワードの使用を禁止することもできます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="21c2d-132">詳細については、「 [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="21c2d-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="21c2d-133">.NET Framework の各インストールには、個別の Security.config ファイルがあるために、セキュリティ設定と互換性の問題はありません。</span><span class="sxs-lookup"><span data-stu-id="21c2d-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="21c2d-134">ただし、アプリケーションは、ADO.NET .NET Framework version 1.1 に含まれるおよびそれ以降の追加のセキュリティ機能に依存する場合、version 1.0 システムに配布することはできません。</span><span class="sxs-lookup"><span data-stu-id="21c2d-134">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="21c2d-135">SqlCommand の実行</span><span class="sxs-lookup"><span data-stu-id="21c2d-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="21c2d-136">方法は、.NET Framework version 1.1 以降を<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>コマンドを実行、データ ソースが変更されました。</span><span class="sxs-lookup"><span data-stu-id="21c2d-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="21c2d-137">.NET framework version 1.0、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>のコンテキストですべてのコマンドを実行、 **sp_executesql**ストアド プロシージャ。</span><span class="sxs-lookup"><span data-stu-id="21c2d-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="21c2d-138">その結果、接続の状態に影響を与えるコマンド (たとえば、SET NOCOUNT ON) は、現在のコマンドの実行だけに適用されます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="21c2d-139">接続が開かれている間に実行される後続のコマンドについては、接続の状態は変更されません。</span><span class="sxs-lookup"><span data-stu-id="21c2d-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="21c2d-140">.NET Framework version 1.1 以降で<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>のみのコンテキストでコマンドを実行、 **sp_executesql**ストアド プロシージャの場合は、コマンドにパラメーター、これにより、パフォーマンスの向上。</span><span class="sxs-lookup"><span data-stu-id="21c2d-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="21c2d-141">その結果、接続の状態に影響を与えるコマンドが、非パラメーター化コマンドに含まれている場合、接続が開いている間に実行される後続のすべてのコマンドに対して、接続の状態を変更します。</span><span class="sxs-lookup"><span data-stu-id="21c2d-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="21c2d-142">たとえば、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> への呼び出しで次のバッチ コマンドが実行されるとします。</span><span class="sxs-lookup"><span data-stu-id="21c2d-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="21c2d-143">.NET framework version 1.1 以降では、NOCOUNT は、接続が開いている間に実行される後続のコマンドの ON はとどまります。</span><span class="sxs-lookup"><span data-stu-id="21c2d-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="21c2d-144">.NET Framework version 1.0 では、NOCOUNT は、コマンドの現在の実行に対してだけをします。</span><span class="sxs-lookup"><span data-stu-id="21c2d-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="21c2d-145">この変更は、の動作に依存している場合、アプリケーションの上位および下位の互換性に影響は<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.NET Framework のいずれかのバージョン。</span><span class="sxs-lookup"><span data-stu-id="21c2d-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="21c2d-146">前と後の両方のバージョンの .NET Framework 上で実行されるアプリケーションでは、動作が実行しているバージョンに関係なく同じであるかどうかを確認するコードを記述することができます。</span><span class="sxs-lookup"><span data-stu-id="21c2d-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="21c2d-147">変更された接続状態が後続のすべてのコマンドでも有効になるようにする場合は、<xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> を使用してコマンドを実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="21c2d-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="21c2d-148">変更された接続状態が後続のコマンドでは無効になるようにする場合は、接続状態をリセットするコマンドを含めるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="21c2d-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="21c2d-149">例:</span><span class="sxs-lookup"><span data-stu-id="21c2d-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="21c2d-150">関連項目</span><span class="sxs-lookup"><span data-stu-id="21c2d-150">See also</span></span>

- [<span data-ttu-id="21c2d-151">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="21c2d-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [<span data-ttu-id="21c2d-152">ADO.NET でのデータの取得および変更</span><span class="sxs-lookup"><span data-stu-id="21c2d-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [<span data-ttu-id="21c2d-153">ADO.NET のマネージド プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="21c2d-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
