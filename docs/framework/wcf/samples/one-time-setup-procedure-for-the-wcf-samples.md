---
title: Windows Communication Foundation サンプルの 1 回限りのセットアップの手順
ms.date: 03/30/2017
ms.assetid: a5848ffd-3eb5-432d-812e-bd948ccb6bca
ms.openlocfilehash: 3c3c5934cbbc7dd68f03d888aa0594f9ff61c225
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/01/2018
ms.locfileid: "43387183"
---
# <a name="one-time-setup-procedure-for-the-windows-communication-foundation-samples"></a><span data-ttu-id="6f849-102">Windows Communication Foundation サンプルの 1 回限りのセットアップの手順</span><span class="sxs-lookup"><span data-stu-id="6f849-102">One-Time Setup Procedure for the Windows Communication Foundation Samples</span></span>
<span data-ttu-id="6f849-103">Windows Communication Foundation (WCF) サンプルのほとんどがインターネット インフォメーション サービス (IIS) でホストされているし、共通の仮想ディレクトリから実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-103">Most of the Windows Communication Foundation (WCF) samples are hosted in Internet Information Services (IIS) and run from a common virtual directory.</span></span> <span data-ttu-id="6f849-104">この 1 回限りのセットアップ手順は、ディスクにフォルダーを作成しますという名前の iis 仮想ディレクトリも追加**ServiceModelSamples**します。</span><span class="sxs-lookup"><span data-stu-id="6f849-104">This one-time setup procedure creates a folder on the disk; it also adds a virtual directory to IIS named **ServiceModelSamples**.</span></span>  
  
 <span data-ttu-id="6f849-105">**ServiceModelSamples**の構築と、IIS でホストされるサービスを使用するすべてのサンプルを実行する仮想ディレクトリが使用されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-105">The **ServiceModelSamples** virtual directory is used for building and running all samples that use an IIS-hosted service.</span></span> <span data-ttu-id="6f849-106">サンプルの実行に必要な仮想ディレクトリはこれだけです。</span><span class="sxs-lookup"><span data-stu-id="6f849-106">This is the only virtual directory that is required to run the samples.</span></span> <span data-ttu-id="6f849-107">サンプルをビルドすると、この仮想ディレクトリにある、以前に配置されたサービスがすべて置き換えられます。この仮想ディレクトリには最近ビルドされたサンプルだけが配置されるため、そのサンプルしか使用できません。</span><span class="sxs-lookup"><span data-stu-id="6f849-107">Building a sample will replace any previously deployed service at this virtual directory; only the most recently built sample will be deployed and available in this virtual directory.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6f849-108">すべてのコマンドは、ローカル管理者アカウントで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-108">You must run all commands under a local administrator account.</span></span> <span data-ttu-id="6f849-109">Windows 7、[!INCLUDE[windowsver](../../../../includes/windowsver-md.md)]、または Windows Server 2008 R2 を使用している場合は、コマンド プロンプトも管理者権限で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-109">If you are using Windows 7, [!INCLUDE[windowsver](../../../../includes/windowsver-md.md)], or Windows Server 2008 R2, you must also run the command prompt with elevated privileges.</span></span> <span data-ttu-id="6f849-110">これを行うには、コマンド プロンプトのアイコンを右クリックし、**管理者として実行**します。</span><span class="sxs-lookup"><span data-stu-id="6f849-110">To do so, right-click the command prompt icon, and then click **Run as administrator**.</span></span> <span data-ttu-id="6f849-111">このトピックで使用するすべてのコマンドは、適切なパスが設定されているコマンド プロンプトで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-111">All commands in this topic must be run in a command prompt that has the appropriate path settings.</span></span>  <span data-ttu-id="6f849-112">このようにするための最も簡単な方法は、Visual Studio コマンド プロンプトを使用する方法です。</span><span class="sxs-lookup"><span data-stu-id="6f849-112">The easiest way to ensure this is by using the Visual Studio Command Prompt.</span></span> <span data-ttu-id="6f849-113">このプロンプトを開くには、次のようにクリックします**開始**を選択します**すべてのプログラム**、下へスクロールして**Visual Studio 2010**を選択します**Visual Studio Tools**、。右クリックして**Visual Studio コマンド プロンプト (2010)**、 をクリックし、**管理者として実行**します。</span><span class="sxs-lookup"><span data-stu-id="6f849-113">To open this prompt, click **Start**, select **All Programs**, scroll down to **Visual Studio 2010**, select **Visual Studio Tools**, right-click **Visual Studio Command Prompt (2010)**, and then click **Run as administrator**.</span></span> <span data-ttu-id="6f849-114">Visual Studio Express Editions のいずれかがインストールされている場合は、このコマンド プロンプトを使用できません。この場合、システム パスに "C:\Windows\Microsoft.Net\Framework\v4.0" を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-114">If you have one of the Visual Studio Express editions installed, this command prompt is not available, and you will have to add "C:\Windows\Microsoft.Net\Framework\v4.0" to the system path.</span></span>  
  
### <a name="one-time-setup-procedure-for-wcf-samples"></a><span data-ttu-id="6f849-115">WCF サンプルの 1 回限りのセットアップの手順</span><span class="sxs-lookup"><span data-stu-id="6f849-115">One-time setup procedure for WCF samples</span></span>  
  
1.  <span data-ttu-id="6f849-116">[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] がセットアップされていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="6f849-116">Ensure that [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] is set up.</span></span> <span data-ttu-id="6f849-117">設定する方法の詳細についての[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]を参照してください[インターネット インフォメーション サービスのホスティング手順](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-117">For more information about how to set up [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], see [Internet Information Service Hosting Instructions](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md).</span></span>  
  
2.  <span data-ttu-id="6f849-118">[!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] がインストールされていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="6f849-118">Ensure that [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] is installed.</span></span> <span data-ttu-id="6f849-119">次のディレクトリに、v4.0 (またはそれ以降) を検索: **\Windows\Microsoft.NET\Framework**</span><span class="sxs-lookup"><span data-stu-id="6f849-119">Search the following directory for v4.0 (or later): **\Windows\Microsoft.NET\Framework**</span></span>  
  
3.  <span data-ttu-id="6f849-120">場合[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)]がインストールされていないオペレーティング システムが Windows Server 2008 SP2 または後で、インストールと[修正プログラム 251798](https://go.microsoft.com/fwlink/?LinkId=184693)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-120">If [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] is not installed, and your operating system is not Windows Server 2008 SP2 or later, install [Hotfix 251798](https://go.microsoft.com/fwlink/?LinkId=184693).</span></span>  
  
4.  <span data-ttu-id="6f849-121">次のコマンドを実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-121">Run the following commands.</span></span> <span data-ttu-id="6f849-122">これらのコマンドを実行する必要があります理由の詳細については、次を参照してください。 [IIS ホスト サービスのエラー](https://msdn.microsoft.com/library/ee5499fc-1b10-4cda-a9b1-13dba70f05f8)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-122">For more information about why these commands must be run, see [IIS Hosted Service Fails](https://msdn.microsoft.com/library/ee5499fc-1b10-4cda-a9b1-13dba70f05f8).</span></span>  
  
    > [!WARNING]
    >  <span data-ttu-id="6f849-123">IIS を再インストールした場合は、次のコマンドを再実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-123">If IIS is reinstalled, the following commands will need to be run again.</span></span>  
  
    ```  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\aspnet_regiis" –i –enable  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\ServiceModelReg.exe" -r  
    ```  
  
    > [!WARNING]
    >  <span data-ttu-id="6f849-124">コマンドを実行して`aspnet_regiis –i –enable`すると、既定のアプリケーション プールを使用して実行[!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)]、同じコンピューター上の他のアプリケーションの互換性の問題を生成する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-124">Running the command `aspnet_regiis –i –enable` will make the Default App Pool run using [!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)], which may produce incompatibility issues for other applications on the same computer.</span></span>  
  
5.  <span data-ttu-id="6f849-125">に従って、[ファイアウォール手順](../../../../docs/framework/wcf/samples/firewall-instructions.md)サンプルで使用されるポートを有効にするためです。</span><span class="sxs-lookup"><span data-stu-id="6f849-125">Follow the [Firewall Instructions](../../../../docs/framework/wcf/samples/firewall-instructions.md) for enabling the ports used by the samples.</span></span>  
  
6.  <span data-ttu-id="6f849-126">次の既定のディレクトリの確認: \<InstallDrive >:**\WF_WCF_Samples**します。</span><span class="sxs-lookup"><span data-stu-id="6f849-126">Check for the following default directory: \<InstallDrive>:**\WF_WCF_Samples**.</span></span> <span data-ttu-id="6f849-127">サンプルが既にインストールされている場合は、これが既定のディレクトリです。</span><span class="sxs-lookup"><span data-stu-id="6f849-127">If the samples were previously installed, this is the default directory.</span></span>  
  
7.  <span data-ttu-id="6f849-128">サンプルがインストールされていない場合はそれらのサンプルのダウンロード場所からインストール[Visual c#](https://go.microsoft.com/fwlink/?LinkId=190939)または[Visual Basic](https://go.microsoft.com/fwlink/?LinkID=193373)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-128">If the samples are not installed, install them from the samples download location for [Visual C#](https://go.microsoft.com/fwlink/?LinkId=190939) or [Visual Basic](https://go.microsoft.com/fwlink/?LinkID=193373).</span></span>  
  
8.  <span data-ttu-id="6f849-129">サンプルのインストール後に移動: \<InstallDrive >:**\WF_WCF_Samples\WCF\Setup\\**</span><span class="sxs-lookup"><span data-stu-id="6f849-129">After installing the samples, go to : \<InstallDrive>:**\WF_WCF_Samples\WCF\Setup\\**</span></span>  
  
9. <span data-ttu-id="6f849-130">実行、 **Setupvroot.bat**バッチ ファイル。</span><span class="sxs-lookup"><span data-stu-id="6f849-130">Run the **Setupvroot.bat** batch file.</span></span> <span data-ttu-id="6f849-131">次の手順が実行されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-131">The following steps are performed:</span></span>  
  
    -   <span data-ttu-id="6f849-132">ServiceModelSamples という名前の仮想ディレクトリが IIS に作成されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-132">A virtual directory is created in IIS named ServiceModelSamples.</span></span>  
  
    -   <span data-ttu-id="6f849-133">%SystemDrive%\Inetpub\wwwroot\ServiceModelSamples and %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples\bin という名前の新しいディスク ディレクトリが作成されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-133">New disk directories are created named %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples and %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples\bin.</span></span>  
  
     <span data-ttu-id="6f849-134">これらのディレクトリを手動で設定する場合を参照してください、[仮想ディレクトリのセットアップ手順](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-134">If you prefer to set up these directories manually, see the [Virtual Directory Setup Instructions](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md).</span></span> <span data-ttu-id="6f849-135">この手順で行ったすべての変更を元に戻すには、サンプルの使用が終わった後で cleanupvroot.bat を実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-135">To revert all changes done in this step, run cleanupvroot.bat after you finish using the samples.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6f849-136">cleanupvroot.bat を実行しない限り、この手順を実行するのは、1 台のコンピューターで 1 回だけです。</span><span class="sxs-lookup"><span data-stu-id="6f849-136">This procedure must be performed only once on a computer, unless cleanupvroot.bat is run.</span></span>  
  
10. <span data-ttu-id="6f849-137">サンプルおよび Network Service ユーザーのビルドに使用するアカウントに対し、%SystemDrive%\inetpub\wwwroot の変更権限を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-137">You must grant permission to modify for %SystemDrive%\inetpub\wwwroot to the account under which you are building the samples and the Network Service user.</span></span> <span data-ttu-id="6f849-138">ビルドの実行時に、Web ホストの一部のサンプルがコンパイル済みバイナリを前述の場所にコピーしようとする場合があり、適切な権限が設定されていないと、ビルドは破損します。</span><span class="sxs-lookup"><span data-stu-id="6f849-138">While building, some Web-hosted samples might attempt to copy the compiled binaries to the previously mentioned location, and if you have not set the appropriate permissions, the build will break.</span></span> <span data-ttu-id="6f849-139">代わりに、アクセス許可の設定はそのままにして、SDK コマンド プロンプトまたは Visual Studio コマンド プロンプト (2012) を管理者として実行するか、[!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] を管理者として実行し、サンプルをビルドすることもできます。</span><span class="sxs-lookup"><span data-stu-id="6f849-139">Alternatively, you can leave the permissions as they are and run the SDK command prompt or Visual Studio Command Prompt (2012) as Administrator, or build the samples in [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], also run as Administrator.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6f849-140">この手順を完了していない場合は、ビルドの実行時に IIS でホストされているすべてのサンプルでエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="6f849-140">If this step is not completed, all IIS-hosted samples will fail while building.</span></span> <span data-ttu-id="6f849-141">アクセス許可が正しく設定されていることを確認するか、SDK コマンド プロンプトと Visual Studio コマンド プロンプト (2012) を管理者として実行してください。</span><span class="sxs-lookup"><span data-stu-id="6f849-141">Ensure that you set the permissions correctly, or run both the SDK command prompt and Visual Studio Command Prompt (2012) as Administrator.</span></span>  
  
11. <span data-ttu-id="6f849-142">コンピューター上に C:\logs ディレクトリを作成します (一部のサンプルで必要になることがあります)。</span><span class="sxs-lookup"><span data-stu-id="6f849-142">Create a C:\logs directory on the computer; some samples might be expecting it.</span></span> <span data-ttu-id="6f849-143">このフォルダーに対する書き込みアクセスが適切なアカウントに付与されていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="6f849-143">Make sure that the appropriate account has write access granted to this folder.</span></span> <span data-ttu-id="6f849-144">Windows 7 では、 [!INCLUDE[wv](../../../../includes/wv-md.md)]、Windows Server 2008 R2 では、このアカウントは**ネットワーク サービス**します。</span><span class="sxs-lookup"><span data-stu-id="6f849-144">For Windows 7, [!INCLUDE[wv](../../../../includes/wv-md.md)], and Windows Server 2008 R2, this account is **Network Service**.</span></span> <span data-ttu-id="6f849-145">[!INCLUDE[lserver](../../../../includes/lserver-md.md)] では NT Authority\Network Service、</span><span class="sxs-lookup"><span data-stu-id="6f849-145">For  [!INCLUDE[lserver](../../../../includes/lserver-md.md)], the account is NT Authority\Network Service.</span></span> <span data-ttu-id="6f849-146">[!INCLUDE[wxp](../../../../includes/wxp-md.md)] および [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] では ASPNET です。</span><span class="sxs-lookup"><span data-stu-id="6f849-146">For [!INCLUDE[wxp](../../../../includes/wxp-md.md)] and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], the account is ASPNET.</span></span>  
  
12. <span data-ttu-id="6f849-147">Setupcerttool.bat ファイルを実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-147">Run the Setupcerttool.bat file.</span></span> <span data-ttu-id="6f849-148">このファイルにある、 \<InstallPath > \WF_WCF_Samples\WCF\Setup\ フォルダー。</span><span class="sxs-lookup"><span data-stu-id="6f849-148">This file is located in the  \<InstallPath>\WF_WCF_Samples\WCF\Setup\  folder.</span></span>  <span data-ttu-id="6f849-149">このスクリプトでは、次のタスクが実行されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-149">This script will perform the following tasks:</span></span>  
  
    -   <span data-ttu-id="6f849-150">FindPrivateKey ツールをビルドします。</span><span class="sxs-lookup"><span data-stu-id="6f849-150">Build the FindPrivateKey tool.</span></span>  
  
    -   <span data-ttu-id="6f849-151">%ProgramFiles%\ServiceModelSampleTools という名前のディレクトリを作成します。</span><span class="sxs-lookup"><span data-stu-id="6f849-151">Create a directory called %ProgramFiles%\ServiceModelSampleTools.</span></span>  
  
    -   <span data-ttu-id="6f849-152">新しい FindPrivateKey ツールをこのディレクトリにコピーします。</span><span class="sxs-lookup"><span data-stu-id="6f849-152">Copy the new FindPrivateKey tool to this directory.</span></span>  
  
     <span data-ttu-id="6f849-153">このツールは、証明書を使用して IIS でホストされるサンプルで必要です。</span><span class="sxs-lookup"><span data-stu-id="6f849-153">This tool is required by samples that use certificates and are hosted in IIS.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6f849-154">セキュリティの目的で、サンプルの使用が終わったら、このセットアップ手順で付与された仮想ディレクトリの定義とアクセス許可を必ず削除してください。削除するには、Cleanupvroot.bat という名前のバッチ ファイルを実行します。</span><span class="sxs-lookup"><span data-stu-id="6f849-154">For security purposes, remember to remove the virtual directory definition and permissions granted in the setup steps above by running the batch file named Cleanupvroot.bat after you are finished with the samples.</span></span>  
  
13. <span data-ttu-id="6f849-155">自己ホスト型の (IIS でホストされていない) サンプルでは、リッスンを行うコンピューター上で HTTP アドレスを登録するためのアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="6f849-155">Samples that are self-hosted (not hosted in IIS) require permission to register HTTP addresses on the computer for listening.</span></span> <span data-ttu-id="6f849-156">HTTP 名前空間予約のアクセス許可は、サンプルの実行に使用されるユーザー アカウントから提供されます。</span><span class="sxs-lookup"><span data-stu-id="6f849-156">The permission for an HTTP namespace reservation comes from the user account used to run the sample.</span></span> <span data-ttu-id="6f849-157">既定では、管理者アカウントには、任意の HTTP アドレスを登録するためのアクセス許可があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-157">By default, administrator accounts have the permission to register any HTTP address.</span></span> <span data-ttu-id="6f849-158">管理者以外のアカウントの場合は、サンプルで使用される HTTP 名前空間へのアクセス許可が付与される必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f849-158">Non-administrator accounts must be granted permission for the HTTP namespaces used by the samples.</span></span> <span data-ttu-id="6f849-159">名前空間の予約を構成する方法については、「[Configuring HTTP and HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md)」 (HTTP と HTTPS を構成する) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6f849-159">For more information about how to configure namespace reservations, see [Configuring HTTP and HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md).</span></span>  
  
14. <span data-ttu-id="6f849-160">一部のサンプルにはメッセージ キューが必要です。</span><span class="sxs-lookup"><span data-stu-id="6f849-160">Some samples require Message Queuing.</span></span> <span data-ttu-id="6f849-161">参照してください[インストール メッセージ キュー (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md)インストール手順についてはします。</span><span class="sxs-lookup"><span data-stu-id="6f849-161">See [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md) for installation instructions.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6f849-162">メッセージ キューが必要なサンプルを実行する場合は、MSMQ サービスを事前に開始しておいてください。</span><span class="sxs-lookup"><span data-stu-id="6f849-162">Ensure that you start the MSMQ service before you run any samples that require Message Queuing.</span></span>  
  
15. <span data-ttu-id="6f849-163">一部のサンプルには証明書が必要です。</span><span class="sxs-lookup"><span data-stu-id="6f849-163">Some samples require certificates.</span></span> <span data-ttu-id="6f849-164">参照してください[インターネット インフォメーション サービス (IIS) サーバー証明書のインストール手順](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md)します。</span><span class="sxs-lookup"><span data-stu-id="6f849-164">See [Internet Information Services (IIS) Server Certificate Installation Instructions](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6f849-165">関連項目</span><span class="sxs-lookup"><span data-stu-id="6f849-165">See Also</span></span>
