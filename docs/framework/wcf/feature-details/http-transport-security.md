---
title: "HTTP トランスポート セキュリティ"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d3439262-c58e-4d30-9f2b-a160170582bb
caps.latest.revision: "14"
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.openlocfilehash: 414ae499b777be5536e64a86fa0c60f9cd2da25a
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="http-transport-security"></a>HTTP トランスポート セキュリティ
トランスポートとして HTTP を使用すると、SSL (Secure Sockets Layer) によりセキュリティが提供されます。 SSL はクライアントに対してサービスの認証を行い、機密性 (暗号化) をチャネルに提供する技術としてインターネットで広く使用されています。 このトピックでは、SSL の機能と SSL を [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] に実装する方法について説明します。  
  
## <a name="basic-ssl"></a>基本 SSL  
 SSL の機能について一般的なシナリオを用いて説明します。ここでは、銀行の Web サイトを考えます。 ユーザーはユーザー名とパスワードを使用してサイトにログオンできます。 認証された後、ユーザーは、残高照会、支払い、口座間振り替えなどの各種取引を実行できます。  
  
 まず、サイトにアクセスするユーザー、SSL メカニズムは一連のネゴシエーションと呼ばれる、まず、*ハンドシェイク*、(ここでは、Internet Explorer)、ユーザーのクライアントを使用します。 SSL は最初にユーザーに対して銀行サイトの認証を行います。 ユーザーを誘導してユーザー名とパスワードを入力させる "なりすまし" サイトではなく、通信先が実際のサイトであることをユーザーが最初に認識する必要があるため、この手順は不可欠です。 SSL は、VeriSign などの信頼された機関から提供される SSL 証明書を使用してこの認証を行います。 論理上は、VeriSign が銀行サイトの識別情報を保証することになります。 Internet Explorer では VeriSign が信頼済みであるため、このサイトも信頼されます。 VeriSign に確認する場合は、VeriSign のロゴをクリックします。 有効期限や発行先 (銀行サイト) などの信頼性に関する報告が表示されます。  
  
 セキュリティで保護されたセッションを開始するには、クライアントは「もしもし」と同等の情報を暗号アルゴリズムのリストと共にサーバーに送信します。サーバーはこの暗号アルゴリズムのリストを使用して署名、ハッシュの生成、暗号化と複号化を行えます。 これに対して、サイトからは受信確認、およびサイトが選択したアルゴリズム スイートの 1 つが返送されます。 この初期ハンドシェイク中に、両方のパーティは nonce を送受信します。 A *nonce*はランダムに生成された一部のデータに使用される、サイトの公開キーと組み合わせてハッシュを作成します。 A*ハッシュ*SHA1 などの標準アルゴリズムを使用して 2 つの数値から派生した新しい番号です。 (クライアントとサイトは、使用するハッシュ アルゴリズムに同意するためのメッセージも交換します)。ハッシュは一意の数値で、クライアントとサイト間のセッションでメッセージの暗号化および復号化を行うためにのみ使用されます。 クライアントとサービスの両方に、元の nonce と証明書の公開キーがあるので、両者で同じハッシュを生成できます。 したがって、クライアントがサービスから送信されたハッシュを検証するには、(a) 同意したアルゴリズムを使用してデータからハッシュを計算し、(b) サービスから送信されたハッシュと比較します。両方が一致する場合は、クライアントはハッシュが改ざんされていないことを確認できます。 次にクライアントはこのハッシュを、さらに別の新しいハッシュが含まれるメッセージを暗号化するキーとして使用します。 サービスはハッシュを使用してこのメッセージを複号化でき、最後から 2 番目のハッシュを復帰できます。 ここで、累積された情報 (nonce、公開キーなどのデータ) が両者で認識されるので、最後のハッシュ (マスター キー) を作成できます。 最後のキーは、最後から 2 番目のハッシュで暗号化され送信されます。 次に、マスター キーを使ってメッセージの暗号化と複号化が行われセッションがリセットされます。 クライアントとサービスの両方を使用するため、同じキーともいいます、*セッション キー*です。  
  
 セッション キーは、対称キーまたは "共有シークレット" としての特性も持っています。 対称キーを使用すると、トランザクションの両側で必要となる計算が削減されるため、このキーを持つことは重要です。 すべてのメッセージが新しい nonce とハッシュの交換を要求した場合、パフォーマンスは低下します。 したがって、対称キーを使用して高い安全性と効率を確保しながらメッセージを両側に自由にフローさせることが、SSL の最終的な目標になります。  
  
 プロトコルはサイトによってさまざまなので、以上の説明では動作を簡略化しています。 また、データ交換処理をさらに複雑にするため (保護を強化するため) に、ハンドシェイク中にクライアントとサイトの両方でアルゴリズムを組み合わせた nonce を別々に生成することもできます。  
  
### <a name="certificates-and-public-key-infrastructure"></a>証明書および公開キー基盤  
 ハンドシェイク中に、サービスは SSL 証明書もクライアントに送信します。 証明書には、有効期限、発行元証明機関、サイトの URI (Uniform Resource Identifier) などの情報が含まれます。 クライアントは、この URI と最初にアクセスした URI を比較して一致するかどうかを確認し、また、日付と発行元証明機関をチェックします。  
  
 すべての証明書が 2 つのキー、秘密キーと公開キー、および 2 つと呼ばれる、*交換キー ペア*です。 簡単に説明すると、秘密キーは証明書の所有者のみが認識し、公開キーは証明書から読み取ることができます。 どちらのキーもダイジェスト、ハッシュ、その他のキーの暗号化と複号化に使用できますが、逆の操作としての使用に限られます。 たとえば、クライアントで公開キーを使用して暗号化した場合、サイトのみが秘密キーを使用してメッセージを複号化できます。 同様に、サイトで秘密キーを使用して暗号化した場合、クライアントは公開キーを使用して複号化できます。 秘密キーを使用して暗号化されたメッセージのみが公開キーを使用して復号化できるため、クライアントには、秘密キーの所有者のみとメッセージ交換することが保証されます。 サイトには、公開キーを使用して暗号化を行っているクライアントとメッセージを交換していることが保証されます。 この交換は初期ハンドシェイクの場合のみセキュリティで保護されます。このため、実際の対称キーを作成する多くの試みが行われています。 いずれにしても、すべての通信は有効な SSL 証明書を保有するサービスに依存します。  
  
## <a name="implementing-ssl-with-wcf"></a>WCF を使用する SSL の実装  
 HTTP トランスポート セキュリティ (つまり SSL) は、[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] の外部に提供されます。 SSL は、次のいずれかの方法で実装できますが、その方法は、アプリケーションがどのようにホストされるかによって決まります。  
  
-   [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] のホストとしてインターネット インフォメーション サービス (IIS) を使用する場合、IIS インフラストラクチャを使用して SSL サービスを設定します。  
  
-   自己ホスト型の [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] アプリケーションを作成する場合は、HttpCfg.exe ツールを使用して SSL 証明書をアドレスにバインドできます。  
  
### <a name="using-iis-for-transport-security"></a>トランスポート セキュリティのための IIS の使用  
  
#### <a name="iis-70"></a>IIS 7.0  
 設定する[!INCLUDE[iisver](../../../../includes/iisver-md.md)](SSL を使用してセキュリティで保護されたホストとして、次を参照してください。 [IIS 7.0 Beta: IIS 7.0 での Secure Sockets Layer の構成](http://go.microsoft.com/fwlink/?LinkId=88600)です。  
  
 使用するための証明書を構成する[!INCLUDE[iisver](../../../../includes/iisver-md.md)]を参照してください[IIS 7.0 Beta: IIS 7.0 でサーバー証明書を構成](http://go.microsoft.com/fwlink/?LinkID=88595)です。  
  
#### <a name="iis-60"></a>IIS 6.0  
 設定する[!INCLUDE[iis601](../../../../includes/iis601-md.md)](SSL を使用してセキュリティで保護されたホストとして、次を参照してください。 [Secure Sockets Layer の構成](http://go.microsoft.com/fwlink/?LinkId=88601)です。  
  
 使用するための証明書を構成する[!INCLUDE[iis601](../../../../includes/iis601-md.md)]を参照してください[Certificates_IIS_SP1_Ops](http://go.microsoft.com/fwlink/?LinkId=88602)です。  
  
### <a name="using-httpcfg-for-ssl"></a>SSL での HttpCfg の使用  
 自己ホスト型を作成する場合[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]アプリケーションでは、HttpCfg.exe ツールをダウンロードして入手、 [Windows XP Service Pack 2 サポート ツール サイト](http://go.microsoft.com/fwlink/?LinkId=29002)です。  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]参照してください、HttpCfg.exe ツールを使用して、X.509 証明書でポートを設定する[する方法: SSL 証明書でポートを構成する](../../../../docs/framework/wcf/feature-details/how-to-configure-a-port-with-an-ssl-certificate.md)です。  
  
## <a name="see-also"></a>関連項目  
 [トランスポート セキュリティ](../../../../docs/framework/wcf/feature-details/transport-security.md)  
 [メッセージ セキュリティ](../../../../docs/framework/wcf/feature-details/message-security-in-wcf.md)
