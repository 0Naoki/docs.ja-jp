---
title: ユーザー定義バインディングの作成
ms.date: 03/30/2017
helpviewer_keywords:
- user-defined bindings [WCF]
ms.assetid: c4960675-d701-4bc9-b400-36a752fdd08b
ms.openlocfilehash: 7be7c156ec20a15cf8d1a12d8d1f429b6c2c33a9
ms.sourcegitcommit: c93fd5139f9efcf6db514e3474301738a6d1d649
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/27/2018
ms.locfileid: "50186058"
---
# <a name="creating-user-defined-bindings"></a><span data-ttu-id="bf93a-102">ユーザー定義バインディングの作成</span><span class="sxs-lookup"><span data-stu-id="bf93a-102">Creating User-Defined Bindings</span></span>
<span data-ttu-id="bf93a-103">システムから提供されないバインディングを作成する方法はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-103">There are several ways to create bindings not provided by the system:</span></span>  
  
-   <span data-ttu-id="bf93a-104">バインド要素を格納するコンテナーである <xref:System.ServiceModel.Channels.CustomBinding> クラスに基づいてカスタム バインディングを作成します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-104">Create a custom binding, based on the <xref:System.ServiceModel.Channels.CustomBinding> class, which is a container that you fill with binding elements.</span></span> <span data-ttu-id="bf93a-105">次に、カスタム バインディングをサービス エンドポイントに追加します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-105">The custom binding is then added to a service endpoint.</span></span> <span data-ttu-id="bf93a-106">カスタム バインディングは、プログラムで作成することも、アプリケーションの構成ファイルに作成することもできます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-106">You can create the custom binding either programmatically or in an application configuration file.</span></span> <span data-ttu-id="bf93a-107">アプリケーション構成ファイルのバインド要素を使用するには、バインド要素で <xref:System.ServiceModel.Configuration.BindingElementExtensionElement> を拡張する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-107">To use a binding element from an application configuration file, the binding element must extend <xref:System.ServiceModel.Configuration.BindingElementExtensionElement>.</span></span> <span data-ttu-id="bf93a-108">カスタム バインドの詳細については、次を参照してください。[カスタム バインド](../../../../docs/framework/wcf/extending/custom-bindings.md)と<xref:System.ServiceModel.Channels.CustomBinding>します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-108">For more information about custom bindings, see [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md) and <xref:System.ServiceModel.Channels.CustomBinding>.</span></span>  
  
-   <span data-ttu-id="bf93a-109">標準バインディングの派生クラスを作成できます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-109">You can create a class that derives from a standard binding.</span></span> <span data-ttu-id="bf93a-110">たとえば、<xref:System.ServiceModel.WSHttpBinding> の派生クラスを作成して <xref:System.ServiceModel.Channels.CustomBinding.CreateBindingElements%2A> メソッドをオーバーライドし、バインド要素を取得してカスタム バインドを挿入したり、セキュリティ用の特定の値を確立したりできます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-110">For example, you can derive a class from <xref:System.ServiceModel.WSHttpBinding> and override <xref:System.ServiceModel.Channels.CustomBinding.CreateBindingElements%2A> method to obtain the binding elements and insert a custom binding element or establish a particular value for security.</span></span>  
  
-   <span data-ttu-id="bf93a-111">新しい <xref:System.ServiceModel.Channels.Binding> 型を作成して、バインディング実装全体を完全に制御することができます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-111">You can create a new <xref:System.ServiceModel.Channels.Binding> type to completely control the entire binding implementation.</span></span>  
  
## <a name="the-order-of-binding-elements"></a><span data-ttu-id="bf93a-112">バインド要素の順序</span><span class="sxs-lookup"><span data-stu-id="bf93a-112">The Order of Binding Elements</span></span>  
 <span data-ttu-id="bf93a-113">各バインド要素は、メッセージの送信または受信時の処理手順を表します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-113">Each binding element represents a processing step when sending or receiving messages.</span></span> <span data-ttu-id="bf93a-114">実行時に、バインド要素により、送受信チャネル スタックの作成に必要なチャネルとリスナーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-114">At runtime, binding elements create the channels and listeners necessary to build outgoing and incoming channel stacks.</span></span>  
  
 <span data-ttu-id="bf93a-115">バインディング要素には主に、プロトコル バインディング要素、エンコーディング バインディング要素、トランスポート バインディング要素という 3 つの種類があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-115">There are three main types of binding elements: Protocol Binding Elements, Encoding Binding Elements and Transport Binding Elements.</span></span>  
  
 <span data-ttu-id="bf93a-116">プロトコル バインド要素 : この要素はメッセージで動作する上位処理ステップを表します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-116">Protocol Binding Elements – These elements represent higher-level processing steps that act on messages.</span></span> <span data-ttu-id="bf93a-117">このバインド要素で作成したチャネルとリスナーを使って、メッセージ内容の追加、削除、変更が可能です。</span><span class="sxs-lookup"><span data-stu-id="bf93a-117">Channels and listeners created by these binding elements can add, remove, or modify the message content.</span></span> <span data-ttu-id="bf93a-118">特定のバインディングには、それぞれが <xref:System.ServiceModel.Channels.BindingElement> を継承する任意の数のプロトコル バインド要素を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-118">A given binding may have an arbitrary number of protocol binding elements, each inheriting from <xref:System.ServiceModel.Channels.BindingElement>.</span></span> <span data-ttu-id="bf93a-119">Windows Communication Foundation (WCF) など、いくつかのプロトコル バインド要素が含まれています、 <xref:System.ServiceModel.Channels.ReliableSessionBindingElement> 、<xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-119">Windows Communication Foundation (WCF) includes several protocol binding elements, including the <xref:System.ServiceModel.Channels.ReliableSessionBindingElement> and the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement>.</span></span>  
  
 <span data-ttu-id="bf93a-120">エンコーディング バインド要素 : この要素は、メッセージとネットワーク転送が可能なエンコーディングとの間の変換を表します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-120">Encoding Binding Element – These elements represent transformations between a message and an encoding ready for transmission on the wire.</span></span> <span data-ttu-id="bf93a-121">一般的な WCF バインドには、1 つのエンコーディング バインド要素が含まれます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-121">Typical WCF bindings include exactly one encoding binding element.</span></span> <span data-ttu-id="bf93a-122">エンコーディング バインド要素の例として、<xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>、<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>、<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement> などがあります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-122">Examples of encoding binding elements include the <xref:System.ServiceModel.Channels.MtomMessageEncodingBindingElement>, the <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>, and the <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>.</span></span> <span data-ttu-id="bf93a-123">エンコーディング バインド要素がバインディングに指定されていない場合、既定のエンコーディングが使用されます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-123">If an encoding binding element is not specified for a binding, a default encoding is used.</span></span> <span data-ttu-id="bf93a-124">既定値は、トランスポートが HTTP の場合はテキスト、それ以外の場合はバイナリです。</span><span class="sxs-lookup"><span data-stu-id="bf93a-124">The default is text when the transport is HTTP and binary otherwise.</span></span>  
  
 <span data-ttu-id="bf93a-125">トランスポート バインド要素 : この要素は、トランスポート プロトコルでのエンコーディング メッセージの送信を表します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-125">Transport Binding Element – These elements represent the transmission of an encoding message on a transport protocol.</span></span> <span data-ttu-id="bf93a-126">一般的な WCF バインドを継承する、1 つのトランスポート バインド要素を含める<xref:System.ServiceModel.Channels.TransportBindingElement>します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-126">Typical WCF bindings include exactly one transport binding element, which inherits from <xref:System.ServiceModel.Channels.TransportBindingElement>.</span></span> <span data-ttu-id="bf93a-127">トランスポート バインド要素の例として、<xref:System.ServiceModel.Channels.TcpTransportBindingElement>、<xref:System.ServiceModel.Channels.HttpTransportBindingElement>、<xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement> などがあります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-127">Examples of transport binding elements include the <xref:System.ServiceModel.Channels.TcpTransportBindingElement>, the <xref:System.ServiceModel.Channels.HttpTransportBindingElement>, and the <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>.</span></span>  
  
 <span data-ttu-id="bf93a-128">新しいバインディングを作成する場合、バインド要素の追加順序が重要になります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-128">When creating new bindings, the order of the added binding elements is important.</span></span> <span data-ttu-id="bf93a-129">バインド要素は必ず次の順序で追加します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-129">Always add binding elements in the following order:</span></span>  
  
|<span data-ttu-id="bf93a-130">レイヤー</span><span class="sxs-lookup"><span data-stu-id="bf93a-130">Layer</span></span>|<span data-ttu-id="bf93a-131">オプション</span><span class="sxs-lookup"><span data-stu-id="bf93a-131">Options</span></span>|<span data-ttu-id="bf93a-132">必須</span><span class="sxs-lookup"><span data-stu-id="bf93a-132">Required</span></span>|  
|-----------|-------------|--------------|  
|<span data-ttu-id="bf93a-133">トランザクション フロー</span><span class="sxs-lookup"><span data-stu-id="bf93a-133">Transaction Flow</span></span>|<xref:System.ServiceModel.Channels.TransactionFlowBindingElement?displayProperty=nameWithType>|<span data-ttu-id="bf93a-134">Ｘ</span><span class="sxs-lookup"><span data-stu-id="bf93a-134">No</span></span>|  
|<span data-ttu-id="bf93a-135">信頼性</span><span class="sxs-lookup"><span data-stu-id="bf93a-135">Reliability</span></span>|<xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType>|<span data-ttu-id="bf93a-136">Ｘ</span><span class="sxs-lookup"><span data-stu-id="bf93a-136">No</span></span>|  
|<span data-ttu-id="bf93a-137">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="bf93a-137">Security</span></span>|<xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType>|<span data-ttu-id="bf93a-138">Ｘ</span><span class="sxs-lookup"><span data-stu-id="bf93a-138">No</span></span>|  
|<span data-ttu-id="bf93a-139">複合二重</span><span class="sxs-lookup"><span data-stu-id="bf93a-139">Composite Duplex</span></span>|<xref:System.ServiceModel.Channels.CompositeDuplexBindingElement?displayProperty=nameWithType>|<span data-ttu-id="bf93a-140">Ｘ</span><span class="sxs-lookup"><span data-stu-id="bf93a-140">No</span></span>|  
|<span data-ttu-id="bf93a-141">エンコーディング</span><span class="sxs-lookup"><span data-stu-id="bf93a-141">Encoding</span></span>|<span data-ttu-id="bf93a-142">テキスト、バイナリ、MTOM、カスタム</span><span class="sxs-lookup"><span data-stu-id="bf93a-142">Text, Binary, MTOM, Custom</span></span>|<span data-ttu-id="bf93a-143">○\*</span><span class="sxs-lookup"><span data-stu-id="bf93a-143">Yes\*</span></span>|  
|<span data-ttu-id="bf93a-144">Transport</span><span class="sxs-lookup"><span data-stu-id="bf93a-144">Transport</span></span>|<span data-ttu-id="bf93a-145">TCP、名前付きパイプ、HTTP、HTTPS、MSMQ、およびカスタム</span><span class="sxs-lookup"><span data-stu-id="bf93a-145">TCP, Named Pipes, HTTP, HTTPS, MSMQ, Custom</span></span>|<span data-ttu-id="bf93a-146">はい</span><span class="sxs-lookup"><span data-stu-id="bf93a-146">Yes</span></span>|  
  
 <span data-ttu-id="bf93a-147">\* エンコーディングに必要なため、各バインド エンコーディングが指定されていない場合、WCF は既定エンコーディングを追加します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-147">\*Because an encoding is required for each binding, if an encoding is not specified, WCF adds a default encoding for you.</span></span> <span data-ttu-id="bf93a-148">既定値は、HTTP および HTTPS トランスポートの場合はテキスト/XML、それ以外の場合はバイナリです。</span><span class="sxs-lookup"><span data-stu-id="bf93a-148">The default is Text/XML for the HTTP and HTTPS transports, and Binary otherwise.</span></span>  
  
## <a name="creating-a-new-binding-element"></a><span data-ttu-id="bf93a-149">新しいバインド要素の作成</span><span class="sxs-lookup"><span data-stu-id="bf93a-149">Creating a new Binding Element</span></span>  
 <span data-ttu-id="bf93a-150">派生した型だけでなく<xref:System.ServiceModel.Channels.BindingElement>は、WCF によって、独自のバインド要素を作成できます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-150">In addition to the types derived from <xref:System.ServiceModel.Channels.BindingElement> that are provided by WCF, you can create your own binding elements.</span></span> <span data-ttu-id="bf93a-151">これにより、他のシステムが提供する型を使ってスタックに組み込むことのできる独自の <xref:System.ServiceModel.Channels.BindingElement> を作成して、バインディングのスタックを作成する方法や、バインディングのスタックに追加するコンポーネントをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-151">This lets you customize the way the stack of bindings is created and the components that go in it by creating your own <xref:System.ServiceModel.Channels.BindingElement> that can be composed with the other system-provided types in the stack.</span></span>  
  
 <span data-ttu-id="bf93a-152">たとえば、メッセージをデータベースに記録する機能を持つ `LoggingBindingElement` を実装する場合、それをチャネル スタックのトランスポート チャネルの上に配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-152">For example, if you implement a `LoggingBindingElement` that provides the ability to log the message to a database, you must place it above a transport channel in the channel stack.</span></span> <span data-ttu-id="bf93a-153">この場合、アプリケーションでは、次の例に示すように、`LoggingBindingElement` と共に `TcpTransportBindingElement` が組み込まれたカスタム バインディングが作成されます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-153">In this case, the application creates a custom binding that composed the `LoggingBindingElement` with `TcpTransportBindingElement`, as in the following example.</span></span>  
  
```csharp  
Binding customBinding = new CustomBinding(  
  new LoggingBindingElement(),   
  new TcpTransportBindingElement()  
);  
```  
  
 <span data-ttu-id="bf93a-154">新しいバインド要素を記述する方法は、機能性の詳細によって異なります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-154">How you write your new binding element depends on its exact functionality.</span></span> <span data-ttu-id="bf93a-155">サンプルの 1 つ[トランスポート: UDP](../../../../docs/framework/wcf/samples/transport-udp.md)、1 つの種類のバインド要素を実装する方法の詳細な説明を提供します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-155">One of the samples, [Transport: UDP](../../../../docs/framework/wcf/samples/transport-udp.md), provides a detailed description of how to implement one kind of binding element.</span></span>  
  
## <a name="creating-a-new-binding"></a><span data-ttu-id="bf93a-156">新しいバインディングの作成</span><span class="sxs-lookup"><span data-stu-id="bf93a-156">Creating a New Binding</span></span>  
 <span data-ttu-id="bf93a-157">ユーザーが作成するバインド要素は、2 つの方法で使用できます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-157">A user-created binding element can be used in two ways.</span></span> <span data-ttu-id="bf93a-158">前のセクションでは、カスタム バインディングを使用する 1 番目の方法が説明されています。</span><span class="sxs-lookup"><span data-stu-id="bf93a-158">The previous section illustrates the first way: through a custom binding.</span></span> <span data-ttu-id="bf93a-159">カスタム バインディングを使用すれば、バインド要素の任意のセットに基づいて独自のバインディングを作成できます。ユーザーが作成するバインディング エレメントもこれに含まれます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-159">A custom binding allows the user to create their own binding based on an arbitrary set of binding elements, including user-created ones.</span></span>  
  
 <span data-ttu-id="bf93a-160">2 つ以上のアプリケーションでバインディングを使用する場合、独自のバインディングを作成し、<xref:System.ServiceModel.Channels.Binding> を拡張します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-160">If you use the binding in more than one application, create your own binding and extend the <xref:System.ServiceModel.Channels.Binding>.</span></span> <span data-ttu-id="bf93a-161">これにより、カスタム バインディングを使う必要があるたびに、手動でカスタム バインディングを作成する必要性を回避できます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-161">This avoids manually creating a custom binding every time you want to use it.</span></span> <span data-ttu-id="bf93a-162">ユーザー定義のバインディングを使用して、バインディングの動作を定義したり、ユーザー定義のバインド要素を格納することができます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-162">A user-defined binding allows you to define the binding’s behavior and include user-defined binding elements.</span></span> <span data-ttu-id="bf93a-163">*事前パッケージング*: を使用するたびに、バインドを再構築する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="bf93a-163">And it is *pre-packaged*: you do not have to rebuild the binding every time you use it.</span></span>  
  
 <span data-ttu-id="bf93a-164">ユーザー定義のバインディングは、少なくとも <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> メソッドと <xref:System.ServiceModel.Channels.Binding.Scheme%2A> プロパティを実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-164">At a minimum, a user-defined binding must implement the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property.</span></span>  
  
 <span data-ttu-id="bf93a-165"><xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> メソッドは、バインディングのバインド要素を格納している新しい <xref:System.ServiceModel.Channels.BindingElementCollection> を返します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-165">The <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method returns a new <xref:System.ServiceModel.Channels.BindingElementCollection> that contains the binding elements for the binding.</span></span> <span data-ttu-id="bf93a-166">このコレクションは順序付けられており、始めにプロトコル バインド要素を格納し、次にエンコーディング バインド要素、その次にトランスポート バインド要素を格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-166">The collection is ordered, and should contain the protocol binding elements first, followed by the encoding binding element, followed by the transport binding element.</span></span> <span data-ttu-id="bf93a-167">WCF システム指定のバインディング要素を使用する場合は、バインド要素の順序で指定されたルールを従う必要があります[カスタム バインド](../../../../docs/framework/wcf/extending/custom-bindings.md)します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-167">When using the WCF system-provided binding elements, you must follow the binding element ordering rules specified in [Custom Bindings](../../../../docs/framework/wcf/extending/custom-bindings.md).</span></span> <span data-ttu-id="bf93a-168">このコレクションから、ユーザー定義のバインディング クラス内で参照されるオブジェクトを参照すべきではありません。このため、バインディングの作成者は、<xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> を呼び出すたびに <xref:System.ServiceModel.Channels.BindingElementCollection> の `Clone()` を返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-168">This collection should never reference objects referenced within the user-defined binding class; consequently, binding authors must return a `Clone()` of the <xref:System.ServiceModel.Channels.BindingElementCollection> on each call to <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A>.</span></span>  
  
 <span data-ttu-id="bf93a-169"><xref:System.ServiceModel.Channels.Binding.Scheme%2A> プロパティは、バインディングで使用するトランスポート プロトコルの URI スキームを表します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-169">The <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property represents the URI scheme for the transport protocol in use on the binding.</span></span> <span data-ttu-id="bf93a-170">たとえば、 *WSHttpBinding*と*NetTcpBinding*から、それぞれ"http"および"net.tcp"を返します<xref:System.ServiceModel.Channels.Binding.Scheme%2A>プロパティ。</span><span class="sxs-lookup"><span data-stu-id="bf93a-170">For example, the *WSHttpBinding* and the *NetTcpBinding* return "http" and "net.tcp" from their respective <xref:System.ServiceModel.Channels.Binding.Scheme%2A> properties.</span></span>  
  
 <span data-ttu-id="bf93a-171">ユーザー定義バインディングのオプション メソッドとプロパティの完全な一覧については、<xref:System.ServiceModel.Channels.Binding> を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bf93a-171">For a complete list of optional methods and properties for user-defined bindings, see <xref:System.ServiceModel.Channels.Binding>.</span></span>  
  
### <a name="example"></a><span data-ttu-id="bf93a-172">例</span><span class="sxs-lookup"><span data-stu-id="bf93a-172">Example</span></span>  
 <span data-ttu-id="bf93a-173">このサンプルでは、プロファイル バインディングを、`SampleProfileUdpBinding` から派生した <xref:System.ServiceModel.Channels.Binding> に実装します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-173">This example implements profile binding in `SampleProfileUdpBinding`, which derives from <xref:System.ServiceModel.Channels.Binding>.</span></span> <span data-ttu-id="bf93a-174">`SampleProfileUdpBinding`に最大 4 つのバインド要素が含まれています。 ユーザーが作成した 1 つ`UdpTransportBindingElement`; システム指定の 3 つ: `TextMessageEncodingBindingElement`、 `CompositeDuplexBindingElement`、と`ReliableSessionBindingElement`。</span><span class="sxs-lookup"><span data-stu-id="bf93a-174">The `SampleProfileUdpBinding` contains up to four binding elements within it: one user-created `UdpTransportBindingElement`; and three system-provided: `TextMessageEncodingBindingElement`, `CompositeDuplexBindingElement`, and `ReliableSessionBindingElement`.</span></span>  
  
```csharp
public override BindingElementCollection CreateBindingElements()  
{     
    BindingElementCollection bindingElements = new BindingElementCollection();  
    if (ReliableSessionEnabled)  
    {  
        bindingElements.Add(session);  
        bindingElements.Add(compositeDuplex);  
    }  
    bindingElements.Add(encoding);  
    bindingElements.Add(transport);  
    return bindingElements.Clone();  
}  
```  
  
## <a name="security-restrictions-with-duplex-contracts"></a><span data-ttu-id="bf93a-175">双方向コントラクトのセキュリティ制限</span><span class="sxs-lookup"><span data-stu-id="bf93a-175">Security Restrictions with Duplex Contracts</span></span>  
 <span data-ttu-id="bf93a-176">すべてのバインド要素どうしに互換性があるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="bf93a-176">Not all binding elements are compatible with each other.</span></span> <span data-ttu-id="bf93a-177">特に双方向コントラクトで使用する場合、セキュリティ バインド要素にはいくつかの制限があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-177">In particular, there are some restrictions on security binding elements when used with duplex contracts.</span></span>  
  
### <a name="one-shot-security"></a><span data-ttu-id="bf93a-178">ワンショット セキュリティ</span><span class="sxs-lookup"><span data-stu-id="bf93a-178">One-Shot Security</span></span>  
 <span data-ttu-id="bf93a-179">すべての必要なセキュリティ資格情報を設定する 1 つのメッセージで送信する場所、「ワンショット」セキュリティを実装することができます、`negotiateServiceCredential`の属性、\<メッセージ > 構成要素を`false`します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-179">You can implement "one-shot" security, where all the necessary security credentials are sent in a single message, by setting the `negotiateServiceCredential` attribute of the \<message> configuration element to `false`.</span></span>  
  
 <span data-ttu-id="bf93a-180">ワンショット認証は双方向コントラクトでは動作しません。</span><span class="sxs-lookup"><span data-stu-id="bf93a-180">One-shot authentication does not work with duplex contracts.</span></span>  
  
 <span data-ttu-id="bf93a-181">要求/応答コントラクトでは、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IRequestChannel> インスタンスまたは <xref:System.ServiceModel.Channels.IRequestSessionChannel> インスタンスの作成がサポートされている場合にのみ、ワンショット認証は動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-181">For Request-Reply contracts, one-shot authentication works only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.</span></span>  
  
 <span data-ttu-id="bf93a-182">一方向コントラクトでは、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IRequestChannel>、<xref:System.ServiceModel.Channels.IRequestSessionChannel>、<xref:System.ServiceModel.Channels.IOutputChannel>、または <xref:System.ServiceModel.Channels.IOutputSessionChannel> の各インスタンスの作成がサポートされている場合にのみ、ワンショット認証は動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-182">For one-way contracts, one-shot authentication works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel>, <xref:System.ServiceModel.Channels.IRequestSessionChannel>, <xref:System.ServiceModel.Channels.IOutputChannel> or <xref:System.ServiceModel.Channels.IOutputSessionChannel> instances.</span></span>  
  
### <a name="cookie-mode-security-context-tokens"></a><span data-ttu-id="bf93a-183">クッキー モードのセキュリティ コンテキスト トークン</span><span class="sxs-lookup"><span data-stu-id="bf93a-183">Cookie-mode Security Context Tokens</span></span>  
 <span data-ttu-id="bf93a-184">クッキー モードのセキュリティ コンテキスト トークンは、双方向コントラクトでは使用できません。</span><span class="sxs-lookup"><span data-stu-id="bf93a-184">Cookie mode security context tokens cannot be used with duplex contracts.</span></span>  
  
 <span data-ttu-id="bf93a-185">要求/応答コントラクトでは、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IRequestChannel> インスタンスまたは <xref:System.ServiceModel.Channels.IRequestSessionChannel> インスタンスの作成がサポートされている場合にのみ、クッキー モードのセキュリティ コンテキスト トークンは動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-185">For Request-Reply contracts, cookie-mode security context tokens work only if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.</span></span>  
  
 <span data-ttu-id="bf93a-186">一方向コントラクトでは、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IRequestChannel> インスタンスまたは <xref:System.ServiceModel.Channels.IRequestSessionChannel> インスタンスの作成がサポートされている場合にのみ、クッキー モードのセキュリティ コンテキスト トークンは動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-186">For one-way contracts, cookie-mode security context tokens works if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.</span></span>  
  
### <a name="session-mode-security-context-tokens"></a><span data-ttu-id="bf93a-187">セッション モードのセキュリティ コンテキスト トークン</span><span class="sxs-lookup"><span data-stu-id="bf93a-187">Session-mode Security Context Tokens</span></span>  
 <span data-ttu-id="bf93a-188">双方向コントラクトでは、セッション モードの SCT (セキュリティ コンテキスト トークン) は、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IDuplexChannel> インスタンスまたは <xref:System.ServiceModel.Channels.IDuplexSessionChannel> インスタンスの作成がサポートされている場合に動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-188">Session mode SCT works for duplex contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel> or <xref:System.ServiceModel.Channels.IDuplexSessionChannel> instances.</span></span>  
  
 <span data-ttu-id="bf93a-189">要求/応答コントラクトでは、セッション モードの SCT は、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IDuplexChannel>、<xref:System.ServiceModel.Channels.IDuplexSessionChannel>、<xref:System.ServiceModel.Channels.IRequestChannel>、または <xref:System.ServiceModel.Channels.IRequestSessionChannel> の各インスタンスの作成がサポートされている場合に動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-189">Session mode SCT works for Request-Reply contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel>, instances.</span></span>  
  
 <span data-ttu-id="bf93a-190">一方向コントラクトでは、セッション モードの SCT は、セキュリティ バインド要素の下にあるバインディング スタックで <xref:System.ServiceModel.Channels.IDuplexChannel>、<xref:System.ServiceModel.Channels.IDuplexSessionChannel>、<xref:System.ServiceModel.Channels.IRequestChannel>、または <xref:System.ServiceModel.Channels.IRequestSessionChannel> の各インスタンスの作成がサポートされている場合に動作します。</span><span class="sxs-lookup"><span data-stu-id="bf93a-190">Session mode SCT works for 1-way contracts if the binding stack below the security binding element supports creating <xref:System.ServiceModel.Channels.IDuplexChannel>, <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, <xref:System.ServiceModel.Channels.IRequestChannel> or <xref:System.ServiceModel.Channels.IRequestSessionChannel> instances.</span></span>  
  
## <a name="deriving-from-a-standard-binding"></a><span data-ttu-id="bf93a-191">標準バインディングからの派生</span><span class="sxs-lookup"><span data-stu-id="bf93a-191">Deriving from a Standard Binding</span></span>  
 <span data-ttu-id="bf93a-192">まったく新しいバインディング クラスを作成する代わりに、システムから提供される既存のバインディングの 1 つを拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="bf93a-192">Instead of creating an entirely new binding class, it may be possible for you to extend one of the existing system-provided bindings.</span></span> <span data-ttu-id="bf93a-193">前述の場合と同様、<xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> メソッドと <xref:System.ServiceModel.Channels.Binding.Scheme%2A> プロパティをオーバーライドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="bf93a-193">Much like the preceding case, you must override the <xref:System.ServiceModel.Channels.Binding.CreateBindingElements%2A> method and the <xref:System.ServiceModel.Channels.Binding.Scheme%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bf93a-194">関連項目</span><span class="sxs-lookup"><span data-stu-id="bf93a-194">See Also</span></span>  
 <xref:System.ServiceModel.Channels.Binding>  
 [<span data-ttu-id="bf93a-195">カスタム バインディング</span><span class="sxs-lookup"><span data-stu-id="bf93a-195">Custom Bindings</span></span>](../../../../docs/framework/wcf/extending/custom-bindings.md)
