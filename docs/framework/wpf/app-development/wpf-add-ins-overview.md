---
title: "WPF アドインの概要"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
caps.latest.revision: "36"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 290682542a0accaf38408127f7358625abca14af
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="3e190-102">WPF アドインの概要</span><span class="sxs-lookup"><span data-stu-id="3e190-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="3e190-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] には、開発者がアドイン機能拡張をサポートするアプリケーションの作成に使用できるアドイン モデルが用意されています。</span><span class="sxs-lookup"><span data-stu-id="3e190-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="3e190-104">このアドイン モデルを使用することで、アプリケーション機能に統合され、アプリケーション機能を拡張するアドインを作成できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="3e190-105">一部のシナリオでは、アドインが提供する [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] をアプリケーションで表示する必要があります。このトピックでは、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] が [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルを強化してこうしたシナリオを実現するしくみ、背後にあるアーキテクチャ、その利点、および制限事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="3e190-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="3e190-106">必須コンポーネント</span><span class="sxs-lookup"><span data-stu-id="3e190-106">Prerequisites</span></span>  
 <span data-ttu-id="3e190-107">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルを十分に理解していることが必要です。</span><span class="sxs-lookup"><span data-stu-id="3e190-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="3e190-108">詳細については、「[アドインおよび拡張機能](../../../../docs/framework/add-ins/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="3e190-109">アドインの概要</span><span class="sxs-lookup"><span data-stu-id="3e190-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="3e190-110">新しい機能を追加するためにアプリケーションを再コンパイルして再配置する手間を省くことを目的として、アプリケーションは機能拡張メカニズムを実装し、開発者 (ファーストパーティ、サードパーティのいずれも) が元のアプリケーションに統合される別のアプリケーションを作成できるようにしています。</span><span class="sxs-lookup"><span data-stu-id="3e190-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="3e190-111">こうした拡張機能をサポートする方法としては、アドイン ("アドオン"、"プラグイン" などとも呼ばれる) の使用が最も一般的です。</span><span class="sxs-lookup"><span data-stu-id="3e190-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="3e190-112">アドインによる機能拡張を公開する実際のアプリケーションとして、次のようなものが挙げられます。</span><span class="sxs-lookup"><span data-stu-id="3e190-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="3e190-113">Internet Explorer のアドオン。</span><span class="sxs-lookup"><span data-stu-id="3e190-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="3e190-114">Windows Media Player のプラグイン。</span><span class="sxs-lookup"><span data-stu-id="3e190-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="3e190-115">Visual Studio のアドイン。</span><span class="sxs-lookup"><span data-stu-id="3e190-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="3e190-116">たとえば、Windows Media Player のアドイン モデルにおいて、サードパーティの開発者は、Windows Media Player の機能をさまざまな形で拡張する "プラグイン" を実装できます。たとえば、Windows Media Player でネイティブにサポートされていないメディア形式 (DVD、MP3 など) のデコーダーおよびエンコーダー、オーディオ効果、スキンなどを作成できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="3e190-117">各アドイン モデルは、アプリケーション固有の機能を公開するためにビルドされますが、どのアドイン モデルにも共通するエンティティや動作がいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="3e190-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="3e190-118">典型的な機能拡張ソリューションの主な 3 つのエンティティは、*コントラクト*、*アドイン*、および*ホスト アプリケーション*です。</span><span class="sxs-lookup"><span data-stu-id="3e190-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="3e190-119">コントラクトは、次の 2 つの方法で、アドインとホスト アプリケーションとの統合方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="3e190-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="3e190-120">アドインは、ホスト アプリケーションによって実装される機能と統合されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="3e190-121">ホスト アプリケーションで、アドインを統合するための機能を公開します。</span><span class="sxs-lookup"><span data-stu-id="3e190-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="3e190-122">アドインを使用するには、ホスト アプリケーションが実行時にアドインを検索して読み込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="3e190-123">したがって、アドインをサポートするアプリケーションには次の機能が必要です。</span><span class="sxs-lookup"><span data-stu-id="3e190-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="3e190-124">**探索**: ホスト アプリケーションによってサポートされるコントラクトに準拠しているアドインを検索します。</span><span class="sxs-lookup"><span data-stu-id="3e190-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="3e190-125">**アクティブ化**: アドインを読み込んで実行し、アドインとの通信を確立します。</span><span class="sxs-lookup"><span data-stu-id="3e190-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="3e190-126">**分離**: アプリケーション ドメインまたはアプリケーション プロセスを使用することで他から切り離すための境界を確立し、アドインの使用に伴うセキュリティおよび実行に関する潜在的な問題からアプリケーションを保護します。</span><span class="sxs-lookup"><span data-stu-id="3e190-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="3e190-127">**通信**: アドインとホスト アプリケーションが分離境界を越えて通信し、メソッドを呼び出したりデータを渡したりできるようにします。</span><span class="sxs-lookup"><span data-stu-id="3e190-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="3e190-128">**有効期間管理**: アプリケーション ドメインとアプリケーション プロセスの読み込みおよびアンロードを、クリーンで予測可能な方法で行います (「[アプリケーション ドメイン](../../../../docs/framework/app-domains/application-domains.md)」を参照)。</span><span class="sxs-lookup"><span data-stu-id="3e190-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="3e190-129">**バージョン管理**: ホスト アプリケーションとアドインのどちらかに、新バージョンが作成された後も引き続き通信できるようにします。</span><span class="sxs-lookup"><span data-stu-id="3e190-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="3e190-130">このことからわかるように、堅牢なアドイン モデルの開発は簡単なことではありません。</span><span class="sxs-lookup"><span data-stu-id="3e190-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="3e190-131">そのため、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] にはアドイン モデルのビルド用のインフラストラクチャが用意されています。</span><span class="sxs-lookup"><span data-stu-id="3e190-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3e190-132">アドインの詳細については、「[アドインおよび拡張機能](../../../../docs/framework/add-ins/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="3e190-133">.NET Framework アドイン モデルの概要</span><span class="sxs-lookup"><span data-stu-id="3e190-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="3e190-134">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]アドイン モデルで見つかった、<xref:System.AddIn>名前空間には、アドインでは、拡張機能の開発を簡略化できるように設計された型のセットが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3e190-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="3e190-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルの基本単位は*コントラクト*です。コントラクトは、ホスト アプリケーションとアドイン間の通信方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="3e190-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="3e190-136">コントラクトのホスト アプリケーション固有の*ビュー*を使用して、コントラクトはホスト アプリケーションに公開されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="3e190-137">同様に、コントラクトのアドイン固有の*ビュー*がアドインに公開されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="3e190-138">*アダプター*は、ホスト アプリケーションとアドインが、コントラクトの対応するビュー間で通信するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="3e190-139">コントラクト、ビュー、およびアダプターはセグメントと見なされ、関連セグメントのセットが*パイプライン*を構成します。</span><span class="sxs-lookup"><span data-stu-id="3e190-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="3e190-140">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルはパイプラインを基盤とし、それを基に探索、アクティブ化、セキュリティ分離、実行分離 (アプリケーションのドメインとプロセスを両方使用)、通信、有効期間管理、およびバージョン管理をサポートします。</span><span class="sxs-lookup"><span data-stu-id="3e190-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="3e190-141">このサポート全体を使用して、開発者はホスト アプリケーションの機能を統合するアドインをビルドできます。</span><span class="sxs-lookup"><span data-stu-id="3e190-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="3e190-142">ただし、一部のシナリオでは、アドインが提供する [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] をホスト アプリケーションで表示する必要があります。[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の各プレゼンテーション テクノロジには [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] 実装の独自のモデルがあるため、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルは特定のプレゼンテーション テクノロジをサポートしません。</span><span class="sxs-lookup"><span data-stu-id="3e190-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="3e190-143">その代わり、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] では [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルをアドインの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] サポートという形で機能拡張します。</span><span class="sxs-lookup"><span data-stu-id="3e190-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="3e190-144">WPF アドイン</span><span class="sxs-lookup"><span data-stu-id="3e190-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3e190-145"> を [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルと併用することで、ホスト アプリケーションでアドインの [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] を表示する必要があるさまざまなシナリオに対応できます。特に、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] によるこれらのシナリオの対応には、次の 2 つのプログラミング モデルが使用されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="3e190-146">**アドインが UI を返す**。</span><span class="sxs-lookup"><span data-stu-id="3e190-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="3e190-147">アドインが、コントラクトの定義に従って、メソッド呼び出しを介してホスト アプリケーションに [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] を返します。</span><span class="sxs-lookup"><span data-stu-id="3e190-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="3e190-148">このシナリオは、次の場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3e190-149">アドインが返す [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] の外観が、動的に生成されるレポートなど、実行時にしか存在しないデータまたは条件に依存している。</span><span class="sxs-lookup"><span data-stu-id="3e190-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="3e190-150">アドインが提供するサービスの[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] が、そのアドインを使用できるホスト アプリケーションの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] と異なっている。</span><span class="sxs-lookup"><span data-stu-id="3e190-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="3e190-151">アドインは主にホスト アプリケーション向けのサービスを実行し、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] を使用してホスト アプリケーションにステータスをレポートする。</span><span class="sxs-lookup"><span data-stu-id="3e190-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="3e190-152">**アドインが UI である**。</span><span class="sxs-lookup"><span data-stu-id="3e190-152">**The add-in is a UI**.</span></span> <span data-ttu-id="3e190-153">アドインが、コントラクトの定義に従う [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] です。</span><span class="sxs-lookup"><span data-stu-id="3e190-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="3e190-154">このシナリオは、次の場合に使用されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3e190-155">アドインは表示以外のサービス (広告など) を提供しない。</span><span class="sxs-lookup"><span data-stu-id="3e190-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="3e190-156">アドインが提供するサービスの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] は、そのアドインを使用できるすべてのホスト アプリケーションで共通である (電卓、カラー ピッカーなど)。</span><span class="sxs-lookup"><span data-stu-id="3e190-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="3e190-157">これらのシナリオでは、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] オブジェクトをホスト アプリケーション ドメインとアドイン アプリケーション ドメインとの間で受け渡しできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="3e190-158">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルは、アプリケーション ドメイン間の通信においてリモート処理に依存しているため、それらの間で受け渡しされるオブジェクトはリモート処理可能である必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="3e190-159">リモート処理可能なオブジェクトとは、次の 1 つ以上に該当するクラスのインスタンスです。</span><span class="sxs-lookup"><span data-stu-id="3e190-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="3e190-160">派生した、<xref:System.MarshalByRefObject>クラスです。</span><span class="sxs-lookup"><span data-stu-id="3e190-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="3e190-161"><xref:System.Runtime.Serialization.ISerializable> インターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="3e190-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="3e190-162"><xref:System.SerializableAttribute>属性を適用します。</span><span class="sxs-lookup"><span data-stu-id="3e190-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3e190-163">リモート処理可能な [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] オブジェクトの作成の詳細については、「[オブジェクトをリモート処理可能にする](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="3e190-164">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 型は、リモート処理可能ではありません。</span><span class="sxs-lookup"><span data-stu-id="3e190-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="3e190-165">この問題を解決するため、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] は [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルを拡張して、アドインによって作成される [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] をホスト アプリケーションで表示できるようにします。</span><span class="sxs-lookup"><span data-stu-id="3e190-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="3e190-166">このサポートによって提供されます[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]によって 2 つの種類:<xref:System.AddIn.Contract.INativeHandleContract>インターフェイスとによって実装される 2 つの静的メソッド、<xref:System.AddIn.Pipeline.FrameworkElementAdapters>クラス:<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>と<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="3e190-167">大まかに、これらの型とメソッドは次のように使用されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3e190-168">いる必要があります[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]によって提供される、アドインから直接または間接的に派生するクラスは、<xref:System.Windows.FrameworkElement>図形、コントロール、ユーザー コントロール、レイアウト パネル、およびページなどです。</span><span class="sxs-lookup"><span data-stu-id="3e190-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="3e190-169">として宣言する必要がありますコントラクトは、UI をアドインとホスト アプリケーションの間で渡されることを宣言する限り、 <xref:System.AddIn.Contract.INativeHandleContract> (されません、 <xref:System.Windows.FrameworkElement>) です。<xref:System.AddIn.Contract.INativeHandleContract>アドインでのリモート処理可能な表現である[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]分離の境界を越えて渡すことです。</span><span class="sxs-lookup"><span data-stu-id="3e190-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="3e190-170">アドインのアプリケーションのドメインから渡される前に、<xref:System.Windows.FrameworkElement>としてパッケージ化、<xref:System.AddIn.Contract.INativeHandleContract>を呼び出して<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="3e190-171">ホスト アプリケーションのアプリケーション ドメインに渡された後、<xref:System.AddIn.Contract.INativeHandleContract>として再パッケージ化する必要があります、<xref:System.Windows.FrameworkElement>を呼び出して<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="3e190-172">方法<xref:System.AddIn.Contract.INativeHandleContract>、 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>、および<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>使用は、特定のシナリオによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3e190-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="3e190-173">以降のセクションでは、各プログラミング モデルについて詳しく説明していきます。</span><span class="sxs-lookup"><span data-stu-id="3e190-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="3e190-174">ユーザー インターフェイスを返すアドイン</span><span class="sxs-lookup"><span data-stu-id="3e190-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="3e190-175">アドインが [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] をホスト アプリケーションに返すには、次のことが必要です。</span><span class="sxs-lookup"><span data-stu-id="3e190-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="3e190-176">ホスト アプリケーション、アドイン、およびパイプラインが、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の「[アドインおよび拡張機能](../../../../docs/framework/add-ins/index.md)」の説明に従って作成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3e190-177">コントラクトを実装する必要があります<xref:System.AddIn.Contract.IContract>およびを返す、 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]、コントラクト型の戻り値を持つメソッドを宣言する必要があります<xref:System.AddIn.Contract.INativeHandleContract>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3e190-178">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]渡されるアドインとホスト間でアプリケーション直接的または間接的にから派生しなければなりません<xref:System.Windows.FrameworkElement>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3e190-179">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]によって返されるアドインから変換する必要があります、<xref:System.Windows.FrameworkElement>を<xref:System.AddIn.Contract.INativeHandleContract>分離境界を横断する前にします。</span><span class="sxs-lookup"><span data-stu-id="3e190-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3e190-180">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]から変換する必要があるれる、<xref:System.AddIn.Contract.INativeHandleContract>を<xref:System.Windows.FrameworkElement>後、分離境界を越えます。</span><span class="sxs-lookup"><span data-stu-id="3e190-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3e190-181">ホスト アプリケーションは、表示、返された<xref:System.Windows.FrameworkElement>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3e190-182">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] を返すアドインを実装する方法の例については、「[方法 : UI を返すアドインを作成する](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="3e190-183">ユーザー インターフェイスであるアドイン</span><span class="sxs-lookup"><span data-stu-id="3e190-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="3e190-184">アドインが [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] である場合、次のことが必要です。</span><span class="sxs-lookup"><span data-stu-id="3e190-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="3e190-185">ホスト アプリケーション、アドイン、およびパイプラインが、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の「[アドインおよび拡張機能](../../../../docs/framework/add-ins/index.md)」の説明に従って作成されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3e190-186">アドインのコントラクト インターフェイスを実装する必要があります<xref:System.AddIn.Contract.INativeHandleContract>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3e190-187">ホスト アプリケーションに渡されるアドインを直接または間接的にから派生しなければなりません<xref:System.Windows.FrameworkElement>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3e190-188">アドインから変換する必要があります、<xref:System.Windows.FrameworkElement>を<xref:System.AddIn.Contract.INativeHandleContract>分離境界を横断する前にします。</span><span class="sxs-lookup"><span data-stu-id="3e190-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3e190-189">アドインから変換する必要があります、<xref:System.AddIn.Contract.INativeHandleContract>を<xref:System.Windows.FrameworkElement>後、分離境界を越えます。</span><span class="sxs-lookup"><span data-stu-id="3e190-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3e190-190">ホスト アプリケーションは、表示、返された<xref:System.Windows.FrameworkElement>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3e190-191">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] であるアドインを実装する方法の例については、「[方法 : UI であるアドインを作成する](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="3e190-192">複数の UI を返すアドイン</span><span class="sxs-lookup"><span data-stu-id="3e190-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="3e190-193">アドインが提供する複数の [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] をホスト アプリケーションが表示するケースはよくあります。</span><span class="sxs-lookup"><span data-stu-id="3e190-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="3e190-194">たとえば、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] であるアドインが、ホスト アプリケーションにステータス情報も [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] として提供するとします。</span><span class="sxs-lookup"><span data-stu-id="3e190-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3e190-195">このようなアドインは、[ユーザー インターフェイスを返すアドイン](#ReturnUIFromAddInContract)のモデルと[ユーザー インターフェイスであるアドイン](#AddInIsAUI)のモデルの両方の手法を組み合わせることで実装できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="3e190-196">アドインと XAML ブラウザー アプリケーション</span><span class="sxs-lookup"><span data-stu-id="3e190-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="3e190-197">ここまでの例では、ホスト アプリケーションはスタンドアロン アプリケーションとしてインストールされています。</span><span class="sxs-lookup"><span data-stu-id="3e190-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="3e190-198">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] はアドインをホストすることもできますが、そのためには次に示すビルドと実装の要件を満たす必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="3e190-199">パイプライン (フォルダーとアセンブリ) とアドイン アセンブリを、[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] と同じフォルダーにある、クライアント コンピューターの [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] アプリケーション キャッシュにダウンロードするよう、[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] アプリケーション マニフェストを特別に構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="3e190-200">アドインを探索して読み込む [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] コードで、[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] の [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] アプリケーション キャッシュを、パイプラインとアドインの場所として使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="3e190-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] は、アドインが起点サイトにある圧縮しないファイルを参照する場合、アドインを特別なセキュリティ コンテキストの下で読み込む必要があります。[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] によってホストされる場合、アドインが参照できるのは、ホスト アプリケーションの起点サイトにある圧縮しないファイルのみです。</span><span class="sxs-lookup"><span data-stu-id="3e190-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="3e190-202">これらのタスクについて、次のサブセクションで詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="3e190-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="3e190-203">ClickOnce 配置のためのパイプラインとアドインの構成</span><span class="sxs-lookup"><span data-stu-id="3e190-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="3e190-204"> は、[!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 配置キャッシュの安全なフォルダーにダウンロードされ、そこから実行されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="3e190-205">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] でアドインをホストするには、パイプラインとアドインのアセンブリも同じ安全なフォルダーにダウンロードする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="3e190-206">このためには、パイプラインとアドインのどちらのアセンブリもダウンロード対象に含まれるよう、アプリケーション マニフェストを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="3e190-207">これは、[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] で実行することが最も簡単ですが、[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] でパイプラインをアセンブリとして検出するには、パイプラインとアドインのアセンブリが、ホスト [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] プロジェクトのルート フォルダーに存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="3e190-208">したがって、まず、パイプライン アセンブリとアドイン アセンブリの各プロジェクトのビルド出力を設定し、パイプラインとアドインのアセンブリを [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] プロジェクトのルートにビルドします。</span><span class="sxs-lookup"><span data-stu-id="3e190-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="3e190-209">次の表は、ホストの [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] プロジェクトと同じソリューションとルートのフォルダーに格納される、パイプライン アセンブリ プロジェクトとアドイン アセンブリ プロジェクトのビルド出力パスを示します。</span><span class="sxs-lookup"><span data-stu-id="3e190-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="3e190-210">表 1: XBAP でホストされるパイプライン アセンブリのビルド出力パス</span><span class="sxs-lookup"><span data-stu-id="3e190-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="3e190-211">パイプライン アセンブリ プロジェクト</span><span class="sxs-lookup"><span data-stu-id="3e190-211">Pipeline assembly project</span></span>|<span data-ttu-id="3e190-212">ビルド出力パス</span><span class="sxs-lookup"><span data-stu-id="3e190-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="3e190-213">コントラクト</span><span class="sxs-lookup"><span data-stu-id="3e190-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="3e190-214">アドイン ビュー</span><span class="sxs-lookup"><span data-stu-id="3e190-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="3e190-215">アドイン側のアダプター</span><span class="sxs-lookup"><span data-stu-id="3e190-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="3e190-216">ホスト側のアダプター</span><span class="sxs-lookup"><span data-stu-id="3e190-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="3e190-217">アドイン</span><span class="sxs-lookup"><span data-stu-id="3e190-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="3e190-218">次に、パイプライン アセンブリとアドイン アセンブリを [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] コンテンツ ファイルとして [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] に指定します。手順は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="3e190-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3e190-219">ソリューション エクスプローラーで各パイプライン フォルダーを右クリックし、**[プロジェクトに含める]** を選択して、パイプラインとアドインのアセンブリをプロジェクトに含めます。</span><span class="sxs-lookup"><span data-stu-id="3e190-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="3e190-220">**[プロパティ]** ウィンドウで、パイプライン アセンブリとアドイン アセンブリそれぞれについて、**[ビルド アクション]** を **[コンテンツ]** に設定します。</span><span class="sxs-lookup"><span data-stu-id="3e190-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="3e190-221">最後に、パイプラインとアドインのどちらのアセンブリ ファイルもダウンロード対象に含まれるよう、アプリケーション マニフェストを構成します。</span><span class="sxs-lookup"><span data-stu-id="3e190-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="3e190-222">ファイルは、[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] アプリケーションが占有する [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] キャッシュ内のフォルダーのルートにあるフォルダー内に存在している必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="3e190-223">この構成は、次の手順に従って、[!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] で行うことができます。</span><span class="sxs-lookup"><span data-stu-id="3e190-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3e190-224">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] プロジェクトを右クリックして、**[プロパティ]**、**[発行]** の順にクリックし、**[アプリケーション ファイル]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="3e190-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="3e190-225">**[アプリケーション ファイル]** ダイアログ ボックスで、各パイプラインとアドインの DLL の **[発行の状況]** を **[含める (自動)]** に設定し、各パイプラインとアドインの DLL の **[ダウンロード グループ]** を **[(必須)]** に設定します。</span><span class="sxs-lookup"><span data-stu-id="3e190-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="3e190-226">アプリケーション ベースからのパイプラインとアドインの使用</span><span class="sxs-lookup"><span data-stu-id="3e190-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="3e190-227">パイプラインとアドインは [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] 配置用に構成されると、同じ [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] キャッシュ フォルダーに [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] としてダウンロードされます。</span><span class="sxs-lookup"><span data-stu-id="3e190-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="3e190-228">このパイプラインとアドインを [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] から使用するには、[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] コードがそれらをアプリケーション ベースから取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="3e190-229">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルのさまざまな型やメンバーは、パイプラインおよびアドインを使用できるよう、このシナリオ用に特別なサポートを提供しています。</span><span class="sxs-lookup"><span data-stu-id="3e190-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="3e190-230">まず、パスは、によって識別される、<xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase>列挙値。</span><span class="sxs-lookup"><span data-stu-id="3e190-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="3e190-231">この値を適切なアドイン メンバーのオーバーロードと併用することで、次のようなパイプラインを使用できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="3e190-232">ホストの起点サイトへのアクセス</span><span class="sxs-lookup"><span data-stu-id="3e190-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="3e190-233">アドインが起点サイトのファイルを参照できるように、アドインはホスト アプリケーションと等価なセキュリティ分離を使用して読み込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="3e190-234">このセキュリティ レベルがによって識別される、<xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType>列挙値に渡されると、<xref:System.AddIn.Hosting.AddInToken.Activate%2A>アドインをアクティブ化されるメソッド。</span><span class="sxs-lookup"><span data-stu-id="3e190-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="3e190-235">WPF アドイン アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="3e190-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="3e190-236">最上位のレベルでは、これまで見てきたよう[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]により[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]を実装するアドイン[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)](から直接的または間接的に派生した<xref:System.Windows.FrameworkElement>) を使用して<xref:System.AddIn.Contract.INativeHandleContract>、<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>と<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="3e190-237">結果は、ホスト アプリケーションが返される、<xref:System.Windows.FrameworkElement>から表示される、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]ホスト アプリケーションにします。</span><span class="sxs-lookup"><span data-stu-id="3e190-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="3e190-238">簡単な [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] アドイン シナリオでは、開発者に必要な詳細はこれだけです。</span><span class="sxs-lookup"><span data-stu-id="3e190-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="3e190-239">より複雑なシナリオ、特にレイアウト、リソース、データ バインドなど、追加の [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] サービスの活用を想定したシナリオでは、その利点と制約を把握するために [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] をサポートする [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルが、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] で拡張されるしくみについて詳しい知識が必要です。</span><span class="sxs-lookup"><span data-stu-id="3e190-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="3e190-240">基本的に、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] は [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] をアドインからホスト アプリケーションに渡しません。その代わり、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] は [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] の Win32 ウィンドウ ハンドルを [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 相互運用性を使用して渡します。</span><span class="sxs-lookup"><span data-stu-id="3e190-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="3e190-241">つまり、アドインの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] がホスト アプリケーションに渡されると、次の処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="3e190-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="3e190-242">アドイン側で、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] は、ホスト アプリケーションによって表示される [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] のウィンドウ ハンドルを取得します。</span><span class="sxs-lookup"><span data-stu-id="3e190-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="3e190-243">ウィンドウ ハンドルが内部でカプセル化された[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]から派生したクラス<xref:System.Windows.Interop.HwndSource>を実装して<xref:System.AddIn.Contract.INativeHandleContract>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3e190-244">このクラスのインスタンスがによって返される<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>はアドインのアプリケーション ドメインから、ホスト アプリケーションのアプリケーション ドメインにマーシャ リングとします。</span><span class="sxs-lookup"><span data-stu-id="3e190-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="3e190-245">ホスト アプリケーション側で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]は再パッケージ化、<xref:System.Windows.Interop.HwndSource>内部として[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]から派生したクラス<xref:System.Windows.Interop.HwndHost>消費<xref:System.AddIn.Contract.INativeHandleContract>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3e190-246">このクラスのインスタンスがによって返される<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>ホスト アプリケーションにします。</span><span class="sxs-lookup"><span data-stu-id="3e190-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="3e190-247"><xref:System.Windows.Interop.HwndHost>表示に存在する[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]から、ウィンドウ ハンドルによって識別される[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)][!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="3e190-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3e190-248">詳細については、「[WPF と Win32 の相互運用性](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3e190-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="3e190-249">要約すると、 <xref:System.AddIn.Contract.INativeHandleContract>、 <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>、および<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>のウィンドウ ハンドルを許可するのには存在、 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]から、アドインによってカプセル化は、ホスト アプリケーションに渡される、<xref:System.Windows.Interop.HwndHost>とホストの表示アプリケーションの[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="3e190-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3e190-250">ホスト アプリケーションを取得するため、 <xref:System.Windows.Interop.HwndHost>、ホスト アプリケーションは、によって返されるオブジェクトを変換できません<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>アドインによって、型に実装されます (たとえば、 <xref:System.Windows.Controls.UserControl>)。</span><span class="sxs-lookup"><span data-stu-id="3e190-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="3e190-251">、その性質上<xref:System.Windows.Interop.HwndHost>ホスト アプリケーションが使用できる方法に影響する特定の制限があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="3e190-252">ただし、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]拡張<xref:System.Windows.Interop.HwndHost>アドインでは、シナリオのいくつかの機能を持つ。</span><span class="sxs-lookup"><span data-stu-id="3e190-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="3e190-253">その利点と制約について、以下に説明します。</span><span class="sxs-lookup"><span data-stu-id="3e190-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="3e190-254">WPF アドインの利点</span><span class="sxs-lookup"><span data-stu-id="3e190-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="3e190-255">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]アドイン[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]から派生する内部クラスを使用してホスト アプリケーションから表示される<xref:System.Windows.Interop.HwndHost>、those[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]の機能によって制限されて<xref:System.Windows.Interop.HwndHost>に関連する[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]レイアウト、レンダリング、データ バインディング、スタイル、テンプレート、およびリソースなどのサービスです。</span><span class="sxs-lookup"><span data-stu-id="3e190-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="3e190-256">ただし、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]は強化し、その内部<xref:System.Windows.Interop.HwndHost>サブクラスを次を含む追加の機能を備えた。</span><span class="sxs-lookup"><span data-stu-id="3e190-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="3e190-257">ホスト アプリケーションの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] とアドインの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] との間を Tab キーで移動できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3e190-258">注意してください、"アドインでは、 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"プログラミング モデルには、オーバーライドするアドイン側アダプターが必要です。<xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A>アドインが完全に信頼できるまたは部分的に信頼されているかどうか、tab キーを有効にします。</span><span class="sxs-lookup"><span data-stu-id="3e190-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="3e190-259">ホスト アプリケーション [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] で表示されるアドイン [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] のアクセシビリティ要件を順守します。</span><span class="sxs-lookup"><span data-stu-id="3e190-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="3e190-260">アプリケーション ドメインが複数あるシナリオで [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] アプリケーションが安全に実行されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="3e190-261">アドインがセキュリティ分離を使用して実行されている場合 (部分的に信頼されているセキュリティ サンドボックス)、アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ウィンドウ ハンドルへの不正アクセスを回避します。</span><span class="sxs-lookup"><span data-stu-id="3e190-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="3e190-262">呼び出す<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>このセキュリティを確保します。</span><span class="sxs-lookup"><span data-stu-id="3e190-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="3e190-263">に対して、"アドインから返されます、 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"プログラミング モデル、アドインでのウィンドウ ハンドルを渡す唯一の方法[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]分離間で境界が呼び出されて<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="3e190-264">"アドインでは、 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"プログラミング モデル、オーバーライドする<xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A>アドイン側アダプターと呼び出し元に<xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>(前の例に示す) が必要がありますアドイン側アダプターの呼び出しとして`QueryContract`実装。ホスト側のアダプターです。</span><span class="sxs-lookup"><span data-stu-id="3e190-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="3e190-265">アプリケーション ドメインの実行を何重にも保護します。</span><span class="sxs-lookup"><span data-stu-id="3e190-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="3e190-266">アプリケーション ドメインの制約に起因して、アドイン アプリケーション ドメインでスローされた未処理の例外は、分離境界が存在していても、アプリケーション全体のクラッシュにつながります。</span><span class="sxs-lookup"><span data-stu-id="3e190-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="3e190-267">ただし、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] アドイン モデルおよび [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アドイン モデルは、この問題を回避して、アプリケーションの安定性を向上させる簡単な手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="3e190-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="3e190-268">A[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]アドインを表示する、[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]を作成、<xref:System.Windows.Threading.Dispatcher>の場合は、ホスト アプリケーションは、アプリケーション ドメインで実行されているスレッドの[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="3e190-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="3e190-269">処理することにより、アプリケーション ドメインで発生したすべての未処理の例外を検出することができます、<xref:System.Windows.Threading.Dispatcher.UnhandledException>のイベント、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]アドインの<xref:System.Windows.Threading.Dispatcher>します。</span><span class="sxs-lookup"><span data-stu-id="3e190-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="3e190-270">取得することができます、<xref:System.Windows.Threading.Dispatcher>から、<xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="3e190-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="3e190-271">WPF アドインの制約</span><span class="sxs-lookup"><span data-stu-id="3e190-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="3e190-272">利点以外を[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]によって提供される既定の動作に追加<xref:System.Windows.Interop.HwndSource>、 <xref:System.Windows.Interop.HwndHost>、およびウィンドウ ハンドルのアドインの制限があります[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]ホスト アプリケーションから表示します。</span><span class="sxs-lookup"><span data-stu-id="3e190-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="3e190-273">ホスト アプリケーションで表示されるアドイン [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] では、ホスト アプリケーションのクリッピング動作が考慮されません。</span><span class="sxs-lookup"><span data-stu-id="3e190-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="3e190-274">相互運用性シナリオの*空域*の概念もアドインに適用されます (「[技術領域の概要](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)」を参照)。</span><span class="sxs-lookup"><span data-stu-id="3e190-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="3e190-275">リソースの継承、データ バインディング、コマンド実行など、ホスト アプリケーションの [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] サービスは、アドイン [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] で自動的には使用可能になりません。</span><span class="sxs-lookup"><span data-stu-id="3e190-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3e190-276">これらのサービスをアドインに提供するには、パイプラインを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="3e190-277">アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] に回転、拡大縮小、傾斜などの変換は適用できません (「[変換の概要](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)」を参照)。</span><span class="sxs-lookup"><span data-stu-id="3e190-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="3e190-278">アドインでは、内部コンテンツ[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]からの操作を描画することによってレンダリングされる、<xref:System.Drawing>アルファ ブレンド名前空間を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="3e190-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="3e190-279">ただし、それを含むアドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] とホスト アプリケーション [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] のいずれも、100% 不透明である必要があります。言い換えると、どちらについても `Opacity` プロパティが 1 に設定されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="3e190-280">場合、<xref:System.Windows.Window.AllowsTransparency%2A>追加で格納しているホスト アプリケーションのウィンドウのプロパティ[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]に設定されている`true`アドインでは表示されません。</span><span class="sxs-lookup"><span data-stu-id="3e190-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="3e190-281">このことは、アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] が 100% 不透明 (`Opacity` プロパティの値が 1) の場合にも該当します。</span><span class="sxs-lookup"><span data-stu-id="3e190-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="3e190-282">アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] は、同じトップレベル ウィンドウ内の他の [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 要素より前面に表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3e190-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="3e190-283">アドインの部分はありません[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]を使用して表示することができます、<xref:System.Windows.Media.VisualBrush>です。</span><span class="sxs-lookup"><span data-stu-id="3e190-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="3e190-284">その代わり、アドインは生成された [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] のスナップショットを取り、コントラクトで定義されているメソッドを使用してホスト アプリケーションに渡すことができるビットマップを作成できます。</span><span class="sxs-lookup"><span data-stu-id="3e190-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="3e190-285">メディア ファイルを再生することはできません、<xref:System.Windows.Controls.MediaElement>アドインで[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="3e190-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="3e190-286">ホスト アプリケーションがアドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 用に生成されたマウス イベントを受け取ったり、発生させたりすることはなく、ホスト アプリケーション [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] の `IsMouseOver` プロパティの値は `false` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="3e190-287">アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 内のコントロール間を、フォーカスが移動しても、`GotFocus` イベントおよび `LostFocus` イベントをホスト アプリケーションで受け取ったり、発生したりすることはありません。</span><span class="sxs-lookup"><span data-stu-id="3e190-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="3e190-288">アドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] を含むホスト アプリケーション部分は、印刷時には白く出力されます。</span><span class="sxs-lookup"><span data-stu-id="3e190-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="3e190-289">すべてのディスパッチャー (を参照してください<xref:System.Windows.Threading.Dispatcher>)、アドインによって作成された[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]必要がある手動でシャット ダウンに所有者のアドインが読み込み解除される場合は、ホスト アプリケーションが実行を継続します。</span><span class="sxs-lookup"><span data-stu-id="3e190-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="3e190-290">コントラクトは、アドインがアンロードされる前にホスト アプリケーションがアドインにシグナルを送信するためのメソッドを実装でき、それによりアドイン [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] がそのディスパッチャーをシャットダウンできます。</span><span class="sxs-lookup"><span data-stu-id="3e190-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="3e190-291">場合、アドイン[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]は、<xref:System.Windows.Controls.InkCanvas>または含まれている、 <xref:System.Windows.Controls.InkCanvas>、アドインをアンロードすることはできません。</span><span class="sxs-lookup"><span data-stu-id="3e190-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="3e190-292">パフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="3e190-292">Performance Optimization</span></span>  
 <span data-ttu-id="3e190-293">既定では、複数のアプリケーション ドメインが使用されていると、各アプリケーションで必要とされているさまざまな [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] アセンブリがすべてそのアプリケーションのドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="3e190-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="3e190-294">その結果、新しいアプリケーション ドメインを作成してその中でアプリケーションを開始するために必要な時間がパフォーマンスに影響します。</span><span class="sxs-lookup"><span data-stu-id="3e190-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="3e190-295">ただし、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] には、アセンブリが既に読み込まれている場合に、それをアプリケーション ドメイン間で共有するようアプリケーションに指示することで開始時間を短縮する手段が用意されています。</span><span class="sxs-lookup"><span data-stu-id="3e190-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="3e190-296">使用して、これを行う、<xref:System.LoaderOptimizationAttribute>属性は、エントリ ポイント メソッドに適用する必要があります (`Main`)。</span><span class="sxs-lookup"><span data-stu-id="3e190-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="3e190-297">この場合、アプリケーション定義を実装するコードのみを使用する必要があります (「[アプリケーション管理の概要](../../../../docs/framework/wpf/app-development/application-management-overview.md)」を参照)。</span><span class="sxs-lookup"><span data-stu-id="3e190-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3e190-298">関連項目</span><span class="sxs-lookup"><span data-stu-id="3e190-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="3e190-299">アドインおよび拡張機能</span><span class="sxs-lookup"><span data-stu-id="3e190-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="3e190-300">アプリケーション ドメイン</span><span class="sxs-lookup"><span data-stu-id="3e190-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="3e190-301">.NET framework リモート処理の概要</span><span class="sxs-lookup"><span data-stu-id="3e190-301">.NET Framework Remoting Overview</span></span>](http://msdn.microsoft.com/en-us/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="3e190-302">オブジェクトをリモート処理可能</span><span class="sxs-lookup"><span data-stu-id="3e190-302">Making Objects Remotable</span></span>](http://msdn.microsoft.com/en-us/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="3e190-303">方法トピック</span><span class="sxs-lookup"><span data-stu-id="3e190-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
