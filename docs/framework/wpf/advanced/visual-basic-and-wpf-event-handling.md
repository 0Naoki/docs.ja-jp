---
title: Visual Basic と WPF のイベント処理
ms.date: 03/30/2017
helpviewer_keywords:
- Visual Basic [WPF], event handlers
- event handlers [WPF], Visual Basic
ms.assetid: ad4eb9aa-3afc-4a71-8cf6-add3fbea54a1
ms.openlocfilehash: 321b4547bffbbae3c16ef8dd046bdff65ebe0bf1
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/04/2018
ms.locfileid: "33547824"
---
# <a name="visual-basic-and-wpf-event-handling"></a><span data-ttu-id="87984-102">Visual Basic と WPF のイベント処理</span><span class="sxs-lookup"><span data-stu-id="87984-102">Visual Basic and WPF Event Handling</span></span>
<span data-ttu-id="87984-103">Microsoft Visual Basic .NET 言語具体的には、使用できます、言語固有`Handles`にイベント ハンドラーを関連付けるインスタンスの属性を持つイベント ハンドラーのアタッチまたはを使用する代わりに、キーワード、<xref:System.Windows.UIElement.AddHandler%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="87984-103">For the Microsoft Visual Basic .NET language specifically, you can use the language-specific `Handles` keyword to associate event handlers with instances, instead of attaching event handlers with attributes or using the <xref:System.Windows.UIElement.AddHandler%2A> method.</span></span> <span data-ttu-id="87984-104">ただし、`Handles`ために、ハンドラーのインスタンスにアタッチする方法はいくつかの制限には、`Handles`構文は、の特定のルーティング イベント機能の一部をサポートできない、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]イベント システムです。</span><span class="sxs-lookup"><span data-stu-id="87984-104">However, the `Handles` technique for attaching handlers to instances does have some limitations, because the `Handles` syntax cannot support some of the specific routed event features of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span>  
  
## <a name="using-handles-in-a-wpf-application"></a><span data-ttu-id="87984-105">WPF アプリケーションで「ハンドル」の使用</span><span class="sxs-lookup"><span data-stu-id="87984-105">Using "Handles" in a WPF Application</span></span>  
 <span data-ttu-id="87984-106">インスタンスでとイベントに接続されているイベント ハンドラー`Handles`すべては、必須の要素の属性値を割り当てられているイベント ハンドラーのインスタンスの部分クラス宣言内で定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="87984-106">The event handlers that are connected to instances and events with `Handles` must all be defined within the partial class declaration of the instance, which is also a requirement for event handlers that are assigned through attribute values on elements.</span></span> <span data-ttu-id="87984-107">のみを指定できます`Handles`を持つページ上の要素の<xref:System.Windows.FrameworkContentElement.Name%2A>プロパティの値 (または[X:name ディレクティブ](../../../../docs/framework/xaml-services/x-name-directive.md)宣言されている)。</span><span class="sxs-lookup"><span data-stu-id="87984-107">You can only specify `Handles` for an element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property value (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="87984-108">これは、ため、<xref:System.Windows.FrameworkContentElement.Name%2A>で[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]をサポートするために必要なインスタンスの参照を作成、 *Instance.Event*で必要な参照形式、`Handles`構文です。</span><span class="sxs-lookup"><span data-stu-id="87984-108">This is because the <xref:System.Windows.FrameworkContentElement.Name%2A> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] creates the instance reference that is necessary to support the *Instance.Event* reference format required by the `Handles` syntax.</span></span> <span data-ttu-id="87984-109">要素でのみ使用できるを`Handles`せず、<xref:System.Windows.FrameworkContentElement.Name%2A>参照は、部分クラスを定義するルート要素のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="87984-109">The only element that can be used for `Handles` without a <xref:System.Windows.FrameworkContentElement.Name%2A> reference is the root-element instance that defines the partial class.</span></span>  
  
 <span data-ttu-id="87984-110">分離することにより、複数の要素に同じハンドラーを割り当てることができます*Instance.Event*後参照`Handles`をコンマでします。</span><span class="sxs-lookup"><span data-stu-id="87984-110">You can assign the same handler to multiple elements by separating *Instance.Event* references after `Handles` with commas.</span></span>  
  
 <span data-ttu-id="87984-111">使用することができます`Handles`に複数のハンドラーを同じに割り当てる*Instance.Event*参照します。</span><span class="sxs-lookup"><span data-stu-id="87984-111">You can use `Handles` to assign more than one handler to the same *Instance.Event*reference.</span></span> <span data-ttu-id="87984-112">ハンドラーがで指定された順序に任意の重要度が割り当てられない、`Handles`参照; 任意の順序で、同じイベントを処理するハンドラーを起動できることを想定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="87984-112">Do not assign any importance to the order in which handlers are given in the `Handles` reference; you should assume that handlers that handle the same event can be invoked in any order.</span></span>  
  
 <span data-ttu-id="87984-113">追加されたハンドラーを削除する`Handles`宣言を呼び出すことができます<xref:System.Windows.UIElement.RemoveHandler%2A>です。</span><span class="sxs-lookup"><span data-stu-id="87984-113">To remove a handler that was added with `Handles` in the declaration, you can call <xref:System.Windows.UIElement.RemoveHandler%2A>.</span></span>  
  
 <span data-ttu-id="87984-114">使用することができます`Handles`にそれらのメンバー テーブルで処理されるイベントを定義するインスタンスにハンドラーをアタッチするように、ルーティングされたイベントのハンドラーをアタッチします。</span><span class="sxs-lookup"><span data-stu-id="87984-114">You can use `Handles` to attach handlers for routed events, so long as you attach handlers to instances that define the event being handled in their members tables.</span></span> <span data-ttu-id="87984-115">ルーティング イベントにアタッチされているハンドラーの`Handles`としてアタッチされているハンドラーと同じルーティング規則に従う[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]属性、またはの一般的なシグネチャを持つ<xref:System.Windows.UIElement.AddHandler%2A>します。</span><span class="sxs-lookup"><span data-stu-id="87984-115">For routed events, handlers that are attached with `Handles` follow the same routing rules as do handlers that are attached as [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] attributes, or with the common signature of <xref:System.Windows.UIElement.AddHandler%2A>.</span></span> <span data-ttu-id="87984-116">つまり、このイベントは既に設定されて処理される場合 (、<xref:System.Windows.RoutedEventArgs.Handled%2A>イベント データのプロパティは`True`) のハンドラーをアタッチし、`Handles`イベント インスタンスをへの応答は呼び出されません。</span><span class="sxs-lookup"><span data-stu-id="87984-116">This means that if the event is already marked handled (the <xref:System.Windows.RoutedEventArgs.Handled%2A> property in the event data is `True`), then handlers attached with `Handles` are not invoked in response to that event instance.</span></span> <span data-ttu-id="87984-117">イベントは、またはクラスには、現在の要素またはルート上の以前の要素を処理して、ルート内の別の要素のインスタンス ハンドラーによって処理されるマークでした。</span><span class="sxs-lookup"><span data-stu-id="87984-117">The event could be marked handled by instance handlers on another element in the route, or by class handling either on the current element or earlier elements along the route.</span></span> <span data-ttu-id="87984-118">ペア トンネル/バブル イベントをサポートする入力イベントのトンネリングのルートを処理イベントのペア マークいる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="87984-118">For input events that support paired tunnel/bubble events, the tunneling route may have marked the event pair handled.</span></span> <span data-ttu-id="87984-119">ルーティング イベントの詳細については、「[ルーティング イベントの概要](../../../../docs/framework/wpf/advanced/routed-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="87984-119">For more information about routed events, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
## <a name="limitations-of-handles-for-adding-handlers"></a><span data-ttu-id="87984-120">ハンドラーの追加「ハンドル」の制限事項</span><span class="sxs-lookup"><span data-stu-id="87984-120">Limitations of "Handles" for Adding Handlers</span></span>  
 <span data-ttu-id="87984-121">`Handles` 添付イベントのハンドラーを参照することはできません。</span><span class="sxs-lookup"><span data-stu-id="87984-121">`Handles` cannot reference handlers for attached events.</span></span> <span data-ttu-id="87984-122">使用する必要があります、`add`その添付イベントのアクセサー メソッドまたは*typename.eventname*イベント属性で[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="87984-122">You must use the `add` accessor method for that attached event, or *typename.eventname* event attributes in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="87984-123">詳細については、「[ルーティング イベントの概要](../../../../docs/framework/wpf/advanced/routed-events-overview.md)です。</span><span class="sxs-lookup"><span data-stu-id="87984-123">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="87984-124">ルーティング イベントの場合のみ使用できます`Handles`ハンドラーを割り当てるインスタンスのメンバー テーブルのイベントが存在するインスタンス。</span><span class="sxs-lookup"><span data-stu-id="87984-124">For routed events, you can only use `Handles` to assign handlers for instances where that event exists in the instance members table.</span></span> <span data-ttu-id="87984-125">ただし、ルーティングされたイベントで一般に、親要素できますから子要素、イベントのリスナー場合でも、親要素では、そのメンバー テーブルでは、そのイベントはありません。</span><span class="sxs-lookup"><span data-stu-id="87984-125">However, with routed events in general, a parent element can be a listener for an event from child elements, even if the parent element does not have that event in its members table.</span></span> <span data-ttu-id="87984-126">属性の構文ではこれを指定できます、 *typename.membername*修飾どの型が実際に処理するイベントを定義するフォームの属性です。</span><span class="sxs-lookup"><span data-stu-id="87984-126">In attribute syntax, you can specify this through a *typename.membername* attribute form that qualifies which type actually defines the event you want to handle.</span></span> <span data-ttu-id="87984-127">インスタンスの親`Page`(のない`Click`イベントが定義されている) 形式で、属性のハンドラーを割り当てることでボタン クリック イベントのリッスンできる`Button.Click`です。</span><span class="sxs-lookup"><span data-stu-id="87984-127">For instance, a parent `Page` (with no `Click` event defined) can listen for button-click events by assigning an attribute handler in the form `Button.Click`.</span></span> <span data-ttu-id="87984-128">`Handles`はサポートしていません、 *typename.membername*フォームで、競合しているをサポートする必要がありますので*Instance.Event*フォーム。</span><span class="sxs-lookup"><span data-stu-id="87984-128">But `Handles` does not support the *typename.membername* form, because it must support a conflicting *Instance.Event* form.</span></span> <span data-ttu-id="87984-129">詳細については、「[ルーティング イベントの概要](../../../../docs/framework/wpf/advanced/routed-events-overview.md)です。</span><span class="sxs-lookup"><span data-stu-id="87984-129">For details, see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="87984-130">`Handles` 既に処理済みとしてマークされるイベントに対して呼び出されるハンドラーをアタッチできません。</span><span class="sxs-lookup"><span data-stu-id="87984-130">`Handles` cannot attach handlers that are invoked for events that are already marked handled.</span></span> <span data-ttu-id="87984-131">代わりに、コードと呼び出しを使用する必要があります、`handledEventsToo`のオーバー ロード<xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>です。</span><span class="sxs-lookup"><span data-stu-id="87984-131">Instead, you must use code and call the `handledEventsToo` overload of <xref:System.Windows.UIElement.AddHandler%28System.Windows.RoutedEvent%2CSystem.Delegate%2CSystem.Boolean%29>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="87984-132">使用しないで、 `Handles` XAML で、同じイベントのイベント ハンドラーを指定すると、Visual Basic コードの構文。</span><span class="sxs-lookup"><span data-stu-id="87984-132">Do not use the `Handles` syntax in Visual Basic code when you specify an event handler for the same event in XAML.</span></span> <span data-ttu-id="87984-133">この場合、イベント ハンドラーが 2 回呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="87984-133">In this case, the event handler is called twice.</span></span>  
  
## <a name="how-wpf-implements-handles-functionality"></a><span data-ttu-id="87984-134">どの WPF 実装「機能を処理」</span><span class="sxs-lookup"><span data-stu-id="87984-134">How WPF Implements "Handles" Functionality</span></span>  
 <span data-ttu-id="87984-135">ときに、[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]ページがコンパイルされた中間ファイルは、宣言`Friend``WithEvents`を持つページ上のすべての要素への参照、<xref:System.Windows.FrameworkContentElement.Name%2A>プロパティ セット (または[X:name ディレクティブ](../../../../docs/framework/xaml-services/x-name-directive.md)宣言されている)。</span><span class="sxs-lookup"><span data-stu-id="87984-135">When a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] page is compiled, the intermediate file declares `Friend` `WithEvents` references to every element on the page that has a <xref:System.Windows.FrameworkContentElement.Name%2A> property set (or [x:Name Directive](../../../../docs/framework/xaml-services/x-name-directive.md) declared).</span></span> <span data-ttu-id="87984-136">各名前付きインスタンスが使用してハンドラーに割り当てることのできる要素である可能性のある`Handles`です。</span><span class="sxs-lookup"><span data-stu-id="87984-136">Each named instance is potentially an element that can be assigned to a handler through `Handles`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="87984-137">内で[!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)]、[!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)]要素が使用できる入力候補を表示できます、`Handles`ページ内の参照。</span><span class="sxs-lookup"><span data-stu-id="87984-137">Within [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)], [!INCLUDE[TLA2#tla_intellisense](../../../../includes/tla2sharptla-intellisense-md.md)] can show you completion for which elements are available for a `Handles` reference in a page.</span></span> <span data-ttu-id="87984-138">ただし、これがかかるコンパイル パスの 1 つの中間ファイルがすべてに設定できるように、`Friends`参照します。</span><span class="sxs-lookup"><span data-stu-id="87984-138">However, this might take one compile pass so that the intermediate file can populate all the `Friends` references.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="87984-139">関連項目</span><span class="sxs-lookup"><span data-stu-id="87984-139">See Also</span></span>  
 <xref:System.Windows.UIElement.AddHandler%2A>  
 [<span data-ttu-id="87984-140">ルーティング イベントの処理済みとしてのマーキング、およびクラス処理</span><span class="sxs-lookup"><span data-stu-id="87984-140">Marking Routed Events as Handled, and Class Handling</span></span>](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md)  
 [<span data-ttu-id="87984-141">ルーティング イベントの概要</span><span class="sxs-lookup"><span data-stu-id="87984-141">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [<span data-ttu-id="87984-142">XAML の概要 (WPF)</span><span class="sxs-lookup"><span data-stu-id="87984-142">XAML Overview (WPF)</span></span>](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)
