---
title: スタイラスからの入力のインターセプト
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- 'architecture [WPF], '
- ', '
- ', '
- ', '
ms.assetid: 791bb2f0-4e5c-4569-ac3c-211996808d44
ms.openlocfilehash: 2547c0aa2f3a14080868c2760fa8999eb99d3d16
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/27/2019
ms.locfileid: "70046328"
---
# <a name="intercepting-input-from-the-stylus"></a><span data-ttu-id="06e97-102">スタイラスからの入力のインターセプト</span><span class="sxs-lookup"><span data-stu-id="06e97-102">Intercepting Input from the Stylus</span></span>
<span data-ttu-id="06e97-103">アーキテクチャ<xref:System.Windows.Input.StylusPlugIns>は、 <xref:System.Windows.Input.Stylus>入力とデジタルインク<xref:System.Windows.Ink.Stroke>オブジェクトの作成に対して低レベルの制御を実装するためのメカニズムを提供します。</span><span class="sxs-lookup"><span data-stu-id="06e97-103">The <xref:System.Windows.Input.StylusPlugIns> architecture provides a mechanism for implementing low-level control over <xref:System.Windows.Input.Stylus> input and the creation of digital ink <xref:System.Windows.Ink.Stroke> objects.</span></span> <span data-ttu-id="06e97-104">クラス<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>は、カスタム動作を実装し、最適なパフォーマンスを得るためにスタイラスデバイスから送信されるデータストリームに適用するためのメカニズムを提供します。</span><span class="sxs-lookup"><span data-stu-id="06e97-104">The <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> class provides a mechanism for you to implement custom behavior and apply it to the stream of data coming from the stylus device for the optimal performance.</span></span>  
  
 <span data-ttu-id="06e97-105">このトピックは、次の内容で構成されています。</span><span class="sxs-lookup"><span data-stu-id="06e97-105">This topic contains the following subsections:</span></span>  
  
- [<span data-ttu-id="06e97-106">アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="06e97-106">Architecture</span></span>](#Architecture)  
  
- [<span data-ttu-id="06e97-107">スタイラスプラグインの実装</span><span class="sxs-lookup"><span data-stu-id="06e97-107">Implementing Stylus Plug-ins</span></span>](#ImplementingStylusPlugins)  
  
- [<span data-ttu-id="06e97-108">System.windows.controls.inkcanvas> にプラグインを追加する</span><span class="sxs-lookup"><span data-stu-id="06e97-108">Adding Your Plug-in to an InkCanvas</span></span>](#AddingYourPluginToAnInkCanvas)  
  
- [<span data-ttu-id="06e97-109">まとめ</span><span class="sxs-lookup"><span data-stu-id="06e97-109">Conclusion</span></span>](#Conclusion)  
  
<a name="Architecture"></a>   
## <a name="architecture"></a><span data-ttu-id="06e97-110">アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="06e97-110">Architecture</span></span>  
 <span data-ttu-id="06e97-111">は、 [Microsoft Windows XP Tablet PC Edition ソフトウェア開発キット 1.7](https://go.microsoft.com/fwlink/?linkid=11782&clcid=0x409)の「[ペン入力にアクセスして操作](https://go.microsoft.com/fwlink/?LinkId=50752&clcid=0x409)する」で説明されている [StylusInput](https://go.microsoft.com/fwlink/?LinkId=50753&clcid=0x409) API の進化<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>です。</span><span class="sxs-lookup"><span data-stu-id="06e97-111">The <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> is the evolution of the [StylusInput](https://go.microsoft.com/fwlink/?LinkId=50753&clcid=0x409) APIs, described in [Accessing and Manipulating Pen Input](https://go.microsoft.com/fwlink/?LinkId=50752&clcid=0x409), in the [Microsoft Windows XP Tablet PC Edition Software Development Kit 1.7](https://go.microsoft.com/fwlink/?linkid=11782&clcid=0x409).</span></span>  
  
 <span data-ttu-id="06e97-112">各<xref:System.Windows.UIElement>には<xref:System.Windows.UIElement.StylusPlugIns%2A> 、と<xref:System.Windows.Input.StylusPlugIns.StylusPlugInCollection>いうプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="06e97-112">Each <xref:System.Windows.UIElement> has a <xref:System.Windows.UIElement.StylusPlugIns%2A> property that is a <xref:System.Windows.Input.StylusPlugIns.StylusPlugInCollection>.</span></span> <span data-ttu-id="06e97-113">を要素の<xref:System.Windows.UIElement.StylusPlugIns%2A>プロパティ<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>に追加して、生成時<xref:System.Windows.Input.StylusPoint>にデータを操作できます。</span><span class="sxs-lookup"><span data-stu-id="06e97-113">You can add a <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> to an element's <xref:System.Windows.UIElement.StylusPlugIns%2A> property to manipulate <xref:System.Windows.Input.StylusPoint> data as it is generated.</span></span> <span data-ttu-id="06e97-114"><xref:System.Windows.Input.StylusPoint>データは<xref:System.Windows.Input.StylusPoint.X%2A> <xref:System.Windows.Input.StylusPoint.PressureFactor%2A> 、データだけでなく、ポイントデータも含め、システムデジタイザーによってサポートされるすべてのプロパティで構成されます。<xref:System.Windows.Input.StylusPoint.Y%2A></span><span class="sxs-lookup"><span data-stu-id="06e97-114"><xref:System.Windows.Input.StylusPoint> data consists of all the properties supported by the system digitizer, including the <xref:System.Windows.Input.StylusPoint.X%2A> and <xref:System.Windows.Input.StylusPoint.Y%2A> point data, as well as <xref:System.Windows.Input.StylusPoint.PressureFactor%2A> data.</span></span>  
  
 <span data-ttu-id="06e97-115">オブジェクトは、 <xref:System.Windows.Input.Stylus> <xref:System.Windows.UIElement.StylusPlugIns%2A>をプロパティに追加するときに、デバイスから送信されるデータのストリームに直接挿入されます。 <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn></span><span class="sxs-lookup"><span data-stu-id="06e97-115">Your <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> objects are inserted directly into the stream of data coming from the <xref:System.Windows.Input.Stylus> device when you add the <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> to the <xref:System.Windows.UIElement.StylusPlugIns%2A> property.</span></span> <span data-ttu-id="06e97-116">プラグインを<xref:System.Windows.UIElement.StylusPlugIns%2A>コレクションに追加する順序によって、データを受信<xref:System.Windows.Input.StylusPoint>する順序が決まります。</span><span class="sxs-lookup"><span data-stu-id="06e97-116">The order in which plug-ins are added to the <xref:System.Windows.UIElement.StylusPlugIns%2A> collection dictates the order in which they will receive <xref:System.Windows.Input.StylusPoint> data.</span></span> <span data-ttu-id="06e97-117">たとえば、特定の領域に対する入力を制限するフィルタープラグインを追加した後、ジェスチャを認識するプラグインを追加すると、ジェスチャを認識するプラグインがフィルター処理<xref:System.Windows.Input.StylusPoint>されたデータを受信します。</span><span class="sxs-lookup"><span data-stu-id="06e97-117">For example, if you add a filter plug-in that restricts input to a particular region, and then add a plug-in that recognizes gestures as they are written, the plug-in that recognizes gestures will receive filtered <xref:System.Windows.Input.StylusPoint> data.</span></span>  
  
<a name="ImplementingStylusPlugins"></a>   
## <a name="implementing-stylus-plug-ins"></a><span data-ttu-id="06e97-118">スタイラスプラグインの実装</span><span class="sxs-lookup"><span data-stu-id="06e97-118">Implementing Stylus Plug-ins</span></span>  
 <span data-ttu-id="06e97-119">プラグインを実装するには、から<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>クラスを派生させます。</span><span class="sxs-lookup"><span data-stu-id="06e97-119">To implement a plug-in, derive a class from <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>.</span></span> <span data-ttu-id="06e97-120">このクラスは、 <xref:System.Windows.Input.Stylus>から取得されるデータのストリームとして適用されます。</span><span class="sxs-lookup"><span data-stu-id="06e97-120">This class is applied o the stream of data as it comes in from the <xref:System.Windows.Input.Stylus>.</span></span> <span data-ttu-id="06e97-121">このクラスでは、 <xref:System.Windows.Input.StylusPoint>データの値を変更できます。</span><span class="sxs-lookup"><span data-stu-id="06e97-121">In this class you can modify the values of the <xref:System.Windows.Input.StylusPoint> data.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="06e97-122">が<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>例外をスローした場合、または例外が発生した場合、アプリケーションは終了します。</span><span class="sxs-lookup"><span data-stu-id="06e97-122">If a <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> throws or causes an exception, the application will close.</span></span> <span data-ttu-id="06e97-123">を<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>使用するコントロールを十分にテストし、が例外をスローしないことが<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>わかっている場合にのみ、コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="06e97-123">You should thoroughly test controls that consume a <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> and only use a control if you are certain the <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> will not throw an exception.</span></span>  
  
 <span data-ttu-id="06e97-124">次の例<xref:System.Windows.Input.StylusPoint.X%2A>は、 <xref:System.Windows.Input.Stylus>デバイスからの<xref:System.Windows.Input.StylusPoint>データのと<xref:System.Windows.Input.StylusPoint.Y%2A>の値を変更することによって、スタイラスの入力を制限するプラグインを示しています。</span><span class="sxs-lookup"><span data-stu-id="06e97-124">The following example demonstrates a plug-in that restricts the stylus input by modifying the <xref:System.Windows.Input.StylusPoint.X%2A> and <xref:System.Windows.Input.StylusPoint.Y%2A> values in the <xref:System.Windows.Input.StylusPoint> data as it comes in from the <xref:System.Windows.Input.Stylus> device.</span></span>  
  
 [!code-csharp[AdvancedInkTopicsSamples#19](~/samples/snippets/csharp/VS_Snippets_Wpf/AdvancedInkTopicsSamples/CSharp/DynamicRenderer.cs#19)]
 [!code-vb[AdvancedInkTopicsSamples#19](~/samples/snippets/visualbasic/VS_Snippets_Wpf/AdvancedInkTopicsSamples/VisualBasic/DynamicRenderer.vb#19)]  
[!code-csharp[AdvancedInkTopicsSamples#3](~/samples/snippets/csharp/VS_Snippets_Wpf/AdvancedInkTopicsSamples/CSharp/DynamicRenderer.cs#3)]
[!code-vb[AdvancedInkTopicsSamples#3](~/samples/snippets/visualbasic/VS_Snippets_Wpf/AdvancedInkTopicsSamples/VisualBasic/DynamicRenderer.vb#3)]  
  
<a name="AddingYourPluginToAnInkCanvas"></a>   
## <a name="adding-your-plug-in-to-an-inkcanvas"></a><span data-ttu-id="06e97-125">System.windows.controls.inkcanvas> にプラグインを追加する</span><span class="sxs-lookup"><span data-stu-id="06e97-125">Adding Your Plug-in to an InkCanvas</span></span>  
 <span data-ttu-id="06e97-126">カスタムプラグインを使用する最も簡単な方法は、system.windows.controls.inkcanvas> から派生するクラスを実装し、それを<xref:System.Windows.UIElement.StylusPlugIns%2A>プロパティに追加することです。</span><span class="sxs-lookup"><span data-stu-id="06e97-126">The easiest way to use your custom plug-in is to implement a class that derives from InkCanvas and add it to the <xref:System.Windows.UIElement.StylusPlugIns%2A> property.</span></span>  
  
 <span data-ttu-id="06e97-127">次の例は、インク<xref:System.Windows.Controls.InkCanvas>をフィルター処理するカスタムを示しています。</span><span class="sxs-lookup"><span data-stu-id="06e97-127">The following example demonstrates a custom <xref:System.Windows.Controls.InkCanvas> that filters the ink.</span></span>  
  
 [!code-csharp[AdvancedInkTopicsSamples#4](~/samples/snippets/csharp/VS_Snippets_Wpf/AdvancedInkTopicsSamples/CSharp/Window1.xaml.cs#4)]  
  
 <span data-ttu-id="06e97-128">アプリケーションにを`FilterInkCanvas`追加して実行すると、ユーザーがストロークを完了するまで、インクが領域に限定されないことがわかります。</span><span class="sxs-lookup"><span data-stu-id="06e97-128">If you add a `FilterInkCanvas` to your application and run it, you will notice that the ink isn't restricted to a region until after the user completes a stroke.</span></span> <span data-ttu-id="06e97-129">これは、 <xref:System.Windows.Controls.InkCanvas>に<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>という<xref:System.Windows.Controls.InkCanvas.DynamicRenderer%2A>プロパティがあり、既に<xref:System.Windows.UIElement.StylusPlugIns%2A>コレクションのメンバーであるためです。</span><span class="sxs-lookup"><span data-stu-id="06e97-129">This is because the <xref:System.Windows.Controls.InkCanvas> has a <xref:System.Windows.Controls.InkCanvas.DynamicRenderer%2A> property, which is a <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> and is already a member of the <xref:System.Windows.UIElement.StylusPlugIns%2A> collection.</span></span> <span data-ttu-id="06e97-130">コレクションに追加<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>したカスタムは、がデータを<xref:System.Windows.Input.StylusPlugIns.DynamicRenderer>受信した後にデータを<xref:System.Windows.Input.StylusPoint>受信します。 <xref:System.Windows.UIElement.StylusPlugIns%2A></span><span class="sxs-lookup"><span data-stu-id="06e97-130">The custom <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> you added to the <xref:System.Windows.UIElement.StylusPlugIns%2A> collection receives the <xref:System.Windows.Input.StylusPoint> data after <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer> receives data.</span></span> <span data-ttu-id="06e97-131">その結果<xref:System.Windows.Input.StylusPoint> 、ユーザーがペンを離してストロークを終了するまで、データはフィルター処理されません。</span><span class="sxs-lookup"><span data-stu-id="06e97-131">As a result, the <xref:System.Windows.Input.StylusPoint> data will not be filtered until after the user lifts the pen to end a stroke.</span></span> <span data-ttu-id="06e97-132">ユーザーがインクを描画するときにフィルター処理するには、 `FilterPlugin`の<xref:System.Windows.Input.StylusPlugIns.DynamicRenderer>前にを挿入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="06e97-132">To filter the ink as the user draws it, you must insert the `FilterPlugin` before the <xref:System.Windows.Input.StylusPlugIns.DynamicRenderer>.</span></span>  
  
 <span data-ttu-id="06e97-133">次C#のコードは、描画<xref:System.Windows.Controls.InkCanvas>時にインクをフィルター処理するカスタムを示しています。</span><span class="sxs-lookup"><span data-stu-id="06e97-133">The following C# code demonstrates a custom <xref:System.Windows.Controls.InkCanvas> that filters the ink as it is drawn.</span></span>  
  
 [!code-csharp[AdvancedInkTopicsSamples#5](~/samples/snippets/csharp/VS_Snippets_Wpf/AdvancedInkTopicsSamples/CSharp/Window1.xaml.cs#5)]  
  
<a name="Conclusion"></a>   
## <a name="conclusion"></a><span data-ttu-id="06e97-134">まとめ</span><span class="sxs-lookup"><span data-stu-id="06e97-134">Conclusion</span></span>  
 <span data-ttu-id="06e97-135">独自<xref:System.Windows.Input.StylusPlugIns.StylusPlugIn>のクラスを派生させてコレクション<xref:System.Windows.Input.StylusPlugIns.StylusPlugInCollection>に挿入することにより、デジタルインクの動作を大幅に向上させることができます。</span><span class="sxs-lookup"><span data-stu-id="06e97-135">By deriving your own <xref:System.Windows.Input.StylusPlugIns.StylusPlugIn> classes and inserting them into <xref:System.Windows.Input.StylusPlugIns.StylusPlugInCollection> collections, you can greatly enhance the behavior of your digital ink.</span></span> <span data-ttu-id="06e97-136">生成された<xref:System.Windows.Input.StylusPoint>データにアクセスできるため、 <xref:System.Windows.Input.Stylus>入力をカスタマイズすることができます。</span><span class="sxs-lookup"><span data-stu-id="06e97-136">You have access to the <xref:System.Windows.Input.StylusPoint> data as it is generated, giving you the opportunity to customize the <xref:System.Windows.Input.Stylus> input.</span></span> <span data-ttu-id="06e97-137">データへの<xref:System.Windows.Input.StylusPoint>低レベルのアクセス権があるため、アプリケーションに最適なパフォーマンスでインクの収集とレンダリングを実装できます。</span><span class="sxs-lookup"><span data-stu-id="06e97-137">Because you have such low-level access to the <xref:System.Windows.Input.StylusPoint> data, you can implement ink collection and rendering with optimal performance for your application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="06e97-138">関連項目</span><span class="sxs-lookup"><span data-stu-id="06e97-138">See also</span></span>

- [<span data-ttu-id="06e97-139">高度なインク処理</span><span class="sxs-lookup"><span data-stu-id="06e97-139">Advanced Ink Handling</span></span>](advanced-ink-handling.md)
- [<span data-ttu-id="06e97-140">ペン入力にアクセスして操作する</span><span class="sxs-lookup"><span data-stu-id="06e97-140">Accessing and Manipulating Pen Input</span></span>](https://go.microsoft.com/fwlink/?LinkId=50752&clcid=0x409)
