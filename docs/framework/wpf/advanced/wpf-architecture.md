---
title: WPF アーキテクチャ
ms.date: 03/30/2017
helpviewer_keywords:
- properties [WPF], attached
- attached properties [WPF]
- architecture [WPF]
- unmanaged components [WPF]
- affinity thread [WPF]
- Storyboards [WPF]
- milcore [WPF]
- components [WPF], unmanaged
- painter's algorithm
- interfaces [WPF], INotifyPropertyChange
- CommandBindings [WPF]
- data templates [WPF]
- thread [WPF], affinity
ms.assetid: 8579c10b-76ab-4c52-9691-195ce02333c8
ms.openlocfilehash: dee88ceb82528955d8809214bff474b92233d28c
ms.sourcegitcommit: 0c48191d6d641ce88d7510e319cf38c0e35697d0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/05/2019
ms.locfileid: "57362014"
---
# <a name="wpf-architecture"></a><span data-ttu-id="bd709-102">WPF アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="bd709-102">WPF Architecture</span></span>
<span data-ttu-id="bd709-103">このトピックでは、Windows Presentation Foundation (WPF) クラスの階層構造のガイド付きツアーを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-103">This topic provides a guided tour of the Windows Presentation Foundation (WPF) class hierarchy.</span></span> <span data-ttu-id="bd709-104">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]の主要なサブシステムの大半に対応し、それらがどのようにやり取りするかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="bd709-104">It covers most of the major subsystems of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], and describes how they interact.</span></span> <span data-ttu-id="bd709-105">また、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]の構造設計者によって行われた選択についての幾つかを詳細に説明します。</span><span class="sxs-lookup"><span data-stu-id="bd709-105">It also details some of the choices made by the architects of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span>  
  
  
<a name="System_Object"></a>   
## <a name="systemobject"></a><span data-ttu-id="bd709-106">System.Object</span><span class="sxs-lookup"><span data-stu-id="bd709-106">System.Object</span></span>  
 <span data-ttu-id="bd709-107">主要な[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プログラミング モデルがマネージ コードを通じて公開されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-107">The primary [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] programming model is exposed through managed code.</span></span> <span data-ttu-id="bd709-108">初期の設計段階で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]のさまざまなシステムのマネージ コンポーネントとアンマネージのコンポーネントとの線引きについての論争がありました。</span><span class="sxs-lookup"><span data-stu-id="bd709-108">Early in the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] there were a number of debates about where the line should be drawn between the managed components of the system and the unmanaged ones.</span></span> <span data-ttu-id="bd709-109">[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]は生産性と堅牢性 (メモリ管理、エラー処理、共通型システムなどを含む) のある開発を行う数多くの機能を提供しますが、それらはコストの増加を招きます。</span><span class="sxs-lookup"><span data-stu-id="bd709-109">The [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides a number of features that make development more productive and robust (including memory management, error handling, common type system, etc.) but they come at a cost.</span></span>  
  
 <span data-ttu-id="bd709-110">主要コンポーネント[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]は次の図のようになります。</span><span class="sxs-lookup"><span data-stu-id="bd709-110">The major components of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are illustrated in the figure below.</span></span> <span data-ttu-id="bd709-111">(PresentationFramework、PresentationCore、および milcore) の図の赤のセクションではの大規模なコード部分[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-111">The red sections of the diagram (PresentationFramework, PresentationCore, and milcore) are the major code portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="bd709-112">これらのうち、1 つだけは、アンマネージ コンポーネント – milcore です。</span><span class="sxs-lookup"><span data-stu-id="bd709-112">Of these, only one is an unmanaged component – milcore.</span></span> <span data-ttu-id="bd709-113">緊密な統合を有効にするには Milcore がアンマネージ コードで記述された[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-113">Milcore is written in unmanaged code in order to enable tight integration with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)].</span></span> <span data-ttu-id="bd709-114">すべて表示[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]を行う、[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]エンジン、効率的なハードウェアとソフトウェア レンダリングすることができます。</span><span class="sxs-lookup"><span data-stu-id="bd709-114">All display in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is done through the [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] engine, allowing for efficient hardware and software rendering.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-115">メモリと実行を細かく制御も必要です。</span><span class="sxs-lookup"><span data-stu-id="bd709-115">also required fine control over memory and execution.</span></span> <span data-ttu-id="bd709-116">Milcore 合成エンジンは、非常に機密性の高い、やの多くの利点をあきらめる必要なパフォーマンス、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]パフォーマンスを向上させます。</span><span class="sxs-lookup"><span data-stu-id="bd709-116">The composition engine in milcore is extremely performance sensitive, and required giving up many advantages of the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] to gain performance.</span></span>  
  
 <span data-ttu-id="bd709-117">![WPF、.NET Framework 内の位置。](./media/wpf-architect1.PNG "wpf_architect1")</span><span class="sxs-lookup"><span data-stu-id="bd709-117">![The position of WPF within the .NET Framework.](./media/wpf-architect1.PNG "wpf_architect1")</span></span>  
  
 <span data-ttu-id="bd709-118">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]のマネージ コードとアンマネージの部分の間の通信はこのトピックの後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="bd709-118">Communication between the managed and unmanaged portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is discussed later in this topic.</span></span> <span data-ttu-id="bd709-119">マネージ プログラミング モデルの残りの部分を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="bd709-119">The remainder of the managed programming model is described below.</span></span>  
  
<a name="System_Threading_DispatcherObject"></a>   
## <a name="systemthreadingdispatcherobject"></a><span data-ttu-id="bd709-120">System.Threading.DispatcherObject</span><span class="sxs-lookup"><span data-stu-id="bd709-120">System.Threading.DispatcherObject</span></span>  
 <span data-ttu-id="bd709-121">多くのオブジェクトに[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]から派生<xref:System.Windows.Threading.DispatcherObject>、同時実行を処理して、スレッド処理の基本的な構造を提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-121">Most objects in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] derive from <xref:System.Windows.Threading.DispatcherObject>, which provides the basic constructs for dealing with concurrency and threading.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-122">ディスパッチャーによって実装されたメッセージング システムに基づいています。</span><span class="sxs-lookup"><span data-stu-id="bd709-122">is based on a messaging system implemented by the dispatcher.</span></span> <span data-ttu-id="bd709-123">これは非常によく似た、使い慣れた[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]メッセージ ポンプは実際には、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]ディスパッチャーが User32 メッセージをスレッド間の呼び出しを実行するために使用します。</span><span class="sxs-lookup"><span data-stu-id="bd709-123">This works much like the familiar [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] message pump; in fact, the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dispatcher uses User32 messages for performing cross thread calls.</span></span>  
  
 <span data-ttu-id="bd709-124">本当に 2 つの主要で同時実行を検討する場合を理解する概念がある[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– ディスパッチャーとスレッド アフィニティ。</span><span class="sxs-lookup"><span data-stu-id="bd709-124">There are really two core concepts to understand when discussing concurrency in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – the dispatcher and thread affinity.</span></span>  
  
 <span data-ttu-id="bd709-125">デザイン フェーズ中に[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]目標は、実行の 1 つのスレッドに移動することでしたが、非スレッド「関連付け」モデル。</span><span class="sxs-lookup"><span data-stu-id="bd709-125">During the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the goal was to move to a single thread of execution, but a non-thread "affinitized" model.</span></span> <span data-ttu-id="bd709-126">スレッドの関係は、コンポーネントの状態の保存するために実行中のスレッドの id を使用するときに発生します。</span><span class="sxs-lookup"><span data-stu-id="bd709-126">Thread affinity happens when a component uses the identity of the executing thread to store some type of state.</span></span> <span data-ttu-id="bd709-127">これの最も一般的な形式では、状態を格納する、スレッド ローカル ストア (TLS) を使用します。</span><span class="sxs-lookup"><span data-stu-id="bd709-127">The most common form of this is to use the thread local store (TLS) to store state.</span></span> <span data-ttu-id="bd709-128">スレッドの関係では、実行の各論理スレッドの所有、オペレーティング システム、メモリ集中型になることで、1 つだけの物理スレッドである必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-128">Thread affinity requires that each logical thread of execution be owned by only one physical thread in the operating system, which can become memory intensive.</span></span> <span data-ttu-id="bd709-129">最後に、WPF のスレッド モデルがスレッドの関係を持つシングル スレッド実行の既存の User32 スレッド モデルとの同期が保持されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-129">In the end, WPF’s threading model was kept in sync with the existing User32 threading model of single threaded execution with thread affinity.</span></span> <span data-ttu-id="bd709-130">その理由は、プライマリ相互運用性のされました – などのシステム[!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)]クリップボード、および Internet Explorer のすべて 1 つのスレッド アフィニティ (STA) の実行が必要です。</span><span class="sxs-lookup"><span data-stu-id="bd709-130">The primary reason for this was interoperability – systems like [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], the clipboard, and Internet Explorer all require single thread affinity (STA) execution.</span></span>  
  
 <span data-ttu-id="bd709-131">STA スレッドでオブジェクトがあること必要があります、スレッド間で通信および検証する方法、適切なスレッドであります。</span><span class="sxs-lookup"><span data-stu-id="bd709-131">Given that you have objects with STA threading, you need a way to communicate between threads, and validate that you are on the correct thread.</span></span> <span data-ttu-id="bd709-132">ディスパッチャーのロールが生じます。</span><span class="sxs-lookup"><span data-stu-id="bd709-132">Herein lies the role of the dispatcher.</span></span> <span data-ttu-id="bd709-133">ディスパッチャーは、複数の優先順位キューでのシステムをディスパッチする基本的なメッセージです。</span><span class="sxs-lookup"><span data-stu-id="bd709-133">The dispatcher is a basic message dispatching system, with multiple prioritized queues.</span></span> <span data-ttu-id="bd709-134">メッセージの例には、生の入力の通知 (マウスの移動)、framework 関数 (レイアウト)、またはユーザー コマンドが含まれます (このメソッドを実行)。</span><span class="sxs-lookup"><span data-stu-id="bd709-134">Examples of messages include raw input notifications (mouse moved), framework functions (layout), or user commands (execute this method).</span></span> <span data-ttu-id="bd709-135">派生することによって<xref:System.Windows.Threading.DispatcherObject>、作成する、 [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] STA の動作を持つオブジェクトし、は指定のポインターをディスパッチャーに作成時にします。</span><span class="sxs-lookup"><span data-stu-id="bd709-135">By deriving from <xref:System.Windows.Threading.DispatcherObject>, you create a [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] object that has STA behavior, and will be given a pointer to a dispatcher at creation time.</span></span>  
  
<a name="System_Windows_DependencyObject"></a>   
## <a name="systemwindowsdependencyobject"></a><span data-ttu-id="bd709-136">System.Windows.DependencyObject</span><span class="sxs-lookup"><span data-stu-id="bd709-136">System.Windows.DependencyObject</span></span>  
 <span data-ttu-id="bd709-137">ビルドで使用されるプライマリ アーキテクチャ哲学の 1 つ[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティの基本設定がメソッドまたはイベントを超えました。</span><span class="sxs-lookup"><span data-stu-id="bd709-137">One of the primary architectural philosophies used in building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] was a preference for properties over methods or events.</span></span> <span data-ttu-id="bd709-138">プロパティ宣言を簡単にアクションではなく、インテントを指定できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-138">Properties are declarative and allow you to more easily specify intent instead of action.</span></span> <span data-ttu-id="bd709-139">これは、モデル駆動型、またはデータ ドリブンでユーザー インターフェイスのコンテンツを表示するためのシステムにもサポートされます。</span><span class="sxs-lookup"><span data-stu-id="bd709-139">This also supported a model driven, or data driven, system for displaying user interface content.</span></span> <span data-ttu-id="bd709-140">この理念は、アプリケーションの動作をより細かく制御するために、バインドが複数のプロパティの作成の目的の効果がありました。</span><span class="sxs-lookup"><span data-stu-id="bd709-140">This philosophy had the intended effect of creating more properties that you could bind to, in order to better control the behavior of an application.</span></span>  
  
 <span data-ttu-id="bd709-141">高度なプロパティ システムのプロパティによって駆動システムの詳細を確保するために、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]提供が必要でした。</span><span class="sxs-lookup"><span data-stu-id="bd709-141">In order to have more of the system driven by properties, a richer property system than what the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides was needed.</span></span> <span data-ttu-id="bd709-142">この豊富な機能の簡単な例では、変更通知です。</span><span class="sxs-lookup"><span data-stu-id="bd709-142">A simple example of this richness is change notifications.</span></span> <span data-ttu-id="bd709-143">双方向バインディングを有効にするには、変更通知をサポートするバインドの両方の側を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-143">In order to enable two way binding, you need both sides of the bind to support change notification.</span></span> <span data-ttu-id="bd709-144">プロパティの値に関連付けられている動作を確保するためには、プロパティ値が変更されたときに通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-144">In order to have behavior tied to property values, you need to be notified when the property value changes.</span></span> <span data-ttu-id="bd709-145">Microsoft .NET Framework には、インターフェイス、 **INotifyPropertyChange**、これは省略可能な変更の通知を発行するオブジェクトを許可します。</span><span class="sxs-lookup"><span data-stu-id="bd709-145">The Microsoft .NET Framework has an interface, **INotifyPropertyChange**, which allows an object to publish change notifications, however it is optional.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-146">派生したより豊富なプロパティ システムの提供、<xref:System.Windows.DependencyObject>型。</span><span class="sxs-lookup"><span data-stu-id="bd709-146">provides a richer property system, derived from the <xref:System.Windows.DependencyObject> type.</span></span> <span data-ttu-id="bd709-147">プロパティ システムは、プロパティ式間の依存関係の追跡、依存関係を変更するときに、プロパティ値を自動的に再評価という点で、「依存関係」プロパティのシステムでは本当に。</span><span class="sxs-lookup"><span data-stu-id="bd709-147">The property system is truly a "dependency" property system in that it tracks dependencies between property expressions and automatically revalidates property values when dependencies change.</span></span> <span data-ttu-id="bd709-148">例では、継承したプロパティがある場合 (など<xref:System.Windows.Controls.Control.FontSize%2A>) には、値を継承する要素の親プロパティが変更された場合、システムが自動的に更新します。</span><span class="sxs-lookup"><span data-stu-id="bd709-148">For example, if you have a property that inherits (like <xref:System.Windows.Controls.Control.FontSize%2A>), the system is automatically updated if the property changes on a parent of an element that inherits the value.</span></span>  
  
 <span data-ttu-id="bd709-149">基盤となる、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティ システムは、プロパティ式の概念です。</span><span class="sxs-lookup"><span data-stu-id="bd709-149">The foundation of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] property system is the concept of a property expression.</span></span> <span data-ttu-id="bd709-150">この最初のリリースの[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティ式のシステムが閉じられるし、式はすべて、framework の一部として提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-150">In this first release of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the property expression system is closed, and the expressions are all provided as part of the framework.</span></span> <span data-ttu-id="bd709-151">式は、プロパティ システムがデータ バインディング、スタイル設定がないか、継承はハード コーディングしていますがではなく、framework 内の以降のレイヤーによって提供される理由です。</span><span class="sxs-lookup"><span data-stu-id="bd709-151">Expressions are why the property system doesn’t have data binding, styling, or inheritance hard coded, but rather provided by later layers within the framework.</span></span>  
  
 <span data-ttu-id="bd709-152">プロパティ システムのプロパティの値のスパース ストレージも提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-152">The property system also provides for sparse storage of property values.</span></span> <span data-ttu-id="bd709-153">オブジェクトは、数十 (ない場合は数百) のプロパティを持つことができ、値のほとんどは、既定の状態であるため (など、スタイルで設定を継承) オブジェクトのすべてのインスタンスが定義されたすべてのプロパティの完全な重みは、する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-153">Because objects can have dozens (if not hundreds) of properties, and most of the values are in their default state (inherited, set by styles, etc.), not every instance of an object needs to have the full weight of every property defined on it.</span></span>  
  
 <span data-ttu-id="bd709-154">プロパティ システムの最終的な新しい機能とは、添付プロパティの概念です。</span><span class="sxs-lookup"><span data-stu-id="bd709-154">The final new feature of the property system is the notion of attached properties.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-155">要素は、構成とコンポーネントの再利用の原則に基づいて構築されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-155">elements are built on the principle of composition and component reuse.</span></span> <span data-ttu-id="bd709-156">多くの場合は、の一部の要素を含む (のように、<xref:System.Windows.Controls.Grid>レイアウト要素) 子要素 (行/列の情報) のような動作を制御する追加のデータが必要です。</span><span class="sxs-lookup"><span data-stu-id="bd709-156">It is often the case that some containing element (like a <xref:System.Windows.Controls.Grid> layout element) needs additional data on child elements to control its behavior (like the Row/Column information).</span></span> <span data-ttu-id="bd709-157">すべての要素では、これらすべてのプロパティを関連付ける、代わりに、他のオブジェクトのプロパティの定義を提供する任意のオブジェクトが許可されています。</span><span class="sxs-lookup"><span data-stu-id="bd709-157">Instead of associating all of these properties with every element, any object is allowed to provide property definitions for any other object.</span></span> <span data-ttu-id="bd709-158">これは、JavaScript の"expando"機能に似ています。</span><span class="sxs-lookup"><span data-stu-id="bd709-158">This is similar to the "expando" features of JavaScript.</span></span>  
  
<a name="System_Windows_Media_Visual"></a>   
## <a name="systemwindowsmediavisual"></a><span data-ttu-id="bd709-159">System.Windows.Media.Visual</span><span class="sxs-lookup"><span data-stu-id="bd709-159">System.Windows.Media.Visual</span></span>  
 <span data-ttu-id="bd709-160">定義されているシステムでは、次の手順は画面に描画されるピクセルになっています。</span><span class="sxs-lookup"><span data-stu-id="bd709-160">With a system defined, the next step is getting pixels drawn to the screen.</span></span> <span data-ttu-id="bd709-161"><xref:System.Windows.Media.Visual>クラスがそれぞれ必要に応じて描画命令とこれらの手順 (クリッピング、変換など) をレンダリングする方法についてのメタデータを含む、ビジュアル オブジェクトのツリーを構築するために提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-161">The <xref:System.Windows.Media.Visual> class provides for building a tree of visual objects, each optionally containing drawing instructions and metadata about how to render those instructions (clipping, transformation, etc.).</span></span> <span data-ttu-id="bd709-162"><xref:System.Windows.Media.Visual> ほとんどの機能には、パブリックあるありませんので非常に軽量で柔軟なをするのには設計されています[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]公開し、保護されているコールバック関数に大きく依存します。</span><span class="sxs-lookup"><span data-stu-id="bd709-162"><xref:System.Windows.Media.Visual> is designed to be extremely lightweight and flexible, so most of the features have no public [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure and rely heavily on protected callback functions.</span></span>  
  
 <span data-ttu-id="bd709-163"><xref:System.Windows.Media.Visual> エントリ ポイントは、実際に、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]コンポジション システム。</span><span class="sxs-lookup"><span data-stu-id="bd709-163"><xref:System.Windows.Media.Visual> is really the entry point to the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] composition system.</span></span> <span data-ttu-id="bd709-164"><xref:System.Windows.Media.Visual> マネージこれらの 2 つサブシステム間の接続ポイントは、[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]まさに、します。</span><span class="sxs-lookup"><span data-stu-id="bd709-164"><xref:System.Windows.Media.Visual> is the point of connection between these two subsystems, the managed [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] and the unmanaged milcore.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-165">milcore によって管理されるアンマネージ データ構造を走査して、データを表示します。</span><span class="sxs-lookup"><span data-stu-id="bd709-165">displays data by traversing the unmanaged data structures managed by the milcore.</span></span> <span data-ttu-id="bd709-166">コンポジションのノードと呼ばれるこれらの構造は、各ノードでレンダリング指示の階層表示にはツリーを表します。</span><span class="sxs-lookup"><span data-stu-id="bd709-166">These structures, called composition nodes, represent a hierarchical display tree with rendering instructions at each node.</span></span> <span data-ttu-id="bd709-167">右側にある次の図のように、このツリーはメッセージング プロトコルを介してアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="bd709-167">This tree, illustrated on the right hand side of the figure below, is only accessible through a messaging protocol.</span></span>  
  
 <span data-ttu-id="bd709-168">プログラミング[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、作成する<xref:System.Windows.Media.Visual>要素、および派生型は、このメッセージング プロトコルを使って構成ツリーに内部的に通信します。</span><span class="sxs-lookup"><span data-stu-id="bd709-168">When programming [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you create <xref:System.Windows.Media.Visual> elements, and derived types, which internally communicate to the composition tree through this messaging protocol.</span></span> <span data-ttu-id="bd709-169">各<xref:System.Windows.Media.Visual>で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]1 つのフィルターまたはいくつかの構成ノードを作成することがあります。</span><span class="sxs-lookup"><span data-stu-id="bd709-169">Each <xref:System.Windows.Media.Visual> in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] may create one, none, or several composition nodes.</span></span>  
  
 <span data-ttu-id="bd709-170">![Windows Presentation Foundation のビジュアル ツリー。](./media/wpf-architecture2.PNG "wpf_architecture2")</span><span class="sxs-lookup"><span data-stu-id="bd709-170">![The Windows Presentation Foundation Visual Tree.](./media/wpf-architecture2.PNG "wpf_architecture2")</span></span>  
  
 <span data-ttu-id="bd709-171">ここでのビジュアル ツリー全体を通知する非常に重要なアーキテクチャの詳細は、描画命令はキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="bd709-171">There is a very important architectural detail to notice here – the entire tree of visuals and drawing instructions is cached.</span></span> <span data-ttu-id="bd709-172">グラフィックスの用語で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]保持モードのレンダリング システムを使用します。</span><span class="sxs-lookup"><span data-stu-id="bd709-172">In graphics terms, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uses a retained rendering system.</span></span> <span data-ttu-id="bd709-173">これにより、高いリフレッシュ レートを合成システムによってユーザー コードにコールバックをブロックせずに再描画するシステムです。</span><span class="sxs-lookup"><span data-stu-id="bd709-173">This enables the system to repaint at high refresh rates without the composition system blocking on callbacks to user code.</span></span> <span data-ttu-id="bd709-174">これは、応答しないアプリケーションの外観を回避できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-174">This helps prevent the appearance of an unresponsive application.</span></span>  
  
 <span data-ttu-id="bd709-175">ダイアグラムで非常に顕著ではないもう 1 つの重要な詳細情報は、システムが実際に合成を実行する方法です。</span><span class="sxs-lookup"><span data-stu-id="bd709-175">Another important detail that isn’t really noticeable in the diagram is how the system actually performs composition.</span></span>  
  
 <span data-ttu-id="bd709-176">User32 でと[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]、イミディ エイト モードのクリッピング システムで、システムが動作します。</span><span class="sxs-lookup"><span data-stu-id="bd709-176">In User32 and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)], the system works on an immediate mode clipping system.</span></span> <span data-ttu-id="bd709-177">コンポーネントは、表示する必要があります、システムは、外側には、コンポーネントがタッチ (ピクセル単位) 許可されていないし、コンポーネントがそのボックス内のピクセルの描画によく寄せられる、クリッピングの境界を確立します。</span><span class="sxs-lookup"><span data-stu-id="bd709-177">When a component needs to be rendered, the system establishes a clipping bounds outside of which the component isn’t allowed to touch the pixels, and then the component is asked to paint pixels in that box.</span></span> <span data-ttu-id="bd709-178">このシステムのメモリの制約があるシステムで非常にうまく動作のみ影響を受けるコンポーネントをタッチする必要がある変更が生じた場合のため – これまでの 1 つのピクセルの色に関与して 2 つのコンポーネントではありません。</span><span class="sxs-lookup"><span data-stu-id="bd709-178">This system works very well in memory constrained systems because when something changes you only have to touch the affected component – no two components ever contribute to the color of a single pixel.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-179">モデルの描画の「ペインタ アルゴリズム」を使用します。</span><span class="sxs-lookup"><span data-stu-id="bd709-179">uses a "painter's algorithm" painting model.</span></span> <span data-ttu-id="bd709-180">これは、各コンポーネントをクリッピングするには、代わりに各コンポーネントは、表示の前に、バックアップから表示を要求はことを意味します。</span><span class="sxs-lookup"><span data-stu-id="bd709-180">This means that instead of clipping each component, each component is asked to render from the back to the front of the display.</span></span> <span data-ttu-id="bd709-181">これにより、前のコンポーネントの表示を描画するには、各コンポーネントができます。</span><span class="sxs-lookup"><span data-stu-id="bd709-181">This allows each component to paint over the previous component's display.</span></span> <span data-ttu-id="bd709-182">このモデルの利点は、使用できる、部分的に透明な複雑な図形にあることです。</span><span class="sxs-lookup"><span data-stu-id="bd709-182">The advantage of this model is that you can have complex, partially transparent shapes.</span></span> <span data-ttu-id="bd709-183">今日の最新のグラフィックス ハードウェアでは、このモデルは比較的高速な (ケースではないときに User32/[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]作成された)。</span><span class="sxs-lookup"><span data-stu-id="bd709-183">With today’s modern graphics hardware, this model is relatively fast (which wasn’t the case when User32/ [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] were created).</span></span>  
  
 <span data-ttu-id="bd709-184">以前は、中核となる考え方を説明したように[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プログラミングより宣言型「プロパティを中心とした」モデルに移動することです。</span><span class="sxs-lookup"><span data-stu-id="bd709-184">As mentioned previously, a core philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is to move to a more declarative, "property centric" model of programming.</span></span> <span data-ttu-id="bd709-185">ビジュアルのシステムでは、これは表示されます興味深い部分はいくつかあります。</span><span class="sxs-lookup"><span data-stu-id="bd709-185">In the visual system, this shows up in a couple of interesting places.</span></span>  
  
 <span data-ttu-id="bd709-186">最初に、保持モード グラフィックス システムに関する場合は、これは本当に、命令型の DrawLine/DrawLine 型モデルからモデルへの移行、データ指向 – 新しい行 ()/新しい Line() します。</span><span class="sxs-lookup"><span data-stu-id="bd709-186">First, if you think about the retained mode graphic system, this is really moving away from an imperative DrawLine/DrawLine type model, to a data oriented model – new Line()/new Line().</span></span> <span data-ttu-id="bd709-187">データ ドリブンのレンダリングには、この移動は、複雑な操作を表すプロパティを使用して描画命令にできます。</span><span class="sxs-lookup"><span data-stu-id="bd709-187">This move to data driven rendering allows complex operations on the drawing instructions to be expressed using properties.</span></span> <span data-ttu-id="bd709-188">派生する型<xref:System.Windows.Media.Drawing>表示オブジェクト モデルでは実質的にします。</span><span class="sxs-lookup"><span data-stu-id="bd709-188">The types deriving from <xref:System.Windows.Media.Drawing> are effectively the object model for rendering.</span></span>  
  
 <span data-ttu-id="bd709-189">次に、アニメーション システムを評価する場合に、ほぼ完全な宣言型であるが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-189">Second, if you evaluate the animation system, you'll see that it is almost completely declarative.</span></span> <span data-ttu-id="bd709-190">次の場所、または次の色を計算する開発者を要求するには、代わりには、アニメーション オブジェクトのプロパティのセットとしてアニメーションを表現できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-190">Instead of requiring a developer to compute the next location, or next color, you can express animations as a set of properties on an animation object.</span></span> <span data-ttu-id="bd709-191">これらのアニメーションは、開発者やデザイナーの意図を表現できます (このボタンをクリックここからに移動が 5 秒間)、システムはこれを実現する最も効率的な方法を決定したりします。</span><span class="sxs-lookup"><span data-stu-id="bd709-191">These animations can then express the intent of the developer or designer (move this button from here to there in 5 seconds), and the system can determine the most efficient way to accomplish that.</span></span>  
  
<a name="System_Windows_UIElement"></a>   
## <a name="systemwindowsuielement"></a><span data-ttu-id="bd709-192">System.Windows.UIElement</span><span class="sxs-lookup"><span data-stu-id="bd709-192">System.Windows.UIElement</span></span>  
 <span data-ttu-id="bd709-193"><xref:System.Windows.UIElement> レイアウト、入力、およびイベントを含むコア サブシステムを定義します。</span><span class="sxs-lookup"><span data-stu-id="bd709-193"><xref:System.Windows.UIElement> defines core subsystems including Layout, Input, and Events.</span></span>  
  
 <span data-ttu-id="bd709-194">レイアウトの中核となる概念は、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-194">Layout is a core concept in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="bd709-195">多くのシステムでは、モデルのレイアウトの固定のセット (HTML では、レイアウトの 3 つのモデルがサポートしています。 フロー、絶対、およびテーブル) またはレイアウトのモデルのない (User32 だけでは絶対配置)。</span><span class="sxs-lookup"><span data-stu-id="bd709-195">In many systems there is either a fixed set of layout models (HTML supports three models for layout; flow, absolute, and tables) or no model for layout (User32 really only supports absolute positioning).</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-196">開発者および設計者が、命令型のロジックではなく、プロパティの値で制御できる、柔軟で拡張性の高いレイアウト モデルを求めていることを想定して開始します。</span><span class="sxs-lookup"><span data-stu-id="bd709-196">started with the assumption that developers and designers wanted a flexible, extensible layout model, which could be driven by property values rather than imperative logic.</span></span> <span data-ttu-id="bd709-197"><xref:System.Windows.UIElement>レベル、レイアウトの基本的なコントラクトが導入 – でモデルをフェーズ 2<xref:System.Windows.UIElement.Measure%2A>と<xref:System.Windows.UIElement.Arrange%2A>を渡します。</span><span class="sxs-lookup"><span data-stu-id="bd709-197">At the <xref:System.Windows.UIElement> level, the basic contract for layout is introduced – a two phase model with <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> passes.</span></span>  
  
 <span data-ttu-id="bd709-198"><xref:System.Windows.UIElement.Measure%2A> により、コンポーネントを実行するどの程度のサイズを決定できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-198"><xref:System.Windows.UIElement.Measure%2A> allows a component to determine how much size it would like to take.</span></span> <span data-ttu-id="bd709-199">これは、別のフェーズから<xref:System.Windows.UIElement.Arrange%2A>が多くの場合の最適な位置とサイズを決定するいくつかの時間を測定する子を親要素が求められます。</span><span class="sxs-lookup"><span data-stu-id="bd709-199">This is a separate phase from <xref:System.Windows.UIElement.Arrange%2A> because there are many situations where a parent element will ask a child to measure several times to determine its optimal position and size.</span></span> <span data-ttu-id="bd709-200">親要素が子要素を測定するよう要求するという事実がもう 1 つの重要な理念を示します[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– コンテンツのサイズ。</span><span class="sxs-lookup"><span data-stu-id="bd709-200">The fact that parent elements ask child elements to measure demonstrates another key philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – size to content.</span></span> <span data-ttu-id="bd709-201">すべてのコントロール[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]サイズがコンテンツの通常サイズにする機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="bd709-201">All controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] support the ability to size to the natural size of their content.</span></span> <span data-ttu-id="bd709-202">これにより、ローカライズをより簡単と、項目のサイズ変更、要素の動的レイアウトできます。</span><span class="sxs-lookup"><span data-stu-id="bd709-202">This makes localization much easier, and allows for dynamic layout of elements as things resize.</span></span> <span data-ttu-id="bd709-203"><xref:System.Windows.UIElement.Arrange%2A>フェーズでは、親を配置し、それぞれの子の最終サイズを決定します。</span><span class="sxs-lookup"><span data-stu-id="bd709-203">The <xref:System.Windows.UIElement.Arrange%2A> phase allows a parent to position and determine the final size of each child.</span></span>  
  
 <span data-ttu-id="bd709-204">多くの時間は、出力側の話に費やされた多くの場合、 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] –<xref:System.Windows.Media.Visual>および関連するオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="bd709-204">A lot of time is often spent talking about the output side of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – <xref:System.Windows.Media.Visual> and related objects.</span></span> <span data-ttu-id="bd709-205">ただしも入力側で大量のイノベーションがあります。</span><span class="sxs-lookup"><span data-stu-id="bd709-205">However there is a tremendous amount of innovation on the input side as well.</span></span> <span data-ttu-id="bd709-206">入力モデルで最も基本的な変更ではおそらく[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]はシステムを経由する入力イベントのルーティング、一貫性のあるモデルです。</span><span class="sxs-lookup"><span data-stu-id="bd709-206">Probably the most fundamental change in the input model for [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the consistent model by which input events are routed through the system.</span></span>  
  
 <span data-ttu-id="bd709-207">入力は、カーネル モード デバイス ドライバーのシグナルとして開始され、正しいプロセスと Windows カーネルと User32 が関係する複雑なプロセスのスレッドにルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="bd709-207">Input originates as a signal on a kernel mode device driver and gets routed to the correct process and thread through an intricate process involving the Windows kernel and User32.</span></span> <span data-ttu-id="bd709-208">入力に対応する User32 メッセージにルーティングされると[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]に変換されます、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]未加工入力メッセージと、ディスパッチャーに送信します。</span><span class="sxs-lookup"><span data-stu-id="bd709-208">Once the User32 message corresponding to the input is routed to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], it is converted into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] raw input message and sent to the dispatcher.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-209">生の入力イベント配信の保証とシステムの低レベルで実装するには、"MouseEnter"などの機能を有効にする、実際の複数のイベントに変換できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-209">allows for raw input events to be converted to multiple actual events, enabling features like "MouseEnter" to be implemented at a low level of the system with guaranteed delivery.</span></span>  
  
 <span data-ttu-id="bd709-210">各入力イベントは、"preview"イベントと、実際のイベントには少なくとも 2 つのイベントに変換されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-210">Each input event is converted to at least two events – a "preview" event and the actual event.</span></span> <span data-ttu-id="bd709-211">すべてのイベント[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]要素ツリーを通じてルーティングの概念があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-211">All events in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] have a notion of routing through the element tree.</span></span> <span data-ttu-id="bd709-212">ルートにツリーをターゲットから走査、ルートで開始し、ターゲットまで走査、使用している「トンネル」と言われています"を"バブル イベントといいます。</span><span class="sxs-lookup"><span data-stu-id="bd709-212">Events are said to "bubble" if they traverse from a target up the tree to the root, and are said to "tunnel" if they start at the root and traverse down to a target.</span></span> <span data-ttu-id="bd709-213">ツリーをフィルター処理またはイベントに対してアクションを実行する機会の任意の要素を有効にすると、プレビュー イベントのトンネルを入力します。</span><span class="sxs-lookup"><span data-stu-id="bd709-213">Input preview events tunnel, enabling any element in the tree an opportunity to filter or take action on the event.</span></span> <span data-ttu-id="bd709-214">通常の (非プレビュー) のイベントは、ルートまでターゲットから、バブルします。</span><span class="sxs-lookup"><span data-stu-id="bd709-214">The regular (non-preview) events then bubble from the target up to the root.</span></span>  
  
 <span data-ttu-id="bd709-215">この分割トンネルとバブル フェーズの間では、キーボード アクセラレータは、複合の世界で一貫性のある方法で動作などの機能の実装です。</span><span class="sxs-lookup"><span data-stu-id="bd709-215">This split between the tunnel and bubble phase makes implementation of features like keyboard accelerators work in a consistent fashion in a composite world.</span></span> <span data-ttu-id="bd709-216">User32 でグローバル含む単一のテーブルをサポートするすべてのアクセラレータ (Ctrl + N の「新規」へのマッピング) することでキーボード アクセラレータを実装します。</span><span class="sxs-lookup"><span data-stu-id="bd709-216">In User32 you would implement keyboard accelerators by having a single global table containing all the accelerators you wanted to support (Ctrl+N mapping to "New").</span></span> <span data-ttu-id="bd709-217">呼び出すことは、アプリケーションのディスパッチャーで**TranslateAccelerator**は User32 で入力メッセージを傍受し、登録済みのアクセラレータが一致するかどうかはいずれかを判断します。</span><span class="sxs-lookup"><span data-stu-id="bd709-217">In the dispatcher for your application you would call **TranslateAccelerator** which would sniff the input messages in User32 and determine if any matched a registered accelerator.</span></span> <span data-ttu-id="bd709-218">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]システムが完全に「コンポーザブル」– 任意の要素を処理し、キーボード アクセラレータを使用できますので、これはうまくいきません。</span><span class="sxs-lookup"><span data-stu-id="bd709-218">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] this wouldn’t work because the system is fully "composable" – any element can handle and use any keyboard accelerator.</span></span> <span data-ttu-id="bd709-219">この 2 つのフェーズのモデルの入力を持つことはできますが独自の"TranslateAccelerator"を実装するコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="bd709-219">Having this two phase model for input allows components to implement their own "TranslateAccelerator".</span></span>  
  
 <span data-ttu-id="bd709-220">さらに、この 1 つの手順を実行する<xref:System.Windows.UIElement>も CommandBindings の概念が導入されています。</span><span class="sxs-lookup"><span data-stu-id="bd709-220">To take this one step further, <xref:System.Windows.UIElement> also introduces the notion of CommandBindings.</span></span> <span data-ttu-id="bd709-221">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]コマンド システムにより、開発者は何かのコマンドの終了ポイント – という観点から機能を定義する、実装する<xref:System.Windows.Input.ICommand>します。</span><span class="sxs-lookup"><span data-stu-id="bd709-221">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] command system allows developers to define functionality in terms of a command end point – something that implements <xref:System.Windows.Input.ICommand>.</span></span> <span data-ttu-id="bd709-222">コマンド バインディングには、入力ジェスチャ (Ctrl + N) とコマンドを (新規) 間のマッピングを定義する要素が有効にします。</span><span class="sxs-lookup"><span data-stu-id="bd709-222">Command bindings enable an element to define a mapping between an input gesture (Ctrl+N) and a command (New).</span></span> <span data-ttu-id="bd709-223">入力ジェスチャとコマンドの定義は拡張可能なおよび使用時にまとめることができます。</span><span class="sxs-lookup"><span data-stu-id="bd709-223">Both the input gestures and command definitions are extensible, and can be wired together at usage time.</span></span> <span data-ttu-id="bd709-224">これにより、たとえば、エンドユーザーがアプリケーション内で使用すると、キー バインドのカスタマイズを許可します。</span><span class="sxs-lookup"><span data-stu-id="bd709-224">This makes it trivial, for example, to allow an end user to customize the key bindings that they want to use within an application.</span></span>  
  
 <span data-ttu-id="bd709-225">このトピックの時点「コア」機能の[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– PresentationCore アセンブリに実装されている機能は、フォーカスされています。</span><span class="sxs-lookup"><span data-stu-id="bd709-225">To this point in the topic, "core" features of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – features implemented in the PresentationCore assembly, have been the focus.</span></span> <span data-ttu-id="bd709-226">構築するときに[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、基礎となる部分の間の分離のクリーンアップ (などのレイアウトでのコントラクト**メジャー**と**配置**) と (特定の実装などのフレームワーク要素ようなレイアウト<xref:System.Windows.Controls.Grid>) が目的の結果。</span><span class="sxs-lookup"><span data-stu-id="bd709-226">When building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a clean separation between foundational pieces (like the contract for layout with **Measure** and **Arrange**) and framework pieces (like the implementation of a specific layout like <xref:System.Windows.Controls.Grid>) was the desired outcome.</span></span> <span data-ttu-id="bd709-227">目標のために必要な場合は、独自のフレームワークを作成する外部の開発者は、スタックの低い機能拡張ポイントを提供することでした。</span><span class="sxs-lookup"><span data-stu-id="bd709-227">The goal was to provide an extensibility point low in the stack that would allow external developers to create their own frameworks if needed.</span></span>  
  
<a name="System_Windows_FrameworkElement"></a>   
## <a name="systemwindowsframeworkelement"></a><span data-ttu-id="bd709-228">System.Windows.FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="bd709-228">System.Windows.FrameworkElement</span></span>  
 <span data-ttu-id="bd709-229"><xref:System.Windows.FrameworkElement> 2 つの方法で参照できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-229"><xref:System.Windows.FrameworkElement> can be looked at in two different ways.</span></span> <span data-ttu-id="bd709-230">ポリシーとの下位層で導入されたサブシステムでのカスタマイズのセットが導入[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-230">It introduces a set of policies and customizations on the subsystems introduced in lower layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="bd709-231">一連の新しいサブシステムも導入されています。</span><span class="sxs-lookup"><span data-stu-id="bd709-231">It also introduces a set of new subsystems.</span></span>  
  
 <span data-ttu-id="bd709-232">導入されたプライマリ ポリシー<xref:System.Windows.FrameworkElement>アプリケーション レイアウトの周りが。</span><span class="sxs-lookup"><span data-stu-id="bd709-232">The primary policy introduced by <xref:System.Windows.FrameworkElement> is around application layout.</span></span> <span data-ttu-id="bd709-233"><xref:System.Windows.FrameworkElement> 導入された基本的なレイアウトのコントラクトに基づいて<xref:System.Windows.UIElement>レイアウト プロパティのレイアウトのセマンティクスを駆動型の一貫性のあるセットがレイアウトの作成者が簡単です「スロット」の概念を追加します。</span><span class="sxs-lookup"><span data-stu-id="bd709-233"><xref:System.Windows.FrameworkElement> builds on the basic layout contract introduced by <xref:System.Windows.UIElement> and adds the notion of a layout "slot" that makes it easier for layout authors to have a consistent set of property driven layout semantics.</span></span> <span data-ttu-id="bd709-234">などのプロパティ<xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>、 <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>、 <xref:System.Windows.FrameworkElement.MinWidth%2A>、および<xref:System.Windows.FrameworkElement.Margin%2A>(をいくつかの名前を付ける) から派生したすべてのコンポーネントを提供<xref:System.Windows.FrameworkElement>レイアウト コンテナー内で一貫性のある動作。</span><span class="sxs-lookup"><span data-stu-id="bd709-234">Properties like <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>, <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>, <xref:System.Windows.FrameworkElement.MinWidth%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A> (to name a few) give all components derived from <xref:System.Windows.FrameworkElement> consistent behavior inside of layout containers.</span></span>  
  
 <span data-ttu-id="bd709-235"><xref:System.Windows.FrameworkElement> 簡単に用意されています[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]の基本レイヤーについては、多くの機能への露出[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-235"><xref:System.Windows.FrameworkElement> also provides easier [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure to many features found in the core layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="bd709-236">たとえば、<xref:System.Windows.FrameworkElement>アニメーションに直接アクセスできる、<xref:System.Windows.FrameworkElement.BeginStoryboard%2A>メソッド。</span><span class="sxs-lookup"><span data-stu-id="bd709-236">For example, <xref:System.Windows.FrameworkElement> provides direct access to animation through the <xref:System.Windows.FrameworkElement.BeginStoryboard%2A> method.</span></span> <span data-ttu-id="bd709-237">A<xref:System.Windows.Media.Animation.Storyboard>プロパティのセットに対して複数のアニメーションのスクリプトを作成する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-237">A <xref:System.Windows.Media.Animation.Storyboard> provides a way to script multiple animations against a set of properties.</span></span>  
  
 <span data-ttu-id="bd709-238">2 つの最も重要なことを<xref:System.Windows.FrameworkElement>紹介はデータ バインドとスタイル。</span><span class="sxs-lookup"><span data-stu-id="bd709-238">The two most critical things that <xref:System.Windows.FrameworkElement> introduces are data binding and styles.</span></span>  
  
 <span data-ttu-id="bd709-239">データ バインディング サブシステム[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]が使用するユーザーにとって比較的馴染みがある[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]または[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]アプリケーションを作成する[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-239">The data binding subsystem in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] should be relatively familiar to anyone that has used [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)] for creating an application [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="bd709-240">これらのシステムの各でのデータにバインドする指定された要素から 1 つまたは複数のプロパティをすることを表現する簡単な方法があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-240">In each of these systems, there is a simple way to express that you want one or more properties from a given element to be bound to a piece of data.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-241">プロパティのバインド、変換、およびリストのバインドを完全にサポートしています。</span><span class="sxs-lookup"><span data-stu-id="bd709-241">has full support for property binding, transformation, and list binding.</span></span>  
  
 <span data-ttu-id="bd709-242">データ バインディングの最も興味深い機能の 1 つ[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]データ テンプレートの導入です。</span><span class="sxs-lookup"><span data-stu-id="bd709-242">One of the most interesting features of data binding in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the introduction of data templates.</span></span> <span data-ttu-id="bd709-243">データ テンプレートを使用して、データを視覚化する方法を宣言によって指定できます。</span><span class="sxs-lookup"><span data-stu-id="bd709-243">Data templates allow you to declaratively specify how a piece of data should be visualized.</span></span> <span data-ttu-id="bd709-244">データにバインドできるカスタム ユーザー インターフェイスを作成する代わりに代わりに問題を有効にし、データが作成される表示を決定できるようにできます。</span><span class="sxs-lookup"><span data-stu-id="bd709-244">Instead of creating a custom user interface that can be bound to data, you can instead turn the problem around and let the data determine the display that will be created.</span></span>  
  
 <span data-ttu-id="bd709-245">スタイル設定は、簡易形式のデータ バインディングです。</span><span class="sxs-lookup"><span data-stu-id="bd709-245">Styling is really a lightweight form of data binding.</span></span> <span data-ttu-id="bd709-246">スタイルを使用するのにバインドできますプロパティのセットを共有定義の要素の 1 つまたは複数のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="bd709-246">Using styling you can bind a set of properties from a shared definition to one or more instances of an element.</span></span> <span data-ttu-id="bd709-247">要素に適用されるスタイルを明示的に参照するか (設定して、<xref:System.Windows.FrameworkElement.Style%2A>プロパティ) のスタイルを関連付けることによって暗黙的にまたは、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]要素の型。</span><span class="sxs-lookup"><span data-stu-id="bd709-247">Styles get applied to an element either by explicit reference (by setting the <xref:System.Windows.FrameworkElement.Style%2A> property) or implicitly by associating a style with the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] type of the element.</span></span>  
  
<a name="System_Windows_Controls_Control"></a>   
## <a name="systemwindowscontrolscontrol"></a><span data-ttu-id="bd709-248">System.Windows.Controls.Control</span><span class="sxs-lookup"><span data-stu-id="bd709-248">System.Windows.Controls.Control</span></span>  
 <span data-ttu-id="bd709-249">コントロールの最も重要な機能とは、テンプレートです。</span><span class="sxs-lookup"><span data-stu-id="bd709-249">Control’s most significant feature is templating.</span></span> <span data-ttu-id="bd709-250">保持モードのレンダリング システムとしての WPF のコンポジション システムについて考えると、テンプレートには、パラメーター化された宣言型の方法で、レンダリングを記述するコントロールができるようにします。</span><span class="sxs-lookup"><span data-stu-id="bd709-250">If you think about WPF’s composition system as a retained mode rendering system, templating allows a control to describe its rendering in a parameterized, declarative manner.</span></span> <span data-ttu-id="bd709-251">A<xref:System.Windows.Controls.ControlTemplate>実際には、コントロールによって提供されるプロパティへのバインドで一連の子要素を作成するスクリプトにすぎません。</span><span class="sxs-lookup"><span data-stu-id="bd709-251">A <xref:System.Windows.Controls.ControlTemplate> is really nothing more than a script to create a set of child elements, with bindings to properties offered by the control.</span></span>  
  
 <span data-ttu-id="bd709-252"><xref:System.Windows.Controls.Control> ストック プロパティのセットを提供します<xref:System.Windows.Controls.Control.Foreground%2A>、 <xref:System.Windows.Controls.Control.Background%2A>、<xref:System.Windows.Controls.Control.Padding%2A>テンプレートの作成者がコントロールの表示のカスタマイズを使用できる、いくつかの名前。</span><span class="sxs-lookup"><span data-stu-id="bd709-252"><xref:System.Windows.Controls.Control> provides a set of stock properties, <xref:System.Windows.Controls.Control.Foreground%2A>, <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Padding%2A>, to name a few, which template authors can then use to customize the display of a control.</span></span> <span data-ttu-id="bd709-253">コントロールの実装では、データ モデルと対話モデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-253">The implementation of a control provides a data model and interaction model.</span></span> <span data-ttu-id="bd709-254">対話モデルでは、(ウィンドウの隅に赤い X 印をクリックする) などのジェスチャを入力するには、(ウィンドウを閉じる) のようなコマンドとバインディングのセットを定義します。</span><span class="sxs-lookup"><span data-stu-id="bd709-254">The interaction model defines a set of commands (like Close for a window) and bindings to input gestures (like clicking the red X in the upper corner of the window).</span></span> <span data-ttu-id="bd709-255">データ モデルでは、相互作用モデルをカスタマイズまたは (テンプレートによって決まります) の表示をカスタマイズするプロパティのセットを提供します。</span><span class="sxs-lookup"><span data-stu-id="bd709-255">The data model provides a set of properties to either customize the interaction model or customize the display (determined by the template).</span></span>  
  
 <span data-ttu-id="bd709-256">データ モデル (プロパティ)、相互作用モデル (コマンドとイベント)、および表示モデル (テンプレート) の間には、この分割により、コントロールの外観と動作のカスタマイズを完了します。</span><span class="sxs-lookup"><span data-stu-id="bd709-256">This split between the data model (properties), interaction model (commands and events), and display model (templates) enables complete customization of a control’s look and behavior.</span></span>  
  
 <span data-ttu-id="bd709-257">コントロールのデータ モデルの一般的な側面は、コンテンツ モデルです。</span><span class="sxs-lookup"><span data-stu-id="bd709-257">A common aspect of the data model of controls is the content model.</span></span> <span data-ttu-id="bd709-258">などのコントロールを見る場合<xref:System.Windows.Controls.Button>、型の場合は"Content"という名前のプロパティを使用しているが表示されます<xref:System.Object>します。</span><span class="sxs-lookup"><span data-stu-id="bd709-258">If you look at a control like <xref:System.Windows.Controls.Button>, you will see that it has a property named "Content" of type <xref:System.Object>.</span></span> <span data-ttu-id="bd709-259">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]と[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]、このプロパティは文字列である通常 – ボタンに配置することができますが、コンテンツの種類を制限します。</span><span class="sxs-lookup"><span data-stu-id="bd709-259">In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)], this property would typically be a string – however that limits the type of content you can put in a button.</span></span> <span data-ttu-id="bd709-260">ボタンのコンテンツか単純な文字列、または指定できます、複雑なデータ オブジェクト全体の要素ツリー。</span><span class="sxs-lookup"><span data-stu-id="bd709-260">Content for a button can either be a simple string, a complex data object, or an entire element tree.</span></span> <span data-ttu-id="bd709-261">データ オブジェクトの場合は、データ テンプレートは、表示の構築に使用されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-261">In the case of a data object, the data template is used to construct a display.</span></span>  
  
<a name="Summary"></a>   
## <a name="summary"></a><span data-ttu-id="bd709-262">まとめ</span><span class="sxs-lookup"><span data-stu-id="bd709-262">Summary</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="bd709-263">データ ドリブン プレゼンテーション システムを動的に作成できるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="bd709-263">is designed to allow you to create dynamic, data driven presentation systems.</span></span> <span data-ttu-id="bd709-264">プロパティ セットを通じてオブジェクトを作成するには、動作を制御するには、システムのすべての部分は設計されています。</span><span class="sxs-lookup"><span data-stu-id="bd709-264">Every part of the system is designed to create objects through property sets that drive behavior.</span></span> <span data-ttu-id="bd709-265">データ バインディングは、システムの基本的な部分は、され、すべてのレイヤーで統合されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-265">Data binding is a fundamental part of the system, and is integrated at every layer.</span></span>  
  
 <span data-ttu-id="bd709-266">従来のアプリケーションでは、表示を作成し、いくつかのデータにバインドします。</span><span class="sxs-lookup"><span data-stu-id="bd709-266">Traditional applications create a display and then bind to some data.</span></span> <span data-ttu-id="bd709-267">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、何らかの種類のデータ バインディングによって生成されるコントロール、ディスプレイのすべての側面に関するすべてのものです。</span><span class="sxs-lookup"><span data-stu-id="bd709-267">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], everything about the control, every aspect of the display, is generated by some type of data binding.</span></span> <span data-ttu-id="bd709-268">ボタンの内側にあるテキストは、ボタンの内部で構成されるコントロールを作成し、その表示をボタンの content プロパティにバインドして表示されます。</span><span class="sxs-lookup"><span data-stu-id="bd709-268">The text found inside a button is displayed by creating a composed control inside of the button and binding its display to the button’s content property.</span></span>  
  
 <span data-ttu-id="bd709-269">開発を開始すると、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]ベースのアプリケーションでは、非常によくと考える必要があります。</span><span class="sxs-lookup"><span data-stu-id="bd709-269">When you begin developing [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] based applications, it should feel very familiar.</span></span> <span data-ttu-id="bd709-270">オブジェクトを使用して、すべてのプロパティを設定することができ、データ バインドで同じ方法を使用できる[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]または[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="bd709-270">You can set properties, use objects, and data bind in much the same way that you can using [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)].</span></span> <span data-ttu-id="bd709-271">アーキテクチャにさらに調査すると[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、根本的に、アプリケーションの中核となるドライバーとしてデータを処理するより充実したアプリケーションを作成するためにできる可能性があることがわかります。</span><span class="sxs-lookup"><span data-stu-id="bd709-271">With a deeper investigation into the architecture of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you'll find that the possibility exists for creating much richer applications that fundamentally treat data as the core driver of the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bd709-272">関連項目</span><span class="sxs-lookup"><span data-stu-id="bd709-272">See also</span></span>
- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.UIElement>
- <xref:System.Windows.Input.ICommand>
- <xref:System.Windows.FrameworkElement>
- <xref:System.Windows.Threading.DispatcherObject>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Controls.Control>
- [<span data-ttu-id="bd709-273">データ バインディングの概要</span><span class="sxs-lookup"><span data-stu-id="bd709-273">Data Binding Overview</span></span>](../data/data-binding-overview.md)
- [<span data-ttu-id="bd709-274">レイアウト</span><span class="sxs-lookup"><span data-stu-id="bd709-274">Layout</span></span>](layout.md)
- [<span data-ttu-id="bd709-275">アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="bd709-275">Animation Overview</span></span>](../graphics-multimedia/animation-overview.md)
