---
title: WPF アーキテクチャ
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-wpf
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- properties [WPF], attached
- attached properties [WPF]
- architecture [WPF]
- unmanaged components [WPF]
- affinity thread [WPF]
- Storyboards [WPF]
- milcore [WPF]
- components [WPF], unmanaged
- painter's algorithm
- interfaces [WPF], INotifyPropertyChange
- CommandBindings [WPF]
- data templates [WPF]
- thread [WPF], affinity
ms.assetid: 8579c10b-76ab-4c52-9691-195ce02333c8
caps.latest.revision: 17
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 29c8e2d632c37a299389b1bdc7f3f19f7df2f7e7
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/30/2018
---
# <a name="wpf-architecture"></a><span data-ttu-id="a785f-102">WPF アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="a785f-102">WPF Architecture</span></span>
<span data-ttu-id="a785f-103">このトピックでは、Windows Presentation Foundation (WPF) のクラス階層のガイド付きツアーを提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-103">This topic provides a guided tour of the Windows Presentation Foundation (WPF) class hierarchy.</span></span> <span data-ttu-id="a785f-104">主要なサブシステムのほとんどをカバー [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、それらの相互作用について説明します。</span><span class="sxs-lookup"><span data-stu-id="a785f-104">It covers most of the major subsystems of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], and describes how they interact.</span></span> <span data-ttu-id="a785f-105">いくつかの設計担当者が行った選択の表示[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-105">It also details some of the choices made by the architects of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span>  
  
  
<a name="System_Object"></a>   
## <a name="systemobject"></a><span data-ttu-id="a785f-106">System.Object</span><span class="sxs-lookup"><span data-stu-id="a785f-106">System.Object</span></span>  
 <span data-ttu-id="a785f-107">プライマリ[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プログラミング モデルがマネージ コードによって公開されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-107">The primary [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] programming model is exposed through managed code.</span></span> <span data-ttu-id="a785f-108">設計フェーズの早い段階で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]システムのマネージ コンポーネントとアンマネージ コンポーネントとの間の線を描画する場所に関する議論の数が発生しました。</span><span class="sxs-lookup"><span data-stu-id="a785f-108">Early in the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] there were a number of debates about where the line should be drawn between the managed components of the system and the unmanaged ones.</span></span> <span data-ttu-id="a785f-109">[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]より生産的かつ (メモリ管理、エラー処理、共通型システムなど) を含む堅牢な開発を構成する機能のいくつか提供コストで送られてきたが、します。</span><span class="sxs-lookup"><span data-stu-id="a785f-109">The [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides a number of features that make development more productive and robust (including memory management, error handling, common type system, etc.) but they come at a cost.</span></span>  
  
 <span data-ttu-id="a785f-110">主要コンポーネント[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]下の図に示します。</span><span class="sxs-lookup"><span data-stu-id="a785f-110">The major components of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are illustrated in the figure below.</span></span> <span data-ttu-id="a785f-111">ダイアグラム (PresentationFramework、PresentationCore、および milcore) の赤のセクションでは、主要なコードの特定の部分は、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-111">The red sections of the diagram (PresentationFramework, PresentationCore, and milcore) are the major code portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="a785f-112">これらは、1 つだけです。 アンマネージ コンポーネント – milcore です。</span><span class="sxs-lookup"><span data-stu-id="a785f-112">Of these, only one is an unmanaged component – milcore.</span></span> <span data-ttu-id="a785f-113">Milcore が緊密に統合を有効にするためにアンマネージ コードで記述された[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-113">Milcore is written in unmanaged code in order to enable tight integration with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)].</span></span> <span data-ttu-id="a785f-114">すべて表示[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]はを通じて行われます、[!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)]エンジン、効率的なハードウェアとソフトウェア レンダリングを許可します。</span><span class="sxs-lookup"><span data-stu-id="a785f-114">All display in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is done through the [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] engine, allowing for efficient hardware and software rendering.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-115"> メモリと実行を細かく制御を必要もあります。</span><span class="sxs-lookup"><span data-stu-id="a785f-115"> also required fine control over memory and execution.</span></span> <span data-ttu-id="a785f-116">Milcore 合成エンジンが機密性の高い、必要と多くの利点のパフォーマンスでは非常に高く、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]パフォーマンスを確保します。</span><span class="sxs-lookup"><span data-stu-id="a785f-116">The composition engine in milcore is extremely performance sensitive, and required giving up many advantages of the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] to gain performance.</span></span>  
  
 <span data-ttu-id="a785f-117">![.NET Framework 内での WPF の位置。] (../../../../docs/framework/wpf/advanced/media/wpf-architect1.PNG "wpf_architect1")</span><span class="sxs-lookup"><span data-stu-id="a785f-117">![The position of WPF within the .NET Framework.](../../../../docs/framework/wpf/advanced/media/wpf-architect1.PNG "wpf_architect1")</span></span>  
  
 <span data-ttu-id="a785f-118">マネージ コードとアンマネージの部分の間の通信[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]はこのトピックの後半で説明します。</span><span class="sxs-lookup"><span data-stu-id="a785f-118">Communication between the managed and unmanaged portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is discussed later in this topic.</span></span> <span data-ttu-id="a785f-119">マネージ プログラミング モデルの残りの部分は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="a785f-119">The remainder of the managed programming model is described below.</span></span>  
  
<a name="System_Threading_DispatcherObject"></a>   
## <a name="systemthreadingdispatcherobject"></a><span data-ttu-id="a785f-120">System.Threading.DispatcherObject</span><span class="sxs-lookup"><span data-stu-id="a785f-120">System.Threading.DispatcherObject</span></span>  
 <span data-ttu-id="a785f-121">多くのオブジェクトに[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]から派生<xref:System.Windows.Threading.DispatcherObject>、同時実行を処理して、スレッド処理の基本的な構造を提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-121">Most objects in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] derive from <xref:System.Windows.Threading.DispatcherObject>, which provides the basic constructs for dealing with concurrency and threading.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-122"> ディスパッチャーによって実装されたメッセージング システムに基づいています。</span><span class="sxs-lookup"><span data-stu-id="a785f-122"> is based on a messaging system implemented by the dispatcher.</span></span> <span data-ttu-id="a785f-123">これは同様に機能、使い慣れた[!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]メッセージ ポンプ以外の場合は実際には、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]ディスパッチャーが User32 メッセージをクロス スレッド呼び出しを実行するために使用します。</span><span class="sxs-lookup"><span data-stu-id="a785f-123">This works much like the familiar [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] message pump; in fact, the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dispatcher uses User32 messages for performing cross thread calls.</span></span>  
  
 <span data-ttu-id="a785f-124">本当に 2 つのコアで同時実行を検討する場合を理解しておくべき概念がある[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– ディスパッチャーとスレッド関係。</span><span class="sxs-lookup"><span data-stu-id="a785f-124">There are really two core concepts to understand when discussing concurrency in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – the dispatcher and thread affinity.</span></span>  
  
 <span data-ttu-id="a785f-125">デザイン フェーズ中に[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]目標、実行の 1 つのスレッドに移動することでしたが、非スレッド「関連付け」モデル。</span><span class="sxs-lookup"><span data-stu-id="a785f-125">During the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the goal was to move to a single thread of execution, but a non-thread "affinitized" model.</span></span> <span data-ttu-id="a785f-126">スレッドの関係は、コンポーネントの状態を保存するために実行中のスレッドの id を使用するときに発生します。</span><span class="sxs-lookup"><span data-stu-id="a785f-126">Thread affinity happens when a component uses the identity of the executing thread to store some type of state.</span></span> <span data-ttu-id="a785f-127">最も一般的な形式では、状態を格納する、スレッド ローカル ストア (TLS) を使用します。</span><span class="sxs-lookup"><span data-stu-id="a785f-127">The most common form of this is to use the thread local store (TLS) to store state.</span></span> <span data-ttu-id="a785f-128">スレッドの関係は、実行の各論理スレッドの所有大量のメモリになることがオペレーティング システムの物理スレッドの 1 つだけである必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-128">Thread affinity requires that each logical thread of execution be owned by only one physical thread in the operating system, which can become memory intensive.</span></span> <span data-ttu-id="a785f-129">最後に、WPF のスレッド モデルはスレッド アフィニティを使用して 1 つのスレッド実行の既存の User32 スレッド モデルとの同期が保持されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-129">In the end, WPF’s threading model was kept in sync with the existing User32 threading model of single threaded execution with thread affinity.</span></span> <span data-ttu-id="a785f-130">これの主な理由が相互運用性 – などのシステム[!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)]クリップボード、および Internet Explorer のすべて 1 つのスレッド (STA) のアフィニティの実行を必要とします。</span><span class="sxs-lookup"><span data-stu-id="a785f-130">The primary reason for this was interoperability – systems like [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], the clipboard, and Internet Explorer all require single thread affinity (STA) execution.</span></span>  
  
 <span data-ttu-id="a785f-131">STA スレッドを持つオブジェクトがある場合は、ある必要があります、スレッド間で通信を検証する方法は、正しいスレッド上にあります。</span><span class="sxs-lookup"><span data-stu-id="a785f-131">Given that you have objects with STA threading, you need a way to communicate between threads, and validate that you are on the correct thread.</span></span> <span data-ttu-id="a785f-132">ディスパッチャーの役割が生じます。</span><span class="sxs-lookup"><span data-stu-id="a785f-132">Herein lies the role of the dispatcher.</span></span> <span data-ttu-id="a785f-133">ディスパッチャーは、複数の優先順位の高いキューでのシステムをディスパッチする基本的なメッセージです。</span><span class="sxs-lookup"><span data-stu-id="a785f-133">The dispatcher is a basic message dispatching system, with multiple prioritized queues.</span></span> <span data-ttu-id="a785f-134">メッセージの例には、生の入力通知 (マウスの移動)、framework 機能 (レイアウト)、またはユーザー コマンドが含まれます (このメソッドを実行) します。</span><span class="sxs-lookup"><span data-stu-id="a785f-134">Examples of messages include raw input notifications (mouse moved), framework functions (layout), or user commands (execute this method).</span></span> <span data-ttu-id="a785f-135">派生することによって<xref:System.Windows.Threading.DispatcherObject>、作成する、 [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] STA 動作を持つオブジェクトおよびに割り当てられる、ポインター、ディスパッチャーの作成時にします。</span><span class="sxs-lookup"><span data-stu-id="a785f-135">By deriving from <xref:System.Windows.Threading.DispatcherObject>, you create a [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] object that has STA behavior, and will be given a pointer to a dispatcher at creation time.</span></span>  
  
<a name="System_Windows_DependencyObject"></a>   
## <a name="systemwindowsdependencyobject"></a><span data-ttu-id="a785f-136">System.Windows.DependencyObject</span><span class="sxs-lookup"><span data-stu-id="a785f-136">System.Windows.DependencyObject</span></span>  
 <span data-ttu-id="a785f-137">ビルドで使用されるプライマリ アーキテクチャ理念のいずれかの[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティの設定をしたメソッドまたはイベント上にあります。</span><span class="sxs-lookup"><span data-stu-id="a785f-137">One of the primary architectural philosophies used in building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] was a preference for properties over methods or events.</span></span> <span data-ttu-id="a785f-138">プロパティは宣言型であり、アクションではなくの目的を簡単を指定すると、詳細が許可されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-138">Properties are declarative and allow you to more easily specify intent instead of action.</span></span> <span data-ttu-id="a785f-139">これは、モデル ドリブン、またはデータ ドリブン、ユーザー インターフェイスのコンテンツを表示するためのシステムにもサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a785f-139">This also supported a model driven, or data driven, system for displaying user interface content.</span></span> <span data-ttu-id="a785f-140">この方針には、意図された効果をする可能性があります、バインドするアプリケーションの動作をより細かく制御するために他のプロパティを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-140">This philosophy had the intended effect of creating more properties that you could bind to, in order to better control the behavior of an application.</span></span>  
  
 <span data-ttu-id="a785f-141">高度なプロパティ システムのプロパティによって、システムの詳細を確保するため、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]提供が必要でした。</span><span class="sxs-lookup"><span data-stu-id="a785f-141">In order to have more of the system driven by properties, a richer property system than what the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides was needed.</span></span> <span data-ttu-id="a785f-142">この機能の簡単な例は、変更通知です。</span><span class="sxs-lookup"><span data-stu-id="a785f-142">A simple example of this richness is change notifications.</span></span> <span data-ttu-id="a785f-143">双方向バインディングを有効にするために、変更通知をサポートするバインドの両方の側を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-143">In order to enable two way binding, you need both sides of the bind to support change notification.</span></span> <span data-ttu-id="a785f-144">プロパティの値に関連付けられている動作するために、プロパティ値が変更されたときに通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-144">In order to have behavior tied to property values, you need to be notified when the property value changes.</span></span> <span data-ttu-id="a785f-145">[!INCLUDE[TLA#tla_netframewk](../../../../includes/tlasharptla-netframewk-md.md)]インターフェイスを持つ**INotifyPropertyChange**、ただし、これは省略可能な変更通知を発行するオブジェクトを許可します。</span><span class="sxs-lookup"><span data-stu-id="a785f-145">The [!INCLUDE[TLA#tla_netframewk](../../../../includes/tlasharptla-netframewk-md.md)] has an interface, **INotifyPropertyChange**, which allows an object to publish change notifications, however it is optional.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-146"> 派生したより豊富なプロパティ システムを提供、<xref:System.Windows.DependencyObject>型です。</span><span class="sxs-lookup"><span data-stu-id="a785f-146"> provides a richer property system, derived from the <xref:System.Windows.DependencyObject> type.</span></span> <span data-ttu-id="a785f-147">プロパティ システムは、プロパティ式間の依存関係の追跡、依存関係を変更するときに、プロパティの値を自動的に再評価という点で、「依存関係」プロパティのシステムでは真です。</span><span class="sxs-lookup"><span data-stu-id="a785f-147">The property system is truly a "dependency" property system in that it tracks dependencies between property expressions and automatically revalidates property values when dependencies change.</span></span> <span data-ttu-id="a785f-148">継承したプロパティがある場合など (と同様に<xref:System.Windows.Controls.Control.FontSize%2A>)、値を継承する要素の親のプロパティが変更された場合、システムが自動的に更新します。</span><span class="sxs-lookup"><span data-stu-id="a785f-148">For example, if you have a property that inherits (like <xref:System.Windows.Controls.Control.FontSize%2A>), the system is automatically updated if the property changes on a parent of an element that inherits the value.</span></span>  
  
 <span data-ttu-id="a785f-149">基盤となる、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティ システムは、プロパティ式の概念です。</span><span class="sxs-lookup"><span data-stu-id="a785f-149">The foundation of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] property system is the concept of a property expression.</span></span> <span data-ttu-id="a785f-150">この最初のリリースの[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プロパティ式システムは閉じられ、式はすべて、framework の一部として提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-150">In this first release of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the property expression system is closed, and the expressions are all provided as part of the framework.</span></span> <span data-ttu-id="a785f-151">式は、プロパティのシステムは、データ バインディング、スタイル設定がないか、継承ハード コード化されたがフレームワーク内のそれ以降のレイヤーによって提供されるではなく理由です。</span><span class="sxs-lookup"><span data-stu-id="a785f-151">Expressions are why the property system doesn’t have data binding, styling, or inheritance hard coded, but rather provided by later layers within the framework.</span></span>  
  
 <span data-ttu-id="a785f-152">プロパティのシステムでは、プロパティ値のスパース ストレージも提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-152">The property system also provides for sparse storage of property values.</span></span> <span data-ttu-id="a785f-153">オブジェクトは、数十個 (ない場合数百台) のプロパティを持つことができますの値が既定の状態であるため (スタイルで設定を継承など)、オブジェクトのすべてのインスタンスを完全に定義されているすべてのプロパティの重みをおく必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-153">Because objects can have dozens (if not hundreds) of properties, and most of the values are in their default state (inherited, set by styles, etc.), not every instance of an object needs to have the full weight of every property defined on it.</span></span>  
  
 <span data-ttu-id="a785f-154">プロパティ システムの最終的な新しい機能は、添付プロパティの概念です。</span><span class="sxs-lookup"><span data-stu-id="a785f-154">The final new feature of the property system is the notion of attached properties.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-155"> 要素は、構成とコンポーネントの再利用の原則に基づいて構築されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-155"> elements are built on the principle of composition and component reuse.</span></span> <span data-ttu-id="a785f-156">多くの場合、大文字と小文字の一部の要素を含む (と同様に、<xref:System.Windows.Controls.Grid>レイアウト要素) (行/列の情報) のような動作を制御する子要素の追加のデータが必要です。</span><span class="sxs-lookup"><span data-stu-id="a785f-156">It is often the case that some containing element (like a <xref:System.Windows.Controls.Grid> layout element) needs additional data on child elements to control its behavior (like the Row/Column information).</span></span> <span data-ttu-id="a785f-157">これらすべてのプロパティを関連付けると、すべての要素を代わりに任意のオブジェクトが許可されたその他のオブジェクトのプロパティ定義を提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-157">Instead of associating all of these properties with every element, any object is allowed to provide property definitions for any other object.</span></span> <span data-ttu-id="a785f-158">これは、JavaScript の"expando"機能に似ています。</span><span class="sxs-lookup"><span data-stu-id="a785f-158">This is similar to the "expando" features of JavaScript.</span></span>  
  
<a name="System_Windows_Media_Visual"></a>   
## <a name="systemwindowsmediavisual"></a><span data-ttu-id="a785f-159">System.Windows.Media.Visual</span><span class="sxs-lookup"><span data-stu-id="a785f-159">System.Windows.Media.Visual</span></span>  
 <span data-ttu-id="a785f-160">システムでは定義されている、次の手順を画面に描画されるピクセルを取得します。</span><span class="sxs-lookup"><span data-stu-id="a785f-160">With a system defined, the next step is getting pixels drawn to the screen.</span></span> <span data-ttu-id="a785f-161"><xref:System.Windows.Media.Visual>クラスがそれぞれ必要に応じて描画命令とこれらの手順 (クリッピング、変換など) を表示する方法についてのメタデータを含む、ビジュアル オブジェクトのツリーを構築するために提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-161">The <xref:System.Windows.Media.Visual> class provides for building a tree of visual objects, each optionally containing drawing instructions and metadata about how to render those instructions (clipping, transformation, etc.).</span></span> <span data-ttu-id="a785f-162"><xref:System.Windows.Media.Visual> 設計されています非常に軽量で柔軟性の高いため、機能のほとんどないパブリック[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]公開し、保護されているコールバック関数に大きく依存します。</span><span class="sxs-lookup"><span data-stu-id="a785f-162"><xref:System.Windows.Media.Visual> is designed to be extremely lightweight and flexible, so most of the features have no public [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure and rely heavily on protected callback functions.</span></span>  
  
 <span data-ttu-id="a785f-163"><xref:System.Windows.Media.Visual> エントリ ポイントを実際には、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]コンポジション システムです。</span><span class="sxs-lookup"><span data-stu-id="a785f-163"><xref:System.Windows.Media.Visual> is really the entry point to the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] composition system.</span></span> <span data-ttu-id="a785f-164"><xref:System.Windows.Media.Visual> これら 2 つのサブシステム、マネージ間の接続ポイントは、[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]まさに、します。</span><span class="sxs-lookup"><span data-stu-id="a785f-164"><xref:System.Windows.Media.Visual> is the point of connection between these two subsystems, the managed [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] and the unmanaged milcore.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-165"> milcore によって管理されているアンマネージ データ構造を走査してデータを表示します。</span><span class="sxs-lookup"><span data-stu-id="a785f-165"> displays data by traversing the unmanaged data structures managed by the milcore.</span></span> <span data-ttu-id="a785f-166">コンポジション ノードと呼ばれるこれらの構造は、各ノードでレンダリング指示を含む階層表示にはツリーを表します。</span><span class="sxs-lookup"><span data-stu-id="a785f-166">These structures, called composition nodes, represent a hierarchical display tree with rendering instructions at each node.</span></span> <span data-ttu-id="a785f-167">このツリーで、次の図の右側の図では、メッセージング プロトコル経由でアクセスできるのみです。</span><span class="sxs-lookup"><span data-stu-id="a785f-167">This tree, illustrated on the right hand side of the figure below, is only accessible through a messaging protocol.</span></span>  
  
 <span data-ttu-id="a785f-168">プログラミング時に[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、作成する<xref:System.Windows.Media.Visual>要素、および派生型は、内部的にこのメッセージング プロトコルを使って構成ツリーと通信します。</span><span class="sxs-lookup"><span data-stu-id="a785f-168">When programming [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you create <xref:System.Windows.Media.Visual> elements, and derived types, which internally communicate to the composition tree through this messaging protocol.</span></span> <span data-ttu-id="a785f-169">各<xref:System.Windows.Media.Visual>で[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]1 つのフィルターまたはコンポジションの複数のノードを作成する場合があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-169">Each <xref:System.Windows.Media.Visual> in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] may create one, none, or several composition nodes.</span></span>  
  
 <span data-ttu-id="a785f-170">![Windows Presentation Foundation ビジュアル ツリー。] (../../../../docs/framework/wpf/advanced/media/wpf-architecture2.PNG "wpf_architecture2")</span><span class="sxs-lookup"><span data-stu-id="a785f-170">![The Windows Presentation Foundation Visual Tree.](../../../../docs/framework/wpf/advanced/media/wpf-architecture2.PNG "wpf_architecture2")</span></span>  
  
 <span data-ttu-id="a785f-171">描画命令はキャッシュし、が非常に重要なアーキテクチャの詳細にビジュアルのツリー全体をここで注目してください。</span><span class="sxs-lookup"><span data-stu-id="a785f-171">There is a very important architectural detail to notice here – the entire tree of visuals and drawing instructions is cached.</span></span> <span data-ttu-id="a785f-172">グラフィックスに言えば、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]保持レンダリング システムを使用します。</span><span class="sxs-lookup"><span data-stu-id="a785f-172">In graphics terms, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uses a retained rendering system.</span></span> <span data-ttu-id="a785f-173">これにより、再コンポジション システムがユーザー コードへのコールバックをブロックしていない高いリフレッシュ レートを描画するシステムです。</span><span class="sxs-lookup"><span data-stu-id="a785f-173">This enables the system to repaint at high refresh rates without the composition system blocking on callbacks to user code.</span></span> <span data-ttu-id="a785f-174">これは、応答しないアプリケーションの外観を防止に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a785f-174">This helps prevent the appearance of an unresponsive application.</span></span>  
  
 <span data-ttu-id="a785f-175">本当に顕著ダイアグラムにはない別の重要な詳細は、合成が実際には、システムを実行する方法です。</span><span class="sxs-lookup"><span data-stu-id="a785f-175">Another important detail that isn’t really noticeable in the diagram is how the system actually performs composition.</span></span>  
  
 <span data-ttu-id="a785f-176">User32 内および[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]システムは、イミディ エイト モードのクリッピング システムで動作します。</span><span class="sxs-lookup"><span data-stu-id="a785f-176">In User32 and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)], the system works on an immediate mode clipping system.</span></span> <span data-ttu-id="a785f-177">コンポーネントは、描画する必要がある、システムの外部でコンポーネントがタッチ (ピクセル単位) 許可されていないし、そのボックスのピクセルを描画するコンポーネントに要求し、クリッピングの境界を確立します。</span><span class="sxs-lookup"><span data-stu-id="a785f-177">When a component needs to be rendered, the system establishes a clipping bounds outside of which the component isn’t allowed to touch the pixels, and then the component is asked to paint pixels in that box.</span></span> <span data-ttu-id="a785f-178">このシステムで問題なく動作メモリの制約システムで変更が生じた場合だけで済むため、影響を受けるコンポーネントをタッチする – これまでの単一のピクセルの色に影響する 2 つのコンポーネントではありません。</span><span class="sxs-lookup"><span data-stu-id="a785f-178">This system works very well in memory constrained systems because when something changes you only have to touch the affected component – no two components ever contribute to the color of a single pixel.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-179"> アルゴリズムを使用して、"画家の"モデルを描画します。</span><span class="sxs-lookup"><span data-stu-id="a785f-179"> uses a "painter's algorithm" painting model.</span></span> <span data-ttu-id="a785f-180">これは、各コンポーネント、クリッピングの代わりに各コンポーネントは表示の前に、バックアップから表示するために要求ことを意味します。</span><span class="sxs-lookup"><span data-stu-id="a785f-180">This means that instead of clipping each component, each component is asked to render from the back to the front of the display.</span></span> <span data-ttu-id="a785f-181">これにより、前のコンポーネントの表示を描画するには、各コンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="a785f-181">This allows each component to paint over the previous component's display.</span></span> <span data-ttu-id="a785f-182">このモデルの場合は、複雑な半透明な図形をとります。</span><span class="sxs-lookup"><span data-stu-id="a785f-182">The advantage of this model is that you can have complex, partially transparent shapes.</span></span> <span data-ttu-id="a785f-183">このモデルは比較的高速、今日の最新のグラフィックス ハードウェアに (ケースではないときに User32/[!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]作成された)。</span><span class="sxs-lookup"><span data-stu-id="a785f-183">With today’s modern graphics hardware, this model is relatively fast (which wasn’t the case when User32/ [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] were created).</span></span>  
  
 <span data-ttu-id="a785f-184">前述の主要理念[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]プログラミングの複数宣言"property 中心"モデルに移動します。</span><span class="sxs-lookup"><span data-stu-id="a785f-184">As mentioned previously, a core philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is to move to a more declarative, "property centric" model of programming.</span></span> <span data-ttu-id="a785f-185">ビジュアルのシステムでは、これに表示、いくつかの興味深い場所。</span><span class="sxs-lookup"><span data-stu-id="a785f-185">In the visual system, this shows up in a couple of interesting places.</span></span>  
  
 <span data-ttu-id="a785f-186">最初に、保持モード グラフィック システムの場合は、これが実際に不可欠な DrawLine/DrawLine 型モデルから離れた場所に移動データ指向モデル – 新しい行 ()/新しい Line() です。</span><span class="sxs-lookup"><span data-stu-id="a785f-186">First, if you think about the retained mode graphic system, this is really moving away from an imperative DrawLine/DrawLine type model, to a data oriented model – new Line()/new Line().</span></span> <span data-ttu-id="a785f-187">データ ドリブン レンダリングするには、この移動は、プロパティを使用して表現を描画命令で複雑な操作を使用できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-187">This move to data driven rendering allows complex operations on the drawing instructions to be expressed using properties.</span></span> <span data-ttu-id="a785f-188">派生する型<xref:System.Windows.Media.Drawing>表示オブジェクト モデルでは実質的にします。</span><span class="sxs-lookup"><span data-stu-id="a785f-188">The types deriving from <xref:System.Windows.Media.Drawing> are effectively the object model for rendering.</span></span>  
  
 <span data-ttu-id="a785f-189">次に、アニメーション システムを評価する場合に、ほとんどの完全な宣言型であるが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-189">Second, if you evaluate the animation system, you'll see that it is almost completely declarative.</span></span> <span data-ttu-id="a785f-190">開発者が次の場所、または次の色を計算する必要はありません、アニメーションをアニメーション オブジェクトのプロパティのセットとして表現できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-190">Instead of requiring a developer to compute the next location, or next color, you can express animations as a set of properties on an animation object.</span></span> <span data-ttu-id="a785f-191">これらのアニメーションは、デザイナー、開発者の意図を表すことができますし、(このボタンをここからに移動が 5 秒以内に)、および、システムがこれを実現する最も効率的な方法を判断することができます。</span><span class="sxs-lookup"><span data-stu-id="a785f-191">These animations can then express the intent of the developer or designer (move this button from here to there in 5 seconds), and the system can determine the most efficient way to accomplish that.</span></span>  
  
<a name="System_Windows_UIElement"></a>   
## <a name="systemwindowsuielement"></a><span data-ttu-id="a785f-192">System.Windows.UIElement</span><span class="sxs-lookup"><span data-stu-id="a785f-192">System.Windows.UIElement</span></span>  
 <span data-ttu-id="a785f-193"><xref:System.Windows.UIElement> レイアウト、入力、およびイベントを含むコア サブシステムを定義します。</span><span class="sxs-lookup"><span data-stu-id="a785f-193"><xref:System.Windows.UIElement> defines core subsystems including Layout, Input, and Events.</span></span>  
  
 <span data-ttu-id="a785f-194">レイアウトでの主要な概念は、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-194">Layout is a core concept in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="a785f-195">多くのシステムでは、レイアウトのモデルのセットが固定 (HTML は、レイアウトの 3 つのモデルをサポートしています。 フロー、絶対、およびテーブル) またはレイアウトのモデルが存在しない (User32 だけでは絶対配置) します。</span><span class="sxs-lookup"><span data-stu-id="a785f-195">In many systems there is either a fixed set of layout models (HTML supports three models for layout; flow, absolute, and tables) or no model for layout (User32 really only supports absolute positioning).</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-196"> 開発者とデザイナーが、命令型のロジックではなく、プロパティ値で制御できる、柔軟で拡張性のレイアウトのモデルを求めているという前提で起動されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-196"> started with the assumption that developers and designers wanted a flexible, extensible layout model, which could be driven by property values rather than imperative logic.</span></span> <span data-ttu-id="a785f-197"><xref:System.Windows.UIElement>レベル、レイアウトの基本的なコントラクトが導入されました-モデルを 2 フェーズ<xref:System.Windows.UIElement.Measure%2A>と<xref:System.Windows.UIElement.Arrange%2A>を渡します。</span><span class="sxs-lookup"><span data-stu-id="a785f-197">At the <xref:System.Windows.UIElement> level, the basic contract for layout is introduced – a two phase model with <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> passes.</span></span>  
  
 <span data-ttu-id="a785f-198"><xref:System.Windows.UIElement.Measure%2A> 対処が必要な量のサイズを決定するコンポーネントを使用します。</span><span class="sxs-lookup"><span data-stu-id="a785f-198"><xref:System.Windows.UIElement.Measure%2A> allows a component to determine how much size it would like to take.</span></span> <span data-ttu-id="a785f-199">これから独立したフェーズ<xref:System.Windows.UIElement.Arrange%2A>が多くの場合は親要素が子の最適な位置とサイズを決定するいくつかの時間を測定するように求められます。</span><span class="sxs-lookup"><span data-stu-id="a785f-199">This is a separate phase from <xref:System.Windows.UIElement.Arrange%2A> because there are many situations where a parent element will ask a child to measure several times to determine its optimal position and size.</span></span> <span data-ttu-id="a785f-200">測定する子要素を親要素が要求されたことを示しますのもう 1 つの主要理念[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– コンテンツをサイズ。</span><span class="sxs-lookup"><span data-stu-id="a785f-200">The fact that parent elements ask child elements to measure demonstrates another key philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – size to content.</span></span> <span data-ttu-id="a785f-201">すべてのコントロール[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]サイズをコンテンツの自然なサイズにする機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="a785f-201">All controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] support the ability to size to the natural size of their content.</span></span> <span data-ttu-id="a785f-202">これによってローカライズを簡単に、し要素の動的レイアウトのように項目のサイズ変更できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-202">This makes localization much easier, and allows for dynamic layout of elements as things resize.</span></span> <span data-ttu-id="a785f-203"><xref:System.Windows.UIElement.Arrange%2A>フェーズでは、親を配置し、それぞれの子の最終的なサイズを決定します。</span><span class="sxs-lookup"><span data-stu-id="a785f-203">The <xref:System.Windows.UIElement.Arrange%2A> phase allows a parent to position and determine the final size of each child.</span></span>  
  
 <span data-ttu-id="a785f-204">多くの時間が、出力側の話にかかった多くの場合、 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] –<xref:System.Windows.Media.Visual>と関連オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="a785f-204">A lot of time is often spent talking about the output side of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – <xref:System.Windows.Media.Visual> and related objects.</span></span> <span data-ttu-id="a785f-205">ただしこれには入力側の同様の膨大な技術革新があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-205">However there is a tremendous amount of innovation on the input side as well.</span></span> <span data-ttu-id="a785f-206">入力モデルで最も基本的な変更可能性[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]システムを経由する入力イベントのルーティング一貫したモデルです。</span><span class="sxs-lookup"><span data-stu-id="a785f-206">Probably the most fundamental change in the input model for [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the consistent model by which input events are routed through the system.</span></span>  
  
 <span data-ttu-id="a785f-207">入力は、カーネル モード デバイス ドライバーのシグナルとして開始され、正しいプロセスと Windows カーネルおよび User32 に関連する複雑なプロセスのスレッドにルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="a785f-207">Input originates as a signal on a kernel mode device driver and gets routed to the correct process and thread through an intricate process involving the Windows kernel and User32.</span></span> <span data-ttu-id="a785f-208">入力に対応する User32 メッセージがルーティングされると[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]に変換、 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] raw メッセージを入力し、ディスパッチャーに送信します。</span><span class="sxs-lookup"><span data-stu-id="a785f-208">Once the User32 message corresponding to the input is routed to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], it is converted into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] raw input message and sent to the dispatcher.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-209"> 配信の保証を使用してシステムの低レベルで実装するには、"MouseEnter"などの機能を有効にすると、実際の複数のイベントに変換される生の入力イベント、できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-209"> allows for raw input events to be converted to multiple actual events, enabling features like "MouseEnter" to be implemented at a low level of the system with guaranteed delivery.</span></span>  
  
 <span data-ttu-id="a785f-210">それぞれの入力イベントは、「プレビュー」イベントと実際のイベントには、少なくとも 2 つのイベントに変換されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-210">Each input event is converted to at least two events – a "preview" event and the actual event.</span></span> <span data-ttu-id="a785f-211">すべてのイベント[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]要素ツリーを通じてルーティングの概念があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-211">All events in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] have a notion of routing through the element tree.</span></span> <span data-ttu-id="a785f-212">イベントと見なされます「バブル」および場合は、ルートの場合に、ツリーをターゲットから走査するルートを起点し、ターゲットまで走査する場合は「トンネル」と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a785f-212">Events are said to "bubble" if they traverse from a target up the tree to the root, and are said to "tunnel" if that start at the root and traverse down to a target.</span></span> <span data-ttu-id="a785f-213">ツリーをフィルター処理またはイベントでアクションを実行することで任意の要素を有効にすると、プレビュー イベント トンネルを入力します。</span><span class="sxs-lookup"><span data-stu-id="a785f-213">Input preview events tunnel, enabling any element in the tree an opportunity to filter or take action on the event.</span></span> <span data-ttu-id="a785f-214">通常の (非プレビュー) のイベントは、ルート ターゲットから、バブルします。</span><span class="sxs-lookup"><span data-stu-id="a785f-214">The regular (non-preview) events then bubble from the target up to the root.</span></span>  
  
 <span data-ttu-id="a785f-215">この分割トンネルおよびバブル チャートのフェーズの間では、キーボード アクセラレータは、複合世界で一貫した方法で動作などの機能の実装です。</span><span class="sxs-lookup"><span data-stu-id="a785f-215">This split between the tunnel and bubble phase makes implementation of features like keyboard accelerators work in a consistent fashion in a composite world.</span></span> <span data-ttu-id="a785f-216">User32 では、グローバル含む単一のテーブルをサポートするすべてのアクセラレータ (Ctrl キーを押しながら N キーの「新規」へのマッピング) を持つキーボード アクセラレータを実装とします。</span><span class="sxs-lookup"><span data-stu-id="a785f-216">In User32 you would implement keyboard accelerators by having a single global table containing all the accelerators you wanted to support (Ctrl+N mapping to "New").</span></span> <span data-ttu-id="a785f-217">呼び出しは、アプリケーションのディスパッチャーで**TranslateAccelerator**は User32 で入力メッセージをスニッフィングできないし、登録済みのアクセラレータが一致するかどうかはいずれかを判断します。</span><span class="sxs-lookup"><span data-stu-id="a785f-217">In the dispatcher for your application you would call **TranslateAccelerator** which would sniff the input messages in User32 and determine if any matched a registered accelerator.</span></span> <span data-ttu-id="a785f-218">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]システムは完全に「コンポーザブル」– をいずれかの要素を処理し、キーボード アクセラレータを使用できますのでこの組み合わせは機能します。</span><span class="sxs-lookup"><span data-stu-id="a785f-218">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] this wouldn’t work because the system is fully "composable" – any element can handle and use any keyboard accelerator.</span></span> <span data-ttu-id="a785f-219">この 2 つのフェーズ モデルの入力を持つことにより、自分"TranslateAccelerator"を実装するコンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="a785f-219">Having this two phase model for input allows components to implement their own "TranslateAccelerator".</span></span>  
  
 <span data-ttu-id="a785f-220">さらに、この 1 つの手順を実行する<xref:System.Windows.UIElement>も踏み込んで言うと導入されています。</span><span class="sxs-lookup"><span data-stu-id="a785f-220">To take this one step further, <xref:System.Windows.UIElement> also introduces the notion of CommandBindings.</span></span> <span data-ttu-id="a785f-221">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]コマンド システムにより、何かのコマンドの終了点 – という観点から機能を定義する開発者を実装する<xref:System.Windows.Input.ICommand>です。</span><span class="sxs-lookup"><span data-stu-id="a785f-221">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] command system allows developers to define functionality in terms of a command end point – something that implements <xref:System.Windows.Input.ICommand>.</span></span> <span data-ttu-id="a785f-222">コマンドのバインドには、入力ジェスチャ (Ctrl + N) および (新規) コマンドの間のマッピングを定義する要素が有効にします。</span><span class="sxs-lookup"><span data-stu-id="a785f-222">Command bindings enable an element to define a mapping between an input gesture (Ctrl+N) and a command (New).</span></span> <span data-ttu-id="a785f-223">入力ジェスチャとコマンドの定義の両方、拡張性、および使用時にまとめることができます。</span><span class="sxs-lookup"><span data-stu-id="a785f-223">Both the input gestures and command definitions are extensible, and can be wired together at usage time.</span></span> <span data-ttu-id="a785f-224">これにより、単純ななど、エンドユーザーにアプリケーション内で使用するキーのバインディングをカスタマイズできるようにします。</span><span class="sxs-lookup"><span data-stu-id="a785f-224">This makes it trivial, for example, to allow an end user to customize the key bindings that they want to use within an application.</span></span>  
  
 <span data-ttu-id="a785f-225">このトピックのポイントに「コア」機能の[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]– PresentationCore アセンブリ内に実装された機能は、フォーカスされています。</span><span class="sxs-lookup"><span data-stu-id="a785f-225">To this point in the topic, "core" features of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – features implemented in the PresentationCore assembly, have been the focus.</span></span> <span data-ttu-id="a785f-226">構築するときに[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、基本的なコンポーネント間の分離をクリーンアップする (などのレイアウトとの契約**メジャー**と**配置**) と (特定の実装などのフレームワーク要素ようなレイアウト<xref:System.Windows.Controls.Grid>) が目的の結果。</span><span class="sxs-lookup"><span data-stu-id="a785f-226">When building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a clean separation between foundational pieces (like the contract for layout with **Measure** and **Arrange**) and framework pieces (like the implementation of a specific layout like <xref:System.Windows.Controls.Grid>) was the desired outcome.</span></span> <span data-ttu-id="a785f-227">目標は、ために必要な場合は、独自のフレームワークを作成する外部の開発者は、スタックの下層に機能拡張ポイントを提供することでした。</span><span class="sxs-lookup"><span data-stu-id="a785f-227">The goal was to provide an extensibility point low in the stack that would allow external developers to create their own frameworks if needed.</span></span>  
  
<a name="System_Windows_FrameworkElement"></a>   
## <a name="systemwindowsframeworkelement"></a><span data-ttu-id="a785f-228">System.Windows.FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="a785f-228">System.Windows.FrameworkElement</span></span>  
 <span data-ttu-id="a785f-229"><xref:System.Windows.FrameworkElement> 2 つの異なる方法で参照できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-229"><xref:System.Windows.FrameworkElement> can be looked at in two different ways.</span></span> <span data-ttu-id="a785f-230">一連のポリシーとの下位層で導入されたサブシステムでのカスタマイズを加える[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-230">It introduces a set of policies and customizations on the subsystems introduced in lower layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="a785f-231">一連の新しいサブシステムも導入されています。</span><span class="sxs-lookup"><span data-stu-id="a785f-231">It also introduces a set of new subsystems.</span></span>  
  
 <span data-ttu-id="a785f-232">導入されたプライマリ ポリシー<xref:System.Windows.FrameworkElement>アプリケーション レイアウトです。</span><span class="sxs-lookup"><span data-stu-id="a785f-232">The primary policy introduced by <xref:System.Windows.FrameworkElement> is around application layout.</span></span> <span data-ttu-id="a785f-233"><xref:System.Windows.FrameworkElement> 導入された基本的なレイアウト コントラクトに基づいて<xref:System.Windows.UIElement>レイアウトやすくレイアウト セマンティクスを駆動型のプロパティの一貫性を確保するレイアウト作成者「スロット」の概念を追加します。</span><span class="sxs-lookup"><span data-stu-id="a785f-233"><xref:System.Windows.FrameworkElement> builds on the basic layout contract introduced by <xref:System.Windows.UIElement> and adds the notion of a layout "slot" that makes it easier for layout authors to have a consistent set of property driven layout semantics.</span></span> <span data-ttu-id="a785f-234">などのプロパティ<xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>、 <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>、<xref:System.Windows.FrameworkElement.MinWidth%2A>と<xref:System.Windows.FrameworkElement.Margin%2A>(を埋める) から派生したすべてのコンポーネントを与える<xref:System.Windows.FrameworkElement>レイアウト コンテナー内で一貫性のある動作します。</span><span class="sxs-lookup"><span data-stu-id="a785f-234">Properties like <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>, <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>, <xref:System.Windows.FrameworkElement.MinWidth%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A> (to name a few) give all components derived from <xref:System.Windows.FrameworkElement> consistent behavior inside of layout containers.</span></span>  
  
 <span data-ttu-id="a785f-235"><xref:System.Windows.FrameworkElement> 簡単に提供[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)]の基本レイヤーについては、多くの機能への露出[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-235"><xref:System.Windows.FrameworkElement> also provides easier [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] exposure to many features found in the core layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="a785f-236">たとえば、<xref:System.Windows.FrameworkElement>を通じてアニメーションに直接アクセスできる、<xref:System.Windows.FrameworkElement.BeginStoryboard%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="a785f-236">For example, <xref:System.Windows.FrameworkElement> provides direct access to animation through the <xref:System.Windows.FrameworkElement.BeginStoryboard%2A> method.</span></span> <span data-ttu-id="a785f-237">A<xref:System.Windows.Media.Animation.Storyboard>プロパティのセットに対し複数のアニメーションのスクリプトを作成する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-237">A <xref:System.Windows.Media.Animation.Storyboard> provides a way to script multiple animations against a set of properties.</span></span>  
  
 <span data-ttu-id="a785f-238">2 つの最も重要なことを<xref:System.Windows.FrameworkElement>が導入されていますが、データ バインドとスタイル。</span><span class="sxs-lookup"><span data-stu-id="a785f-238">The two most critical things that <xref:System.Windows.FrameworkElement> introduces are data binding and styles.</span></span>  
  
 <span data-ttu-id="a785f-239">データ バインディング サブシステム[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]が使用するユーザーにとって比較的について理解する必要があります[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]または[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]アプリケーションを作成する[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-239">The data binding subsystem in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] should be relatively familiar to anyone that has used [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)] for creating an application [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="a785f-240">これらのシステムの各では、express の一部のデータにバインドされている指定された要素から 1 つ以上のプロパティを表示する簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="a785f-240">In each of these systems, there is a simple way to express that you want one or more properties from a given element to be bound to a piece of data.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-241"> プロパティのバインド、変換、およびリストのバインディングを完全にサポートがあります。</span><span class="sxs-lookup"><span data-stu-id="a785f-241"> has full support for property binding, transformation, and list binding.</span></span>  
  
 <span data-ttu-id="a785f-242">データ バインディングの最も一般的な機能の 1 つ[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]データ テンプレートを導入します。</span><span class="sxs-lookup"><span data-stu-id="a785f-242">One of the most interesting features of data binding in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the introduction of data templates.</span></span> <span data-ttu-id="a785f-243">データ テンプレートを使用すると、一部のデータを視覚化する方法を宣言によって指定できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-243">Data templates allow you to declaratively specify how a piece of data should be visualized.</span></span> <span data-ttu-id="a785f-244">データにバインドできるカスタム ユーザー インターフェイスを作成するには、代わりに代わりの周囲の問題を有効にし、データが作成される表示を決定できるようにできます。</span><span class="sxs-lookup"><span data-stu-id="a785f-244">Instead of creating a custom user interface that can be bound to data, you can instead turn the problem around and let the data determine the display that will be created.</span></span>  
  
 <span data-ttu-id="a785f-245">スタイルは、実際に、データ バインディングの軽量な形式です。</span><span class="sxs-lookup"><span data-stu-id="a785f-245">Styling is really a lightweight form of data binding.</span></span> <span data-ttu-id="a785f-246">スタイルを使用するのにバインドできます一連のプロパティ共有定義から要素の 1 つまたは複数のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="a785f-246">Using styling you can bind a set of properties from a shared definition to one or more instances of an element.</span></span> <span data-ttu-id="a785f-247">要素に適用されるスタイル明示的な参照でいずれか (設定して、<xref:System.Windows.FrameworkElement.Style%2A>プロパティ) のスタイルを関連付けることによって暗黙的にまたは、[!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)]要素の型。</span><span class="sxs-lookup"><span data-stu-id="a785f-247">Styles get applied to an element either by explicit reference (by setting the <xref:System.Windows.FrameworkElement.Style%2A> property) or implicitly by associating a style with the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] type of the element.</span></span>  
  
<a name="System_Windows_Controls_Control"></a>   
## <a name="systemwindowscontrolscontrol"></a><span data-ttu-id="a785f-248">System.Windows.Controls.Control</span><span class="sxs-lookup"><span data-stu-id="a785f-248">System.Windows.Controls.Control</span></span>  
 <span data-ttu-id="a785f-249">コントロールの最上位機能とは、テンプレートです。</span><span class="sxs-lookup"><span data-stu-id="a785f-249">Control’s most significant feature is templating.</span></span> <span data-ttu-id="a785f-250">WPF のコンポジション システム保持モード レンダリング システムとしてを検討する場合は、パラメーター化された宣言型の方法で、レンダリングを記述するためのコントロールが、テンプレートできます。</span><span class="sxs-lookup"><span data-stu-id="a785f-250">If you think about WPF’s composition system as a retained mode rendering system, templating allows a control to describe its rendering in a parameterized, declarative manner.</span></span> <span data-ttu-id="a785f-251">A<xref:System.Windows.Controls.ControlTemplate>は実際にコントロールによって提供されるプロパティへのバインドと一連の子要素を作成するスクリプトをより詳細に何も行われません。</span><span class="sxs-lookup"><span data-stu-id="a785f-251">A <xref:System.Windows.Controls.ControlTemplate> is really nothing more than a script to create a set of child elements, with bindings to properties offered by the control.</span></span>  
  
 <span data-ttu-id="a785f-252"><xref:System.Windows.Controls.Control> ストック プロパティのセットを提供<xref:System.Windows.Controls.Control.Foreground%2A>、 <xref:System.Windows.Controls.Control.Background%2A>、<xref:System.Windows.Controls.Control.Padding%2A>テンプレートの作成者がコントロールの表示のカスタマイズに使用できるし、いくつかの名前を付ける。</span><span class="sxs-lookup"><span data-stu-id="a785f-252"><xref:System.Windows.Controls.Control> provides a set of stock properties, <xref:System.Windows.Controls.Control.Foreground%2A>, <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Padding%2A>, to name a few, which template authors can then use to customize the display of a control.</span></span> <span data-ttu-id="a785f-253">コントロールの実装では、データ モデルとの相互作用モデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-253">The implementation of a control provides a data model and interaction model.</span></span> <span data-ttu-id="a785f-254">相互作用モデルでは、(ウィンドウの隅に赤い X 印をクリックする) などのジェスチャを入力するには、(ウィンドウを閉じる) のようなコマンドとバインドのセットを定義します。</span><span class="sxs-lookup"><span data-stu-id="a785f-254">The interaction model defines a set of commands (like Close for a window) and bindings to input gestures (like clicking the red X in the upper corner of the window).</span></span> <span data-ttu-id="a785f-255">データ モデルでは、一連の相互作用モデルをカスタマイズするか、(テンプレートによって異なります) の表示をカスタマイズするプロパティを提供します。</span><span class="sxs-lookup"><span data-stu-id="a785f-255">The data model provides a set of properties to either customize the interaction model or customize the display (determined by the template).</span></span>  
  
 <span data-ttu-id="a785f-256">データ モデル (プロパティ)、相互作用モデル (コマンドとイベント)、および表示モデル (テンプレート) の間には、この分割は、コントロールの外観と動作のカスタマイズを完了できます。</span><span class="sxs-lookup"><span data-stu-id="a785f-256">This split between the data model (properties), interaction model (commands and events), and display model (templates) enables complete customization of a control’s look and behavior.</span></span>  
  
 <span data-ttu-id="a785f-257">コントロールのデータ モデルの一般的な側面は、コンテンツ モデルです。</span><span class="sxs-lookup"><span data-stu-id="a785f-257">A common aspect of the data model of controls is the content model.</span></span> <span data-ttu-id="a785f-258">コントロールを確認する場合と同様に<xref:System.Windows.Controls.Button>、型の「コンテンツ」という名前のプロパティを使用しているが表示されます<xref:System.Object>です。</span><span class="sxs-lookup"><span data-stu-id="a785f-258">If you look at a control like <xref:System.Windows.Controls.Button>, you will see that it has a property named "Content" of type <xref:System.Object>.</span></span> <span data-ttu-id="a785f-259">[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]と[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]、このプロパティは文字列である通常 –、ボタンに配置することができますが、コンテンツの種類を制限します。</span><span class="sxs-lookup"><span data-stu-id="a785f-259">In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] and [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)], this property would typically be a string – however that limits the type of content you can put in a button.</span></span> <span data-ttu-id="a785f-260">ボタンのコンテンツできます、単純な文字列、複雑なデータ オブジェクト、またはツリー全体。</span><span class="sxs-lookup"><span data-stu-id="a785f-260">Content for a button can either be a simple string, a complex data object, or an entire element tree.</span></span> <span data-ttu-id="a785f-261">データ オブジェクトの場合は、データ テンプレートは、ディスプレイを構築するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-261">In the case of a data object, the data template is used to construct a display.</span></span>  
  
<a name="Summary"></a>   
## <a name="summary"></a><span data-ttu-id="a785f-262">まとめ</span><span class="sxs-lookup"><span data-stu-id="a785f-262">Summary</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="a785f-263"> データ ドリブン プレゼンテーション システムを動的に作成できるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="a785f-263"> is designed to allow you to create dynamic, data driven presentation systems.</span></span> <span data-ttu-id="a785f-264">動作を制御するプロパティ セットを通じてオブジェクトを作成するのには、システムのすべての部分は設計されています。</span><span class="sxs-lookup"><span data-stu-id="a785f-264">Every part of the system is designed to create objects through property sets that drive behavior.</span></span> <span data-ttu-id="a785f-265">データ バインディングは、システムの基本的な部分は、され、すべてのレイヤーで統合されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-265">Data binding is a fundamental part of the system, and is integrated at every layer.</span></span>  
  
 <span data-ttu-id="a785f-266">従来のアプリケーションは、表示を作成し、後、一部のデータをバインドします。</span><span class="sxs-lookup"><span data-stu-id="a785f-266">Traditional applications create a display and then bind to some data.</span></span> <span data-ttu-id="a785f-267">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、いくつかの種類のデータ バインディングによって生成される、コントロール、ディスプレイ画面のあらゆる側面に関するすべてのものです。</span><span class="sxs-lookup"><span data-stu-id="a785f-267">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], everything about the control, every aspect of the display, is generated by some type of data binding.</span></span> <span data-ttu-id="a785f-268">ボタンの内側にあるテキストは、ボタンの内部で構成されるコントロールを作成し、ボタンのコンテンツ プロパティの表示をバインドして表示されます。</span><span class="sxs-lookup"><span data-stu-id="a785f-268">The text found inside a button is displayed by creating a composed control inside of the button and binding its display to the button’s content property.</span></span>  
  
 <span data-ttu-id="a785f-269">開発を開始すると、[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]ベースのアプリケーション、非常になじみと考える必要があります。</span><span class="sxs-lookup"><span data-stu-id="a785f-269">When you begin developing [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] based applications, it should feel very familiar.</span></span> <span data-ttu-id="a785f-270">プロパティ、オブジェクトを使用してを設定することができ、データ バインドほぼ同じ方法を使用できる[!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)]または[!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="a785f-270">You can set properties, use objects, and data bind in much the same way that you can using [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or [!INCLUDE[TLA#tla_aspnet](../../../../includes/tlasharptla-aspnet-md.md)].</span></span> <span data-ttu-id="a785f-271">アーキテクチャに深く調査と[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]、基本的に、アプリケーションのコア ドライバーとしてデータを処理するはるかに充実したアプリケーションを作成するためにできる可能性があることがわかります。</span><span class="sxs-lookup"><span data-stu-id="a785f-271">With a deeper investigation into the architecture of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you'll find that the possibility exists for creating much richer applications that fundamentally treat data as the core driver of the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a785f-272">関連項目</span><span class="sxs-lookup"><span data-stu-id="a785f-272">See Also</span></span>  
 <xref:System.Windows.Media.Visual>  
 <xref:System.Windows.UIElement>  
 <xref:System.Windows.Input.ICommand>  
 <xref:System.Windows.FrameworkElement>  
 <xref:System.Windows.Threading.DispatcherObject>  
 <xref:System.Windows.Input.CommandBinding>  
 <xref:System.Windows.Controls.Control>  
 [<span data-ttu-id="a785f-273">データ バインディングの概要</span><span class="sxs-lookup"><span data-stu-id="a785f-273">Data Binding Overview</span></span>](../../../../docs/framework/wpf/data/data-binding-overview.md)  
 [<span data-ttu-id="a785f-274">レイアウト</span><span class="sxs-lookup"><span data-stu-id="a785f-274">Layout</span></span>](../../../../docs/framework/wpf/advanced/layout.md)  
 [<span data-ttu-id="a785f-275">アニメーションの概要</span><span class="sxs-lookup"><span data-stu-id="a785f-275">Animation Overview</span></span>](../../../../docs/framework/wpf/graphics-multimedia/animation-overview.md)
