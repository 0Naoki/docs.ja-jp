---
title: "コマンド実行の概要"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
caps.latest.revision: "35"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 9b75319b5a07ac2ee1601f30394da641eb2b781c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="commanding-overview"></a><span data-ttu-id="c0823-102">コマンド実行の概要</span><span class="sxs-lookup"><span data-stu-id="c0823-102">Commanding Overview</span></span>
<a name="introduction"></a> <span data-ttu-id="c0823-103">コマンド実行は [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] の入力メカニズムであり、デバイス入力よりいっそうセマンティックなレベルでの入力処理を提供します。</span><span class="sxs-lookup"><span data-stu-id="c0823-103">Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="c0823-104">コマンドの例は、多くのアプリケーションで見られる**コピー**、**切り取り**、**貼り付け**などの操作です。</span><span class="sxs-lookup"><span data-stu-id="c0823-104">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="c0823-105">この概要では、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でのコマンドとはどういうものか、コマンド実行モデルに含まれるクラス、アプリケーションでコマンドを作成して使用する方法を定義します。</span><span class="sxs-lookup"><span data-stu-id="c0823-105">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="c0823-106">このトピックは、次のセクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="c0823-106">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="c0823-107">コマンドとは</span><span class="sxs-lookup"><span data-stu-id="c0823-107">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
-   [<span data-ttu-id="c0823-108">WPF での簡単なコマンドの例</span><span class="sxs-lookup"><span data-stu-id="c0823-108">Simple Command Example in WPF</span></span>](#simple_command)  
  
-   [<span data-ttu-id="c0823-109">WPF のコマンド実行における 4 つの主要な概念</span><span class="sxs-lookup"><span data-stu-id="c0823-109">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
-   [<span data-ttu-id="c0823-110">コマンド ライブラリ</span><span class="sxs-lookup"><span data-stu-id="c0823-110">Command Library</span></span>](#Command_Library)  
  
-   [<span data-ttu-id="c0823-111">カスタム コマンドの作成</span><span class="sxs-lookup"><span data-stu-id="c0823-111">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>   
## <a name="what-are-commands"></a><span data-ttu-id="c0823-112">コマンドとは</span><span class="sxs-lookup"><span data-stu-id="c0823-112">What Are Commands?</span></span>  
 <span data-ttu-id="c0823-113">コマンドには、いくつかの目的があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-113">Commands have several purposes.</span></span> <span data-ttu-id="c0823-114">第 1 の目的は、コマンドを呼び出すセマンティクスとオブジェクトを、コマンドを実行するロジックから分離することです。</span><span class="sxs-lookup"><span data-stu-id="c0823-114">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="c0823-115">これにより、複数の異なるソースから同じコマンド ロジックを呼び出すことができ、異なるターゲットに合わせてコマンド ロジックをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="c0823-115">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="c0823-116">たとえば、多くのアプリケーションで使われる編集操作である**コピー**、**切り取り**、**貼り付け**は、コマンドを使って実装されていれば、異なるユーザー アクションを使って呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="c0823-116">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="c0823-117">ユーザーは、ボタンをクリックして、メニューの項目を選択して、または Ctrl + X などのキーの組み合わせを使って、選んだオブジェクトやテキストを切り取ることができます。</span><span class="sxs-lookup"><span data-stu-id="c0823-117">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="c0823-118">コマンドを使うことにより、各種のユーザー アクションを同じロジックにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="c0823-118">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="c0823-119">コマンドのもう 1 つの目的は、アクションを実行できるかどうかを示すことです。</span><span class="sxs-lookup"><span data-stu-id="c0823-119">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="c0823-120">再びオブジェクトやテキストの切り取りを例にすると、アクションは何かを選択したときにのみ意味があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-120">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="c0823-121">何も選ばないでオブジェクトまたはテキストを切り取ろうとすると、何も起こりません。</span><span class="sxs-lookup"><span data-stu-id="c0823-121">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="c0823-122">ユーザーにこのことを示すため、多くのアプリケーションでは、ボタンやメニュー項目を無効にして、アクションを実行できるかどうかをユーザーが認識できるようにしています。</span><span class="sxs-lookup"><span data-stu-id="c0823-122">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="c0823-123">コマンドは、アクションは、実装することによって可能かどうかを示すことができます、<xref:System.Windows.Input.ICommand.CanExecute%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c0823-123">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="c0823-124">サブスクライブするボタン、<xref:System.Windows.Input.ICommand.CanExecuteChanged>イベント場合無効にして<xref:System.Windows.Input.ICommand.CanExecute%2A>を返します`false`場合に有効にするか<xref:System.Windows.Input.ICommand.CanExecute%2A>を返します`true`です。</span><span class="sxs-lookup"><span data-stu-id="c0823-124">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="c0823-125">コマンドのセマンティクスはアプリケーションおよびクラス全体で統一できますが、アクションのロジックは対象となる特定のオブジェクトに固有です。</span><span class="sxs-lookup"><span data-stu-id="c0823-125">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="c0823-126">キーの組み合わせ Ctrl + X キーはテキスト クラス、イメージ クラス、Web ブラウザーの**切り取り**コマンドを呼び出しますが、**切り取り**操作を実行する実際のロジックは、切り取りを実行するアプリケーションによって定義されています。</span><span class="sxs-lookup"><span data-stu-id="c0823-126">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="c0823-127">A<xref:System.Windows.Input.RoutedCommand>ロジックの実装にクライアントを有効にします。</span><span class="sxs-lookup"><span data-stu-id="c0823-127">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="c0823-128">テキスト オブジェクトは選択されたテキストを切り取ってクリップボードに移動できるのに対し、イメージ オブジェクトは選択されたイメージを切り取ることができます。</span><span class="sxs-lookup"><span data-stu-id="c0823-128">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="c0823-129">アプリケーションで処理すると、<xref:System.Windows.Input.CommandManager.Executed>イベント、コマンドのターゲットにアクセスし、ターゲットの種類に応じて適切な対策を実施できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-129">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>   
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="c0823-130">WPF での簡単なコマンドの例</span><span class="sxs-lookup"><span data-stu-id="c0823-130">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="c0823-131">コマンドを使用する最も簡単な方法[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]を使用して、定義済み<xref:System.Windows.Input.RoutedCommand>コマンド ライブラリ クラス; のいずれかのコマンドを処理するためのネイティブ サポートしているコントロールを使用し、コマンドを呼び出すためのネイティブ サポートしているコントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="c0823-131">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="c0823-132"><xref:System.Windows.Input.ApplicationCommands.Paste%2A>定義済みのコマンドのいずれかのコマンドは、<xref:System.Windows.Input.ApplicationCommands>クラスです。</span><span class="sxs-lookup"><span data-stu-id="c0823-132">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="c0823-133"><xref:System.Windows.Controls.TextBox>コントロールを処理するためのロジックが組み込まれています、<xref:System.Windows.Input.ApplicationCommands.Paste%2A>コマンド。</span><span class="sxs-lookup"><span data-stu-id="c0823-133">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="c0823-134">および<xref:System.Windows.Controls.MenuItem>クラスには、コマンドを呼び出すためのネイティブ サポート。</span><span class="sxs-lookup"><span data-stu-id="c0823-134">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="c0823-135">次の例を設定する方法を示しています、<xref:System.Windows.Controls.MenuItem>が呼び出さがクリックされたときにできるように、<xref:System.Windows.Input.ApplicationCommands.Paste%2A>コマンドを<xref:System.Windows.Controls.TextBox>と見なし、<xref:System.Windows.Controls.TextBox>キーボード フォーカスがあります。</span><span class="sxs-lookup"><span data-stu-id="c0823-135">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>   
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="c0823-136">WPF のコマンド実行における 4 つの主要な概念</span><span class="sxs-lookup"><span data-stu-id="c0823-136">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="c0823-137">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] のルーティング コマンド モデルは、コマンド、コマンド ソース、コマンド ターゲット、コマンド バインディングという 4 つの主要な概念に分けることができます。</span><span class="sxs-lookup"><span data-stu-id="c0823-137">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
-   <span data-ttu-id="c0823-138">"*コマンド*" は、実行するアクションです。</span><span class="sxs-lookup"><span data-stu-id="c0823-138">The *command* is the action to be executed.</span></span>  
  
-   <span data-ttu-id="c0823-139">"*コマンド ソース*" は、コマンドを呼び出すオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c0823-139">The *command source* is the object which invokes the command.</span></span>  
  
-   <span data-ttu-id="c0823-140">"*コマンド ターゲット*" は、コマンドが実行されているオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c0823-140">The *command target* is the object that the command is being executed on.</span></span>  
  
-   <span data-ttu-id="c0823-141">"*コマンド バインディング*" は、コマンド ロジックをコマンドにマップするオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c0823-141">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="c0823-142">前の例で、<xref:System.Windows.Input.ApplicationCommands.Paste%2A>は、コマンド、<xref:System.Windows.Controls.MenuItem>コマンド ソースが、<xref:System.Windows.Controls.TextBox>コマンド ターゲットでは、コマンドのバインドは、によって提供される、<xref:System.Windows.Controls.TextBox>コントロール。</span><span class="sxs-lookup"><span data-stu-id="c0823-142">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="c0823-143">常に大文字と小文字の注目すべきであること、<xref:System.Windows.Input.CommandBinding>コマンド ターゲット クラスにあるコントロールによって提供されます。</span><span class="sxs-lookup"><span data-stu-id="c0823-143">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="c0823-144">多くの場合、<xref:System.Windows.Input.CommandBinding>アプリケーション開発者によって作成する必要がありますまたは<xref:System.Windows.Input.CommandBinding>コマンド ターゲットの親にアタッチする場合があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-144">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>   
### <a name="commands"></a><span data-ttu-id="c0823-145">コマンド</span><span class="sxs-lookup"><span data-stu-id="c0823-145">Commands</span></span>  
 <span data-ttu-id="c0823-146">コマンド内[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]実装することによって作成された、<xref:System.Windows.Input.ICommand>インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="c0823-146">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="c0823-147"><xref:System.Windows.Input.ICommand>2 つのメソッドを公開<xref:System.Windows.Input.ICommand.Execute%2A>、および<xref:System.Windows.Input.ICommand.CanExecute%2A>、およびイベントが、<xref:System.Windows.Input.ICommand.CanExecuteChanged>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-147"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="c0823-148"><xref:System.Windows.Input.ICommand.Execute%2A>コマンドに関連付けられているアクションを実行します。</span><span class="sxs-lookup"><span data-stu-id="c0823-148"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="c0823-149"><xref:System.Windows.Input.ICommand.CanExecute%2A>現在のコマンド ターゲットでコマンドを実行できるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c0823-149"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="c0823-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged>コマンド実行の操作を一元化コマンド マネージャーされた発生がコマンドのバインドによって実行されていないコマンドが無効になるコマンド ソースで変更が検出される場合に発生します。</span><span class="sxs-lookup"><span data-stu-id="c0823-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="c0823-151">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]の実装<xref:System.Windows.Input.ICommand>は、<xref:System.Windows.Input.RoutedCommand>クラスし、この概要でのフォーカスが置かれています。</span><span class="sxs-lookup"><span data-stu-id="c0823-151">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="c0823-152">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] での主な入力ソースは、マウス、キーボード、インク、およびルーティング コマンドです。</span><span class="sxs-lookup"><span data-stu-id="c0823-152">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="c0823-153">デバイス指向の入力を使用して、<xref:System.Windows.RoutedEvent>入力イベントが発生したアプリケーション ページで、オブジェクトに通知します。</span><span class="sxs-lookup"><span data-stu-id="c0823-153">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="c0823-154">A<xref:System.Windows.Input.RoutedCommand>に違いはありません。</span><span class="sxs-lookup"><span data-stu-id="c0823-154">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="c0823-155"><xref:System.Windows.Input.RoutedCommand.Execute%2A>と<xref:System.Windows.Input.RoutedCommand.CanExecute%2A>のメソッド、<xref:System.Windows.Input.RoutedCommand>コマンドは、アプリケーション ロジックが含まれていませんが、トンネルのルーティング イベントを発生させるし、持つオブジェクトに遭遇するまで、要素ツリーを通じてバブルではなく、、<xref:System.Windows.Input.CommandBinding>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-155">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="c0823-156"><xref:System.Windows.Input.CommandBinding>これらのイベントのハンドラーを含むコマンドを実行するハンドラーであるとします。</span><span class="sxs-lookup"><span data-stu-id="c0823-156">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="c0823-157">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でのルーティング イベントについて詳しくは、「[ルーティング イベントの概要](../../../../docs/framework/wpf/advanced/routed-events-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="c0823-157">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="c0823-158"><xref:System.Windows.Input.RoutedCommand.Execute%2A>メソッドを<xref:System.Windows.Input.RoutedCommand>を生成、<xref:System.Windows.Input.CommandManager.PreviewExecuted>と<xref:System.Windows.Input.CommandManager.Executed>コマンド ターゲットでのイベントです。</span><span class="sxs-lookup"><span data-stu-id="c0823-158">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="c0823-159"><xref:System.Windows.Input.RoutedCommand.CanExecute%2A>メソッドを<xref:System.Windows.Input.RoutedCommand>を生成、<xref:System.Windows.Input.CommandManager.CanExecute>と<xref:System.Windows.Input.CommandManager.PreviewCanExecute>コマンド ターゲットでのイベントです。</span><span class="sxs-lookup"><span data-stu-id="c0823-159">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="c0823-160">これらのイベント トンネルおよびバブルがオブジェクトに遭遇するまで、要素ツリーを通じて、<xref:System.Windows.Input.CommandBinding>その特定のコマンド。</span><span class="sxs-lookup"><span data-stu-id="c0823-160">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="c0823-161">一連の一般的なルーティング コマンドがいくつかのクラスに分散装置: <xref:System.Windows.Input.MediaCommands>、 <xref:System.Windows.Input.ApplicationCommands>、 <xref:System.Windows.Input.NavigationCommands>、 <xref:System.Windows.Input.ComponentCommands>、および<xref:System.Windows.Documents.EditingCommands>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-161"> supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="c0823-162">これらのクラスのみで構成、<xref:System.Windows.Input.RoutedCommand>オブジェクトとコマンドの実装ロジックではありません。</span><span class="sxs-lookup"><span data-stu-id="c0823-162">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="c0823-163">実装ロジックは、コマンドが実行されるオブジェクトに存在します。</span><span class="sxs-lookup"><span data-stu-id="c0823-163">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>   
### <a name="command-sources"></a><span data-ttu-id="c0823-164">コマンド ソース</span><span class="sxs-lookup"><span data-stu-id="c0823-164">Command Sources</span></span>  
 <span data-ttu-id="c0823-165">コマンド ソースは、コマンドを呼び出すオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c0823-165">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="c0823-166">コマンド ソースの例としては<xref:System.Windows.Controls.MenuItem>、 <xref:System.Windows.Controls.Button>、および<xref:System.Windows.Input.KeyGesture>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-166">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="c0823-167">コマンド内のソース[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]実装では、通常、<xref:System.Windows.Input.ICommandSource>インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="c0823-167">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="c0823-168"><xref:System.Windows.Input.ICommandSource>次の 3 つのプロパティを公開: <xref:System.Windows.Input.ICommandSource.Command%2A>、 <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>、および<xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span><span class="sxs-lookup"><span data-stu-id="c0823-168"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
-   <span data-ttu-id="c0823-169"><xref:System.Windows.Input.ICommandSource.Command%2A>コマンド ソースが呼び出されたときに実行されるコマンドです。</span><span class="sxs-lookup"><span data-stu-id="c0823-169"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
-   <span data-ttu-id="c0823-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A>コマンドを実行するオブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c0823-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="c0823-171">点に注意が[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>プロパティ<xref:System.Windows.Input.ICommandSource>のみ該当する場合は、<xref:System.Windows.Input.ICommand>は、<xref:System.Windows.Input.RoutedCommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-171">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="c0823-172">場合、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>に設定されている、 <xref:System.Windows.Input.ICommandSource> 、対応するコマンドが、<xref:System.Windows.Input.RoutedCommand>コマンドの対象は無視されます。</span><span class="sxs-lookup"><span data-stu-id="c0823-172">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="c0823-173">場合、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>が設定された場合、キーボード フォーカスを持つ要素がコマンドの対象となります。</span><span class="sxs-lookup"><span data-stu-id="c0823-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
-   <span data-ttu-id="c0823-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A>ハンドラーに情報を渡すユーザー定義データ型は、コマンドの実装です。</span><span class="sxs-lookup"><span data-stu-id="c0823-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="c0823-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]を実装するクラス<xref:System.Windows.Input.ICommandSource>は<xref:System.Windows.Controls.Primitives.ButtonBase>、 <xref:System.Windows.Controls.MenuItem>、 <xref:System.Windows.Documents.Hyperlink>、および<xref:System.Windows.Input.InputBinding>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-175">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="c0823-176"><xref:System.Windows.Controls.Primitives.ButtonBase>、 <xref:System.Windows.Controls.MenuItem>、および<xref:System.Windows.Documents.Hyperlink>がクリックされたときに、コマンドを呼び出す<xref:System.Windows.Input.InputBinding>コマンドを呼び出すときに、<xref:System.Windows.Input.InputGesture>関連付けられているで実行されます。</span><span class="sxs-lookup"><span data-stu-id="c0823-176"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="c0823-177">次の例を使用する方法を示しています、<xref:System.Windows.Controls.MenuItem>で、<xref:System.Windows.Controls.ContextMenu>用コマンドのソースとして、<xref:System.Windows.Input.ApplicationCommands.Properties%2A>コマンド。</span><span class="sxs-lookup"><span data-stu-id="c0823-177">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="c0823-178">コマンド ソースがリッスンする通常、<xref:System.Windows.Input.RoutedCommand.CanExecuteChanged>イベント。</span><span class="sxs-lookup"><span data-stu-id="c0823-178">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="c0823-179">このイベントは、現在のコマンド ターゲットでのコマンド実行機能が変化した可能性があることを、コマンド ソースに通知します。</span><span class="sxs-lookup"><span data-stu-id="c0823-179">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="c0823-180">コマンド ソースがの現在の状態を照会できます、<xref:System.Windows.Input.RoutedCommand>を使用して、<xref:System.Windows.Input.RoutedCommand.CanExecute%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="c0823-180">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="c0823-181">コマンドを実行できない場合、コマンド ソースはそれ自体を無効にできます。</span><span class="sxs-lookup"><span data-stu-id="c0823-181">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="c0823-182">この例は、<xref:System.Windows.Controls.MenuItem>要素自体のコマンドを実行できませんを灰色表示します。</span><span class="sxs-lookup"><span data-stu-id="c0823-182">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="c0823-183"><xref:System.Windows.Input.InputGesture>コマンド ソースとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-183">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="c0823-184">2 種類の入力ジェスチャの[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]は、<xref:System.Windows.Input.KeyGesture>と<xref:System.Windows.Input.MouseGesture>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-184">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="c0823-185">考えることができます、 <xref:System.Windows.Input.KeyGesture> CTRL + C などのキーボード ショートカットとします。</span><span class="sxs-lookup"><span data-stu-id="c0823-185">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="c0823-186">A<xref:System.Windows.Input.KeyGesture>から成る、<xref:System.Windows.Input.Key>と一連の<xref:System.Windows.Input.ModifierKeys>します。</span><span class="sxs-lookup"><span data-stu-id="c0823-186">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="c0823-187">A<xref:System.Windows.Input.MouseGesture>から成る、<xref:System.Windows.Input.MouseAction>と省略可能な一連の<xref:System.Windows.Input.ModifierKeys>します。</span><span class="sxs-lookup"><span data-stu-id="c0823-187">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="c0823-188">順序で、<xref:System.Windows.Input.InputGesture>コマンド ソースとして機能しをコマンドに関連付けられている場合があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-188">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="c0823-189">これを実現するにはいくつかの方法があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-189">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="c0823-190">1 つの方法は、使用する、<xref:System.Windows.Input.InputBinding>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-190">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="c0823-191">次の例を作成する方法を示しています、<xref:System.Windows.Input.KeyBinding>間、<xref:System.Windows.Input.KeyGesture>と<xref:System.Windows.Input.RoutedCommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-191">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="c0823-192">関連付けるには別の方法、<xref:System.Windows.Input.InputGesture>を<xref:System.Windows.Input.RoutedCommand>を追加するには、<xref:System.Windows.Input.InputGesture>を<xref:System.Windows.Input.InputGestureCollection>上、<xref:System.Windows.Input.RoutedCommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-192">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="c0823-193">次の例は、追加する方法を示します、<xref:System.Windows.Input.KeyGesture>を<xref:System.Windows.Input.InputGestureCollection>の<xref:System.Windows.Input.RoutedCommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-193">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>   
### <a name="commandbinding"></a><span data-ttu-id="c0823-194">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="c0823-194">CommandBinding</span></span>  
 <span data-ttu-id="c0823-195">A<xref:System.Windows.Input.CommandBinding>コマンドをコマンドを実装するイベント ハンドラーに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="c0823-195">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="c0823-196"><xref:System.Windows.Input.CommandBinding>クラスに含まれる、<xref:System.Windows.Input.CommandBinding.Command%2A>プロパティ、および<xref:System.Windows.Input.CommandBinding.PreviewExecuted>、 <xref:System.Windows.Input.CommandBinding.Executed>、 <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>、および<xref:System.Windows.Input.CommandBinding.CanExecute>イベント。</span><span class="sxs-lookup"><span data-stu-id="c0823-196">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="c0823-197"><xref:System.Windows.Input.CommandBinding.Command%2A>コマンドを<xref:System.Windows.Input.CommandBinding>を関連付けています。</span><span class="sxs-lookup"><span data-stu-id="c0823-197"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="c0823-198">イベント ハンドラーにアタッチされている、<xref:System.Windows.Input.CommandBinding.PreviewExecuted>と<xref:System.Windows.Input.CommandBinding.Executed>イベントは、コマンドのロジックを実装します。</span><span class="sxs-lookup"><span data-stu-id="c0823-198">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="c0823-199">イベント ハンドラーがアタッチされている、<xref:System.Windows.Input.CommandBinding.PreviewCanExecute>と<xref:System.Windows.Input.CommandBinding.CanExecute>イベントは、コマンドを現在のコマンド ターゲットで実行できるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="c0823-199">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="c0823-200">次の例を作成する方法を示しています、<xref:System.Windows.Input.CommandBinding>ルートに対する<xref:System.Windows.Window>アプリケーションのです。</span><span class="sxs-lookup"><span data-stu-id="c0823-200">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="c0823-201"><xref:System.Windows.Input.CommandBinding>関連付けます、<xref:System.Windows.Input.ApplicationCommands.Open%2A>コマンドと<xref:System.Windows.Input.CommandManager.Executed>と<xref:System.Windows.Input.CommandBinding.CanExecute>ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="c0823-201">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="c0823-202">次に、<xref:System.Windows.Input.ExecutedRoutedEventHandler>と<xref:System.Windows.Input.CanExecuteRoutedEventHandler>が作成されます。</span><span class="sxs-lookup"><span data-stu-id="c0823-202">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="c0823-203"><xref:System.Windows.Input.ExecutedRoutedEventHandler>開きます、<xref:System.Windows.MessageBox>コマンドが実行されたというメッセージが文字列を表示します。</span><span class="sxs-lookup"><span data-stu-id="c0823-203">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="c0823-204"><xref:System.Windows.Input.CanExecuteRoutedEventHandler>設定、<xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A>プロパティを`true`です。</span><span class="sxs-lookup"><span data-stu-id="c0823-204">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="c0823-205">A<xref:System.Windows.Input.CommandBinding>ルートなどの特定のオブジェクトにアタッチされて<xref:System.Windows.Window>アプリケーションまたはコントロールのです。</span><span class="sxs-lookup"><span data-stu-id="c0823-205">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="c0823-206">オブジェクトを<xref:System.Windows.Input.CommandBinding>バインディングのスコープを定義にアタッチされています。</span><span class="sxs-lookup"><span data-stu-id="c0823-206">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="c0823-207">たとえば、<xref:System.Windows.Input.CommandBinding>接続からアクセスできるターゲット コマンドの先祖に、<xref:System.Windows.Input.CommandBinding.Executed>イベントが、<xref:System.Windows.Input.CommandBinding>接続されているコマンドの子孫をターゲットに到達できません。</span><span class="sxs-lookup"><span data-stu-id="c0823-207">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="c0823-208">これは、方法の直接の結果、<xref:System.Windows.RoutedEvent>トンネルおよびイベントを発生させるオブジェクトからバブルします。</span><span class="sxs-lookup"><span data-stu-id="c0823-208">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="c0823-209">状況によっては、<xref:System.Windows.Input.CommandBinding>はターゲットに接続された、コマンド自体などで、<xref:System.Windows.Controls.TextBox>クラスおよび<xref:System.Windows.Input.ApplicationCommands.Cut%2A>、 <xref:System.Windows.Input.ApplicationCommands.Copy%2A>、および<xref:System.Windows.Input.ApplicationCommands.Paste%2A>コマンド。</span><span class="sxs-lookup"><span data-stu-id="c0823-209">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="c0823-210">多くの場合は、アタッチする方が便利です、<xref:System.Windows.Input.CommandBinding>メインなど、コマンド ターゲットでの先祖に<xref:System.Windows.Window>またはアプリケーション オブジェクト場合に特に同じ<xref:System.Windows.Input.CommandBinding>複数のコマンド ターゲットを使用できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-210">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="c0823-211">これらは、コマンド実行のインフラストラクチャを作成するときに考慮する設計上の決定です。</span><span class="sxs-lookup"><span data-stu-id="c0823-211">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>   
### <a name="command-target"></a><span data-ttu-id="c0823-212">コマンド ターゲット</span><span class="sxs-lookup"><span data-stu-id="c0823-212">Command Target</span></span>  
 <span data-ttu-id="c0823-213">コマンド ターゲットは、コマンドが実行される要素です。</span><span class="sxs-lookup"><span data-stu-id="c0823-213">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="c0823-214">Regards すると、 <xref:System.Windows.Input.RoutedCommand>、コマンドの対象は、ルーティングの位置にある要素、<xref:System.Windows.Input.CommandManager.Executed>と<xref:System.Windows.Input.CommandManager.CanExecute>を開始します。</span><span class="sxs-lookup"><span data-stu-id="c0823-214">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="c0823-215">以前に記載されている[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>プロパティ<xref:System.Windows.Input.ICommandSource>のみ該当する場合は、<xref:System.Windows.Input.ICommand>は、<xref:System.Windows.Input.RoutedCommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-215">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="c0823-216">場合、<xref:System.Windows.Input.ICommandSource.CommandTarget%2A>に設定されている、 <xref:System.Windows.Input.ICommandSource> 、対応するコマンドが、<xref:System.Windows.Input.RoutedCommand>コマンドの対象は無視されます。</span><span class="sxs-lookup"><span data-stu-id="c0823-216">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="c0823-217">コマンド ソースは、コマンド ターゲットを明示的に設定できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-217">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="c0823-218">コマンド ターゲットが定義されていない場合は、キーボード フォーカスを持つ要素がコマンド ターゲットとして使われます。</span><span class="sxs-lookup"><span data-stu-id="c0823-218">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="c0823-219">キーボード フォーカスを持つ要素をコマンド ターゲットとして使うことの、アプリケーション開発者にとっての利点の 1 つは、コマンド ターゲットを追跡しなくても、同じコマンド ソースを使って、複数のターゲットでコマンドを呼び出すことができることです。</span><span class="sxs-lookup"><span data-stu-id="c0823-219">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="c0823-220">たとえば場合、<xref:System.Windows.Controls.MenuItem>呼び出します、**貼り付け**を持つアプリケーションでコマンド、<xref:System.Windows.Controls.TextBox>コントロールと<xref:System.Windows.Controls.PasswordBox>コントロールをターゲットにできますか、<xref:System.Windows.Controls.TextBox>または<xref:System.Windows.Controls.PasswordBox>に応じてコントロールには、キーボード フォーカスがあります。</span><span class="sxs-lookup"><span data-stu-id="c0823-220">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="c0823-221">次の例では、マークアップおよび分離コードでコマンド ターゲットを明示的に設定する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="c0823-221">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>   
### <a name="the-commandmanager"></a><span data-ttu-id="c0823-222">CommandManager</span><span class="sxs-lookup"><span data-stu-id="c0823-222">The CommandManager</span></span>  
 <span data-ttu-id="c0823-223"><xref:System.Windows.Input.CommandManager>はコマンドの数、関連する関数。</span><span class="sxs-lookup"><span data-stu-id="c0823-223">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="c0823-224">追加および削除するための静的メソッドのセットが提供<xref:System.Windows.Input.CommandManager.PreviewExecuted>、 <xref:System.Windows.Input.CommandManager.Executed>、 <xref:System.Windows.Input.CommandManager.PreviewCanExecute>、および<xref:System.Windows.Input.CommandManager.CanExecute>の特定の要素との間のイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="c0823-224">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="c0823-225">登録するための手段を提供<xref:System.Windows.Input.CommandBinding>と<xref:System.Windows.Input.InputBinding>オブジェクトを特定のクラスにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="c0823-225">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="c0823-226"><xref:System.Windows.Input.CommandManager>も提供する、経由、<xref:System.Windows.Input.CommandManager.RequerySuggested>それを発生させるときに、コマンドを通知する、イベント、<xref:System.Windows.Input.ICommand.CanExecuteChanged>イベント。</span><span class="sxs-lookup"><span data-stu-id="c0823-226">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="c0823-227"><xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A>メソッド フォース、<xref:System.Windows.Input.CommandManager>させる、<xref:System.Windows.Input.CommandManager.RequerySuggested>イベント。</span><span class="sxs-lookup"><span data-stu-id="c0823-227">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="c0823-228">これは、条件必要があるに便利ですコマンドだが無効化/有効化の条件を<xref:System.Windows.Input.CommandManager>を認識します。</span><span class="sxs-lookup"><span data-stu-id="c0823-228">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>   
## <a name="command-library"></a><span data-ttu-id="c0823-229">コマンド ライブラリ</span><span class="sxs-lookup"><span data-stu-id="c0823-229">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="c0823-230"> には、定義済みのコマンドのセットが用意されています。</span><span class="sxs-lookup"><span data-stu-id="c0823-230"> provides a set of predefined commands.</span></span>  <span data-ttu-id="c0823-231">コマンドのライブラリは、次のクラス: <xref:System.Windows.Input.ApplicationCommands>、 <xref:System.Windows.Input.NavigationCommands>、 <xref:System.Windows.Input.MediaCommands>、 <xref:System.Windows.Documents.EditingCommands>、および<xref:System.Windows.Input.ComponentCommands>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-231">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="c0823-232">これらのクラスなどのコマンドを入力<xref:System.Windows.Input.ApplicationCommands.Cut%2A>、<xref:System.Windows.Input.NavigationCommands.BrowseBack%2A>と<xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>、 <xref:System.Windows.Input.MediaCommands.Play%2A>、 <xref:System.Windows.Input.MediaCommands.Stop%2A>、および<xref:System.Windows.Input.MediaCommands.Pause%2A>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-232">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="c0823-233">これらのコマンドの多くには、既定の入力バインディングのセットが含まれます。</span><span class="sxs-lookup"><span data-stu-id="c0823-233">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="c0823-234">たとえば、アプリケーションがコピー コマンドを処理することを指定すると、キーボード バインディング "Ctrl + C" が自動的に有効になります。また、[!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] のペン ジェスチャや音声情報などの他の入力デバイスに対するバインディングも有効になります。</span><span class="sxs-lookup"><span data-stu-id="c0823-234">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="c0823-235">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] を使ってさまざまなコマンド ライブラリのコマンドを参照するときは、通常、静的なコマンド プロパティを公開するライブラリ クラスのクラス名を省略できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-235">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="c0823-236">一般に、コマンド名に文字列としての曖昧さはなく、所有する型は、コマンドの論理グループを提供するために存在しますが、曖昧さの解消のためには必要ありません。</span><span class="sxs-lookup"><span data-stu-id="c0823-236">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="c0823-237">たとえば、詳細な `Command="ApplicationCommands.Cut"` ではなく`Command="Cut"` と指定できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-237">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="c0823-238">これに組み込まれている便利なメカニズム、 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]コマンド プロセッサ (の型コンバーターの動作が正確には、 <xref:System.Windows.Input.ICommand>、どの、 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]読み込み時にプロセッサ参照)。</span><span class="sxs-lookup"><span data-stu-id="c0823-238">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>   
## <a name="creating-custom-commands"></a><span data-ttu-id="c0823-239">カスタム コマンドの作成</span><span class="sxs-lookup"><span data-stu-id="c0823-239">Creating Custom Commands</span></span>  
 <span data-ttu-id="c0823-240">コマンド ライブラリ クラスのコマンドがニーズを満たさない場合は、独自のコマンドを作成できます。</span><span class="sxs-lookup"><span data-stu-id="c0823-240">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="c0823-241">カスタム コマンドを作成するには 2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="c0823-241">There are two ways to create a custom command.</span></span>  <span data-ttu-id="c0823-242">最初から起動され、実装する、<xref:System.Windows.Input.ICommand>インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="c0823-242">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="c0823-243">作成するその他の方法より一般的な方法は、<xref:System.Windows.Input.RoutedCommand>または<xref:System.Windows.Input.RoutedUICommand>です。</span><span class="sxs-lookup"><span data-stu-id="c0823-243">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="c0823-244">カスタムの作成の例については<xref:System.Windows.Input.RoutedCommand>を参照してください[カスタム RoutedCommand サンプルを作成する](http://go.microsoft.com/fwlink/?LinkID=159980)です。</span><span class="sxs-lookup"><span data-stu-id="c0823-244">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c0823-245">関連項目</span><span class="sxs-lookup"><span data-stu-id="c0823-245">See Also</span></span>  
 <xref:System.Windows.Input.RoutedCommand>  
 <xref:System.Windows.Input.CommandBinding>  
 <xref:System.Windows.Input.InputBinding>  
 <xref:System.Windows.Input.CommandManager>  
 [<span data-ttu-id="c0823-246">入力の概要</span><span class="sxs-lookup"><span data-stu-id="c0823-246">Input Overview</span></span>](../../../../docs/framework/wpf/advanced/input-overview.md)  
 [<span data-ttu-id="c0823-247">ルーティング イベントの概要</span><span class="sxs-lookup"><span data-stu-id="c0823-247">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [<span data-ttu-id="c0823-248">ICommandSource を実装する</span><span class="sxs-lookup"><span data-stu-id="c0823-248">Implement ICommandSource</span></span>](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md)  
 [<span data-ttu-id="c0823-249">方法: メニュー アイテムにコマンドを追加する</span><span class="sxs-lookup"><span data-stu-id="c0823-249">How to: Add a Command to a MenuItem</span></span>](http://msdn.microsoft.com/en-us/013d68a0-5373-4a68-bd91-5de574307370)  
 [<span data-ttu-id="c0823-250">カスタム RoutedCommand の作成のサンプル</span><span class="sxs-lookup"><span data-stu-id="c0823-250">Create a Custom RoutedCommand Sample</span></span>](http://go.microsoft.com/fwlink/?LinkID=159980)
