---
title: "ドキュメントのシリアル化および保存"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- 'serialization of documents [WPF], , '
- documents [WPF], storage
- documents [WPF], serialization
ms.assetid: 4839cd87-e206-4571-803f-0200098ad37b
caps.latest.revision: "24"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 34b517366a5f143a86388abff5ae13022bc710c3
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="document-serialization-and-storage"></a><span data-ttu-id="725a2-102">ドキュメントのシリアル化および保存</span><span class="sxs-lookup"><span data-stu-id="725a2-102">Document Serialization and Storage</span></span>
[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)]<span data-ttu-id="725a2-103"> では、高品質のドキュメントを作成および表示するための強力な環境が提供されています。</span><span class="sxs-lookup"><span data-stu-id="725a2-103"> provides a powerful environment for creating and displaying high quality documents.</span></span>  <span data-ttu-id="725a2-104">固定ドキュメントとフロー ドキュメントの両方および高度な表示コントロールをサポートし、強力な 2D および 3D グラフィックス機能と組み合わされた拡張機能により、[!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] アプリケーションの品質とユーザー エクスペリエンスは新しいレベルになります。</span><span class="sxs-lookup"><span data-stu-id="725a2-104">Enhanced features that support both fixed-documents and flow-documents, advanced viewing controls, combined with powerful 2D and 3D graphic capabilities take [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications to a new level of quality and user experience.</span></span>  <span data-ttu-id="725a2-105">ドキュメントのメモリ内の表現を柔軟に管理できることは [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] の重要な機能であり、ほぼすべてのアプリケーションではデータ ストアのドキュメントを効率的に保存および読み込むことができる必要があります。</span><span class="sxs-lookup"><span data-stu-id="725a2-105">Being able to flexibly manage an in-memory representation of a document is a key feature of [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)], and being able to efficiently save and load documents from a data store is a need of almost every application.</span></span>  <span data-ttu-id="725a2-106">内部のメモリ内表現から外部のデータ ストアにドキュメントを変換するプロセスは、シリアル化と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="725a2-106">The process of converting a document from an internal in-memory representation to an external data store is termed serialization.</span></span>  <span data-ttu-id="725a2-107">データ ストアを読み取って元のメモリ内インスタンスを再作成する逆のプロセスは、逆シリアル化と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="725a2-107">The reverse process of reading a data store and recreating the original in-memory instance is termed deserialization.</span></span>  
  
 
  
<a name="AboutSerialization"></a>   
## <a name="about-document-serialization"></a><span data-ttu-id="725a2-108">ドキュメントのシリアル化について</span><span class="sxs-lookup"><span data-stu-id="725a2-108">About Document Serialization</span></span>  
 <span data-ttu-id="725a2-109">ドキュメントをメモリからシリアル化し、後で逆シリアル化してメモリに戻すプロセスは、アプリケーションに対して透過的に行われるのが理想的です。</span><span class="sxs-lookup"><span data-stu-id="725a2-109">Ideally the process of serializing and deserializing a document from and then back into memory is transparent to the application.</span></span>  <span data-ttu-id="725a2-110">アプリケーションは、シリアライザーの "書き込み" メソッドを呼び出してドキュメントを保存します。デシリアライザーの "読み取り" メソッドは、データ ストアにアクセスし、メモリ内の元のインスタンスを再作成します。</span><span class="sxs-lookup"><span data-stu-id="725a2-110">The application calls a serializer "write" method to save the document, while a deserializer "read" method accesses the data store and recreates the original instance in memory.</span></span>  <span data-ttu-id="725a2-111">通常、シリアル化と逆シリアル化のプロセスで元の形式のドキュメントが再作成される限り、データが格納される特定の形式はアプリケーションにとって問題ではありません。</span><span class="sxs-lookup"><span data-stu-id="725a2-111">The specific format that the data is stored in is generally not a concern of the application as long as the serialize and deserialize process recreates the document back to its original form.</span></span>  
  
 <span data-ttu-id="725a2-112">多くの場合、アプリケーションでは複数のシリアル化オプションが提供され、ユーザーは異なるメディアまたは異なる形式にドキュメントを保存できます。</span><span class="sxs-lookup"><span data-stu-id="725a2-112">Applications often provide multiple serialization options which allow the user to save documents to different medium or to a different format.</span></span>  <span data-ttu-id="725a2-113">たとえば、[名前を付けて保存] オプションでは、ドキュメントをディスク ファイル、データベース、Web サービスなどに保存できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="725a2-113">For example, an application might offer "Save As" options to store a document to a disk file, database, or web service.</span></span>  <span data-ttu-id="725a2-114">同様に、別のシリアライザーでは、HTML、RTF、XML、XPS、サード パーティ形式などのさまざまな形式でドキュメントを格納できます。</span><span class="sxs-lookup"><span data-stu-id="725a2-114">Similarly, different serializers could store the document in different formats such as in HTML, RTF, XML, XPS, or alternately to a third-party format.</span></span>  <span data-ttu-id="725a2-115">アプリケーションに対して、シリアル化により、実装内のストレージ メディアの詳細を分離するインターフェイスが定義されます。</span><span class="sxs-lookup"><span data-stu-id="725a2-115">To the application, serialization defines an interface that isolates the details of the storage medium within the implementation of each specific serializer.</span></span>  <span data-ttu-id="725a2-116">記憶域の詳細をカプセル化の利点に加え、 [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] <xref:System.Windows.Documents.Serialization> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]他のいくつかの重要な機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="725a2-116">In addition to the benefits of encapsulating storage details, the [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] <xref:System.Windows.Documents.Serialization> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] provide several other important features.</span></span>  
  
### <a name="features-of-net-framework-30-document-serializers"></a><span data-ttu-id="725a2-117">.NET Framework 3.0 ドキュメント シリアライザーの機能</span><span class="sxs-lookup"><span data-stu-id="725a2-117">Features of .NET Framework 3.0 Document Serializers</span></span>  
  
-   <span data-ttu-id="725a2-118">上位レベルのドキュメント オブジェクト (論理ツリーとビジュアル) に直接アクセスすることにより、ページ分割されたコンテンツ、2D/3D 要素、イメージ、メディア、ハイパーリンク、注釈、およびその他のサポート コンテンツの効率的な保存が可能になります。</span><span class="sxs-lookup"><span data-stu-id="725a2-118">Direct access to the high-level document objects (logical tree and visuals) enable efficient storage of paginated content, 2D/3D elements, images, media, hyperlinks, annotations, and other support content.</span></span>  
  
-   <span data-ttu-id="725a2-119">同期操作と非同期操作。</span><span class="sxs-lookup"><span data-stu-id="725a2-119">Synchronous and asynchronous operation.</span></span>  
  
-   <span data-ttu-id="725a2-120">拡張機能でのプラグイン シリアライザーのサポート:</span><span class="sxs-lookup"><span data-stu-id="725a2-120">Support for plug-in serializers with enhanced capabilities:</span></span>  
  
    -   <span data-ttu-id="725a2-121">すべての [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] アプリケーションで使用するためのシステム全体のアクセス。</span><span class="sxs-lookup"><span data-stu-id="725a2-121">System-wide access for use by all [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications.</span></span>  
  
    -   <span data-ttu-id="725a2-122">簡単なアプリケーション プラグインの検出。</span><span class="sxs-lookup"><span data-stu-id="725a2-122">Simple application plug-in discoverability.</span></span>  
  
    -   <span data-ttu-id="725a2-123">カスタム サードパーティ プラグインの簡単な展開、インストール、更新。</span><span class="sxs-lookup"><span data-stu-id="725a2-123">Simple deployment, installation, and update for custom third-party plug-ins.</span></span>  
  
    -   <span data-ttu-id="725a2-124">カスタム実行時設定とオプションのユーザー インターフェイス サポート。</span><span class="sxs-lookup"><span data-stu-id="725a2-124">User interface support for custom run-time settings and options.</span></span>  
  
### <a name="xps-print-path"></a><span data-ttu-id="725a2-125">XPS 印刷パス</span><span class="sxs-lookup"><span data-stu-id="725a2-125">XPS Print Path</span></span>  
 <span data-ttu-id="725a2-126">[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)][!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] の印刷パスでは、印刷出力によってドキュメントを作成するための拡張機構も提供されます。</span><span class="sxs-lookup"><span data-stu-id="725a2-126">The [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path also provides an extensible mechanism for writing documents through print output.</span></span>  [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]<span data-ttu-id="725a2-127"> は、ドキュメント ファイル形式と、[!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] のネイティブ印刷スプール形式の両方として機能します。</span><span class="sxs-lookup"><span data-stu-id="725a2-127"> serves as both a document file format and is the native print spool format for [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].</span></span>  [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]<span data-ttu-id="725a2-128"> のドキュメントは [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] 互換性のあるプリンターに直接送信でき、中間形式に変換する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="725a2-128"> documents can be sent directly to [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]-compatible printers without the need for conversion to an intermediate format.</span></span>  <span data-ttu-id="725a2-129">印刷パス出力オプションと機能について詳しくは、「[印刷の概要](../../../../docs/framework/wpf/advanced/printing-overview.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="725a2-129">See the [Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md) for additional information on print path output options and capabilities.</span></span>  
  
<a name="PluginSerializers"></a>   
## <a name="plug-in-serializers"></a><span data-ttu-id="725a2-130">プラグイン シリアライザー</span><span class="sxs-lookup"><span data-stu-id="725a2-130">Plug-in Serializers</span></span>  
 <span data-ttu-id="725a2-131"><xref:System.Windows.Documents.Serialization> Api は、プラグイン シリアライザーと、アプリケーションから個別にインストールされているリンクされたシリアライザーの両方のサポートを提供し、実行時に、バインドを使用してアクセス、<xref:System.Windows.Documents.Serialization.SerializerProvider>探索メカニズムです。</span><span class="sxs-lookup"><span data-stu-id="725a2-131">The <xref:System.Windows.Documents.Serialization> APIs provide support for both plug-in serializers and linked serializers that are installed separately from the application, bind at run time, and are accessed by using the <xref:System.Windows.Documents.Serialization.SerializerProvider> discovery mechanism.</span></span>  <span data-ttu-id="725a2-132">プラグイン シリアライザーには、簡単に展開でき、システム全体で使用できるという大きな利点があります。</span><span class="sxs-lookup"><span data-stu-id="725a2-132">Plug-in serializers offer enhanced benefits for ease of deployment and system-wide use.</span></span>  <span data-ttu-id="725a2-133">プラグイン シリアライザーにアクセスできない [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] などの部分信頼環境には、リンクされたシリアライザーを実装することもできます。</span><span class="sxs-lookup"><span data-stu-id="725a2-133">Linked serializers can also be implemented for partial trust environments such as [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] where plug-in serializers are not accessible.</span></span>  <span data-ttu-id="725a2-134">派生の実装に基づいているシリアライザーのリンク、<xref:System.Windows.Documents.Serialization.SerializerWriter>クラス、コンパイルされ、アプリケーションに直接リンクされています。</span><span class="sxs-lookup"><span data-stu-id="725a2-134">Linked serializers, which are based on a derived implementation of the <xref:System.Windows.Documents.Serialization.SerializerWriter> class, are compiled and linked directly into the application.</span></span>  <span data-ttu-id="725a2-135">プラグイン シリアライザーとリンクされたシリアライザーはどちらも同じパブリック メソッドとイベントを通じて動作するので、同じアプリケーションでどちらか一方でも両方のシリアライザーでも簡単に使うことができます。</span><span class="sxs-lookup"><span data-stu-id="725a2-135">Both plug-in serializers and linked serializers operate through identical public methods and events which make it easy to use either or both types of serializers in the same application.</span></span>  
  
 <span data-ttu-id="725a2-136">アプリケーション開発者にとっての利点として、プラグイン シリアライザーは新しいストレージ設計およびファイル形式に対する拡張性を備え、ビルド時に可能性のあるすべての形式を直接コーディングする必要はありません。</span><span class="sxs-lookup"><span data-stu-id="725a2-136">Plug-in serializers aid application developers by providing extensibility to new storage designs and file formats without having to code directly for every potential format at build time.</span></span>  <span data-ttu-id="725a2-137">また、サードパーティの開発者にとっても、プラグイン シリアライザーには、カスタムまたは独自のファイル形式のためのシステムでアクセス可能なプラグインを展開、インストール、更新する標準化された手段が提供されるというメリットがあります。</span><span class="sxs-lookup"><span data-stu-id="725a2-137">Plug-in serializers also benefit third-party developers by providing a standardized means to deploy, install, and update system accessible plug-ins for custom or proprietary file formats.</span></span>  
  
### <a name="using-a-plug-in-serializer"></a><span data-ttu-id="725a2-138">プラグイン シリアライザーの使用</span><span class="sxs-lookup"><span data-stu-id="725a2-138">Using a Plug-in Serializer</span></span>  
 <span data-ttu-id="725a2-139">プラグイン シリアライザーは簡単に使うことができます。</span><span class="sxs-lookup"><span data-stu-id="725a2-139">Plug-in serializers are simple to use.</span></span>  <span data-ttu-id="725a2-140"><xref:System.Windows.Documents.Serialization.SerializerProvider>クラスを列挙、<xref:System.Windows.Documents.Serialization.SerializerDescriptor>システムにインストールされている各プラグインのオブジェクトします。</span><span class="sxs-lookup"><span data-stu-id="725a2-140">The <xref:System.Windows.Documents.Serialization.SerializerProvider> class enumerates a <xref:System.Windows.Documents.Serialization.SerializerDescriptor> object for each plug-in installed on the system.</span></span>  <span data-ttu-id="725a2-141"><xref:System.Windows.Documents.Serialization.SerializerDescriptor.IsLoadable%2A>プロパティは、現在の構成に基づいたインストール済みのプラグインをフィルター処理し、シリアライザーの読み込まれ、アプリケーションで使用されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="725a2-141">The <xref:System.Windows.Documents.Serialization.SerializerDescriptor.IsLoadable%2A> property filters the installed plug-ins based on the current configuration and verifies that the serializer can be loaded and used by the application.</span></span>  <span data-ttu-id="725a2-142"><xref:System.Windows.Documents.Serialization.SerializerDescriptor>などその他のプロパティの提供も<xref:System.Windows.Documents.Serialization.SerializerDescriptor.DisplayName%2A>と<xref:System.Windows.Documents.Serialization.SerializerDescriptor.DefaultFileExtension%2A>、使用可能な出力形式のシリアライザーの選択にユーザー入力を求める、アプリケーションが使用できます。</span><span class="sxs-lookup"><span data-stu-id="725a2-142">The <xref:System.Windows.Documents.Serialization.SerializerDescriptor> also provides other properties, such as <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DisplayName%2A> and <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DefaultFileExtension%2A>, which the application can use to prompt the user in selecting a serializer for an available output format.</span></span>  <span data-ttu-id="725a2-143">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] 用の既定のプラグイン シリアライザーは [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] で提供され、常に列挙されます。</span><span class="sxs-lookup"><span data-stu-id="725a2-143">A default plug-in serializer for [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] is provided with [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] and is always enumerated.</span></span>  <span data-ttu-id="725a2-144">ユーザーが、出力形式を選択した後、<xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A>メソッドの使用を作成、<xref:System.Windows.Documents.Serialization.SerializerWriter>の特定の形式です。</span><span class="sxs-lookup"><span data-stu-id="725a2-144">After the user selects an output format, the <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> method is used to create a <xref:System.Windows.Documents.Serialization.SerializerWriter> for the specific format.</span></span>  <span data-ttu-id="725a2-145"><xref:System.Windows.Documents.Serialization.SerializerWriter>.<xref:System.Windows.Documents.Serialization.SerializerWriter.Write%2A>メソッドは、データ ストアにドキュメント ストリームを出力し、呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="725a2-145">The <xref:System.Windows.Documents.Serialization.SerializerWriter>.<xref:System.Windows.Documents.Serialization.SerializerWriter.Write%2A> method can then be called to output the document stream to the data store.</span></span>  
  
 <span data-ttu-id="725a2-146">次の例では、使用するアプリケーションを<xref:System.Windows.Documents.Serialization.SerializerProvider>"PlugInFileFilter"プロパティのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="725a2-146">The following example illustrates an application that uses the <xref:System.Windows.Documents.Serialization.SerializerProvider> method in a "PlugInFileFilter" property.</span></span>  <span data-ttu-id="725a2-147">PlugInFileFilter がインストールされているプラグインを列挙しの使用可能なファイルのオプションのフィルター文字列を構築、<xref:Microsoft.Win32.SaveFileDialog>です。</span><span class="sxs-lookup"><span data-stu-id="725a2-147">PlugInFileFilter enumerates the installed plug-ins and builds a filter string with the available file options for a <xref:Microsoft.Win32.SaveFileDialog>.</span></span>  
  
 [!code-csharp[DocumentSerialize#DocSerializeFileFilter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DocumentSerialize/CSharp/ThumbViewer.cs#docserializefilefilter)]  
  
 <span data-ttu-id="725a2-148">出力ファイル名がユーザーによって選択された後、次の例の使用、<xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A>指定の形式で、特定のドキュメントを格納する方法です。</span><span class="sxs-lookup"><span data-stu-id="725a2-148">After an output file name has been selected by the user, the following example illustrates use of the <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> method to store a given document in a specified format.</span></span>  
  
 [!code-csharp[DocumentSerialize#DocSerializePlugIn](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DocumentSerialize/CSharp/ThumbViewer.cs#docserializeplugin)]  
  
<a name="InstallingPluginSerializers"></a>   
### <a name="installing-plug-in-serializers"></a><span data-ttu-id="725a2-149">プラグイン シリアライザーのインストール</span><span class="sxs-lookup"><span data-stu-id="725a2-149">Installing Plug-in Serializers</span></span>  
 <span data-ttu-id="725a2-150"><xref:System.Windows.Documents.Serialization.SerializerProvider>クラスは、プラグイン シリアライザー探索およびアクセスの上位レベルのアプリケーション インターフェイスを提供します。</span><span class="sxs-lookup"><span data-stu-id="725a2-150">The <xref:System.Windows.Documents.Serialization.SerializerProvider> class supplies the upper-level application interface for plug-in serializer discovery and access.</span></span>  <span data-ttu-id="725a2-151"><xref:System.Windows.Documents.Serialization.SerializerProvider>検索し、アプリケーションがインストールされ、システム上でアクセスするシリアライザーの一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="725a2-151"><xref:System.Windows.Documents.Serialization.SerializerProvider> locates and provides the application a list of the serializers that are installed and accessible on the system.</span></span>  <span data-ttu-id="725a2-152">インストールされているシリアライザーの詳細は、レジストリ設定によって定義されます。</span><span class="sxs-lookup"><span data-stu-id="725a2-152">The specifics of the installed serializers are defined through registry settings.</span></span>  <span data-ttu-id="725a2-153">プラグイン シリアライザーを使用して、レジストリに追加されることができます、<xref:System.Windows.Documents.Serialization.SerializerProvider.RegisterSerializer%2A>メソッド場合[!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)]がまだないインストールの場合は、一連のレジストリ値自体直接、プラグインのインストール スクリプトになります。</span><span class="sxs-lookup"><span data-stu-id="725a2-153">Plug-in serializers can be added to the registry by using the <xref:System.Windows.Documents.Serialization.SerializerProvider.RegisterSerializer%2A> method; or if [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] is not yet installed, the plug-in installation script can directly set the registry values itself.</span></span>  <span data-ttu-id="725a2-154"><xref:System.Windows.Documents.Serialization.SerializerProvider.UnregisterSerializer%2A>以前にインストールを削除するメソッドを使用できるプラグイン、レジストリ設定は、アンインストール スクリプトによって同様にリセットすることもできます。</span><span class="sxs-lookup"><span data-stu-id="725a2-154">The <xref:System.Windows.Documents.Serialization.SerializerProvider.UnregisterSerializer%2A> method can be used to remove a previously installed plug-in, or the registry settings can be reset similarly by an uninstall script.</span></span>  
  
### <a name="creating-a-plug-in-serializer"></a><span data-ttu-id="725a2-155">プラグイン シリアライザーの作成</span><span class="sxs-lookup"><span data-stu-id="725a2-155">Creating a Plug-in Serializer</span></span>  
 <span data-ttu-id="725a2-156">プラグイン シリアライザーとリンクされたシリアライザーはどちらも、同じ公開されたパブリック メソッドとイベントを使い、同期または非同期で動作するように同じように設計できます。</span><span class="sxs-lookup"><span data-stu-id="725a2-156">Both plug-in serializers and linked serializers use the same exposed public methods and events, and similarly can be designed to operate either synchronously or asynchronously.</span></span>  <span data-ttu-id="725a2-157">通常、プラグイン シリアライザーの作成には 3 つの基本的な手順があります。</span><span class="sxs-lookup"><span data-stu-id="725a2-157">There are three basic steps normally followed to create a plug-in serializer:</span></span>  
  
1.  <span data-ttu-id="725a2-158">最初に、シリアライザーをリンクされたシリアライザーとして実装してデバッグします。</span><span class="sxs-lookup"><span data-stu-id="725a2-158">Implement and debug the serializer first as a linked serializer.</span></span>  <span data-ttu-id="725a2-159">コンパイルしてテスト アプリケーションに直接リンクするシリアライザーを最初に作成すると、テストに役立つブレークポイントや他のデバッグ サービスに完全にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="725a2-159">Initially creating the serializer compiled and linked directly in a test application provides full access to breakpoints and other debug services helpful for testing.</span></span>  
  
2.  <span data-ttu-id="725a2-160">シリアライザーを完全にテストした後、<xref:System.Windows.Documents.Serialization.ISerializerFactory>プラグインを作成するインターフェイスを追加します。</span><span class="sxs-lookup"><span data-stu-id="725a2-160">After the serializer is fully tested, an <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface is added to create a plug-in.</span></span>  <span data-ttu-id="725a2-161"><xref:System.Windows.Documents.Serialization.ISerializerFactory>インターフェイスによって、すべてへのフル アクセス[!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)]論理ツリーを含むオブジェクト<xref:System.Windows.UIElement>オブジェクト、 <xref:System.Windows.Documents.IDocumentPaginatorSource>、および<xref:System.Windows.Media.Visual>要素。</span><span class="sxs-lookup"><span data-stu-id="725a2-161">The <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface permits full access to all [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] objects which includes the logical tree, <xref:System.Windows.UIElement> objects, <xref:System.Windows.Documents.IDocumentPaginatorSource>, and <xref:System.Windows.Media.Visual> elements.</span></span>  <span data-ttu-id="725a2-162">さらに<xref:System.Windows.Documents.Serialization.ISerializerFactory>同じ同期および非同期のメソッドとリンクされたシリアライザーで使用されるイベントを提供します。</span><span class="sxs-lookup"><span data-stu-id="725a2-162">Additionally <xref:System.Windows.Documents.Serialization.ISerializerFactory> provides the same synchronous and asynchronous methods and events used by linked serializers.</span></span>  <span data-ttu-id="725a2-163">サイズの大きいドキュメントの出力には時間がかかる場合があるため、ユーザーの操作に応答できる状態を維持し、データ ストアで問題が発生した場合の "キャンセル" オプションを提供できるよう、非同期操作を使うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="725a2-163">Since large documents can take time to output, asynchronous operations are recommended to maintain responsive user interaction and offer a "Cancel" option if some problem occurs with the data store.</span></span>  
  
3.  <span data-ttu-id="725a2-164">プラグイン シリアライザーを作成した後、プラグインを配布してインストール (およびアンインストール) するためのインストール スクリプトを実装します (前の「[プラグイン シリアライザーのインストール](#InstallingPluginSerializers)」を参照)。</span><span class="sxs-lookup"><span data-stu-id="725a2-164">After the plug-in serializer is created, an installation script is implemented for distributing and installing (and uninstalling) the plug-in (see above, "[Installing Plug-in Serializers](#InstallingPluginSerializers)").</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="725a2-165">関連項目</span><span class="sxs-lookup"><span data-stu-id="725a2-165">See Also</span></span>  
 <xref:System.Windows.Documents.Serialization>  
 <xref:System.Windows.Xps.XpsDocumentWriter>  
 <xref:System.Windows.Xps.Packaging.XpsDocument>  
 [<span data-ttu-id="725a2-166">WPF のドキュメント</span><span class="sxs-lookup"><span data-stu-id="725a2-166">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="725a2-167">印刷の概要</span><span class="sxs-lookup"><span data-stu-id="725a2-167">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)  
 [<span data-ttu-id="725a2-168">XML Paper Specification: 概要</span><span class="sxs-lookup"><span data-stu-id="725a2-168">XML Paper Specification: Overview</span></span>](http://go.microsoft.com/fwlink?LinkID=106246)
