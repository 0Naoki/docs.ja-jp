---
title: "Windows フォーム DataGridView コントロールを拡張するための推奨される手順"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
caps.latest.revision: "31"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: bfefd41a4773c81757f73e725095057f988cef2c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="8dd81-102">Windows フォーム DataGridView コントロールを拡張するための推奨される手順</span><span class="sxs-lookup"><span data-stu-id="8dd81-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="8dd81-103"><xref:System.Windows.Forms.DataGridView>コントロールが最大限のスケーラビリティを提供するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="8dd81-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="8dd81-104">大量のデータを表示する必要がある場合または大量のメモリを使用して、ユーザー インターフェイス (UI) の応答性を低下させることを回避するには、このトピックで説明されているガイドラインに従ってください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="8dd81-105">このトピックでは、次の問題について説明します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-105">This topic discusses the following issues:</span></span>  
  
-   <span data-ttu-id="8dd81-106">セル スタイルを効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-106">Using cell styles efficiently</span></span>  
  
-   <span data-ttu-id="8dd81-107">ショートカット メニューを効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-107">Using shortcut menus efficiently</span></span>  
  
-   <span data-ttu-id="8dd81-108">自動サイズ変更の効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-108">Using automatic resizing efficiently</span></span>  
  
-   <span data-ttu-id="8dd81-109">選択したセル、行、および列のコレクションの効率的な使用</span><span class="sxs-lookup"><span data-stu-id="8dd81-109">Using the selected cells, rows, and columns collections efficiently</span></span>  
  
-   <span data-ttu-id="8dd81-110">共有行の使用</span><span class="sxs-lookup"><span data-stu-id="8dd81-110">Using shared rows</span></span>  
  
-   <span data-ttu-id="8dd81-111">行が非共有になることを妨げてください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-111">Preventing rows from becoming unshared</span></span>  
  
 <span data-ttu-id="8dd81-112">特別なパフォーマンスのニーズがある場合は、仮想モードを実装し、独自のデータ管理操作を提供できます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="8dd81-113">詳細については、次を参照してください。 [Windows フォーム DataGridView コントロールでのデータ表示モード](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="8dd81-114">セル スタイルを効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-114">Using Cell Styles Efficiently</span></span>  
 <span data-ttu-id="8dd81-115">各セル、行、および列には、独自のスタイル情報を持つことができます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="8dd81-116">スタイル情報が格納されている<xref:System.Windows.Forms.DataGridViewCellStyle>オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="8dd81-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="8dd81-117">多くの個々 のセル スタイル オブジェクトを作成する<xref:System.Windows.Forms.DataGridView>大量のデータを使用する場合に特にに要素が、効率的にすることができます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="8dd81-118">パフォーマンスに影響を回避するのには、次のガイドラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-118">To avoid a performance impact, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="8dd81-119">個々 のセル スタイル プロパティを設定しないように<xref:System.Windows.Forms.DataGridViewCell>または<xref:System.Windows.Forms.DataGridViewRow>オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="8dd81-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="8dd81-120">指定された行のオブジェクトが含まれます、<xref:System.Windows.Forms.DataGridView.RowTemplate%2A>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="8dd81-121">テンプレートのセル スタイル オブジェクトのコピーが新しい行のテンプレートから複製する各行に表示されます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="8dd81-122">スケーラビリティを最大にするでのセル スタイル プロパティを設定、<xref:System.Windows.Forms.DataGridView>レベル。</span><span class="sxs-lookup"><span data-stu-id="8dd81-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="8dd81-123">たとえば、設定、<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>プロパティではなく、<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="8dd81-124">一部のセルは、既定の書式設定よりもその他の書式設定を必要とする場合と同じ使用<xref:System.Windows.Forms.DataGridViewCellStyle>セル、行、または列のグループにまたがるインスタンス。</span><span class="sxs-lookup"><span data-stu-id="8dd81-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="8dd81-125">型のプロパティを直接設定しないでください<xref:System.Windows.Forms.DataGridViewCellStyle>個々 のセル、行、および列にします。</span><span class="sxs-lookup"><span data-stu-id="8dd81-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="8dd81-126">セルのスタイルの共有の例は、次を参照してください。[する方法: Windows フォーム DataGridView コントロールの既定のセル スタイルの設定](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="8dd81-127">セルのスタイルを処理することにより個別に設定するときにも、パフォーマンスの低下を回避できます、<xref:System.Windows.Forms.DataGridView.CellFormatting>イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="8dd81-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="8dd81-128">例については、次を参照してください。[する方法: Windows フォーム DataGridView コントロールでデータの書式をカスタマイズする](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md)です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="8dd81-129">セルのスタイルを決定するときに使用して、<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>プロパティではなく、<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="8dd81-130">アクセス、<xref:System.Windows.Forms.DataGridViewCell.Style%2A>プロパティの新しいインスタンスを作成する、<xref:System.Windows.Forms.DataGridViewCellStyle>クラスのプロパティは既に使用されていない場合。</span><span class="sxs-lookup"><span data-stu-id="8dd81-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="8dd81-131">さらに、このオブジェクトには可能性がありますが含まれていませんのセルの完全なスタイル情報には一部のスタイルは、行、列、またはコントロールから継承された場合。</span><span class="sxs-lookup"><span data-stu-id="8dd81-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="8dd81-132">セル スタイルの継承の詳細については、次を参照してください。 [Windows フォーム DataGridView コントロールのセル スタイル](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="8dd81-133">ショートカット メニューを効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-133">Using Shortcut Menus Efficiently</span></span>  
 <span data-ttu-id="8dd81-134">各セル、行、および列には、独自のショートカット メニューを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="8dd81-135">ショートカット メニューで、<xref:System.Windows.Forms.DataGridView>コントロールがによって表される<xref:System.Windows.Forms.ContextMenuStrip>コントロール。</span><span class="sxs-lookup"><span data-stu-id="8dd81-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="8dd81-136">セル スタイル オブジェクトと同様に、多くの個々 のショートカット メニューを作成します。<xref:System.Windows.Forms.DataGridView>要素には、パフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="8dd81-137">この低下を避けるためには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="8dd81-137">To avoid this penalty, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="8dd81-138">個々 のセルと行のショートカット メニューを作成しないでください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="8dd81-139">これには、コントロールに新しい行が追加されると共に、ショートカット メニューを複製する行テンプレートが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="8dd81-140">最大限のスケーラビリティ、管理を使用してのみの<xref:System.Windows.Forms.Control.ContextMenuStrip%2A>プロパティ コントロール全体の 1 つのショートカット メニューを指定します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>  
  
-   <span data-ttu-id="8dd81-141">で複数の行またはセルを複数のショートカット メニューを要求する場合は、処理、<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>または<xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>イベント。</span><span class="sxs-lookup"><span data-stu-id="8dd81-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="8dd81-142">これらのイベントでは、ショートカット メニュー オブジェクトを管理できます。 自分で、パフォーマンスを調整することができます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>  
  
## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="8dd81-143">自動サイズ変更の効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-143">Using Automatic Resizing Efficiently</span></span>  
 <span data-ttu-id="8dd81-144">行、列、およびヘッダーに自動的にサイズを変更できるセルの内容の変更としてセルの内容全体がクリッピングなしに表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="8dd81-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="8dd81-145">サイズ変更モードを変更することができますもサイズを変更する行、列、およびヘッダー。</span><span class="sxs-lookup"><span data-stu-id="8dd81-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="8dd81-146">適切なサイズを決定する、<xref:System.Windows.Forms.DataGridView>コントロールに対応する必要がありますの各セルの値を調べる必要があります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="8dd81-147">大きなデータ セットを使用するときにこの分析できるパフォーマンスに悪影響コントロールの自動サイズ変更が発生したとき。</span><span class="sxs-lookup"><span data-stu-id="8dd81-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="8dd81-148">パフォーマンスの低下を避けるためには、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="8dd81-148">To avoid performance penalties, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="8dd81-149">自動サイズ変更は使用しないでください、<xref:System.Windows.Forms.DataGridView>行の大きなセットで制御します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="8dd81-150">自動サイズ変更、表示されている行に基づくサイズ変更のみを使用場合します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="8dd81-151">仮想モードにも表示されている行のみを使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-151">Use only the displayed rows in virtual mode as well.</span></span>  
  
    -   <span data-ttu-id="8dd81-152">行と列を使用して、`DisplayedCells`または`DisplayedCellsExceptHeaders`のフィールド、 <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>、 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>、および<xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode>列挙体です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>  
  
    -   <span data-ttu-id="8dd81-153">行ヘッダーを使用して、<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders>または<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader>のフィールド、<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode>列挙します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>  
  
-   <span data-ttu-id="8dd81-154">スケーラビリティを最大にするには、サイズの自動調整をオフにして、プログラムによるサイズ変更を使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>  
  
 <span data-ttu-id="8dd81-155">詳細については、次を参照してください。 [Windows フォーム DataGridView コントロールのサイズ変更オプション](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="8dd81-156">選択したセル、行、および列のコレクションを効率的に使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>  
 <span data-ttu-id="8dd81-157"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A>大規模な選択にコレクションが効率的に実行されません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="8dd81-158"><xref:System.Windows.Forms.DataGridView.SelectedRows%2A>と<xref:System.Windows.Forms.DataGridView.SelectedColumns%2A>コレクション解除することも、効率的な度より低いレベルには一般的なセルより少ない数の行があるため<xref:System.Windows.Forms.DataGridView>制御、および行よりも多くの少ない列です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="8dd81-159">パフォーマンスの低下を避けるためには、これらのコレクションを使用する場合、次のガイドラインに従います。</span><span class="sxs-lookup"><span data-stu-id="8dd81-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="8dd81-160">決定するかどうかのすべてのセル、<xref:System.Windows.Forms.DataGridView>の内容にアクセスする前に選択されている、 <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> 、コレクションの戻り値を確認して、<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="8dd81-161">ただし、このメソッドは、共有が解除する行で発生することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="8dd81-162">詳細については、次のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-162">For more information, see the next section.</span></span>  
  
-   <span data-ttu-id="8dd81-163">使用しないでください、<xref:System.Collections.ICollection.Count%2A>のプロパティ、<xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType>を選択したセルの数を決定します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="8dd81-164">代わりに、使用、<xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType>メソッドを渡します、<xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType>値。</span><span class="sxs-lookup"><span data-stu-id="8dd81-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="8dd81-165">同様に、使用、<xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType>と<xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType>メソッドを選択した行と列コレクションにアクセスするのではなく、選択した要素の数を決定します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>  
  
-   <span data-ttu-id="8dd81-166">セルに基づく選択モードは避けてください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="8dd81-167">代わりに、設定、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>プロパティを<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>または<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
## <a name="using-shared-rows"></a><span data-ttu-id="8dd81-168">行の共有の使用</span><span class="sxs-lookup"><span data-stu-id="8dd81-168">Using Shared Rows</span></span>  
 <span data-ttu-id="8dd81-169">効率的なメモリの使用を行う、<xref:System.Windows.Forms.DataGridView>共有行を制御します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="8dd81-170">行のインスタンスを共有することで、できるだけ、外観と動作に関する多くの情報を共有、<xref:System.Windows.Forms.DataGridViewRow>クラスです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>  
  
 <span data-ttu-id="8dd81-171">行のインスタンスの共有メモリを節約できる行は簡単になる共有されていません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="8dd81-172">たとえば、ユーザーは、セルと直接やり取りをするたびにその行は非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="8dd81-173">これを回避することはできません、ためこのトピックのガイドラインでは、非常に大量のデータを使用する場合にのみ、ユーザーが操作するデータの割合が比較的小さいプログラムを実行するたびに場合にのみ役立ちます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>  
  
 <span data-ttu-id="8dd81-174">行を共有することはできません、バインドされていないで<xref:System.Windows.Forms.DataGridView>のセルの値が含まれている場合は、制御します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="8dd81-175">ときに、<xref:System.Windows.Forms.DataGridView>コントロールが外部データ ソースにバインドされているか、セル オブジェクトであり、共有する行ではなく、コントロールの外部仮想モードを実装する独自のデータ ソースを指定すると、セルの値が格納されます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>  
  
 <span data-ttu-id="8dd81-176">行オブジェクトは、行の状態と、セルを含む列の状態からすべてのセルの状態を特定できない場合にのみ共有できます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="8dd81-177">場合は、行と列の状態から不要になった推測できるように、セルの状態を変更すると、行を共有することはできません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>  
  
 <span data-ttu-id="8dd81-178">たとえば、行は、次の状況のいずれかで共有できません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-178">For example, a row cannot be shared in any of the following situations:</span></span>  
  
-   <span data-ttu-id="8dd81-179">行には、選択した列に含まれていない 1 つの選択したセルが含まれています。</span><span class="sxs-lookup"><span data-stu-id="8dd81-179">The row contains a single selected cell that is not in a selected column.</span></span>  
  
-   <span data-ttu-id="8dd81-180">行を含むセルに含まれるその<xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A>または<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>  
  
-   <span data-ttu-id="8dd81-181">行に含まれる、<xref:System.Windows.Forms.DataGridViewComboBoxCell>でその<xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A>プロパティ セットです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>  
  
 <span data-ttu-id="8dd81-182">バインド モードまたは仮想モードで使用できるツールヒントとショートカット メニューの個々 のセルの処理によって、<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded>と<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>イベント。</span><span class="sxs-lookup"><span data-stu-id="8dd81-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>  
  
 <span data-ttu-id="8dd81-183"><xref:System.Windows.Forms.DataGridView>コントロールは自動的に試みますに行が追加されるたびに、共有された行を使用して、<xref:System.Windows.Forms.DataGridViewRowCollection>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="8dd81-184">次のガイドラインを使用して、行を共有することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-184">Use the following guidelines to ensure that rows are shared:</span></span>  
  
-   <span data-ttu-id="8dd81-185">通話を避けるため、`Add(Object[])`のオーバー ロード、<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>メソッドおよび`Insert(Object[])`のオーバー ロード、<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>のメソッド、<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="8dd81-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="8dd81-186">これらのオーバー ロードは、共有されていない行を自動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-186">These overloads automatically create unshared rows.</span></span>  
  
-   <span data-ttu-id="8dd81-187">あることを確認で指定された行、<xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType>プロパティは、次の場合に共有できます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>  
  
    -   <span data-ttu-id="8dd81-188">呼び出すときに、`Add()`または`Add(Int32)`のオーバー ロードが、<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>メソッドまたは`Insert(Int32,Int32)`のオーバー ロード、<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>のメソッド、<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="8dd81-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
    -   <span data-ttu-id="8dd81-189">値を増やすときに、<xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>  
  
    -   <span data-ttu-id="8dd81-190">設定するときに、<xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="8dd81-191">あることを確認で示される行、`indexSource`を呼び出すときに、パラメーターを共有することができます、 <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>、 <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>、 <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>、および<xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A>のメソッド、<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="8dd81-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
-   <span data-ttu-id="8dd81-192">指定された行の行で共有できることを呼び出すときに、必ず、`Add(DataGridViewRow)`のオーバー ロード、<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>メソッド、<xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A>メソッド、`Insert(Int32,DataGridViewRow)`のオーバー ロード、<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>メソッド、および<xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A>のメソッド<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="8dd81-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
 <span data-ttu-id="8dd81-193">行を共有するかどうかを判断するのには、使用、<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>行オブジェクトを取得し、オブジェクトのメソッド<xref:System.Windows.Forms.DataGridViewBand.Index%2A>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="8dd81-194">常に共有行である、 <xref:System.Windows.Forms.DataGridViewBand.Index%2A> – 1 のプロパティの値。</span><span class="sxs-lookup"><span data-stu-id="8dd81-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>  
  
## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="8dd81-195">行が非共有になることを妨げてください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-195">Preventing Rows from Becoming Unshared</span></span>  
 <span data-ttu-id="8dd81-196">共有行は、コードまたはユーザーの操作の結果として共有されていないになることができます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="8dd81-197">パフォーマンスに影響を回避するのには、共有が解除する行の原因を避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="8dd81-198">処理できるアプリケーションの開発中、<xref:System.Windows.Forms.DataGridView.RowUnshared>行に非共有になる時期を決定するイベントです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="8dd81-199">これは、機能は、行の共有の問題をデバッグするときに便利です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-199">This is useful when debugging row-sharing problems.</span></span>  
  
 <span data-ttu-id="8dd81-200">行が非共有にならないようにするのには、次のガイドラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="8dd81-201">インデックス作成を避けるため、<xref:System.Windows.Forms.DataGridView.Rows%2A>またはコレクションを反復処理に使用して、`foreach`ループします。</span><span class="sxs-lookup"><span data-stu-id="8dd81-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="8dd81-202">行に直接アクセスする通常必要はありません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="8dd81-203"><xref:System.Windows.Forms.DataGridView>行を操作するメソッドは、行のインスタンスではなく、行のインデックスの引数を取ります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="8dd81-204">さらに、行に関連するイベント ハンドラーは発生させずに共有が解除する行を操作に使用できる行のプロパティを持つイベント引数オブジェクトを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-205">行オブジェクトにアクセスする必要がある場合、<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>メソッドと行の実際のインデックスを渡します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="8dd81-206">ただし、このメソッドを使用して取得共有行オブジェクトを変更すると、このオブジェクトを共有するすべての行は変更することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="8dd81-207">新しいレコードの行とは共有されません他の行では、ただし、ため、他の行を変更するときに影響しません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="8dd81-208">共有行によって表される複数の異なる行に異なるショートカット メニューがあることにも注意してください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="8dd81-209">共有行のインスタンスから正しいショートカット メニューを取得する、<xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A>メソッドと行の実際のインデックスを渡します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="8dd81-210">共有行にアクセスする場合は<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>プロパティ代わりに、-1 の場合、共有行のインデックスを使用し、正しいショートカット メニューを取得しません。</span><span class="sxs-lookup"><span data-stu-id="8dd81-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>  
  
-   <span data-ttu-id="8dd81-211">インデックス作成を避けるため、<xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType>コレクション。</span><span class="sxs-lookup"><span data-stu-id="8dd81-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="8dd81-212">セルに直接アクセスすると、その親の行が解除された場合、新しくインスタンス化する<xref:System.Windows.Forms.DataGridViewRow>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="8dd81-213">セルに関連するイベント ハンドラーは、共有が解除する行を引き起こすことがなくセルを操作に使用できるセル プロパティを持つイベント引数オブジェクトを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="8dd81-214">使用することも、<xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A>セルに直接アクセスしなくても、現在のセルの行と列のインデックスを取得するプロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>  
  
-   <span data-ttu-id="8dd81-215">セルに基づく選択モードは避けてください。</span><span class="sxs-lookup"><span data-stu-id="8dd81-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="8dd81-216">これらのモードでは、共有が解除する行が発生します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="8dd81-217">代わりに、設定、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>プロパティを<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>または<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="8dd81-218">処理しない、<xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType>または<xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType>イベント。</span><span class="sxs-lookup"><span data-stu-id="8dd81-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="8dd81-219">これらのイベントには、共有が解除する行が発生します。</span><span class="sxs-lookup"><span data-stu-id="8dd81-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="8dd81-220">また、呼び出す必要はありません、<xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType>または<xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType>メソッドで、これらのイベントを発生させます。</span><span class="sxs-lookup"><span data-stu-id="8dd81-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>  
  
-   <span data-ttu-id="8dd81-221">アクセスしない、<xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType>コレクションと、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>プロパティの値が<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>、 <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>、 <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>、または<xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="8dd81-222">これにより、すべての選択した行を非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-222">This causes all selected rows to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-223">呼び出す必要はありません、<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="8dd81-224">このメソッドには、行を非共有になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-224">This method can cause rows to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-225">呼び出す必要はありません、<xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType>メソッドと、<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>プロパティの値が<xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="8dd81-226">これにより、すべての行を非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-226">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-227">設定しないでください、<xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A>または<xref:System.Windows.Forms.DataGridViewCell.Selected%2A>にセル プロパティ`false`にその列に対応するプロパティを設定すると`true`です。</span><span class="sxs-lookup"><span data-stu-id="8dd81-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="8dd81-228">これにより、すべての行を非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-228">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-229">アクセスしない、<xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="8dd81-230">これにより、すべての行を非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-230">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="8dd81-231">呼び出す必要はありません、`Sort(IComparer)`のオーバー ロード、<xref:System.Windows.Forms.DataGridView.Sort%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="8dd81-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="8dd81-232">カスタムの比較演算子の並び替えにすると、すべての行を非共有になります。</span><span class="sxs-lookup"><span data-stu-id="8dd81-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8dd81-233">関連項目</span><span class="sxs-lookup"><span data-stu-id="8dd81-233">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 [<span data-ttu-id="8dd81-234">Windows フォーム DataGridView コントロールでのパフォーマンス チューニング</span><span class="sxs-lookup"><span data-stu-id="8dd81-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/performance-tuning-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="8dd81-235">Windows フォーム DataGridView コントロールでの仮想モード</span><span class="sxs-lookup"><span data-stu-id="8dd81-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="8dd81-236">Windows フォーム DataGridView コントロールでのデータ表示モード</span><span class="sxs-lookup"><span data-stu-id="8dd81-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-display-modes-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="8dd81-237">Windows フォーム DataGridView コントロールでのセルのスタイル</span><span class="sxs-lookup"><span data-stu-id="8dd81-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/cell-styles-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="8dd81-238">方法: Windows フォーム DataGridView コントロールの既定のセル スタイルを設定する</span><span class="sxs-lookup"><span data-stu-id="8dd81-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="8dd81-239">Windows フォーム DataGridView コントロールのサイズ変更オプション</span><span class="sxs-lookup"><span data-stu-id="8dd81-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/sizing-options-in-the-windows-forms-datagridview-control.md)
