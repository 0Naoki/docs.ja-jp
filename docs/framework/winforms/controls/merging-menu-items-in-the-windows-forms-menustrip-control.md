---
title: Windows フォームの MenuStrip コントロールへのメニュー項目のマージ
ms.date: 03/30/2017
helpviewer_keywords:
- MenuStrip [Windows Forms], merging
- merging [Windows Forms], general concepts
ms.assetid: 95e113ba-f362-4dda-8a76-6d95ddc45cee
ms.openlocfilehash: dbe1c0325499e7b925d504fc80f9034f9e387475
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/18/2019
ms.locfileid: "59231566"
---
# <a name="merging-menu-items-in-the-windows-forms-menustrip-control"></a><span data-ttu-id="52dc4-102">Windows フォームの MenuStrip コントロールへのメニュー項目のマージ</span><span class="sxs-lookup"><span data-stu-id="52dc4-102">Merging Menu Items in the Windows Forms MenuStrip Control</span></span>
<span data-ttu-id="52dc4-103">マルチ ドキュメント インターフェイス (MDI) アプリケーションがある場合は、親フォームのメニューにメニュー項目や子フォームの全体のメニューをマージできます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-103">If you have a multiple-document interface (MDI) application, you can merge menu items or whole menus from the child form into the menus of the parent form.</span></span>  
  
 <span data-ttu-id="52dc4-104">このトピックでは、MDI アプリケーションでメニュー項目のマージに関連付けられている基本的な概念について説明します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-104">This topic describes the basic concepts associated with merging menu items in an MDI application.</span></span>  
  
## <a name="general-concepts"></a><span data-ttu-id="52dc4-105">一般的な概念</span><span class="sxs-lookup"><span data-stu-id="52dc4-105">General Concepts</span></span>  
 <span data-ttu-id="52dc4-106">マージ手順には、ターゲットとソース管理の両方が含まれます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-106">Merging procedures involve both a target and a source control:</span></span>  
  
-   <span data-ttu-id="52dc4-107">ターゲットが、<xref:System.Windows.Forms.MenuStrip>メニュー項目のマージ先のメインまたは MDI 親フォームのコントロール。</span><span class="sxs-lookup"><span data-stu-id="52dc4-107">The target is the <xref:System.Windows.Forms.MenuStrip> control on the main or MDI parent form into which you are merging menu items.</span></span>  
  
-   <span data-ttu-id="52dc4-108">ソースが、 <xref:System.Windows.Forms.MenuStrip> [ターゲット] メニューにマージするメニュー項目を含む MDI 子フォームのコントロール。</span><span class="sxs-lookup"><span data-stu-id="52dc4-108">The source is the <xref:System.Windows.Forms.MenuStrip> control on the MDI child form that contains the menu items you want to merge into the target menu.</span></span>  
  
 <span data-ttu-id="52dc4-109"><xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A>プロパティは、現在の MDI のタイトルが表示されます - ドロップダウン リストを持つ親フォームの MDI 子メニュー項目を識別します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-109">The <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> property identifies the menu item whose drop-down list you will populate with the titles of the current MDI parent form's MDI children.</span></span> <span data-ttu-id="52dc4-110">現在開いている MDI 子フォームを通常に一覧表示など、**ウィンドウ**メニュー。</span><span class="sxs-lookup"><span data-stu-id="52dc4-110">For example, you typically list MDI children that are currently open on the **Window** menu.</span></span>  
  
 <span data-ttu-id="52dc4-111"><xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A>からメニュー項目を取得するプロパティを識別、<xref:System.Windows.Forms.MenuStrip>の MDI 子フォーム。</span><span class="sxs-lookup"><span data-stu-id="52dc4-111">The <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> property identifies which menu items come from a <xref:System.Windows.Forms.MenuStrip> on an MDI child form.</span></span>  
  
 <span data-ttu-id="52dc4-112">メニュー項目は、手動または自動マージできます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-112">You can merge menu items manually or automatically.</span></span> <span data-ttu-id="52dc4-113">両方のメソッドに対して同じ方法でのメニュー項目のマージが、マージが「手動マージ」と「自動マージ」セクションでは、このトピックの後半で説明したように、異なるアクティブ化します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-113">The menu items merge in the same way for both methods, but the merge is activated differently, as discussed in the "Manual Merging" and "Automatic Merging" sections later in this topic.</span></span> <span data-ttu-id="52dc4-114">手動および自動マージの各マージ操作は、[次へ] のマージ操作に影響します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-114">In both manual and automatic merging, each merge action affects the next merge action.</span></span>  
  
 <span data-ttu-id="52dc4-115"><xref:System.Windows.Forms.MenuStrip> 1 つのメニュー アイテムを移動するマージ<xref:System.Windows.Forms.ToolStrip>を別の場合と同様に、複製ではなく<xref:System.Windows.Forms.MainMenu>します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-115"><xref:System.Windows.Forms.MenuStrip> merging moves menu items from one <xref:System.Windows.Forms.ToolStrip> to another rather than cloning them, as was the case with <xref:System.Windows.Forms.MainMenu>.</span></span>  
  
## <a name="mergeaction-values"></a><span data-ttu-id="52dc4-116">MergeAction 値</span><span class="sxs-lookup"><span data-stu-id="52dc4-116">MergeAction Values</span></span>  
 <span data-ttu-id="52dc4-117">ソースのメニュー項目にマージ操作を設定する<xref:System.Windows.Forms.MenuStrip>を使用して、<xref:System.Windows.Forms.MergeAction>プロパティ。</span><span class="sxs-lookup"><span data-stu-id="52dc4-117">You set the merge action on menu items in the source <xref:System.Windows.Forms.MenuStrip> using the <xref:System.Windows.Forms.MergeAction> property.</span></span>  
  
 <span data-ttu-id="52dc4-118">次の表では、使用できるマージ処理の意味と一般的な使用について説明します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-118">The following table describes the meaning and typical use of the available merge actions.</span></span>  
  
|<span data-ttu-id="52dc4-119">MergeAction 値</span><span class="sxs-lookup"><span data-stu-id="52dc4-119">MergeAction Value</span></span>|<span data-ttu-id="52dc4-120">説明</span><span class="sxs-lookup"><span data-stu-id="52dc4-120">Description</span></span>|<span data-ttu-id="52dc4-121">一般的な用途</span><span class="sxs-lookup"><span data-stu-id="52dc4-121">Typical Use</span></span>|  
|-----------------------|-----------------|-----------------|  
|<xref:System.Windows.Forms.MergeAction.Append>|<span data-ttu-id="52dc4-122">(既定値)ターゲット項目のコレクションの末尾には、元の項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-122">(Default) Adds the source item to the end of the target item's collection.</span></span>|<span data-ttu-id="52dc4-123">プログラムの一部がアクティブになると、メニューの末尾にメニュー項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-123">Adding menu items to the end of the menu when some part of the program is activated.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Insert>|<span data-ttu-id="52dc4-124">指定された場所では、ターゲット項目のコレクションに元の項目を追加、<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>ソース アイテムのプロパティで設定します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-124">Adds the source item to the target item's collection, in the location specified by the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> property set on the source item.</span></span>|<span data-ttu-id="52dc4-125">プログラムの一部がアクティブの場合は、中間またはメニューの先頭にメニュー項目を追加します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-125">Adding menu items to the middle or the beginning of the menu when some part of the program is activated.</span></span><br /><br /> <span data-ttu-id="52dc4-126">場合の値<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>は両方のメニュー項目を追加する逆の順序で。</span><span class="sxs-lookup"><span data-stu-id="52dc4-126">If the value of <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> is the same for both menu items, they are added in reverse order.</span></span> <span data-ttu-id="52dc4-127">設定<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>適切に元の順序を保持します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-127">Set <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> appropriately to preserve the original order.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Replace>|<span data-ttu-id="52dc4-128">一致するテキストを検索またはを使用して、<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>値の場合、テキスト一致するものが検出され、一致する対象のメニュー項目をソースのメニュー項目に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-128">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then replaces the matching target menu item with the source menu item.</span></span>|<span data-ttu-id="52dc4-129">ターゲットのメニュー項目を別の処理を実行するのと同じ名前のソースのメニュー項目に置き換えます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-129">Replacing a target menu item with a source menu item of the same name that does something different.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.MatchOnly>|<span data-ttu-id="52dc4-130">一致するテキストを検索またはを使用して、<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>値の場合、テキスト一致するものが検出され、元のドロップダウン リストのすべての項目をターゲットに追加します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-130">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then adds all the drop-down items from the source to the target.</span></span>|<span data-ttu-id="52dc4-131">メニュー構造を構築挿入またはサブメニューの場合にメニュー項目を追加またはサブメニューのメニュー項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-131">Building a menu structure that inserts or adds menu items into a submenu, or removes menu items from a submenu.</span></span> <span data-ttu-id="52dc4-132">主に、MDI 子からメニュー項目を追加するなど、 <xref:System.Windows.Forms.MenuStrip>**名前を付けて保存**メニュー。</span><span class="sxs-lookup"><span data-stu-id="52dc4-132">For example, you can add a menu item from an MDI child to a main <xref:System.Windows.Forms.MenuStrip>**Save As** menu.</span></span><br /><br /> <span data-ttu-id="52dc4-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> 操作を行わずにメニュー構造をナビゲートすることができます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> allows you to navigate through the menu structure without taking any action.</span></span> <span data-ttu-id="52dc4-134">それ以降の項目を評価する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-134">It provides a way to evaluate the subsequent items.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Remove>|<span data-ttu-id="52dc4-135">一致するテキストを検索またはを使用して、<xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A>値の場合、テキスト一致するものが検出され、ターゲットから項目を削除します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-135">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then removes the item from the target.</span></span>|<span data-ttu-id="52dc4-136">ターゲットからメニュー項目を削除する<xref:System.Windows.Forms.MenuStrip>します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-136">Removing a menu item from the target <xref:System.Windows.Forms.MenuStrip>.</span></span>|  
  
## <a name="manual-merging"></a><span data-ttu-id="52dc4-137">手動マージ</span><span class="sxs-lookup"><span data-stu-id="52dc4-137">Manual Merging</span></span>  
 <span data-ttu-id="52dc4-138">のみ<xref:System.Windows.Forms.MenuStrip>コントロールが自動マージに参加します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-138">Only <xref:System.Windows.Forms.MenuStrip> controls participate in automatic merging.</span></span> <span data-ttu-id="52dc4-139">などの他のコントロールの項目を組み合わせて<xref:System.Windows.Forms.ToolStrip>と<xref:System.Windows.Forms.StatusStrip>コントロール、する必要があります手動でマージを呼び出すことによって、<xref:System.Windows.Forms.ToolStripManager.Merge%2A>と<xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A>必要に応じて、コード内のメソッド。</span><span class="sxs-lookup"><span data-stu-id="52dc4-139">To combine the items of other controls, such as <xref:System.Windows.Forms.ToolStrip> and <xref:System.Windows.Forms.StatusStrip> controls, you must merge them manually, by calling the <xref:System.Windows.Forms.ToolStripManager.Merge%2A> and <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> methods in your code as required.</span></span>  
  
## <a name="automatic-merging"></a><span data-ttu-id="52dc4-140">自動マージ</span><span class="sxs-lookup"><span data-stu-id="52dc4-140">Automatic Merging</span></span>  
 <span data-ttu-id="52dc4-141">ソース形式をアクティブ化して、MDI アプリケーションの自動マージを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-141">You can use automatic merging for MDI applications by activating the source form.</span></span> <span data-ttu-id="52dc4-142">使用する、 <xref:System.Windows.Forms.MenuStrip> MDI アプリケーションでは、次のように設定します。、<xref:System.Windows.Forms.Form.MainMenuStrip%2A>プロパティ、ターゲットを<xref:System.Windows.Forms.MenuStrip>ソースに対して実行するアクションをマージできるように<xref:System.Windows.Forms.MenuStrip>ターゲットに反映されます<xref:System.Windows.Forms.MenuStrip>します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-142">To use a <xref:System.Windows.Forms.MenuStrip> in an MDI application, set the <xref:System.Windows.Forms.Form.MainMenuStrip%2A> property to the target <xref:System.Windows.Forms.MenuStrip> so that merging actions performed on the source <xref:System.Windows.Forms.MenuStrip> are reflected in the target <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
 <span data-ttu-id="52dc4-143">アクティブ化して自動マージをトリガーすることができます、 <xref:System.Windows.Forms.MenuStrip> MDI ソース。</span><span class="sxs-lookup"><span data-stu-id="52dc4-143">You can trigger automatic merging by activating the <xref:System.Windows.Forms.MenuStrip> on the MDI source.</span></span> <span data-ttu-id="52dc4-144">ソースの起動時に<xref:System.Windows.Forms.MenuStrip>MDI ターゲットにマージされます。</span><span class="sxs-lookup"><span data-stu-id="52dc4-144">Upon activation, the source <xref:System.Windows.Forms.MenuStrip> is merged into the MDI target.</span></span> <span data-ttu-id="52dc4-145">新しいフォームがアクティブになったときに、マージが最後のフォームで元に戻すで、新しいフォームにトリガーします。</span><span class="sxs-lookup"><span data-stu-id="52dc4-145">When a new form becomes active, the merge is reverted on the last form and triggered on the new form.</span></span> <span data-ttu-id="52dc4-146">設定してこの動作を制御することができます、<xref:System.Windows.Forms.ToolStripItem.MergeAction%2A>プロパティそれぞれで、必要に応じて<xref:System.Windows.Forms.ToolStripItem>を設定したり、<xref:System.Windows.Forms.ToolStrip.AllowMerge%2A>プロパティをそれぞれ<xref:System.Windows.Forms.MenuStrip>。</span><span class="sxs-lookup"><span data-stu-id="52dc4-146">You can control this behavior by setting the <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> property as needed on each <xref:System.Windows.Forms.ToolStripItem>, and by setting the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property on each <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="52dc4-147">関連項目</span><span class="sxs-lookup"><span data-stu-id="52dc4-147">See also</span></span>

- <xref:System.Windows.Forms.ToolStripManager>
- <xref:System.Windows.Forms.MenuStrip>
- [<span data-ttu-id="52dc4-148">MenuStrip コントロール</span><span class="sxs-lookup"><span data-stu-id="52dc4-148">MenuStrip Control</span></span>](menustrip-control-windows-forms.md)
- [<span data-ttu-id="52dc4-149">方法: MenuStrip を MDI ウィンドウ リストを作成します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-149">How to: Create an MDI Window List with MenuStrip</span></span>](how-to-create-an-mdi-window-list-with-menustrip-windows-forms.md)
- [<span data-ttu-id="52dc4-150">方法: メニューの自動マージ MDI アプリケーションを設定します。</span><span class="sxs-lookup"><span data-stu-id="52dc4-150">How to: Set Up Automatic Menu Merging for MDI Applications</span></span>](how-to-set-up-automatic-menu-merging-for-mdi-applications.md)
