---
title: Windows フォームおよびアンマネージ アプリケーションの概要
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: cb7df844458be083adefa16421a7088bd1e74893
ms.sourcegitcommit: 160a88c8087b0e63606e6e35f9bd57fa5f69c168
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/09/2019
ms.locfileid: "57717935"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="3a8e4-102">Windows フォームおよびアンマネージ アプリケーションの概要</span><span class="sxs-lookup"><span data-stu-id="3a8e4-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="3a8e4-103">Windows フォーム アプリケーションとコントロールは、いくつかの注意事項がありますが、アンマネージ アプリケーションと相互運用できます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="3a8e4-104">次のセクションでは、Windows フォーム アプリケーションとコントロールがサポートするシナリオと構成、および、サポートしないシナリオと構成について説明します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="3a8e4-105">Windows フォーム コントロールおよび ActiveX アプリケーション</span><span class="sxs-lookup"><span data-stu-id="3a8e4-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="3a8e4-106">Microsoft Internet Explorer と Microsoft Foundation Classes (MFC) を除いて、Windows フォーム コントロールは、ActiveX コントロールをホストするように設計されたアプリケーションではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="3a8e4-107">Visual Studio .NET 2003 より前のバージョンの Visual Studio からの ActiveX テスト コンテナーなど、ActiveX コントロールをホストできるその他のアプリケーションと開発ツールは、Windows Forms コントロールでサポートされるホストではありません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="3a8e4-108">これらの制約は、コンポーネント オブジェクト モデルの COM 相互運用機能を通じて、Windows フォーム コントロールの使用にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="3a8e4-109">COM 呼び出し可能ラッパー (CCW) を通じた Windows フォーム コントロールの使用は、Internet Explorer でのみサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="3a8e4-110">COM 相互運用の詳細については、</span><span class="sxs-lookup"><span data-stu-id="3a8e4-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="3a8e4-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md)。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="3a8e4-112">Windows フォーム コントロールのサポートをホストしている、使用できる ActiveX を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="3a8e4-113">Windows フォームのバージョン</span><span class="sxs-lookup"><span data-stu-id="3a8e4-113">Windows Forms version</span></span>|<span data-ttu-id="3a8e4-114">Support</span><span class="sxs-lookup"><span data-stu-id="3a8e4-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="3a8e4-115">.NET Framework version 1.0</span><span class="sxs-lookup"><span data-stu-id="3a8e4-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="3a8e4-116">Internet Explorer 5.01 以降のバージョン</span><span class="sxs-lookup"><span data-stu-id="3a8e4-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="3a8e4-117">.NET Framework version 1.1 以降</span><span class="sxs-lookup"><span data-stu-id="3a8e4-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="3a8e4-118">Internet Explorer 5.01 以降のバージョン</span><span class="sxs-lookup"><span data-stu-id="3a8e4-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="3a8e4-119">Microsoft Foundation Classes (MFC) 7.0 以降</span><span class="sxs-lookup"><span data-stu-id="3a8e4-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="3a8e4-120">ActiveX コントロールとして Windows フォームのコンポーネントをホストする</span><span class="sxs-lookup"><span data-stu-id="3a8e4-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="3a8e4-121">.NET Framework 1.1 では、MFC 7.0 以降のバージョンを含めるようサポートが拡張されました。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="3a8e4-122">このサポートには、MFC 7.0 以降の ActiveX コントロール コンテナーと完全に互換性があるすべてのコンテナーが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="3a8e4-123">ただし、Windows フォーム コントロールの ActiveX コントロールとしての登録はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="3a8e4-124">また、Windows フォーム コントロールの `com.ms.win32.Ole32.CoCreateInstance` メソッドの呼び出しはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="3a8e4-125">Windows フォーム コントロールのマネージド アクティベーションだけがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="3a8e4-126">Windows フォーム コントロールを作成すると、ActiveX コントロールの場合と同様に MFC アプリケーションでホストできます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="3a8e4-127">アンマネージ アプリケーションで Windows フォーム コントロールを使用するには、アンマネージ CLR ホスティング API を使用して CLR をホストするか、C++ interop 機能を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="3a8e4-128">C++ interop 機能の使用が、推奨されるソリューションです。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="3a8e4-129">COM クライアント アプリケーションでの Windows フォーム</span><span class="sxs-lookup"><span data-stu-id="3a8e4-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="3a8e4-130">Windows フォームを Visual Basic 6.0 アプリケーションや MFC アプリケーションなどの COM クライアント アプリケーションから開くと、フォームが予期しない動作をすることがあります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="3a8e4-131">たとえば、TAB キーを押した時に、フォーカスが 1 つのコントロールから別のコントロールに変更されません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="3a8e4-132">コマンド ボタンにフォーカスがあるときに ENTER キーを押すと、ボタンの <xref:System.Windows.Forms.Control.Click> イベントは発生しません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="3a8e4-133">また、キー ストロークやマウスのアクティビティで、予期しない動作が発生することもあります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="3a8e4-134">この動作は、Windows フォームが正常に動作するために必要なメッセージ ループ サポートを、アンマネージ アプリケーションが実装していないために発生します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="3a8e4-135">COM クライアント アプリケーションによって提供されるメッセージ ループは、Windows フォームのメッセージ ループと基本的に異なります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="3a8e4-136">アプリケーションのメッセージ ループは、スレッドのメッセージ キューのメッセージを取得して変換し、処理のためにアプリケーションに送信する内部プログラム ループです。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="3a8e4-137">Windows フォームのメッセージ ループは、Visual Basic 6.0 アプリケーションや MFC アプリケーションなど、以前のアプリケーションが提供するメッセージ ループと同じアーキテクチャを持っていません。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="3a8e4-138">メッセージ ループにポストされたウィンドウのメッセージは、Windows フォームの要求とは異なる処理を実行することがあります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="3a8e4-139">そのため、予期しない動作が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="3a8e4-140">一部のキーストロークの組み合わせ、一部のマウスのアクティビティが動作せず、一部のイベントが想定どおりに発生しないことがあります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="3a8e4-141">相互運用性の問題の解決</span><span class="sxs-lookup"><span data-stu-id="3a8e4-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="3a8e4-142">これらの問題は、<xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> メソッドを使用して作成された [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] メッセージ ループでフォームを表示することで解決できます。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-142">You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="3a8e4-143">Windows フォームが COM クライアント アプリケーションから正しく動作するには、Windows フォームのメッセージ ループ上で実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="3a8e4-144">そのためには、次の方法のいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-144">To do this, use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="3a8e4-145"><xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> メソッドを使用して、Windows フォームを表示します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="3a8e4-146">詳細については、「[方法 :ShowDialog メソッドを使用して Windows フォームを表示して COM 相互運用機能をサポートして](com-interop-by-displaying-a-windows-form-shadow.md)します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
-   <span data-ttu-id="3a8e4-147">各 Windows フォームを新しいスレッドで表示します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="3a8e4-148">詳細については、「[方法 :独自のスレッドで各 Windows フォームを表示して COM 相互運用機能をサポート](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)します。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a8e4-149">関連項目</span><span class="sxs-lookup"><span data-stu-id="3a8e4-149">See also</span></span>
- [<span data-ttu-id="3a8e4-150">Windows Forms and Unmanaged Applications</span><span class="sxs-lookup"><span data-stu-id="3a8e4-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="3a8e4-151">COM 相互運用</span><span class="sxs-lookup"><span data-stu-id="3a8e4-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="3a8e4-152">.NET Framework アプリケーションにおける COM 相互運用性</span><span class="sxs-lookup"><span data-stu-id="3a8e4-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="3a8e4-153">[COM 相互運用性サンプル](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="3a8e4-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="3a8e4-154">Aximp.exe (Windows フォーム ActiveX コントロール インポーター)</span><span class="sxs-lookup"><span data-stu-id="3a8e4-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="3a8e4-155">COM への .NET Framework コンポーネントの公開</span><span class="sxs-lookup"><span data-stu-id="3a8e4-155">Exposing .NET Framework Components to COM</span></span>](../../interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="3a8e4-156">COM 用のアセンブリのパッケージ化</span><span class="sxs-lookup"><span data-stu-id="3a8e4-156">Packaging an Assembly for COM</span></span>](../../interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="3a8e4-157">COM へのアセンブリの登録</span><span class="sxs-lookup"><span data-stu-id="3a8e4-157">Registering Assemblies with COM</span></span>](../../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="3a8e4-158">方法: ShowDialog メソッドを使用して Windows フォームを表示して COM 相互運用機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="3a8e4-159">方法: 独自のスレッドで各 Windows フォームを表示して COM 相互運用機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="3a8e4-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
