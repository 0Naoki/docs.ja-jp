---
title: "チュートリアル : ビジュアル継承のデモンストレーション | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-winforms"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "jsharp"
helpviewer_keywords: 
  - "フォームの継承, チュートリアル"
  - "継承, チュートリアル"
  - "ビジュアルな継承"
  - "チュートリアル [Windows フォーム], ビジュアルな継承"
  - "Windows フォーム, 継承"
ms.assetid: 01966086-3142-450e-8210-3fd4cb33f591
caps.latest.revision: 24
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 24
---
# チュートリアル : ビジュアル継承のデモンストレーション
ビジュアル継承により、基本フォームのコントロールを表示して、新しいコントロールを追加できます。  このチュートリアルでは、基本フォームを作成してクラス ライブラリにコンパイルします。  このクラス ライブラリを別のプロジェクトにインポートして、基本フォームから継承する新しいフォームを作成します。  このチュートリアルでは、次の作業を行う方法について説明します。  
  
-   基本フォームを含むクラス ライブラリ プロジェクトを作成します。  
  
-   基本フォームの派生クラスが変更できるプロパティを持つボタンを追加します。  
  
-   基本フォームの継承元により変更できないボタンを追加します。  
  
-   `BaseForm` から継承したフォームを含むプロジェクトを作成します。  
  
 最終的には、このチュートリアルでは、継承されたフォーム上のプライベート コントロールとプロテクト コントロールの違いを示します。  
  
> [!NOTE]
>  実際に画面に表示されるダイアログ ボックスとメニュー コマンドは、アクティブな設定またはエディションによっては、ヘルプの説明と異なる場合があります。  設定を変更するには、**\[ツール\]** メニューの **\[設定のインポートとエクスポート\]** をクリックします。  詳細については、「[Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ja-jp/22c4debb-4e31-47a8-8f19-16f328d7dcd3)」を参照してください。  
  
> [!CAUTION]
>  すべてのコントロールが基本フォームのビジュアル継承をサポートするわけではありません。  次のコントロールでは、このチュートリアルで説明するシナリオはサポートされません。  
>   
>  <xref:System.Windows.Forms.WebBrowser>  
>   
>  <xref:System.Windows.Forms.ToolStrip>  
>   
>  <xref:System.Windows.Forms.ToolStripPanel>  
>   
>  <xref:System.Windows.Forms.TableLayoutPanel>  
>   
>  <xref:System.Windows.Forms.FlowLayoutPanel>  
>   
>  <xref:System.Windows.Forms.DataGridView>  
>   
>  継承されたフォームのこれらのコントロールは、使用する修飾子 \(`private`、`protected`、または `public`\) に関係なく、常に読み取り専用です。  
  
## シナリオの手順  
 最初の手順では、基本フォームを作成します。  
  
#### 基本フォームを含むクラス ライブラリ プロジェクトを作成するには  
  
1.  **\[ファイル\]** メニューから **\[新規作成\]** を選択し、**\[プロジェクト…\]** を選択します。**\[新しいプロジェクト\]** ダイアログ ボックスが表示されます。  
  
2.  `BaseFormLibrary` という名前の Windows フォーム アプリケーションを作成します。  
  
3.  標準の Windows フォーム アプリケーションではなく、クラス ライブラリを作成するには、**ソリューション エクスプローラー**で、**BaseFormLibrary** プロジェクト ノードを右クリックして、**\[プロパティ\]** を選択します。  
  
4.  プロジェクトのプロパティで、**\[出力の種類\]** を **\[Windows アプリケーション\]** から **\[クラス ライブラリ\]** に変更します。  
  
5.  **\[ファイル\]** メニューから、**\[すべてを保存\]** を選択して、プロジェクトおよびファイルを既定の場所に保存します。  
  
 次の 2 つの手順では、基本フォームにボタンを追加します。  ビジュアル継承を示すには、`Modifiers` プロパティを設定して、ボタンに異なるアクセス レベルを付与します。  
  
#### 基本フォームの継承クラスから変更が可能なボタンを追加するには  
  
1.  デザイナーで **Form1** を開きます。  
  
2.  **ツールボックス**の **\[すべての Windows フォーム\]** タブで、**\[ボタン\]** をダブルクリックしてフォームにボタンを追加します。  マウスを使用し、ボタンを配置してサイズを変更します。  
  
3.  \[プロパティ\] ウィンドウで、ボタンの次のプロパティを設定します。  
  
    -   **Text** プロパティを **Say Hello** に設定します。  
  
    -   **\(Name\)** プロパティを **btnProtected** に設定します。  
  
    -   **Modifiers** プロパティを **Protected** に設定します。  これにより、**Form1** から継承するフォームが、**btnProtected** のプロパティを変更できるようになります。  
  
4.  **\[Say Hello\]** ボタンをダブルクリックして、**クリック** イベントのイベント ハンドラーを追加します。  
  
5.  イベント ハンドラーに次のコードを追加します。  
  
    ```vb  
    MessageBox.Show("Hello, World!")  
    ```  
  
    ```csharp  
    MessageBox.Show("Hello, World!");  
    ```  
  
#### 基本フォームの継承元により変更できないボタンを追加するには  
  
1.  コード エディターの上にある **Form1.vb の \[デザイン\]、Form1.cs の \[デザイン\]、または Form1.jsl の \[デザイン\]** タブをクリックするか、F7 を押して、デザイン ビューに切り替えます。  
  
2.  2 番目のボタンを追加し、そのプロパティを次のように設定します。  
  
    -   **Text** プロパティを **Say Goodbye** に設定します。  
  
    -   **\(Name\)** プロパティを **btnPrivate** に設定します。  
  
    -   **Modifiers** プロパティを **Private** に設定します。  これにより、**Form1** から継承するフォームが、**btnPrivate** のプロパティを変更できなくなります。  
  
3.  **\[Say Goodbye\]** ボタンをダブルクリックして、**クリック** イベントのイベント ハンドラーを追加します。  イベントの手順で、次のコード行を配置します。  
  
    ```vb  
    MessageBox.Show("Goodbye!")  
    ```  
  
    ```csharp  
    MessageBox.Show("Goodbye!");  
    ```  
  
4.  **\[ビルド\]** メニューから、**\[BaseForm ライブラリのビルド\]** を選択してクラス ライブラリをビルドします。  
  
     ライブラリがビルドされたら、作成したフォームから継承する新しいプロジェクトを作成できます。  
  
#### 基本フォームから継承したフォームを含むプロジェクトを作成するには  
  
1.  **\[ファイル\]** メニューから **\[追加\]** を選択し、**\[新しいプロジェクト\]** を選択します。**\[新しいプロジェクトの追加\]** ダイアログ ボックスが表示されます。  
  
2.  `InheritanceTest` という名前の Windows フォーム アプリケーションを作成します。  
  
#### 継承されたフォームを追加するには  
  
1.  **ソリューション エクスプローラー**で、**InheritanceTest** プロジェクトを右クリックし、**\[追加\]** を選択して、**\[新しいアイテム\]** を選択します。  
  
2.  **\[新しいアイテムの追加\]** ダイアログ ボックスで、**\[Windows フォーム\]** カテゴリを選択して \(カテゴリのリストがある場合\)、**\[継承されたフォーム\]** テンプレートを選択します。  
  
3.  名前を既定の `Form2` のままにして、**\[追加\]** をクリックします。  
  
4.  **\[継承ピッカー\]** ダイアログ ボックスで、継承元のフォームとして、**BaseFormLibrary** プロジェクトから **Form1** を選択し、**\[OK\]** をクリックします。  
  
     これで、**InheritanceTest** プロジェクトに**BaseFormLibrary** のフォームから派生したフォームが作成されます。  
  
5.  デザイナーで継承されたフォーム \(**Form2**\) がまだ開いていない場合は、ダブルクリックして開きます。  
  
     デザイナーで、継承されたボタンには、上の隅に継承されたことを示すシンボル \(![VisualBasicInheritanceSymbol スクリーンショット](../../../../docs/framework/winforms/advanced/media/vbinheritanceglyph.png "vbInheritanceGlyph")\) があります。  
  
6.  **\[Say Hello\]** ボタンを選択して、サイズ変更ハンドルを確認します。  このボタンは保護されているため、継承元が、移動、サイズ変更、キャプションの変更、およびその他の変更を実行できます。  
  
7.  プライベートの **\[Say Goodbye\]** ボタンを選択して、サイズ変更ハンドルがないことを確認します。  また、**\[プロパティ\]** ウィンドウでは、このボタンのプロパティが、変更できないことを示すグレー表示になっています。  
  
8.  [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)] を使用している場合:  
  
    1.  **ソリューション エクスプローラー**で、**InheritanceTest** プロジェクトの **Form1** を右クリックして、**\[削除\]** を選択します。  表示されたメッセージ ボックスで、**\[OK\]** をクリックして削除を確認します。  
  
    2.  Program.cs ファイルを開き、行 `Application.Run(new Form1());` を `Application.Run(new Form2());` に変更します。  
  
9. **ソリューション エクスプローラー**で **InheritanceTest** プロジェクトを右クリックし、**\[スタートアップ プロジェクトに設定\]** を選択します。  
  
10. **ソリューション エクスプローラー**で **InheritanceTest** プロジェクトを右クリックし、**\[プロパティ\]** を選択します。  
  
11. **InheritanceTest** プロパティ ページで、**スタートアップ オブジェクト** を継承されたたフォームに設定します \(**Form2**\)。  
  
12. F5 を押してアプリケーションを実行し、継承されたフォームの動作を確認します。  
  
## 次の手順  
 ユーザー コントロールの継承はほぼ同じ方法で機能します。  新しいクラス ライブラリ プロジェクトを開き、ユーザー コントロールを追加します。  内在コントロールを配置し、プロジェクトをコンパイルします。  別の新しいクラス ライブラリ プロジェクトを開き、コンパイル済みのクラス ライブラリへの参照を追加します。  また、継承されたコントロールを、**継承ピッカー** を使用して \(**\[新しいアイテムの追加\]** ダイアログ ボックスから\) プロジェクトに追加してみます。  ユーザー コントロールを追加し、`Inherits` \([!INCLUDE[csprcs](../../../../includes/csprcs-md.md)] の`:`\) ステートメントを変更します。  詳細については、「[方法 : Windows フォームを継承する](../../../../docs/framework/winforms/advanced/how-to-inherit-windows-forms.md)」を参照してください。  
  
## 参照  
 [方法 : Windows フォームを継承する](../../../../docs/framework/winforms/advanced/how-to-inherit-windows-forms.md)   
 [Windows フォームのビジュアルの継承](../../../../docs/framework/winforms/advanced/windows-forms-visual-inheritance.md)   
 [Windows フォーム](../../../../docs/framework/winforms/index.md)