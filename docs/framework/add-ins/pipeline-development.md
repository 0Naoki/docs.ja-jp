---
title: パイプラインの開発
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 047cd7a2b8a6d315c6cadb9b535b84f744fd2d09
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/04/2018
ms.locfileid: "43504886"
---
# <a name="pipeline-development"></a>パイプラインの開発
アドイン パイプラインは、ホスト アプリケーションとそのアドインが互いに通信するために使用する必要がありますパイプライン セグメントのパスです。  
  
 次の図は、通信パイプラインとそのセグメントを示します。  
  
 ![追加&#45;パイプライン モデル。](../../../docs/framework/add-ins/media/addin1.png "AddIn1")  
アドイン パイプライン  
  
 ホスト アプリケーションは、パイプラインの 1 つの端とアドインは、もう一方の end。 各端から開始し、中央方向へ移動、ホスト アプリケーションとアドインの両方がある、両方を共有するオブジェクト モデルのビューを定義する抽象基本クラス。 これらの型 (クラス) は、アドイン ビュー パイプライン セグメント、アドイン パイプライン セグメントのホスト ビューを構成します。 アドイン ビュー パイプライン セグメントには多くの場合、1 つ以上の抽象クラスが含まれていますが、アドインから継承するクラスは、アドインをベースと呼ばれます。  
  
 追加アドイン側アダプター パイプライン セグメントとホスト側アダプター パイプライン セグメント変換、ビュー パイプライン セグメント、およびコントラクト パイプライン セグメントの間で型のフロー。 パイプラインの中央のセグメントがから派生したコントラクト、<xref:System.AddIn.Contract.IContract>インターフェイス。 このコントラクトは、ホスト アプリケーションとそのアドインを両方使用するメソッドを定義します。  
  
 個別のアプリケーション ドメインにホストとアドインを読み込む場合にアドインのスコープからホスト アプリケーションのスコープを分離する分離境界が設定されます。 コントラクトは、ホストとアドイン アプリケーション ドメインの両方に読み込まれる唯一のアセンブリです。 ホストとアドインを各コントラクト メソッドのビューのみを参照してください。 したがって、コントラクトから抽象化レイヤーで区切られます。  
  
 パイプライン セグメントを開発するには、それらを格納するディレクトリ構造を作成する必要があります。 開発要件とスコープのガイドラインの詳細については、次を参照してください。[パイプライン開発の必要条件](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5)します。  
  
 次の図は、パイプライン セグメントを構成する型を示します。 任意の図に示す型の名前が、情報ストアを構築するメソッドによって検出できるように、ホストとホストを除くすべての種類を追加で必要な属性の表示。  
  
 ![追加&#45;型に必要な属性を持つモデルにします。](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")  
アドイン パイプラインの種類  
  
 次の表では、アドインをアクティブ化するためのパイプライン セグメントについて説明します。 これらのセグメントの詳細については、次を参照してください。[コントラクト、ビュー、およびアダプター](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c)します。  
  
|パイプライン セグメント|説明|  
|----------------------|-----------------|  
|ホスト|アプリケーションのアセンブリに、追加のインスタンスを作成します。|  
|アドインのホスト ビュー|オブジェクトの種類と、アドインとの通信に使用されるメソッドのホスト アプリケーションのビューを表します。 ホスト ビューは、抽象基本クラスまたはインターフェイスです。|  
|ホスト側アダプター|メソッドをおよび、契約からの対応する 1 つまたは複数のクラスがアセンブリ。<br /><br /> 使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.HostAdapterAttribute>属性。<br /><br /> マルチ モジュール アセンブリはサポートされていません。|  
|コントラクト|派生したインターフェイス、<xref:System.AddIn.Contract.IContract>インターフェイスをホストとそのアドインの間で型との通信用プロトコルを定義します。<br /><br /> このパイプライン セグメントが設定で識別される、<xref:System.AddIn.Pipeline.AddInContractAttribute>属性。|  
|アドイン側アダプター|メソッドをおよび、契約からの対応する 1 つまたは複数のクラスがアセンブリ。<br /><br /> 使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.AddInAdapterAttribute>属性。<br /><br /> 持つ型を含む追加アドイン側アダプターのディレクトリ内の各アセンブリ、<xref:System.AddIn.Pipeline.AddInAdapterAttribute>属性がアドインのアプリケーション ドメインに読み込まれます。<br /><br /> 追加側ディレクトリ内の各アセンブリは、独自のアプリケーション ドメインに読み込まれます。<br /><br /> マルチ モジュール アセンブリはサポートされていません|  
|アドイン ビュー|アドインのビューのオブジェクトの種類と、ホストとの通信に使用されるメソッドを表すアセンブリ。 アドイン ビューは、抽象基本クラスまたはインターフェイスです。<br /><br /> 使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性。<br /><br /> 持つ型を含む AddInViews ディレクトリ内の各アセンブリ、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性がアドインのアプリケーション ドメインに読み込まれます。|  
|アドイン|ホストのサービスを実行する型のインスタンス。|  
  
## <a name="pipeline-activation-path"></a>パイプラインのアクティブ化パス  
 次の図は、アドインがアクティブな場合に、型のアクティブ化を示します。 オブジェクトを渡すことは、計算、またはオブジェクトのコレクションの結果などのホストにも表示されます。 これは、最も一般的なシナリオです。  
  
 ![追加&#45;アクティベーション パスを持つモデル。](../../../docs/framework/add-ins/media/addin6.png "AddIn6")  
アドインからホストへのアクティブ化パス  
  
 パイプラインのアクティブ化パスは、次のようが発生します。  
  
1.  ホスト アプリケーションがアドインをアクティブ化、<xref:System.AddIn.Hosting.AddInToken.Activate%2A>メソッド。  
  
2.  アドイン、アドインを表示、追加アドイン側アダプター、およびコントラクト アセンブリは、アドインのアプリケーション ドメインに読み込まれます。  
  
3.  アドイン ビューを使用して追加アドイン側アダプターのインスタンスが作成されます (で識別されるクラスを使用して、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性) として、コンス トラクター。 追加アドイン側アダプターは、コントラクトから継承します。  
  
4.  コントラクトとして型指定された、追加アドイン側アダプターは (省略可能) の分離の境界を越えて、ホスト側アダプターのコンス トラクターに渡されます。  
  
5.  アドイン、ホスト側アダプター、およびコントラクト アセンブリのホスト ビューは、ホストのアプリケーション ドメインに読み込まれます。  
  
6.  ホスト側アダプターのインスタンスを作成するには、コントラクトのコンス トラクターとして使用されます。 ホスト側アダプターは、アドインのホスト ビューから継承します。  
  
7.  ホストは、アドイン、ホスト、アドインの表示し、そのメソッドの呼び出しをそのままできますとして型指定されています。  
  
## <a name="walkthroughs"></a>チュートリアル  
 Visual Studio を使用してパイプラインを作成する方法を説明する 3 つのチュートリアル トピックがあります。  
  
-   [チュートリアル : 拡張性のあるアプリケーションの作成](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     ホストの加算、減算、乗算、および除算を実行する計算ツール アドインについて説明します。  
  
-   [チュートリアル: ホスト変更時の下位互換性を有効にします。](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     計算ツール アドインを計算の強化された機能と計算ツールを追加では、最初との互換性を維持する方法について説明します。  
  
-   [チュートリアル: アドインとホスト間でコレクションの引き渡し](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     書店のシナリオを使用して、パイプライン経由でデータ コレクションを渡す方法について説明します。  
  
## <a name="see-also"></a>関連項目  
 [アドイン パイプラインのシナリオ](https://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [アドインおよび拡張機能](../../../docs/framework/add-ins/index.md)
