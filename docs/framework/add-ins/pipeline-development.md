---
title: パイプラインの開発
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 047cd7a2b8a6d315c6cadb9b535b84f744fd2d09
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/04/2018
ms.locfileid: "43504886"
---
# <a name="pipeline-development"></a><span data-ttu-id="8b2b3-102">パイプラインの開発</span><span class="sxs-lookup"><span data-stu-id="8b2b3-102">Pipeline Development</span></span>
<span data-ttu-id="8b2b3-103">アドイン パイプラインは、ホスト アプリケーションとそのアドインが互いに通信するために使用する必要がありますパイプライン セグメントのパスです。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="8b2b3-104">次の図は、通信パイプラインとそのセグメントを示します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="8b2b3-105">![追加&#45;パイプライン モデル。](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="8b2b3-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="8b2b3-106">アドイン パイプライン</span><span class="sxs-lookup"><span data-stu-id="8b2b3-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="8b2b3-107">ホスト アプリケーションは、パイプラインの 1 つの端とアドインは、もう一方の end。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="8b2b3-108">各端から開始し、中央方向へ移動、ホスト アプリケーションとアドインの両方がある、両方を共有するオブジェクト モデルのビューを定義する抽象基本クラス。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="8b2b3-109">これらの型 (クラス) は、アドイン ビュー パイプライン セグメント、アドイン パイプライン セグメントのホスト ビューを構成します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="8b2b3-110">アドイン ビュー パイプライン セグメントには多くの場合、1 つ以上の抽象クラスが含まれていますが、アドインから継承するクラスは、アドインをベースと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="8b2b3-111">追加アドイン側アダプター パイプライン セグメントとホスト側アダプター パイプライン セグメント変換、ビュー パイプライン セグメント、およびコントラクト パイプライン セグメントの間で型のフロー。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="8b2b3-112">パイプラインの中央のセグメントがから派生したコントラクト、<xref:System.AddIn.Contract.IContract>インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="8b2b3-113">このコントラクトは、ホスト アプリケーションとそのアドインを両方使用するメソッドを定義します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="8b2b3-114">個別のアプリケーション ドメインにホストとアドインを読み込む場合にアドインのスコープからホスト アプリケーションのスコープを分離する分離境界が設定されます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="8b2b3-115">コントラクトは、ホストとアドイン アプリケーション ドメインの両方に読み込まれる唯一のアセンブリです。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="8b2b3-116">ホストとアドインを各コントラクト メソッドのビューのみを参照してください。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="8b2b3-117">したがって、コントラクトから抽象化レイヤーで区切られます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="8b2b3-118">パイプライン セグメントを開発するには、それらを格納するディレクトリ構造を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="8b2b3-119">開発要件とスコープのガイドラインの詳細については、次を参照してください。[パイプライン開発の必要条件](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5)します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="8b2b3-120">次の図は、パイプライン セグメントを構成する型を示します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="8b2b3-121">任意の図に示す型の名前が、情報ストアを構築するメソッドによって検出できるように、ホストとホストを除くすべての種類を追加で必要な属性の表示。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="8b2b3-122">![追加&#45;型に必要な属性を持つモデルにします。](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="8b2b3-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="8b2b3-123">アドイン パイプラインの種類</span><span class="sxs-lookup"><span data-stu-id="8b2b3-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="8b2b3-124">次の表では、アドインをアクティブ化するためのパイプライン セグメントについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="8b2b3-125">これらのセグメントの詳細については、次を参照してください。[コントラクト、ビュー、およびアダプター](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c)します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-125">For more information about these segments, see [Contracts, Views, and Adapters](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="8b2b3-126">パイプライン セグメント</span><span class="sxs-lookup"><span data-stu-id="8b2b3-126">Pipeline segment</span></span>|<span data-ttu-id="8b2b3-127">説明</span><span class="sxs-lookup"><span data-stu-id="8b2b3-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="8b2b3-128">ホスト</span><span class="sxs-lookup"><span data-stu-id="8b2b3-128">Host</span></span>|<span data-ttu-id="8b2b3-129">アプリケーションのアセンブリに、追加のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="8b2b3-130">アドインのホスト ビュー</span><span class="sxs-lookup"><span data-stu-id="8b2b3-130">Host view of the add-in</span></span>|<span data-ttu-id="8b2b3-131">オブジェクトの種類と、アドインとの通信に使用されるメソッドのホスト アプリケーションのビューを表します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="8b2b3-132">ホスト ビューは、抽象基本クラスまたはインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="8b2b3-133">ホスト側アダプター</span><span class="sxs-lookup"><span data-stu-id="8b2b3-133">Host-side adapter</span></span>|<span data-ttu-id="8b2b3-134">メソッドをおよび、契約からの対応する 1 つまたは複数のクラスがアセンブリ。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="8b2b3-135">使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.HostAdapterAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="8b2b3-136">マルチ モジュール アセンブリはサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="8b2b3-137">コントラクト</span><span class="sxs-lookup"><span data-stu-id="8b2b3-137">Contract</span></span>|<span data-ttu-id="8b2b3-138">派生したインターフェイス、<xref:System.AddIn.Contract.IContract>インターフェイスをホストとそのアドインの間で型との通信用プロトコルを定義します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="8b2b3-139">このパイプライン セグメントが設定で識別される、<xref:System.AddIn.Pipeline.AddInContractAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="8b2b3-140">アドイン側アダプター</span><span class="sxs-lookup"><span data-stu-id="8b2b3-140">Add-in-side adapter</span></span>|<span data-ttu-id="8b2b3-141">メソッドをおよび、契約からの対応する 1 つまたは複数のクラスがアセンブリ。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="8b2b3-142">使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.AddInAdapterAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="8b2b3-143">持つ型を含む追加アドイン側アダプターのディレクトリ内の各アセンブリ、<xref:System.AddIn.Pipeline.AddInAdapterAttribute>属性がアドインのアプリケーション ドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="8b2b3-144">追加側ディレクトリ内の各アセンブリは、独自のアプリケーション ドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="8b2b3-145">マルチ モジュール アセンブリはサポートされていません</span><span class="sxs-lookup"><span data-stu-id="8b2b3-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="8b2b3-146">アドイン ビュー</span><span class="sxs-lookup"><span data-stu-id="8b2b3-146">Add-in view</span></span>|<span data-ttu-id="8b2b3-147">アドインのビューのオブジェクトの種類と、ホストとの通信に使用されるメソッドを表すアセンブリ。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="8b2b3-148">アドイン ビューは、抽象基本クラスまたはインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="8b2b3-149">使用してこのパイプライン セグメントが識別される、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="8b2b3-150">持つ型を含む AddInViews ディレクトリ内の各アセンブリ、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性がアドインのアプリケーション ドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="8b2b3-151">アドイン</span><span class="sxs-lookup"><span data-stu-id="8b2b3-151">Add-in</span></span>|<span data-ttu-id="8b2b3-152">ホストのサービスを実行する型のインスタンス。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="8b2b3-153">パイプラインのアクティブ化パス</span><span class="sxs-lookup"><span data-stu-id="8b2b3-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="8b2b3-154">次の図は、アドインがアクティブな場合に、型のアクティブ化を示します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="8b2b3-155">オブジェクトを渡すことは、計算、またはオブジェクトのコレクションの結果などのホストにも表示されます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="8b2b3-156">これは、最も一般的なシナリオです。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="8b2b3-157">![追加&#45;アクティベーション パスを持つモデル。](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="8b2b3-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="8b2b3-158">アドインからホストへのアクティブ化パス</span><span class="sxs-lookup"><span data-stu-id="8b2b3-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="8b2b3-159">パイプラインのアクティブ化パスは、次のようが発生します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="8b2b3-160">ホスト アプリケーションがアドインをアクティブ化、<xref:System.AddIn.Hosting.AddInToken.Activate%2A>メソッド。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="8b2b3-161">アドイン、アドインを表示、追加アドイン側アダプター、およびコントラクト アセンブリは、アドインのアプリケーション ドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="8b2b3-162">アドイン ビューを使用して追加アドイン側アダプターのインスタンスが作成されます (で識別されるクラスを使用して、<xref:System.AddIn.Pipeline.AddInBaseAttribute>属性) として、コンス トラクター。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="8b2b3-163">追加アドイン側アダプターは、コントラクトから継承します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="8b2b3-164">コントラクトとして型指定された、追加アドイン側アダプターは (省略可能) の分離の境界を越えて、ホスト側アダプターのコンス トラクターに渡されます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="8b2b3-165">アドイン、ホスト側アダプター、およびコントラクト アセンブリのホスト ビューは、ホストのアプリケーション ドメインに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="8b2b3-166">ホスト側アダプターのインスタンスを作成するには、コントラクトのコンス トラクターとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="8b2b3-167">ホスト側アダプターは、アドインのホスト ビューから継承します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="8b2b3-168">ホストは、アドイン、ホスト、アドインの表示し、そのメソッドの呼び出しをそのままできますとして型指定されています。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="8b2b3-169">チュートリアル</span><span class="sxs-lookup"><span data-stu-id="8b2b3-169">Walkthroughs</span></span>  
 <span data-ttu-id="8b2b3-170">Visual Studio を使用してパイプラインを作成する方法を説明する 3 つのチュートリアル トピックがあります。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="8b2b3-171">チュートリアル : 拡張性のあるアプリケーションの作成</span><span class="sxs-lookup"><span data-stu-id="8b2b3-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="8b2b3-172">ホストの加算、減算、乗算、および除算を実行する計算ツール アドインについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.</span></span>  
  
-   [<span data-ttu-id="8b2b3-173">チュートリアル: ホスト変更時の下位互換性を有効にします。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="8b2b3-174">計算ツール アドインを計算の強化された機能と計算ツールを追加では、最初との互換性を維持する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="8b2b3-175">チュートリアル: アドインとホスト間でコレクションの引き渡し</span><span class="sxs-lookup"><span data-stu-id="8b2b3-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="8b2b3-176">書店のシナリオを使用して、パイプライン経由でデータ コレクションを渡す方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="8b2b3-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8b2b3-177">関連項目</span><span class="sxs-lookup"><span data-stu-id="8b2b3-177">See Also</span></span>  
 [<span data-ttu-id="8b2b3-178">アドイン パイプラインのシナリオ</span><span class="sxs-lookup"><span data-stu-id="8b2b3-178">Add-in Pipeline Scenarios</span></span>](https://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [<span data-ttu-id="8b2b3-179">アドインおよび拡張機能</span><span class="sxs-lookup"><span data-stu-id="8b2b3-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
