---
title: "LINQ Querying2 のデータ ソースの有効化 |Microsoft ドキュメント"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
ms.assetid: c412f0cf-ff0e-4993-ab3d-1b49e23f00f8
caps.latest.revision: 3
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: 658b581b235982d0b2e47cf92d050657e5150281
ms.contentlocale: ja-jp
ms.lasthandoff: 04/12/2017

---
# <a name="enabling-a-data-source-for-linq-querying"></a><span data-ttu-id="7f4d2-102">データ ソースの LINQ クエリの有効化</span><span class="sxs-lookup"><span data-stu-id="7f4d2-102">Enabling a Data Source for LINQ Querying</span></span>
<span data-ttu-id="7f4d2-103">さまざまな方法で拡張する[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]でクエリを実行する任意のデータ ソースを有効にする、[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]パターンです。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-103">There are various ways to extend [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] to enable any data source to be queried in the [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] pattern.</span></span> <span data-ttu-id="7f4d2-104">データ ソースは、いくつか例を挙げると、データ構造体、Web サービス、ファイル システム、またはデータベースの場合があります。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-104">The data source might be a data structure, a Web service, a file system, or a database, to name some.</span></span> <span data-ttu-id="7f4d2-105">クエリの構文とパターンは変わらないため、[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] パターンを使用すると、クライアントは [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] クエリが有効になっているデータ ソースを簡単にクエリできます。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-105">The [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] pattern makes it easy for clients to query a data source for which [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] querying is enabled, because the syntax and pattern of the query does not change.</span></span> <span data-ttu-id="7f4d2-106">方法[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]を拡張できるこれらのデータをソースには、次が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-106">The ways in which [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] can be extended to these data sources include the following:</span></span>  
  
-   <span data-ttu-id="7f4d2-107">実装する、<xref:System.Collections.Generic.IEnumerable%601>インターフェイスを有効にするのには、タイプで[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]その型のオブジェクトを照会します</xref:System.Collections.Generic.IEnumerable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-107">Implementing the <xref:System.Collections.Generic.IEnumerable%601> interface in a type to enable [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] to Objects querying of that type.</span></span>  
  
-   <span data-ttu-id="7f4d2-108">標準クエリ演算子メソッドのなど作成<xref:System.Linq.Enumerable.Where%2A>と<xref:System.Linq.Enumerable.Select%2A>ユーザー設定を有効にする、型を拡張する[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]その型のクエリを実行します</xref:System.Linq.Enumerable.Select%2A></xref:System.Linq.Enumerable.Where%2A>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-108">Creating standard query operator methods such as <xref:System.Linq.Enumerable.Where%2A> and <xref:System.Linq.Enumerable.Select%2A> that extend a type, to enable custom [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] querying of that type.</span></span>  
  
-   <span data-ttu-id="7f4d2-109">実装するデータ ソースのプロバイダーを作成する、<xref:System.Linq.IQueryable%601>インターフェイス</xref:System.Linq.IQueryable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-109">Creating a provider for your data source that implements the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="7f4d2-110">このインターフェイスを実装したプロバイダーは、式ツリーの形式で [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] クエリを受け取ります。プロバイダーはこれをカスタマイズされた方法 (たとえばリモート) で実行できます。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-110">A provider that implements this interface receives [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] queries in the form of expression trees, which it can execute in a custom way, for example remotely.</span></span>  
  
-   <span data-ttu-id="7f4d2-111">既存の活用、データ ソースのプロバイダーを作成する[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]テクノロジです。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-111">Creating a provider for your data source that takes advantage of an existing [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] technology.</span></span> <span data-ttu-id="7f4d2-112">そのようなプロバイダーは、クエリだけでなく、挿入、更新、および削除などの操作や、ユーザー定義型のマッピングも有効にします。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-112">Such a provider would enable not only querying, but also insert, update, and delete operations and mapping for user-defined types.</span></span>  
  
 <span data-ttu-id="7f4d2-113">このトピックでは、これらのオプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-113">This topic discusses these options.</span></span>  
  
## <a name="how-to-enable-linq-querying-of-your-data-source"></a><span data-ttu-id="7f4d2-114">データ ソースの LINQ クエリを有効にする方法</span><span class="sxs-lookup"><span data-stu-id="7f4d2-114">How to Enable LINQ Querying of Your Data Source</span></span>  
  
### <a name="in-memory-data"></a><span data-ttu-id="7f4d2-115">インメモリ データ</span><span class="sxs-lookup"><span data-stu-id="7f4d2-115">In-Memory Data</span></span>  
 <span data-ttu-id="7f4d2-116">2 つの方法が有効にできます[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]メモリ内のデータのクエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-116">There are two ways you can enable [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] querying of in-memory data.</span></span> <span data-ttu-id="7f4d2-117">実装する型の場合は、データ<xref:System.Collections.Generic.IEnumerable%601>を使用して、データを照会する[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]オブジェクトにします</xref:System.Collections.Generic.IEnumerable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-117">If the data is of a type that implements <xref:System.Collections.Generic.IEnumerable%601>, you can query the data by using [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] to Objects.</span></span> <span data-ttu-id="7f4d2-118">実装することで、型の列挙体を有効にする意味が行わないかどうか、<xref:System.Collections.Generic.IEnumerable%601>インターフェイスを定義できます[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]標準クエリ演算子メソッドをその型または作成[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]標準クエリ演算子メソッド型を拡張する</xref:System.Collections.Generic.IEnumerable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-118">If it does not make sense to enable enumeration of your type by implementing the <xref:System.Collections.Generic.IEnumerable%601> interface, you can define [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] standard query operator methods in that type or create [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] standard query operator methods that extend the type.</span></span> <span data-ttu-id="7f4d2-119">標準クエリ演算子のカスタム実装は、結果を返すために遅延実行を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-119">Custom implementations of the standard query operators should use deferred execution to return the results.</span></span>  
  
### <a name="remote-data"></a><span data-ttu-id="7f4d2-120">リモート データ</span><span class="sxs-lookup"><span data-stu-id="7f4d2-120">Remote Data</span></span>  
 <span data-ttu-id="7f4d2-121">有効にするための最適なオプション[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]を実装するのには、リモート データ ソースのクエリ、<xref:System.Linq.IQueryable%601>インターフェイス</xref:System.Linq.IQueryable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-121">The best option for enabling [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] querying of a remote data source is to implement the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="7f4d2-122">しかしこれは、[!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] などのプロバイダーをデータ ソースに対して拡張することとは別です。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-122">However, this differs from extending a provider such as [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] for a data source.</span></span> <span data-ttu-id="7f4d2-123">既存の拡張するためにプロバイダー モデル[!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]テクノロジなど[!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] でその他の型のデータ ソースが利用[!INCLUDE[vs_orcas_long](../../../../csharp/misc/includes/vs_orcas_long_md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-123">No provider models for extending existing [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] technologies, such as [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)], to other types of data source are available in [!INCLUDE[vs_orcas_long](../../../../csharp/misc/includes/vs_orcas_long_md.md)].</span></span>  
  
## <a name="iqueryable-linq-providers"></a><span data-ttu-id="7f4d2-124">IQueryable LINQ プロバイダー</span><span class="sxs-lookup"><span data-stu-id="7f4d2-124">IQueryable LINQ Providers</span></span>  
 [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)]<span data-ttu-id="7f4d2-125">実装したプロバイダー<xref:System.Linq.IQueryable%601>複雑度に大きく異なることができます</xref:System.Linq.IQueryable%601>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-125"> providers that implement <xref:System.Linq.IQueryable%601> can vary widely in their complexity.</span></span> <span data-ttu-id="7f4d2-126">このセクションでは、さまざまなレベルの複雑度について説明します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-126">This section discusses the different levels of complexity.</span></span>  
  
 <span data-ttu-id="7f4d2-127">複雑度が低めの `IQueryable` プロバイダーは、多くの場合、Web サービスの単一のメソッドとやり取りします。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-127">A less complex `IQueryable` provider might interface with a single method of a Web service.</span></span> <span data-ttu-id="7f4d2-128">この種のプロバイダーは処理するクエリに特定の情報を受け取るので非常に高い固有性を持ちます。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-128">This type of provider is very specific because it expects specific information in the queries that it handles.</span></span> <span data-ttu-id="7f4d2-129">クローズされた型システムを持ち、おそらく&1; つの結果型を公開します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-129">It has a closed type system, perhaps exposing a single result type.</span></span> <span data-ttu-id="7f4d2-130">たとえばを使用するクエリの実行のほとんどがローカルで発生する、<xref:System.Linq.Enumerable>標準クエリ演算子の実装</xref:System.Linq.Enumerable>。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-130">Most of the execution of the query occurs locally, for example by using the <xref:System.Linq.Enumerable> implementations of the standard query operators.</span></span> <span data-ttu-id="7f4d2-131">複雑度が低めのプロバイダーは、クエリを表す式ツリーのメソッド呼び出し式を&1; つだけ調べ、残りのクエリのロジックは他の場所で処理されるようにします。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-131">A less complex provider might examine only one method call expression in the expression tree that represents the query, and let the remaining logic of the query be handled elsewhere.</span></span>  
  
 <span data-ttu-id="7f4d2-132">複雑度が中レベルの `IQueryable` プロバイダーは、部分的に表現力が豊かなクエリ言語を持つデータ ソースを対象とします。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-132">An `IQueryable` provider of medium complexity might target a data source that has a partially expressive query language.</span></span> <span data-ttu-id="7f4d2-133">そのプロバイダーが Web サービスを対象とする場合、Web サービスの複数のメソッドとやり取りし、クエリが提示する問題に基づいて呼び出すメソッドを選択します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-133">If it targets a Web service, it might interface with more than one method of the Web service and select the method to call based on the question that the query poses.</span></span> <span data-ttu-id="7f4d2-134">中レベルの複雑度のプロバイダーは、簡単なプロバイダーより型システムが豊富ですが、それでもその種類は限られています。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-134">A provider of medium complexity would have a richer type system than a simple provider, but it would still be a fixed type system.</span></span> <span data-ttu-id="7f4d2-135">たとえば、このレベルのプロバイダーは走査できる一対多リレーションシップを持つ型を公開する場合がありますが、ユーザー定義型のマッピング テクノロジは提供しません。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-135">For example, the provider might expose types that have one-to-many relationships that can be traversed, but it would not provide mapping technology for user-defined types.</span></span>  
  
 <span data-ttu-id="7f4d2-136">`IQueryable` プロバイダーなどの複雑な [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] プロバイダーは [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] クエリ一式を、SQL などの表現力が豊かなクエリ言語に変換する場合があります。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-136">A complex `IQueryable` provider, such as the [!INCLUDE[vbtecdlinq](../../../../csharp/includes/vbtecdlinq_md.md)] provider, might translate complete [!INCLUDE[vbteclinq](../../../../csharp/includes/vbteclinq_md.md)] queries to an expressive query language, such as SQL.</span></span> <span data-ttu-id="7f4d2-137">複雑なプロバイダーは、それほど複雑でないプロバイダーより一般的です。これは、より多様な質問をクエリで処理できるためです。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-137">A complex provider is more general than a less complex provider, because it can handle a wider variety of questions in the query.</span></span> <span data-ttu-id="7f4d2-138">さらに、オープンな型システムを持つため、ユーザー定義型をマップするために広範なインフラストラクチャを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-138">It also has an open type system and therefore must contain extensive infrastructure to map user-defined types.</span></span> <span data-ttu-id="7f4d2-139">複雑なプロバイダーの開発には、多大な労力を要します。</span><span class="sxs-lookup"><span data-stu-id="7f4d2-139">Developing a complex provider requires a significant amount of effort.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7f4d2-140">関連項目</span><span class="sxs-lookup"><span data-stu-id="7f4d2-140">See Also</span></span>  
 <span data-ttu-id="7f4d2-141"><xref:System.Linq.IQueryable%601></xref:System.Linq.IQueryable%601></span><span class="sxs-lookup"><span data-stu-id="7f4d2-141"><xref:System.Linq.IQueryable%601></span></span>   
 <span data-ttu-id="7f4d2-142"><xref:System.Collections.Generic.IEnumerable%601></xref:System.Collections.Generic.IEnumerable%601></span><span class="sxs-lookup"><span data-stu-id="7f4d2-142"><xref:System.Collections.Generic.IEnumerable%601></span></span>   
 <span data-ttu-id="7f4d2-143"><xref:System.Linq.Enumerable></xref:System.Linq.Enumerable></span><span class="sxs-lookup"><span data-stu-id="7f4d2-143"><xref:System.Linq.Enumerable></span></span>   
<span data-ttu-id="7f4d2-144"> [標準クエリ演算子の概要 (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md) </span><span class="sxs-lookup"><span data-stu-id="7f4d2-144"> [Standard Query Operators Overview (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/standard-query-operators-overview.md) </span></span>  
<span data-ttu-id="7f4d2-145"> [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</span><span class="sxs-lookup"><span data-stu-id="7f4d2-145"> [LINQ to Objects (Visual Basic)](../../../../visual-basic/programming-guide/concepts/linq/linq-to-objects.md)</span></span>
