---
title: "For Each...Next ステートメント (Visual Basic)"
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
caps.latest.revision: "56"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 4aefacd33e0b3c8f64fd26929af06469136237f3
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="46a3a-102">For Each...Next ステートメント (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="46a3a-102">For Each...Next Statement (Visual Basic)</span></span>
<span data-ttu-id="46a3a-103">コレクションの各要素に対して、ステートメントのグループを繰り返します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-103">Repeats a group of statements for each element in a collection.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="46a3a-104">構文</span><span class="sxs-lookup"><span data-stu-id="46a3a-104">Syntax</span></span>  
  
```  
For Each element [ As datatype ] In group  
    [ statements ]  
    [ Continue For ]  
    [ statements ]  
    [ Exit For ]  
    [ statements ]  
Next [ element ]  
```  
  
## <a name="parts"></a><span data-ttu-id="46a3a-105">指定項目</span><span class="sxs-lookup"><span data-stu-id="46a3a-105">Parts</span></span>  
  
|<span data-ttu-id="46a3a-106">用語</span><span class="sxs-lookup"><span data-stu-id="46a3a-106">Term</span></span>|<span data-ttu-id="46a3a-107">定義</span><span class="sxs-lookup"><span data-stu-id="46a3a-107">Definition</span></span>|  
|---|---|  
|`element`|<span data-ttu-id="46a3a-108">必要な`For Each`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="46a3a-109">省略可能で、`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="46a3a-110">変数。</span><span class="sxs-lookup"><span data-stu-id="46a3a-110">Variable.</span></span> <span data-ttu-id="46a3a-111">コレクションの要素を反復処理するために使用します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-111">Used to iterate through the elements of the collection.</span></span>|  
|`datatype`|<span data-ttu-id="46a3a-112">場合は必須`element`既に宣言されていません。</span><span class="sxs-lookup"><span data-stu-id="46a3a-112">Required if `element` isn't already declared.</span></span> <span data-ttu-id="46a3a-113">データ型`element`です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-113">Data type of `element`.</span></span>|  
|`group`|<span data-ttu-id="46a3a-114">必須です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-114">Required.</span></span> <span data-ttu-id="46a3a-115">コレクション型またはオブジェクト型を含む変数を指定します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="46a3a-116">コレクションを参照する対象で、`statements`繰り返されるはします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|  
|`statements`|<span data-ttu-id="46a3a-117">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-117">Optional.</span></span> <span data-ttu-id="46a3a-118">1 つまたは複数のステートメント間`For Each`と`Next`内の各項目で実行される`group`です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|  
|`Continue For`|<span data-ttu-id="46a3a-119">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-119">Optional.</span></span> <span data-ttu-id="46a3a-120">先頭に制御を転送、`For Each`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-120">Transfers control to the start of the `For Each` loop.</span></span>|  
|`Exit For`|<span data-ttu-id="46a3a-121">省略可能です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-121">Optional.</span></span> <span data-ttu-id="46a3a-122">うちの制御を転送、`For Each`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-122">Transfers control out of the `For Each` loop.</span></span>|  
|`Next`|<span data-ttu-id="46a3a-123">必須です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-123">Required.</span></span> <span data-ttu-id="46a3a-124">定義を終了、`For Each`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-124">Terminates the definition of the `For Each` loop.</span></span>|  
  
## <a name="simple-example"></a><span data-ttu-id="46a3a-125">簡単な例</span><span class="sxs-lookup"><span data-stu-id="46a3a-125">Simple Example</span></span>  
 <span data-ttu-id="46a3a-126">使用して、`For Each`しています.`Next`コレクションまたは配列の各要素の一連のステートメントを繰り返すときループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="46a3a-127">A[をしています.次のステートメントの](../../../visual-basic/language-reference/statements/for-next-statement.md)うまくループの各反復処理を制御変数に関連付けるし、その変数の最初と最後の値を決定することができます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="46a3a-128">ただし、コレクションを扱う場合は、最初と最後の値の概念が意味を持つと、コレクションには、要素の数がわからないとは限りません。</span><span class="sxs-lookup"><span data-stu-id="46a3a-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="46a3a-129">このような場合で、`For Each`しています.`Next`ループは多くの場合があることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>  
  
 <span data-ttu-id="46a3a-130">次の例で、`For Each`しています.`Next`</span><span class="sxs-lookup"><span data-stu-id="46a3a-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="46a3a-131">ステートメントは、リスト コレクションのすべての要素を反復処理します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-131">statement iterates through all the elements of a List collection.</span></span>  
  
 [!code-vb[VbVbalrStatements#121](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_1.vb)]  
  
 <span data-ttu-id="46a3a-132">例については、次を参照してください。[コレクション](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)と[配列](../../../visual-basic/programming-guide/language-features/arrays/index.md)です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-132">For more examples, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>  
  
## <a name="nested-loops"></a><span data-ttu-id="46a3a-133">入れ子になったループ</span><span class="sxs-lookup"><span data-stu-id="46a3a-133">Nested Loops</span></span>  
 <span data-ttu-id="46a3a-134">入れ子にすることができます`For Each`別内で 1 つのループを記述することによってループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-134">You can nest `For Each` loops by putting one loop within another.</span></span>  
  
 <span data-ttu-id="46a3a-135">次の例で入れ子になった`For Each`しています.`Next`</span><span class="sxs-lookup"><span data-stu-id="46a3a-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="46a3a-136">構造体。</span><span class="sxs-lookup"><span data-stu-id="46a3a-136">structures.</span></span>  
  
 [!code-vb[VbVbalrStatements#122](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_2.vb)]  
  
 <span data-ttu-id="46a3a-137">ループを入れ子にする場合は、各ループが一意なが必要`element`変数。</span><span class="sxs-lookup"><span data-stu-id="46a3a-137">When you nest loops, each loop must have a unique `element` variable.</span></span>  
  
 <span data-ttu-id="46a3a-138">さまざまな種類の他の制御構造を入れ子にすることもできます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="46a3a-139">詳細については、次を参照してください。[制御構造の入れ子になった](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md)です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>  
  
## <a name="exit-for-and-continue-for"></a><span data-ttu-id="46a3a-140">終了し、続行</span><span class="sxs-lookup"><span data-stu-id="46a3a-140">Exit For and Continue For</span></span>  
 <span data-ttu-id="46a3a-141">[Exit For](../../../visual-basic/language-reference/statements/exit-statement.md)ステートメントは、実行を終了する、`For`しています.`Next`</span><span class="sxs-lookup"><span data-stu-id="46a3a-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="46a3a-142">これに続くステートメントにループと転送の制御、`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>  
  
 <span data-ttu-id="46a3a-143">`Continue For`ステートメントに制御を移しますすぐに、ループの次の反復処理します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="46a3a-144">詳細については、次を参照してください。 [Continue ステートメント](../../../visual-basic/language-reference/statements/continue-statement.md)です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>  
  
 <span data-ttu-id="46a3a-145">次の例を使用する方法を示しています、`Continue For`と`Exit For`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>  
  
 [!code-vb[VbVbalrStatements#123](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_3.vb)]  
  
 <span data-ttu-id="46a3a-146">任意の数を配置する`Exit For`内のステートメント、`For Each`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="46a3a-147">使用すると内で入れ子になった`For Each`ループ、`Exit For`終了して入れ子の上位のレベルに最も内側のループと転送コントロールの実行制御が移ります。</span><span class="sxs-lookup"><span data-stu-id="46a3a-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>  
  
 <span data-ttu-id="46a3a-148">`Exit For`いくつかの条件の評価後は、よく使用などで、`If`しています.`Then`...`Else`構造体。</span><span class="sxs-lookup"><span data-stu-id="46a3a-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="46a3a-149">使用することができます`Exit For`次の条件。</span><span class="sxs-lookup"><span data-stu-id="46a3a-149">You might want to use `Exit For` for the following conditions:</span></span>  
  
-   <span data-ttu-id="46a3a-150">反復処理を続行するは、不要なまたは不可能です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="46a3a-151">値が間違っているか、終了要求によってためと考えられます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-151">This might be caused by an erroneous value or a termination request.</span></span>  
  
-   <span data-ttu-id="46a3a-152">例外がキャッチされました、`Try`しています.`Catch`...`Finally`.使用する場合があります`Exit For`の最後に、`Finally`ブロックします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>  
  
-   <span data-ttu-id="46a3a-153">これは、大規模なまたは無限も可能回数だけ実行できるループ、無限ループがあります。</span><span class="sxs-lookup"><span data-stu-id="46a3a-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="46a3a-154">このような条件を検出した場合を使用できます`Exit For`ループをエスケープするためにします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="46a3a-155">詳細については、次を参照してください[操作を行います.。ステートメントをループ](../../../visual-basic/language-reference/statements/do-loop-statement.md)です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>  
  
## <a name="iterators"></a><span data-ttu-id="46a3a-156">反復子</span><span class="sxs-lookup"><span data-stu-id="46a3a-156">Iterators</span></span>  
 <span data-ttu-id="46a3a-157">使用する、*反復子*コレクションに対するカスタム イテレーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="46a3a-158">関数は、反復子または`Get`アクセサー。</span><span class="sxs-lookup"><span data-stu-id="46a3a-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="46a3a-159">使用して、`Yield`ステートメントを一度にいずれかのコレクションの各要素を返します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>  
  
 <span data-ttu-id="46a3a-160">使用して、反復子を呼び出す、`For Each...Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="46a3a-161">`For Each` ループの各イテレーションは、反復子を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="46a3a-162">ときに、`Yield`ステートメントが、反復子の式に到達、`Yield`ステートメントが返され、コードの現在の位置が保持されます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="46a3a-163">次回、反復子が呼び出されると、この位置から実行が再開されます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-163">Execution is restarted from that location the next time that the iterator is called.</span></span>  
  
 <span data-ttu-id="46a3a-164">次の例では、iterator 関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-164">The following example uses an iterator function.</span></span> <span data-ttu-id="46a3a-165">Iterator 関数が、`Yield`内にあるステートメント、[をしています.[次へ]](../../../visual-basic/language-reference/statements/for-next-statement.md)ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="46a3a-166">`ListEvenNumbers`メソッドは、の各反復処理、`For Each`ステートメント本体を作成、関数の呼び出しを反復子を次に進みます`Yield`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>  
  
 [!code-vb[VbVbalrStatements#127](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_4.vb)]  
  
 <span data-ttu-id="46a3a-167">詳細については、次を参照してください。[反復子](http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7)、 [Yield ステートメント](../../../visual-basic/language-reference/statements/yield-statement.md)、および[反復子](../../../visual-basic/language-reference/modifiers/iterator.md)です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-167">For more information, see [Iterators](http://msdn.microsoft.com/library/f45331db-d595-46ec-9142-551d3d1eb1a7), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>  
  
## <a name="technical-implementation"></a><span data-ttu-id="46a3a-168">技術的な実装</span><span class="sxs-lookup"><span data-stu-id="46a3a-168">Technical Implementation</span></span>  
 <span data-ttu-id="46a3a-169">ときに、`For Each`しています.`Next`</span><span class="sxs-lookup"><span data-stu-id="46a3a-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="46a3a-170">ステートメントが実行されて、Visual Basic では、コレクション、ループを開始する前に、1 つだけの時間を評価します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="46a3a-171">ステートメント ブロックが変更された場合`element`または`group`、これらの変更には影響しません、ループの反復処理します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>  
  
 <span data-ttu-id="46a3a-172">ときに、コレクション内のすべての要素まで連続的に割り当てられている`element`、`For Each`ループが停止し、次のステートメントのパスを制御、`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>  
  
 <span data-ttu-id="46a3a-173">場合`element`宣言されていないこのループの外側に宣言する必要がありますで、`For Each`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-173">If `element` hasn't been declared outside this loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="46a3a-174">型を宣言する`element`を使用して明示的に、`As`ステートメント、またはするが、型を割り当てる型の推定に依存できます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-174">You can declare the type of `element` explicitly by using an `As` statement, or you can rely on type inference to assign the type.</span></span> <span data-ttu-id="46a3a-175">どちらの場合のスコープ`element`ループの本体します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-175">In either case, the scope of `element` is the body of the loop.</span></span> <span data-ttu-id="46a3a-176">ただし、宣言することはできません`element`ループの内外両方です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-176">However, you cannot declare `element` both outside and inside the loop.</span></span>  
  
 <span data-ttu-id="46a3a-177">必要に応じて指定することができます`element`で、`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-177">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="46a3a-178">これが読みやすく、プログラムでは、入れ子にしていない場合に特に`For Each`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-178">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="46a3a-179">対応する、含まれているものと同じ変数を指定する必要があります`For Each`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-179">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>  
  
 <span data-ttu-id="46a3a-180">値が変更されないようにすることができます`element`ループ内です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-180">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="46a3a-181">これを行うことができます難しくを読み取り、コードをデバッグします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-181">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="46a3a-182">値を変更する`group`コレクションまたはその要素は、ループが最初に入力されたときに決定されたには影響しません。</span><span class="sxs-lookup"><span data-stu-id="46a3a-182">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>  
  
 <span data-ttu-id="46a3a-183">場合に、ループがネストしているときに、`Next`する前に外部の入れ子レベルのステートメントが見つかりましたが、`Next`内部レベルでのコンパイラはエラーです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-183">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="46a3a-184">ただし、コンパイラが検出できるこれを指定する場合にのみ、エラーを重複`element`ですべて`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-184">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>  
  
 <span data-ttu-id="46a3a-185">特定の順序でコレクションを走査することで、コードが依存している場合、`For Each`しています.`Next`ループが最適な選択肢はありません、列挙子オブジェクトの特性をわかっていない限り、コレクションを公開します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-185">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="46a3a-186">走査の順序はの Visual Basic では、によって決定されていない、<xref:System.Collections.IEnumerator.MoveNext%2A>列挙子オブジェクトのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-186">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="46a3a-187">そのため、するできないことがありますのどの要素のコレクションは、最初に返されるを予測する`element`、これは、指定された要素の後に返される次またはします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-187">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="46a3a-188">など、さまざまなループ構造を使用して信頼性を高めるの結果が得られる可能性があります`For`しています.`Next`または`Do`しています.`Loop`.</span><span class="sxs-lookup"><span data-stu-id="46a3a-188">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>  
  
 <span data-ttu-id="46a3a-189">データ型`element`の要素のデータ型になるようにする必要があります`group`に変換することができます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-189">The data type of `element` must be such that the data type of the elements of `group` can be converted to it.</span></span>  
  
 <span data-ttu-id="46a3a-190">データ型`group`列挙可能な配列またはコレクションに参照する参照型である必要があります。</span><span class="sxs-lookup"><span data-stu-id="46a3a-190">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="46a3a-191">つまり通常`group`を実装するオブジェクトを参照して、<xref:System.Collections.IEnumerable>のインターフェイス、`System.Collections`名前空間または<xref:System.Collections.Generic.IEnumerable%601>のインターフェイス、`System.Collections.Generic`名前空間。</span><span class="sxs-lookup"><span data-stu-id="46a3a-191">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="46a3a-192">`System.Collections.IEnumerable`定義、<xref:System.Collections.IEnumerable.GetEnumerator%2A>メソッドで、コレクションの列挙子オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-192">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="46a3a-193">列挙子オブジェクトが実装する、`System.Collections.IEnumerator`のインターフェイス、`System.Collections`名前空間を公開し、<xref:System.Collections.IEnumerator.Current%2A>プロパティおよび<xref:System.Collections.IEnumerator.Reset%2A>と<xref:System.Collections.IEnumerator.MoveNext%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-193">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="46a3a-194">Visual Basic では、これらを使用して、コレクションを走査します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-194">Visual Basic uses these to traverse the collection.</span></span>  
  
### <a name="narrowing-conversions"></a><span data-ttu-id="46a3a-195">縮小変換</span><span class="sxs-lookup"><span data-stu-id="46a3a-195">Narrowing Conversions</span></span>  
 <span data-ttu-id="46a3a-196">ときに`Option Strict`に設定されている`On`、縮小変換に通常はコンパイラ エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-196">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="46a3a-197">`For Each`ステートメント、ただし、内の要素からの変換`group`に`element`が評価され、実行時に実行し、コンパイラによってエラーが発生縮小変換は抑制されます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-197">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>  
  
 <span data-ttu-id="46a3a-198">割り当て、次の例で`m`の初期値として`n`ときにコンパイルされません`Option Strict`ためにはへの変換、`Long`を`Integer`縮小変換です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-198">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="46a3a-199">`For Each`ステートメント、ただし、コンパイラ エラーがないへの割り当てがいなくても報告`number`から同じ変換が必要`Long`に`Integer`です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-199">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="46a3a-200">`For Each`大きな数値を含んだステートメントでは、実行時エラーが発生したときに<xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A>は膨大な数に適用します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-200">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>  
  
 [!code-vb[VbVbalrStatements#89](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_5.vb)]  
  
### <a name="ienumerator-calls"></a><span data-ttu-id="46a3a-201">IEnumerator の呼び出し</span><span class="sxs-lookup"><span data-stu-id="46a3a-201">IEnumerator Calls</span></span>  
 <span data-ttu-id="46a3a-202">ときの実行、`For Each`しています.`Next`ループが開始、Visual Basic では、あることを確認`group`は有効なコレクション オブジェクトを参照します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-202">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="46a3a-203">ない場合は、例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-203">If not, it throws an exception.</span></span> <span data-ttu-id="46a3a-204">それ以外の場合、呼び出し、<xref:System.Collections.IEnumerator.MoveNext%2A>メソッドおよび<xref:System.Collections.IEnumerator.Current%2A>最初の要素を返す列挙子オブジェクトのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-204">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="46a3a-205">場合`MoveNext`が示されるない次の要素は、コレクションが空の場合、`For Each`ループが停止し、次のステートメントのパスを制御、`Next`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-205">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="46a3a-206">それ以外の場合、Visual Basic 設定`element`を最初の要素と、ステートメント ブロックを実行します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-206">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>  
  
 <span data-ttu-id="46a3a-207">Visual Basic が発生するたびに、`Next`にステートメントを返します、`For Each`ステートメントです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-207">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="46a3a-208">再び呼び出します`MoveNext`と`Current`を返す次の要素と、もう一度するか、ブロックが実行または結果に応じて、ループを終了します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-208">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="46a3a-209">までこの処理を続けます`MoveNext`次の要素がないことを示しますまたは`Exit For`ステートメントが見つかりました。</span><span class="sxs-lookup"><span data-stu-id="46a3a-209">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>  
  
 <span data-ttu-id="46a3a-210">**コレクションを変更します。**</span><span class="sxs-lookup"><span data-stu-id="46a3a-210">**Modifying the Collection.**</span></span> <span data-ttu-id="46a3a-211">によって返される列挙子オブジェクト<xref:System.Collections.IEnumerable.GetEnumerator%2A>通常することは追加、削除、置換、または任意の要素を並べ替えることによりコレクションを変更します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-211">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="46a3a-212">開始した後にコレクションを変更する場合、`For Each`しています.`Next`ループ、列挙子オブジェクトは、無効になり、[次へ] しようとすると、要素アクセス、<xref:System.InvalidOperationException>例外。</span><span class="sxs-lookup"><span data-stu-id="46a3a-212">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>  
  
 <span data-ttu-id="46a3a-213">ただし、によって決定されていない変更のこのブロック[!INCLUDE[vbprvb](~/includes/vbprvb-md.md)]の実装ではなく、<xref:System.Collections.IEnumerable>インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-213">However, this blocking of modification isn't determined by [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="46a3a-214">実装することは`IEnumerable`ことがイテレーション中に変更が可能です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-214">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="46a3a-215">このような動的な変更を行うを検討している場合は、特性を理解することを確認してください、`IEnumerable`を使用しているコレクションを実装します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-215">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>  
  
 <span data-ttu-id="46a3a-216">**コレクションの要素を変更します。**</span><span class="sxs-lookup"><span data-stu-id="46a3a-216">**Modifying Collection Elements.**</span></span> <span data-ttu-id="46a3a-217"><xref:System.Collections.IEnumerator.Current%2A>列挙子オブジェクトのプロパティが[ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md)、し、コレクションの各要素のローカル コピーを返します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-217">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="46a3a-218">つまり、要素自体を変更できないことで、`For Each`しています.`Next`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-218">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="46a3a-219">対して行った変更の影響からローカルのコピーのみ`Current`し、基になるコレクションに反映されることはありません。</span><span class="sxs-lookup"><span data-stu-id="46a3a-219">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="46a3a-220">ただし、要素が参照型の場合は、ポイントするインスタンスのメンバーを変更できます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-220">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="46a3a-221">次の例を変更、`BackColor`のそれぞれに所属`thisControl`要素。</span><span class="sxs-lookup"><span data-stu-id="46a3a-221">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="46a3a-222">ただし、変更することはできません、`thisControl`自体です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-222">You cannot, however, modify `thisControl` itself.</span></span>  
  
```vb  
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)  
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls  
        thisControl.BackColor = System.Drawing.Color.LightBlue  
    Next thisControl  
End Sub  
```  
  
 <span data-ttu-id="46a3a-223">前の例を変更できます、`BackColor`のそれぞれに所属`thisControl`要素、それを変更できませんが`thisControl`自体です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-223">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>  
  
 <span data-ttu-id="46a3a-224">**配列の反復処理します。**</span><span class="sxs-lookup"><span data-stu-id="46a3a-224">**Traversing Arrays.**</span></span> <span data-ttu-id="46a3a-225"><xref:System.Array>クラスが実装する、<xref:System.Collections.IEnumerable>インターフェイス、すべての配列を公開、<xref:System.Array.GetEnumerator%2A>メソッドです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-225">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="46a3a-226">つまり、格納された配列を反復処理できること、`For Each`しています.`Next`ループします。</span><span class="sxs-lookup"><span data-stu-id="46a3a-226">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="46a3a-227">ただし、配列の要素のみを読み取ることができます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-227">However, you can only read the array elements.</span></span> <span data-ttu-id="46a3a-228">変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="46a3a-228">You cannot change them.</span></span>  
  
## <a name="example"></a><span data-ttu-id="46a3a-229">例</span><span class="sxs-lookup"><span data-stu-id="46a3a-229">Example</span></span>  
 <span data-ttu-id="46a3a-230">次の例を使用して、C:\ ディレクトリ内のすべてのフォルダーを一覧表示、<xref:System.IO.DirectoryInfo>クラスです。</span><span class="sxs-lookup"><span data-stu-id="46a3a-230">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>  
  
 [!code-vb[VbVbalrStatements#124](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_6.vb)]  
  
## <a name="example"></a><span data-ttu-id="46a3a-231">例</span><span class="sxs-lookup"><span data-stu-id="46a3a-231">Example</span></span>  
 <span data-ttu-id="46a3a-232">次の例では、コレクションを並べ替えるための手順を示しています。</span><span class="sxs-lookup"><span data-stu-id="46a3a-232">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="46a3a-233">例では、インスタンスの並べ替え、`Car`に格納されているクラス、<xref:System.Collections.Generic.List%601>です。</span><span class="sxs-lookup"><span data-stu-id="46a3a-233">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="46a3a-234">`Car` クラスは、<xref:System.IComparable%601> のメソッドの実装を必要とする <xref:System.IComparable%601.CompareTo%2A> インターフェイスを実装します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-234">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>  
  
 <span data-ttu-id="46a3a-235">呼び出しごとに、<xref:System.IComparable%601.CompareTo%2A>メソッドは、並べ替えに使用される単一の比較できます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-235">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="46a3a-236">`CompareTo` メソッドのユーザーが作成したコードは、現在のオブジェクトと別のオブジェクトとの各比較の値を戻します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-236">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="46a3a-237">現在のオブジェクトが別のオブジェクトよりも小さい場合はゼロ未満の値を、大きい場合はゼロ以上の値を、等しい場合はゼロを戻します。</span><span class="sxs-lookup"><span data-stu-id="46a3a-237">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="46a3a-238">これによって、より大きい、より小さい、等しい、の条件をコードに定義することができます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-238">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>  
  
 <span data-ttu-id="46a3a-239">`ListCars` のメソッドでは、`cars.Sort()` ステートメントがリストを並べ替えます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-239">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="46a3a-240"><xref:System.Collections.Generic.List%601.Sort%2A> の <xref:System.Collections.Generic.List%601> メソッドへの呼び出しによって、`CompareTo` メソッドは `Car` 内の `List` オブジェクトに自動的に呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="46a3a-240">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>  
  
 [!code-vb[VbVbalrStatements#125](../../../visual-basic/language-reference/error-messages/codesnippet/VisualBasic/for-each-next-statement_7.vb)]  
  
## <a name="see-also"></a><span data-ttu-id="46a3a-241">関連項目</span><span class="sxs-lookup"><span data-stu-id="46a3a-241">See Also</span></span>  
 [<span data-ttu-id="46a3a-242">コレクション</span><span class="sxs-lookup"><span data-stu-id="46a3a-242">Collections</span></span>](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)  
 [<span data-ttu-id="46a3a-243">For...Next ステートメント</span><span class="sxs-lookup"><span data-stu-id="46a3a-243">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)  
 [<span data-ttu-id="46a3a-244">ループ構造</span><span class="sxs-lookup"><span data-stu-id="46a3a-244">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)  
 [<span data-ttu-id="46a3a-245">While...End While ステートメント</span><span class="sxs-lookup"><span data-stu-id="46a3a-245">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)  
 [<span data-ttu-id="46a3a-246">Do...Loop ステートメント</span><span class="sxs-lookup"><span data-stu-id="46a3a-246">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)  
 [<span data-ttu-id="46a3a-247">拡大変換と縮小変換</span><span class="sxs-lookup"><span data-stu-id="46a3a-247">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)  
 [<span data-ttu-id="46a3a-248">オブジェクト初期化子 : 名前付きの型と匿名型</span><span class="sxs-lookup"><span data-stu-id="46a3a-248">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="46a3a-249">コレクション初期化子</span><span class="sxs-lookup"><span data-stu-id="46a3a-249">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)  
 [<span data-ttu-id="46a3a-250">配列</span><span class="sxs-lookup"><span data-stu-id="46a3a-250">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)
