---
title: Windows コンテナーとして既存の .NET アプリを展開する
description: Azure クラウドおよび Windows コンテナーで既存の .NET アプリケーションを最新化する |既存の .NET アプリを Windows コンテナーとしてデプロイする
ms.date: 04/29/2018
ms.openlocfilehash: 4d58be828418abe4964e26a983f194fd5d30b93d
ms.sourcegitcommit: c70542d02736e082e8dac67dad922c19249a8893
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/05/2019
ms.locfileid: "70374018"
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a><span data-ttu-id="fccf7-103">Windows コンテナーとして既存の .NET アプリを展開する</span><span class="sxs-lookup"><span data-stu-id="fccf7-103">Deploy existing .NET apps as Windows containers</span></span>

<span data-ttu-id="fccf7-104">Windows コンテナーに基づく展開は、クラウド向けに最適化されたアプリケーションやクラウドネイティブのアプリケーションに適用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-104">Deployments that are based on Windows Containers are applicable to Cloud-Optimized applications and Cloud-Native applications.</span></span>

<span data-ttu-id="fccf7-105">ただし、このガイドと特に次のセクションでは、アプリケーションを再設計する必要のない、*クラウド向けに最適化*されたアプリケーションに Windows コンテナーを使用することに重点を置いています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-105">However, in this guide and especially in the following sections, it mostly focuses on using Windows Containers for *Cloud-Optimized* applications where you don’t need to rearchitect your application.</span></span>

## <a name="what-are-containers-linux-or-windows"></a><span data-ttu-id="fccf7-106">コンテナーとは</span><span class="sxs-lookup"><span data-stu-id="fccf7-106">What are containers?</span></span> <span data-ttu-id="fccf7-107">(Linux または Windows)</span><span class="sxs-lookup"><span data-stu-id="fccf7-107">(Linux or Windows)</span></span>

<span data-ttu-id="fccf7-108">コンテナーは、アプリケーションを独自の分離パッケージにまとめる方法です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-108">Containers are a way to wrap up an application into its own isolated package.</span></span> <span data-ttu-id="fccf7-109">コンテナーでは、コンテナーの外部に存在するアプリケーションやプロセスの影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="fccf7-109">In its container, the application is not affected by applications or processes that exist outside of the container.</span></span> <span data-ttu-id="fccf7-110">プロセスがコンテナー内にあるため、アプリケーションが依存しているすべてのものが正常に実行されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-110">Everything the application depends on to run successfully as a process is inside the container.</span></span> <span data-ttu-id="fccf7-111">コンテナーが移動される場合、アプリケーションの要件は、直接の依存関係の観点から常に満たされます。これは、実行する必要があるすべてのもの (ライブラリの依存関係、ランタイムなど) にバンドルされているためです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-111">Wherever the container might move, the requirements of the application will always be met, in terms of direct dependencies, because it is bundled with everything that it needs to run (library dependencies, runtimes, and so on).</span></span>

<span data-ttu-id="fccf7-112">コンテナーの主な特性は、コンテナー自体に必要なすべての依存関係が含まれているため、異なるデプロイで環境を同じにすることです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-112">The main characteristic of a container is that it makes the environment the same across different deployments because the container itself comes with all the dependencies it needs.</span></span> <span data-ttu-id="fccf7-113">コンピューターでアプリケーションをデバッグし、同じ環境が保証されている別のコンピューターに展開することができます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-113">You can debug the application on your machine, and then deploy it to another machine, with the same environment guaranteed.</span></span>

<span data-ttu-id="fccf7-114">コンテナーは、コンテナーイメージのインスタンスです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-114">A container is an instance of a container image.</span></span> <span data-ttu-id="fccf7-115">コンテナーイメージは、(スナップショットのような) アプリまたはサービスをパッケージ化し、信頼性の高い再現可能な方法でデプロイする方法です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-115">A container image is a way to package an app or service (like a snapshot), and then deploy it in a reliable and reproducible way.</span></span> <span data-ttu-id="fccf7-116">Docker はテクノロジだけでなく、理念とプロセスでもあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-116">You could say that Docker is not only a technology-it's also a philosophy and a process.</span></span>

<span data-ttu-id="fccf7-117">1日に複数のコンテナーがより一般的になり、業界全体の "展開の単位" になりつつあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-117">As containers daily become more common, they are becoming an industry-wide "unit of deployment."</span></span>

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a><span data-ttu-id="fccf7-118">コンテナーの利点 (Linux または Windows 上の Docker エンジン)</span><span class="sxs-lookup"><span data-stu-id="fccf7-118">Benefits of containers (Docker Engine on Linux or Windows)</span></span>

<span data-ttu-id="fccf7-119">コンテナーを使用したアプリケーションの構築 (軽量な構成要素として定義されている場合もあります) は、インフラストラクチャ全体で任意のアプリケーションを構築、配布、実行するための機敏性を大幅に向上させます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-119">Building applications by using containers-which also might be defined as lightweight building blocks-offers a significant increase in agility for building, shipping, and running any application, across any infrastructure.</span></span>

<span data-ttu-id="fccf7-120">コンテナーを使用すると、Microsoft 開発者ツール、オペレーティングシステム、クラウド全体にわたる Docker 統合により、コードをほとんどまたはまったく変更せずに、開発から運用までのあらゆるアプリを利用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-120">With containers, you can take any app from development to production with little or no code change, thanks to Docker integration across Microsoft developer tools, operating systems, and cloud.</span></span>

<span data-ttu-id="fccf7-121">Plain Vm にデプロイする場合、ASP.NET アプリを Vm にデプロイするための方法が既に用意されていることがあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-121">When you deploy to plain VMs, you probably already have a method in place for deploying ASP.NET apps to your VMs.</span></span> <span data-ttu-id="fccf7-122">ただし、方法には、パペットなどのデプロイツールまたは同様のツールを使用して、複数の手動手順または複雑な自動化プロセスが含まれている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-122">It's likely, though, that your method involves multiple manual steps or complex automated processes by using a deployment tool like Puppet, or a similar tool.</span></span> <span data-ttu-id="fccf7-123">場合によっては、構成項目の変更、サーバー間でのアプリケーションコンテンツのコピー、.msi セットアップに基づく対話型セットアッププログラムの実行、テストの実行などのタスクを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-123">You might need to perform tasks like modifying configuration items, copying application content between servers, and running interactive setup programs based on .msi setups, followed by testing.</span></span> <span data-ttu-id="fccf7-124">デプロイに含まれるすべての手順によって、展開にかかる時間とリスクが追加されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-124">All those steps in the deployment add time and risk to deployments.</span></span> <span data-ttu-id="fccf7-125">ターゲット環境に依存関係が存在しない場合は、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-125">You will get failures whenever a dependency is not present in the target environment.</span></span>

<span data-ttu-id="fccf7-126">Windows コンテナーでは、アプリケーションをパッケージ化するプロセスは完全に自動化されています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-126">In Windows Containers, the process of packaging applications is fully automated.</span></span> <span data-ttu-id="fccf7-127">Windows コンテナーは、コンテナーデプロイの自動更新とロールバックを提供する Docker プラットフォームに基づいています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-127">Windows Containers is based on the Docker platform, which offers automatic updates and rollbacks for container deployments.</span></span> <span data-ttu-id="fccf7-128">Docker エンジンの使用によって得られる主な改善点は、アプリケーションのスナップショットのようなイメージを、すべての依存関係と共に作成することです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-128">The main improvement you get from using the Docker engine is that you create images, which are like snapshots of your application, with all its dependencies.</span></span> <span data-ttu-id="fccf7-129">イメージは、Docker イメージ (この場合は Windows コンテナーイメージ) です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-129">The images are Docker images (a Windows container image, in this case).</span></span> <span data-ttu-id="fccf7-130">イメージは、ソースコードに戻ることなく、コンテナーで ASP.NET アプリを実行します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-130">The images run ASP.NET apps in containers, without going back to source code.</span></span> <span data-ttu-id="fccf7-131">コンテナーのスナップショットが配置の単位になります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-131">The container snapshot becomes the unit of deployment.</span></span>

<span data-ttu-id="fccf7-132">多くの組織は、次の理由で既存のモノリシックアプリケーションをコンテナー化しています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-132">Many organizations are containerizing existing monolithic applications for the following reasons:</span></span>

- <span data-ttu-id="fccf7-133">強化された**デプロイによって機敏性が向上**します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-133">**Release agility through improved deployment**.</span></span> <span data-ttu-id="fccf7-134">コンテナーは、開発と運用の間に一貫した配置コントラクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-134">Containers offer a consistent deployment contract between development and operations.</span></span> <span data-ttu-id="fccf7-135">コンテナーを使用すると、開発者は、「私のコンピューターで動作し、運用環境では動作しないのはなぜですか。」と言うと、</span><span class="sxs-lookup"><span data-stu-id="fccf7-135">When you use containers, you won't hear developers say, "It works on my machine, why not in production?"</span></span> <span data-ttu-id="fccf7-136">「コンテナーとして実行され、運用環境で実行される」と言うことができます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-136">They can say, "It runs as a container, so it will run in production."</span></span> <span data-ttu-id="fccf7-137">パッケージ化されたアプリケーションは、すべての依存関係と共に、サポートされている任意のコンテナーベースの環境で実行できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-137">The packaged application, with all its dependencies, can be executed in any supported container-based environment.</span></span> <span data-ttu-id="fccf7-138">すべてのデプロイターゲット (dev、QA、ステージング、運用) での実行を意図した方法で実行されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-138">It will run the way it was intended to run in all deployment targets (dev, QA, staging, production).</span></span> <span data-ttu-id="fccf7-139">コンテナーは、1つの段階から次の段階に移行するときにほとんどの frictions を排除します。これにより、展開が大幅に改善され、より迅速に出荷できるようになります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-139">Containers eliminate most frictions when they move from one stage to the next, which greatly improves deployment, and you can ship faster.</span></span>

- <span data-ttu-id="fccf7-140">**コストの削減**。</span><span class="sxs-lookup"><span data-stu-id="fccf7-140">**Cost reductions**.</span></span> <span data-ttu-id="fccf7-141">コンテナーは、既存のハードウェアの統合と削除によって、またはハードウェアのユニットあたりの高密度でアプリケーションを実行することで、コストを削減します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-141">Containers lead to lower costs, either by the consolidation and removal of existing hardware, or from running applications at a higher density per unit of hardware.</span></span>

- <span data-ttu-id="fccf7-142">**移植性**。</span><span class="sxs-lookup"><span data-stu-id="fccf7-142">**Portability**.</span></span> <span data-ttu-id="fccf7-143">コンテナーはモジュール型で移植可能です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-143">Containers are modular and portable.</span></span> <span data-ttu-id="fccf7-144">Docker コンテナーは、任意のメジャーパブリッククラウド (Microsoft Azure、Amazon AWS、Google、IBM) の任意のサーバーオペレーティングシステム (Linux および Windows)、およびオンプレミスとプライベートまたはハイブリッドのクラウド環境でサポートされています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-144">Docker containers are supported on any server operating system (Linux and Windows), in any major public cloud (Microsoft Azure, Amazon AWS, Google, IBM), and in on-premises and private or hybrid cloud environments.</span></span>

- <span data-ttu-id="fccf7-145">**コントロール**。</span><span class="sxs-lookup"><span data-stu-id="fccf7-145">**Control**.</span></span> <span data-ttu-id="fccf7-146">コンテナーは、コンテナーレベルで制御される柔軟で安全な環境を提供します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-146">Containers offer a flexible and secure environment that's controlled at the container level.</span></span> <span data-ttu-id="fccf7-147">コンテナーは、コンテナーに対して実行制約ポリシーを設定することによって、セキュリティ保護、分離、および制限することができます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-147">A container can be secured, isolated, and even limited by setting execution constraint policies on the container.</span></span> <span data-ttu-id="fccf7-148">「Windows コンテナーについて」セクションで詳しく説明したように、Windows Server 2016 と Hyper-v コンテナーには、追加のエンタープライズサポートオプションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-148">As detailed in the section about Windows Containers, Windows Server 2016 and Hyper-V containers offer additional enterprise support options.</span></span>

<span data-ttu-id="fccf7-149">アプリケーションを開発および管理するためにコンテナーを使用すると、機敏性、移植性、および制御が大幅に改善され、最終的には大幅なコスト削減につながります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-149">Significant improvements in agility, portability, and control ultimately lead to significant cost reductions when you use containers to develop and maintain applications.</span></span>

## <a name="what-is-docker"></a><span data-ttu-id="fccf7-150">Docker について</span><span class="sxs-lookup"><span data-stu-id="fccf7-150">What is Docker?</span></span>

<span data-ttu-id="fccf7-151">[Docker](https://www.docker.com/)は、クラウドまたはオンプレミスで実行できる移植可能な自己完結型のコンテナーとしてアプリケーションのデプロイを自動化する[オープンソースプロジェクト](https://github.com/docker/docker)です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-151">[Docker](https://www.docker.com/) is an [open-source project](https://github.com/docker/docker) that automates the deployment of applications as portable, self-sufficient containers that can run in the cloud or on-premises.</span></span> <span data-ttu-id="fccf7-152">Docker は、このテクノロジを促進および進化させる[会社](https://www.docker.com/)でもあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-152">Docker is also a [company](https://www.docker.com/) that promotes and evolves this technology.</span></span> <span data-ttu-id="fccf7-153">この会社は、Microsoft などのクラウド、Linux、および Windows ベンダーとの共同作業を行っています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-153">The company works in collaboration with cloud, Linux, and Windows vendors, including Microsoft.</span></span>

![Docker は、ハイブリッド クラウドのすべてのレイヤーでコンテナーを展開します。](./media/image6.png)

<span data-ttu-id="fccf7-155">**図 4-6.**</span><span class="sxs-lookup"><span data-stu-id="fccf7-155">**Figure 4-6.**</span></span> <span data-ttu-id="fccf7-156">Docker は、ハイブリッド クラウドのすべてのレイヤーでコンテナーを展開します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-156">Docker deploys containers at all layers of the hybrid cloud</span></span>

<span data-ttu-id="fccf7-157">仮想マシンを使い慣れているユーザーにとって、コンテナーは非常に似ているように見えるかもしれません。</span><span class="sxs-lookup"><span data-stu-id="fccf7-157">To someone familiar with virtual machines, containers might appear to be remarkably similar.</span></span> <span data-ttu-id="fccf7-158">コンテナーは、オペレーティングシステムを実行し、ファイルシステムを備えています。また、物理または仮想コンピューターシステムと同様に、ネットワーク経由でアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-158">A container runs an operating system, has a file system, and can be accessed over a network, just like a physical or virtual computer system.</span></span> <span data-ttu-id="fccf7-159">ただし、コンテナーの背後にあるテクノロジと概念は、仮想マシンとは大きく異なります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-159">However, the technology and concepts behind containers are vastly different from virtual machines.</span></span> <span data-ttu-id="fccf7-160">開発者の観点から見ると、コンテナーは1つのプロセスと同様に扱う必要があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-160">From a developer point of view, a container must be treated more like a single process.</span></span> <span data-ttu-id="fccf7-161">実際、コンテナーは1つのプロセスに対して1つのエントリポイントを持ちます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-161">In fact, a container has a single entry point for one process.</span></span>

<span data-ttu-id="fccf7-162">Docker コンテナー (わかりやすくするために、*コンテナー*) は、Linux と Windows でネイティブに実行できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-162">Docker containers (for simplicity, *containers*) can run natively on Linux and Windows.</span></span> <span data-ttu-id="fccf7-163">標準のコンテナーを実行する場合、Windows コンテナーは Windows ホスト (ホストサーバーまたは VM) 上でのみ実行でき、Linux コンテナーは Linux ホストでのみ実行できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-163">When running regular containers, Windows containers can run only on Windows hosts (a host server or a VM), and Linux containers can run only on Linux hosts.</span></span> <span data-ttu-id="fccf7-164">ただし、最新バージョンの Windows Server と Hyper-v コンテナーでは、Linux コンテナーは、現在 Windows server のコンテナーでのみ使用できる Hyper-v 分離テクノロジを使用して、Windows Server 上でネイティブに実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-164">However, in recent versions of Windows Server and Hyper-V containers, a Linux container also can run natively on Windows Server by using the Hyper-V isolation technology that currently is available only in Windows Server Containers.</span></span>

<span data-ttu-id="fccf7-165">近い将来、Linux と Windows の両方のコンテナーを持つ混合環境が可能であり、さらに一般的です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-165">In the near future, mixed environments that have both Linux and Windows containers will be possible and even common.</span></span>

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a><span data-ttu-id="fccf7-166">既存の .NET アプリケーション用の Windows コンテナーの利点</span><span class="sxs-lookup"><span data-stu-id="fccf7-166">Benefits of Windows Containers for your existing .NET applications</span></span>

<span data-ttu-id="fccf7-167">Windows コンテナーを使用する利点は、一般にコンテナーから得られる利点と基本的に同じです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-167">The benefits of using Windows Containers are fundamentally the same benefits you get from containers in general.</span></span> <span data-ttu-id="fccf7-168">Windows コンテナーを使用することは、機敏性、移植性、および制御を大幅に向上させることです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-168">Using Windows Containers is about greatly improving agility, portability, and control.</span></span>

<span data-ttu-id="fccf7-169">既存の .NET アプリケーションは、.NET Framework を使用して作成されたアプリケーションを参照します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-169">Existing .NET applications refer to those applications that were created using the .NET Framework.</span></span> <span data-ttu-id="fccf7-170">たとえば、従来の ASP.NET web アプリケーションである場合があります。 .NET Core は使用されず、Linux、Windows、MacOS でクロスプラットフォームで実行されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-170">For example, they might be traditional ASP.NET web applications-they don't use .NET Core, which is newer and runs cross-platform on Linux, Windows, and MacOS.</span></span>

<span data-ttu-id="fccf7-171">.NET Framework の主な依存関係は Windows です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-171">The main dependency in the .NET Framework is Windows.</span></span> <span data-ttu-id="fccf7-172">また、IIS のようなセカンダリの依存関係と、従来の ASP.NET の System.web もあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-172">It also has secondary dependencies, like IIS, and System.Web in traditional ASP.NET.</span></span>

<span data-ttu-id="fccf7-173">.NET Framework アプリケーションは、Windows、ピリオドで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-173">A .NET Framework application must run on Windows, period.</span></span> <span data-ttu-id="fccf7-174">既存の .NET Framework アプリケーションをコンテナー化する場合に、.NET Core への移行に投資することはできないかどうか (「正常に動作している場合は移行しない」)、コンテナーの唯一の選択肢は Windows コンテナーを使用することです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-174">If you want to containerize existing .NET Framework applications and you can't or don't want to invest in a migration to .NET Core ("If it works properly, don't migrate it"), the only choice you have for containers is to use Windows Containers.</span></span>

<span data-ttu-id="fccf7-175">Windows コンテナーの主な利点の1つは、コンテナー化で実行されている既存の .NET Framework アプリケーションを最新化する方法を提供できることです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-175">So, one of the main benefits of Windows Containers is that they offer you a way to modernize your existing .NET Framework applications that are running on Windows-through containerization.</span></span> <span data-ttu-id="fccf7-176">最終的に、Windows コンテナーは、コンテナーを使用して求めているメリットを得ることができます。俊敏性、移植性、および制御が優れています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-176">Ultimately, Windows Containers gets you the benefits that you are looking for by using containers-agility, portability, and better control.</span></span>

## <a name="choose-an-os-to-target-with-net-based-containers"></a><span data-ttu-id="fccf7-177">対象の OS を選択します。NET ベースのコンテナー</span><span class="sxs-lookup"><span data-stu-id="fccf7-177">Choose an OS to target with .NET-based containers</span></span>

<span data-ttu-id="fccf7-178">Docker でサポートされているオペレーティングシステムの多様性と、.NET Framework と .NET Core の違いにより、使用しているフレームワークに基づいて特定の OS と特定のバージョンを対象にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-178">Given the diversity of operating systems that are supported by Docker, as well as the differences between .NET Framework and .NET Core, you should target a specific OS and specific versions based on the framework you are using.</span></span>

<span data-ttu-id="fccf7-179">Windows の場合、Windows Server Core または Windows Nano Server を使用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-179">For Windows, you can use Windows Server Core or Windows Nano Server.</span></span> <span data-ttu-id="fccf7-180">これらの Windows バージョンには、.NET Framework または .NET Core アプリケーションで必要となる可能性があるさまざまな特性 (IIS と、Kestrel などの自己ホスト型 web サーバー) が用意されています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-180">These Windows versions provide different characteristics (like IIS versus a self-hosted web server like Kestrel) that might be needed by .NET Framework or .NET Core applications.</span></span>

<span data-ttu-id="fccf7-181">Linux の場合、複数のディストリビューションを利用できます。また、Linux は公式の .NET Docker イメージ (Debian など) でサポートされています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-181">For Linux, multiple distros are available and supported in official .NET Docker images (like Debian).</span></span>

<span data-ttu-id="fccf7-182">図4-7 に、アプリのバージョン .NET Framework に応じてターゲットにできる OS バージョンを示します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-182">Figure 4-7 shows OS versions that you can target, depending on the app's version of the .NET Framework.</span></span>

![.NET Framework のバージョンに基づいて対象とするオペレーティングシステム](./media/image7.png)

<span data-ttu-id="fccf7-184">**図 4-7.**</span><span class="sxs-lookup"><span data-stu-id="fccf7-184">**Figure 4-7.**</span></span> <span data-ttu-id="fccf7-185">.NET Framework のバージョンに基づいて対象とするオペレーティングシステム</span><span class="sxs-lookup"><span data-stu-id="fccf7-185">Operating systems to target based on .NET Framework version</span></span>

<span data-ttu-id="fccf7-186">.NET Framework アプリケーションに基づく既存またはレガシアプリケーションの移行シナリオでは、主な依存関係は Windows と IIS にあります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-186">In migration scenarios for existing or legacy applications that are based on .NET Framework applications, the main dependencies are on Windows and IIS.</span></span> <span data-ttu-id="fccf7-187">唯一のオプションは、Windows Server Core と .NET Framework に基づく Docker イメージを使用することです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-187">Your only option is to use Docker images based on Windows Server Core and the .NET Framework.</span></span>

<span data-ttu-id="fccf7-188">イメージ名を Dockerfile ファイルに追加すると、次の例のように、タグを使用してオペレーティングシステムとバージョンを選択できます。 .NET Framework ベースの Windows コンテナーイメージについては、次の例をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="fccf7-188">When you add the image name to your Dockerfile file, you can select the operating system and version by using a tag, as in the following examples for .NET Framework-based Windows container images:</span></span>

> | <span data-ttu-id="fccf7-189">**番号**</span><span class="sxs-lookup"><span data-stu-id="fccf7-189">**Tag**</span></span> | <span data-ttu-id="fccf7-190">**システムとバージョン**</span><span class="sxs-lookup"><span data-stu-id="fccf7-190">**System and version**</span></span> |
> |---|---|
> | <span data-ttu-id="fccf7-191">**microsoft/dotnet-framework:4.x-windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="fccf7-191">**microsoft/dotnet-framework:4.x-windowsservercore**</span></span> | <span data-ttu-id="fccf7-192">Windows Server Core での .NET Framework 4.x</span><span class="sxs-lookup"><span data-stu-id="fccf7-192">.NET Framework 4.x on Windows Server Core</span></span> |
> | <span data-ttu-id="fccf7-193">**microsoft/aspnet:4.x-windowsservercore**</span><span class="sxs-lookup"><span data-stu-id="fccf7-193">**microsoft/aspnet:4.x-windowsservercore**</span></span> | <span data-ttu-id="fccf7-194">Windows Server Core で ASP.NET カスタマイズが追加された .NET Framework 4.x</span><span class="sxs-lookup"><span data-stu-id="fccf7-194">.NET Framework 4.x with additional ASP.NET customization, on Windows Server Core</span></span> |

<span data-ttu-id="fccf7-195">.NET Core (Linux と Windows のクロスプラットフォーム) の場合、タグは次のようになります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-195">For .NET Core (cross-platform for Linux and Windows), the tags would look like the following:</span></span>

> | <span data-ttu-id="fccf7-196">**番号**</span><span class="sxs-lookup"><span data-stu-id="fccf7-196">**Tag**</span></span> | <span data-ttu-id="fccf7-197">**システムとバージョン**</span><span class="sxs-lookup"><span data-stu-id="fccf7-197">**System and version**</span></span>
> |---|---|
> | <span data-ttu-id="fccf7-198">**microsoft/dotnet:2.0.0-runtime**</span><span class="sxs-lookup"><span data-stu-id="fccf7-198">**microsoft/dotnet:2.0.0-runtime**</span></span> | <span data-ttu-id="fccf7-199">.NET Core 2.0 ランタイム-Linux 上のみ</span><span class="sxs-lookup"><span data-stu-id="fccf7-199">.NET Core 2.0 runtime-only on Linux</span></span> |
> | <span data-ttu-id="fccf7-200">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="fccf7-200">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span></span> | <span data-ttu-id="fccf7-201">.NET Core 2.0 ランタイム-Windows Nano Server のみ</span><span class="sxs-lookup"><span data-stu-id="fccf7-201">.NET Core 2.0 runtime-only on Windows Nano Server</span></span> |

### <a name="multi-arch-images"></a><span data-ttu-id="fccf7-202">マルチアーキテクチャイメージ</span><span class="sxs-lookup"><span data-stu-id="fccf7-202">Multi-arch images</span></span>

<span data-ttu-id="fccf7-203">2017以降では、[マルチアーキテクチャ](https://github.com/moby/moby/issues/15866)イメージと呼ばれる Docker の新機能を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-203">Beginning in mid-2017, you also can use a new feature in Docker called [multi-arch](https://github.com/moby/moby/issues/15866) images.</span></span> <span data-ttu-id="fccf7-204">.NET Core Docker イメージでは、マルチアーキテクチャタグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-204">.NET Core Docker images can use multi-arch tags.</span></span> <span data-ttu-id="fccf7-205">Dockerfile ファイルは、対象とするオペレーティングシステムを定義する必要がなくなりました。</span><span class="sxs-lookup"><span data-stu-id="fccf7-205">Your Dockerfile files no longer need to define the operating system that you are targeting.</span></span> <span data-ttu-id="fccf7-206">マルチアーキテクチャ機能では、複数のコンピューター構成で1つのタグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-206">The multi-arch feature allows a single tag to be used across multiple machine configurations.</span></span> <span data-ttu-id="fccf7-207">たとえば、マルチアーキテクチャでは、 **microsoft/dotnet: 2.0.0**という1つの共通タグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-207">For instance, with multi-arch, you can use one common tag: **microsoft/dotnet:2.0.0-runtime**.</span></span> <span data-ttu-id="fccf7-208">Linux コンテナー環境からそのタグをプルすると、Debian ベースのイメージを取得できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-208">If you pull that tag from a Linux container environment, you get the Debian-based image.</span></span> <span data-ttu-id="fccf7-209">このタグを Windows コンテナー環境からプルすると、Nano Server ベースのイメージが取得されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-209">If you pull that tag from a Windows container environment, you get the Nano Server-based image.</span></span>

<span data-ttu-id="fccf7-210">.NET Framework イメージの場合、従来の .NET Framework では Windows のみがサポートされるため、マルチアーキテクチャ機能は使用できません。</span><span class="sxs-lookup"><span data-stu-id="fccf7-210">For .NET Framework images, because the traditional .NET Framework supports only Windows, you cannot use the multi-arch feature.</span></span>

## <a name="windows-container-types"></a><span data-ttu-id="fccf7-211">Windows コンテナーの種類</span><span class="sxs-lookup"><span data-stu-id="fccf7-211">Windows container types</span></span>

<span data-ttu-id="fccf7-212">Linux コンテナーと同様に、Windows Server コンテナーは Docker エンジンを使用して管理されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-212">Like Linux containers, Windows Server containers are managed by using Docker Engine.</span></span> <span data-ttu-id="fccf7-213">Linux コンテナーとは異なり、Windows コンテナーには、2つの異なるコンテナーの種類、または実行時-Windows Server のコンテナーと Hyper-v の分離が含まれています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-213">Unlike Linux containers, Windows containers include two different container types, or run times-Windows Server containers and Hyper-V isolation.</span></span>

<span data-ttu-id="fccf7-214">**Windows Server のコンテナー**:プロセスと名前空間の分離テクノロジを使用して、アプリケーションを分離します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-214">**Windows Server containers**: Provides application isolation through process and namespace isolation technology.</span></span> <span data-ttu-id="fccf7-215">Windows Server コンテナーは、コンテナーホストとホストで実行されているすべてのコンテナーとカーネルを共有します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-215">A Windows Server container shares a kernel with the container host and all containers that are running on the host.</span></span> <span data-ttu-id="fccf7-216">これらのコンテナーは、悪意のあるセキュリティ境界を提供しないため、信頼されていないコードを分離するために使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="fccf7-216">These containers do not provide a hostile security boundary and should not be used to isolate untrusted code.</span></span> <span data-ttu-id="fccf7-217">これらのコンテナーには、共有されたカーネル空間があるため、同じカーネルバージョンと構成が必要です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-217">Because of the shared kernel space, these containers require the same kernel version and configuration.</span></span>

<span data-ttu-id="fccf7-218">**Hyper-v の分離**:高度に最適化された VM で各コンテナーを実行することで、Windows Server コンテナーによって提供される分離を拡大します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-218">**Hyper-V isolation**: Expands on the isolation provided by Windows Server Containers by running each container on a highly optimized VM.</span></span> <span data-ttu-id="fccf7-219">この構成では、コンテナーホストのカーネルは、同じホスト上の他のコンテナーとは共有されません。</span><span class="sxs-lookup"><span data-stu-id="fccf7-219">In this configuration, the kernel of the container host is not shared with other containers on the same host.</span></span> <span data-ttu-id="fccf7-220">これらのコンテナーは、VM と同じセキュリティ保証で、悪意のあるマルチテナントホスティング向けに設計されています。</span><span class="sxs-lookup"><span data-stu-id="fccf7-220">These containers are designed for hostile multitenant hosting, with the same security assurances of a VM.</span></span> <span data-ttu-id="fccf7-221">これらのコンテナーは、ホスト上のホストまたはその他のコンテナーとカーネルを共有しないため、異なるバージョンと構成 (サポートされているバージョン) でカーネルを実行できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-221">Because these containers don't share the kernel with the host or other containers on the host, they can run kernels with different versions and configurations (with supported versions).</span></span> <span data-ttu-id="fccf7-222">たとえば、windows 10 のすべての Windows コンテナーは、Windows Server カーネルのバージョンと構成を利用するために、Hyper-v の分離を使用します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-222">For example, all Windows containers on Windows 10 use Hyper-V isolation to utilize the Windows Server kernel version and configuration.</span></span>

<span data-ttu-id="fccf7-223">Hyper-v の分離を使用するかどうかに関係なく、Windows でコンテナーを実行することは、実行時の決定です。</span><span class="sxs-lookup"><span data-stu-id="fccf7-223">Running a container on Windows with or without Hyper-V isolation is a run-time decision.</span></span> <span data-ttu-id="fccf7-224">最初に Hyper-v の分離を使用してコンテナーを作成し、実行時に Windows Server のコンテナーとして実行するように選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-224">You might choose to create the container with Hyper-V isolation initially, and at run time, choose to run it as a Windows Server container instead.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="fccf7-225">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="fccf7-225">Additional resources</span></span>

- <span data-ttu-id="fccf7-226">**Windows コンテナーのドキュメント**</span><span class="sxs-lookup"><span data-stu-id="fccf7-226">**Windows Containers documentation**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/>

- <span data-ttu-id="fccf7-227">**Windows コンテナーの基礎**</span><span class="sxs-lookup"><span data-stu-id="fccf7-227">**Windows Containers fundamentals**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/about/>

- <span data-ttu-id="fccf7-228">**インフォグラフィックMicrosoft とコンテナー**</span><span class="sxs-lookup"><span data-stu-id="fccf7-228">**Infographic: Microsoft and containers**</span></span>

    <https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf>

## <a name="the-container-ecosystem-in-azure"></a><span data-ttu-id="fccf7-229">Azure のコンテナーエコシステム</span><span class="sxs-lookup"><span data-stu-id="fccf7-229">The container ecosystem in Azure</span></span>

<span data-ttu-id="fccf7-230">前のセクションでは、Docker コンテナーの利点、および .NET アプリケーションの特定のコンテナーイメージの詳細について説明しました。</span><span class="sxs-lookup"><span data-stu-id="fccf7-230">In previous sections, it’s been explained what the benefits of Docker containers are as well as details on the specific container images for .NET applications.</span></span> <span data-ttu-id="fccf7-231">アプリケーションを開発したりコンテナー化したりするための一般的な情報はすべて基本的なものです。</span><span class="sxs-lookup"><span data-stu-id="fccf7-231">All that generic information is fundamental in order to develop or containerize an application.</span></span>
<span data-ttu-id="fccf7-232">ただし、運用環境のデプロイ環境や、QA および開発/テスト環境について考える場合、Microsoft Azure は、クラウドの完全なコンテナーエコシステムであるオープンで広範な選択肢を提供しています (以下の図を参照)。</span><span class="sxs-lookup"><span data-stu-id="fccf7-232">However, when thinking about the production deployment environment or even QA and Dev/Test environments, Microsoft Azure provides an open and broad variety of choices, a full container ecosystem in the cloud (shown in the diagram below).</span></span> <span data-ttu-id="fccf7-233">アプリケーションのニーズに応じて、1つまたは別の Azure 製品を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-233">Depending on your specific application’s needs, you should choose one or another Azure product.</span></span>

![Azure のコンテナーエコシステム](./media/image7.5.png)

<span data-ttu-id="fccf7-235">**図 4-7.5。**</span><span class="sxs-lookup"><span data-stu-id="fccf7-235">**Figure 4-7.5.**</span></span> <span data-ttu-id="fccf7-236">Azure のコンテナーエコシステム</span><span class="sxs-lookup"><span data-stu-id="fccf7-236">The container ecosystem in Azure</span></span>

<span data-ttu-id="fccf7-237">Azure のコンテナーエコシステムから、インフラストラクチャと見なされるコンテナーをサポートする次の製品があります。</span><span class="sxs-lookup"><span data-stu-id="fccf7-237">From the container ecosystem in Azure, the following products supporting containers that are considered infrastructure:</span></span>
- <span data-ttu-id="fccf7-238">**Azure Container Instances (ACI)**</span><span class="sxs-lookup"><span data-stu-id="fccf7-238">**Azure Container Instances (ACI)**</span></span>
- <span data-ttu-id="fccf7-239">**Azure Virtual Machines**(コンテナーのサポートあり)</span><span class="sxs-lookup"><span data-stu-id="fccf7-239">**Azure Virtual Machines** (With container's support)</span></span>
- <span data-ttu-id="fccf7-240">**Azure Virtual Machine Scale Sets**(コンテナーのサポートあり)</span><span class="sxs-lookup"><span data-stu-id="fccf7-240">**Azure Virtual Machine Scale Sets** (With container's support)</span></span>

<span data-ttu-id="fccf7-241">これら3つのうち、ACI には大きな利点があります。これは、基盤となる OS を維持する必要がなく、アップグレードやパッチなどを行う必要がないという事実ですが、このブックの今後のセクションで説明するように、ACI は引き続きインフラストラクチャレベルに配置されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-241">From those three, ACI provides a great benefit, which is the fact that you don't need to maintain the underlying OS, no need for you to upgrade/patch, etc. but ACI still is positioned in the infrastructure level, as better explained in the upcoming sections of this book.</span></span>

<span data-ttu-id="fccf7-242">Azure サポートコンテナーの製品は、PaaS (サービスとしてのプラットフォーム) レベルで同時に配置されます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-242">The products in Azure supporting containers that are at the same time positioned more in the PaaS (Platform as a Service) level are:</span></span>

- <span data-ttu-id="fccf7-243">**Azure App Service**</span><span class="sxs-lookup"><span data-stu-id="fccf7-243">**Azure App Service**</span></span>
- <span data-ttu-id="fccf7-244">**Azure Kubernetes サービス (AKS と ACS)**</span><span class="sxs-lookup"><span data-stu-id="fccf7-244">**Azure Kubernetes Service (AKS and ACS)**</span></span>
- <span data-ttu-id="fccf7-245">**Azure Batch**</span><span class="sxs-lookup"><span data-stu-id="fccf7-245">**Azure Batch**</span></span> 

<span data-ttu-id="fccf7-246">次に、Azure でホストされている拡張性の高いコンテナーレジストリを Azure Container Registry します。これは、カスタムコンテナーイメージを登録してデプロイするときに、以前のすべての製品から使用できます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-246">Then, Azure Container Registry is a high scalable container registry hosted in Azure that you can use from all the previous products when registering and deploying your custom container images.</span></span>

<span data-ttu-id="fccf7-247">さらに、コンテナーから、Azure SQL Database、Azure Redis cache、Azure Cosmos DB など、Azure の他の管理されたサービスを利用することもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-247">In addition, from your containers, you can consume other managed services in Azure like Azure SQL Database, Azure Redis cache, Azure Cosmos DB, etc.</span></span> <span data-ttu-id="fccf7-248">また、Azure Marketplace には、Cloud Foundry や OpenShift などのサードパーティ製ソリューション/プラットフォームも用意されており、Azure 内でコンテナーを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="fccf7-248">plus there are third-party solutions/platforms available in Azure Marketplace like Cloud Foundry and OpenShift where you can also use containers within Azure.</span></span> 

<span data-ttu-id="fccf7-249">次のセクションでは、Windows コンテナーを対象とする場合に、これらの各 Azure 製品とソリューションを使用するタイミングに関する Microsoft の推奨事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="fccf7-249">In the next sections, you can explore Microsoft's recommendations on when to use each of those Azure products and solutions specifically when targeting Windows Containers.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="fccf7-250">[前へ](what-about-cloud-native-applications.md)
>[次へ](when-not-to-deploy-to-windows-containers.md)</span><span class="sxs-lookup"><span data-stu-id="fccf7-250">[Previous](what-about-cloud-native-applications.md)
[Next](when-not-to-deploy-to-windows-containers.md)</span></span>
